import{bt as W,bs as v,dE as Z,ck as P,cn as c,co as d,cp as s,cr as o,cB as m,cs as l,cG as b,ct as i,bE as e,cq as a,gB as H,dZ as F,gd as Q,cu as E,eD as ee,cS as C,df as R,fr as V,du as O,dl as te,dq as ae,dn as se,gC as oe,gD as ne,dM as re,cj as k,cl as Y}from"./vendor-DTjPma1U.js";import{a as le}from"./AppLayout.vue_vue_type_script_setup_true_lang-BDhU9anl.js";import{_ as f,a as _}from"./CardContent.vue_vue_type_script_setup_true_lang-I4CEGKdn.js";import{_ as S}from"./CardDescription.vue_vue_type_script_setup_true_lang-CWoegFai.js";import{_ as $,a as B}from"./CardTitle.vue_vue_type_script_setup_true_lang-CV0UXs4e.js";import{_ as x}from"./index-mwxrBKxi.js";import{_ as L}from"./Input.vue_vue_type_script_setup_true_lang-DAeY8mMm.js";import{_ as U}from"./Label.vue_vue_type_script_setup_true_lang-D84UGLqY.js";import{_ as N}from"./index-3KGx5n4o.js";import{_ as q,a as G}from"./index-flAI1UrP.js";import{b as de,c as ie,d as ue}from"./WordBalanceDisplay.vue_vue_type_script_setup_true_lang-9Gi9MMOg.js";import{_ as ce,a as me,b as fe,c as _e,d as pe,e as be}from"./index-Dh9-s5cZ.js";import"./UserInfo.vue_vue_type_script_setup_true_lang-tVoAfrlY.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-DunnpUO7.js";import"./Sonner.vue_vue_type_script_setup_true_lang-D0ynKKgD.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-DJJgD8pr.js";import"./useAppearance-C_-cKrTG.js";import"./useWordBalance-CuedtyJP.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./PWAInstallPrompt.vue_vue_type_script_setup_true_lang-C9K06Fb-.js";const ge={class:"container mx-auto px-4 py-8 max-w-6xl"},ye={class:"mb-8"},ve={class:"text-muted-foreground mt-1"},ke={class:"space-y-4"},xe={class:"space-y-2"},he={class:"space-y-2"},we={class:"flex gap-2"},Ce={key:1,class:"p-4 rounded-lg bg-green-500/10 border border-green-500/20"},Se={class:"text-lg font-semibold text-green-600"},$e={class:"grid gap-4 md:grid-cols-4 mb-8"},Be={class:"flex items-center gap-4"},Ne={class:"p-3 rounded-xl bg-blue-500/10 text-blue-500"},Te={class:"text-2xl font-bold"},Ee={class:"text-xs text-muted-foreground"},Re={class:"flex items-center gap-4"},Ae={class:"p-3 rounded-xl bg-green-500/10 text-green-500"},je={class:"text-2xl font-bold"},De={class:"flex items-center gap-4"},Pe={class:"p-3 rounded-xl bg-yellow-500/10 text-yellow-500"},Fe={class:"text-2xl font-bold"},Ve={class:"flex items-center gap-4"},Oe={class:"p-3 rounded-xl bg-purple-500/10 text-purple-500"},Ye={class:"text-2xl font-bold"},Le={class:"flex gap-2"},Ue={class:"text-sm text-muted-foreground mt-2"},qe={class:"px-2 py-1 bg-muted rounded font-mono"},Ge={class:"grid gap-8 lg:grid-cols-2"},Je={key:0,class:"text-center py-8 text-muted-foreground"},ze={key:1,class:"space-y-4"},Ke={class:"font-medium"},Me={class:"text-sm text-muted-foreground"},Xe={class:"text-xs text-muted-foreground"},Ie={class:"text-right"},We={class:"font-semibold text-green-600"},Ze={key:0,class:"text-center py-8 text-muted-foreground"},He={key:1,class:"space-y-3"},Qe={class:"font-medium"},et={class:"text-sm text-muted-foreground"},tt={class:"text-xs text-muted-foreground"},at={class:"text-right"},wt=W({__name:"Dashboard",props:{data:{},banks:{},isEnabled:{type:Boolean}},setup(J){const g=J,h=v(!1),w=v(!1),y=v(null),p=v(null),u=Z({bank_code:"",bank_name:"",account_number:"",account_name:""}),A=P(()=>g.banks.find(n=>n.code===u.bank_code)),T=v(!1),z=P(()=>typeof navigator<"u"&&typeof navigator.share=="function"),j=()=>{g.data.referral_link&&(navigator.clipboard.writeText(g.data.referral_link),h.value=!0,k.success("Referral link copied to clipboard!"),setTimeout(()=>{h.value=!1},2e3))},K=async()=>{if(g.data.referral_link){if(z.value){try{await navigator.share({title:"Join me on Finalyze",text:"Use my referral link to sign up.",url:g.data.referral_link})}catch{}return}j()}},M=async()=>{if(!u.bank_code||u.account_number.length!==10){p.value="Please select a bank and enter a 10-digit account number";return}w.value=!0,p.value=null,y.value=null;try{const t=await(await fetch(Y("affiliate.verify-bank"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({bank_code:u.bank_code,account_number:u.account_number})})).json();t.success?(y.value=t.account_name,u.account_name=t.account_name,u.bank_name=A.value?.name||"",k.success("Bank account verified!")):p.value=t.message||"Could not verify account"}catch{p.value="Failed to verify account. Please try again."}finally{w.value=!1}},X=async()=>{try{const t=await(await fetch(Y("affiliate.setup-bank"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify(u.data())})).json();t.success?(k.success("Bank account setup complete! You can now share your referral link."),window.location.reload()):k.error(t.message||"Failed to setup bank account. Please try again.")}catch{k.error("Failed to setup bank account. Please try again.")}},D=n=>new Date(n).toLocaleDateString("en-NG",{year:"numeric",month:"short",day:"numeric"}),I=n=>{switch(n){case"paid":return"bg-green-500/10 text-green-600 border-green-500/20";case"pending":return"bg-yellow-500/10 text-yellow-600 border-yellow-500/20";case"failed":return"bg-red-500/10 text-red-600 border-red-500/20";default:return"bg-gray-500/10 text-gray-600 border-gray-500/20"}};return(n,t)=>(d(),c(le,{title:"Affiliate Dashboard"},{default:s(()=>[o("div",ge,[o("div",ye,[t[3]||(t[3]=o("h1",{class:"text-3xl font-bold tracking-tight"},"Affiliate Dashboard",-1)),o("p",ve,[l(" Earn "+i(n.data.commission_rate)+"% commission on every purchase made by users you refer. ",1),n.data.has_custom_rate?(d(),c(e(N),{key:0,variant:"secondary",class:"ml-2"},{default:s(()=>[a(e(H),{class:"h-3 w-3 mr-1"}),t[2]||(t[2]=l(" VIP Rate ",-1))]),_:1})):b("",!0)])]),n.isEnabled?n.data.bank_setup_complete?(d(),m(C,{key:2},[o("div",$e,[a(e(f),{class:"bg-card border-border/50"},{default:s(()=>[a(e(_),{class:"p-6"},{default:s(()=>[o("div",Be,[o("div",Ne,[a(e(te),{class:"h-6 w-6"})]),o("div",null,[t[13]||(t[13]=o("p",{class:"text-sm text-muted-foreground"},"Total Referrals",-1)),o("p",Te,i(n.data.stats.total_referrals),1),o("p",Ee,i(n.data.stats.active_referrals)+" made purchases ",1)])])]),_:1})]),_:1}),a(e(f),{class:"bg-card border-border/50"},{default:s(()=>[a(e(_),{class:"p-6"},{default:s(()=>[o("div",Re,[o("div",Ae,[a(e(ae),{class:"h-6 w-6"})]),o("div",null,[t[14]||(t[14]=o("p",{class:"text-sm text-muted-foreground"},"Total Earned",-1)),o("p",je,i(n.data.stats.total_earned_formatted),1)])])]),_:1})]),_:1}),a(e(f),{class:"bg-card border-border/50"},{default:s(()=>[a(e(_),{class:"p-6"},{default:s(()=>[o("div",De,[o("div",Pe,[a(e(se),{class:"h-6 w-6"})]),o("div",null,[t[15]||(t[15]=o("p",{class:"text-sm text-muted-foreground"},"This Month",-1)),o("p",Fe,i(n.data.stats.this_month_formatted),1)])])]),_:1})]),_:1}),a(e(f),{class:"bg-card border-border/50"},{default:s(()=>[a(e(_),{class:"p-6"},{default:s(()=>[o("div",Ve,[o("div",Oe,[a(e(oe),{class:"h-6 w-6"})]),o("div",null,[t[16]||(t[16]=o("p",{class:"text-sm text-muted-foreground"},"Commission Rate",-1)),o("p",Ye,i(n.data.commission_rate)+"%",1)])])]),_:1})]),_:1})]),a(e(f),{class:"mb-8 border-primary/20 bg-gradient-to-r from-primary/5 to-transparent"},{default:s(()=>[a(e($),null,{default:s(()=>[a(e(B),null,{default:s(()=>[...t[17]||(t[17]=[l("Your Referral Link",-1)])]),_:1}),a(e(S),null,{default:s(()=>[l(" Share this link with friends. When they sign up and make a purchase, you earn "+i(n.data.commission_rate)+"%! ",1)]),_:1})]),_:1}),a(e(_),null,{default:s(()=>[o("div",Le,[a(e(L),{"model-value":n.data.referral_link||"",readonly:"",class:"flex-1 bg-background font-mono text-sm"},null,8,["model-value"]),n.data.referral_link?(d(),c(e(x),{key:0,onClick:K,variant:"outline"},{default:s(()=>[a(e(ne),{class:"h-4 w-4 mr-2"}),t[18]||(t[18]=l(" Share ",-1))]),_:1})):b("",!0),a(e(x),{onClick:j,variant:"outline"},{default:s(()=>[h.value?(d(),c(e(V),{key:0,class:"h-4 w-4 mr-2 text-green-500"})):(d(),c(e(re),{key:1,class:"h-4 w-4 mr-2"})),l(" "+i(h.value?"Copied!":"Copy"),1)]),_:1})]),o("p",Ue,[t[19]||(t[19]=l(" Your referral code: ",-1)),o("code",qe,i(n.data.referral_code),1)])]),_:1})]),_:1}),o("div",Ge,[a(e(f),{class:"border-border/50"},{default:s(()=>[a(e($),null,{default:s(()=>[a(e(B),{class:"text-base"},{default:s(()=>[...t[20]||(t[20]=[l("Recent Earnings",-1)])]),_:1}),a(e(S),null,{default:s(()=>[...t[21]||(t[21]=[l("Your latest commission earnings",-1)])]),_:1})]),_:1}),a(e(_),null,{default:s(()=>[n.data.recent_earnings.length===0?(d(),m("div",Je," No earnings yet. Share your referral link to start earning! ")):(d(),m("div",ze,[(d(!0),m(C,null,R(n.data.recent_earnings,r=>(d(),m("div",{key:r.id,class:"flex items-center justify-between p-3 rounded-lg bg-muted/50 border border-border/50"},[o("div",null,[o("p",Ke,i(r.referee_name),1),o("p",Me,i(r.payment_formatted)+" purchase ",1),o("p",Xe,i(D(r.created_at)),1)]),o("div",Ie,[o("p",We,i(r.commission_formatted),1),a(e(N),{class:E(I(r.status)),variant:"outline"},{default:s(()=>[l(i(r.status),1)]),_:2},1032,["class"])])]))),128))]))]),_:1})]),_:1}),a(e(f),{class:"border-border/50"},{default:s(()=>[a(e($),null,{default:s(()=>[a(e(B),{class:"text-base"},{default:s(()=>[...t[22]||(t[22]=[l("Your Referrals",-1)])]),_:1}),a(e(S),null,{default:s(()=>[...t[23]||(t[23]=[l("People who signed up with your link",-1)])]),_:1})]),_:1}),a(e(_),null,{default:s(()=>[n.data.referrals.length===0?(d(),m("div",Ze," No referrals yet. Share your link to invite friends! ")):(d(),m("div",He,[(d(!0),m(C,null,R(n.data.referrals,r=>(d(),m("div",{key:r.id,class:"flex items-center justify-between p-3 rounded-lg bg-muted/50 border border-border/50"},[o("div",null,[o("p",Qe,i(r.name),1),o("p",et,i(r.email),1),o("p",tt," Joined "+i(D(r.joined_at)),1)]),o("div",at,[r.successful_payments_count>0?(d(),c(e(N),{key:0,class:"bg-green-500/10 text-green-600 border-green-500/20"},{default:s(()=>[l(i(r.successful_payments_count)+" purchase"+i(r.successful_payments_count>1?"s":""),1)]),_:2},1024)):(d(),c(e(N),{key:1,variant:"outline",class:"text-muted-foreground"},{default:s(()=>[...t[24]||(t[24]=[l(" No purchases ",-1)])]),_:1}))])]))),128))]))]),_:1})]),_:1})])],64)):(d(),c(e(f),{key:1,class:"max-w-2xl"},{default:s(()=>[a(e($),null,{default:s(()=>[a(e(B),{class:"flex items-center gap-2"},{default:s(()=>[a(e(Q),{class:"h-5 w-5"}),t[5]||(t[5]=l(" Setup Your Bank Account ",-1))]),_:1}),a(e(S),null,{default:s(()=>[...t[6]||(t[6]=[l(" To start earning commissions, you need to setup your bank account first. Your commissions will be automatically sent to this account. ",-1)])]),_:1})]),_:1}),a(e(_),{class:"space-y-6"},{default:s(()=>[o("div",ke,[o("div",xe,[a(e(U),null,{default:s(()=>[...t[7]||(t[7]=[l("Select Bank",-1)])]),_:1}),a(e(de),{open:T.value,"onUpdate:open":t[0]||(t[0]=r=>T.value=r)},{default:s(()=>[a(e(ie),{"as-child":""},{default:s(()=>[a(e(x),{variant:"outline",role:"combobox",class:E(["w-full justify-between",!e(u).bank_code&&"text-muted-foreground"])},{default:s(()=>[l(i(A.value?.name??"Choose your bank")+" ",1),a(e(ee),{class:"ml-2 h-4 w-4 shrink-0 opacity-50"})]),_:1},8,["class"])]),_:1}),a(e(ue),{class:"w-full p-0",align:"start"},{default:s(()=>[a(e(ce),null,{default:s(()=>[a(e(me),{placeholder:"Search bank..."}),a(e(fe),null,{default:s(()=>[...t[8]||(t[8]=[l("No bank found.",-1)])]),_:1}),a(e(_e),null,{default:s(()=>[a(e(pe),null,{default:s(()=>[(d(!0),m(C,null,R(n.banks,r=>(d(),c(e(be),{key:r.code,value:r.name,onSelect:()=>{e(u).bank_code=r.code,e(u).bank_name=r.name,T.value=!1}},{default:s(()=>[l(i(r.name)+" ",1),a(e(V),{class:E(["ml-auto h-4 w-4",r.code===e(u).bank_code?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]),o("div",he,[a(e(U),null,{default:s(()=>[...t[9]||(t[9]=[l("Account Number",-1)])]),_:1}),o("div",we,[a(e(L),{modelValue:e(u).account_number,"onUpdate:modelValue":t[1]||(t[1]=r=>e(u).account_number=r),placeholder:"Enter 10-digit account number",maxlength:"10",class:"flex-1"},null,8,["modelValue"]),a(e(x),{onClick:M,disabled:w.value||!e(u).bank_code||e(u).account_number.length!==10,variant:"outline"},{default:s(()=>[w.value?(d(),c(e(O),{key:0,class:"h-4 w-4 animate-spin mr-2"})):b("",!0),t[10]||(t[10]=l(" Verify ",-1))]),_:1},8,["disabled"])])]),p.value?(d(),c(e(q),{key:0,variant:"destructive"},{default:s(()=>[a(e(F),{class:"h-4 w-4"}),a(e(G),null,{default:s(()=>[l(i(p.value),1)]),_:1})]),_:1})):b("",!0),y.value?(d(),m("div",Ce,[t[11]||(t[11]=o("p",{class:"text-sm text-muted-foreground"},"Account Name",-1)),o("p",Se,i(y.value),1)])):b("",!0)]),a(e(x),{onClick:X,disabled:!y.value||e(u).processing,class:"w-full"},{default:s(()=>[e(u).processing?(d(),c(e(O),{key:0,class:"h-4 w-4 animate-spin mr-2"})):b("",!0),t[12]||(t[12]=l(" Complete Setup & Get Referral Code ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})):(d(),c(e(q),{key:0,class:"mb-6"},{default:s(()=>[a(e(F),{class:"h-4 w-4"}),a(e(G),null,{default:s(()=>[...t[4]||(t[4]=[l(" The affiliate program is currently disabled. Please check back later. ",-1)])]),_:1})]),_:1}))])]),_:1}))}});export{wt as default};
