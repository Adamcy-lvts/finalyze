import{d as J,I as L,g as V,o as p,w as l,e as s,u as e,b as n,b_ as M,h as o,V as q,bF as z,aq as G,bl as Y,_ as j,aw as f,bE as T,T as H,m as U,r as B,D as Q,ax as R,b$ as W,a as g,Y as X,t as _,aD as Z,c as y,a1 as ee}from"./vendor-CwVTuNDX.js";import{s as $}from"./app-Cc9TUqoT.js";import{_ as te}from"./AdminLayout.vue_vue_type_script_setup_true_lang-H2BJd-PL.js";import{_ as se}from"./DataTable.vue_vue_type_script_setup_true_lang-9SDF-RlL.js";import{_ as re}from"./index-D-ML2bGq.js";import{_ as I}from"./Switch.vue_vue_type_script_setup_true_lang-CSQiFhKB.js";import{_ as b}from"./index-CrxE9Zi3.js";import{a as le,b as ae,e as oe,c as E,f as ue,_ as ne}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-Bf5Vg9oh.js";import{_ as de,a as ie}from"./CardContent.vue_vue_type_script_setup_true_lang-BtnEOQTw.js";import{_ as ce}from"./CardDescription.vue_vue_type_script_setup_true_lang-Brri8w8u.js";import{_ as me,a as pe}from"./CardTitle.vue_vue_type_script_setup_true_lang-nJJ1IpBN.js";import{_ as F}from"./Input.vue_vue_type_script_setup_true_lang-C_DmbuW5.js";import{_ as v}from"./Label.vue_vue_type_script_setup_true_lang-BO6sf_Jr.js";import{_ as k}from"./Textarea.vue_vue_type_script_setup_true_lang-AJoN-JVQ.js";import{_ as N}from"./Checkbox.vue_vue_type_script_setup_true_lang-6dk4bZib.js";import{_ as fe,a as _e}from"./index-QaS4lz9S.js";import{_ as ge}from"./AlertTitle.vue_vue_type_script_setup_true_lang-BxemBwiM.js";import{a as ye,_ as ve}from"./DialogContent.vue_vue_type_script_setup_true_lang-2N0uTeXP.js";import{_ as xe}from"./DialogDescription.vue_vue_type_script_setup_true_lang-D2my-8qT.js";import{_ as be,a as he}from"./DialogTitle.vue_vue_type_script_setup_true_lang-B3TbSoEk.js";import{_ as ke,a as $e,b as we,c as Se}from"./AccordionTrigger.vue_vue_type_script_setup_true_lang-ClJx0JKp.js";import"./UserInfo.vue_vue_type_script_setup_true_lang-B09QH7gk.js";import"./Presence-DIu7Hq1J.js";import"./useForwardExpose-DzXfkUQ9.js";import"./index-BaA8aalJ.js";import"./DialogTitle-DCnPxe3d.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-CN-XKNc_.js";import"./VisuallyHidden-DPKZa3kD.js";import"./index-wCVBFwDO.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-CQsg0FAl.js";import"./useFormControl-D0no87xr.js";import"./VisuallyHiddenInput-CSQJp8H2.js";import"./nullish-CHIgUVhi.js";import"./isValueEqualOrExist-DSClXoPv.js";import"./ohash.D__AXeF1-C-E83dC9.js";import"./RovingFocusItem-VdLAJO2h.js";import"./CollapsibleTrigger-N_6l0ttW.js";const Ve=J({__name:"StructureActions",props:{structure:{}},setup(u){const c=u,h=L("onEditFacultyStructure"),w=()=>{confirm(`Delete ${c.structure.faculty_name}? This will also delete chapters/sections.`)&&j.delete($("admin.system.faculty-structures.destroy",{structure:c.structure.id}),{preserveScroll:!0})};return(O,i)=>(p(),V(e(ne),null,{default:l(()=>[s(e(le),{"as-child":""},{default:l(()=>[s(e(b),{variant:"ghost",class:"h-8 w-8 p-0"},{default:l(()=>[i[1]||(i[1]=n("span",{class:"sr-only"},"Open menu",-1)),s(e(M),{class:"h-4 w-4"})]),_:1})]),_:1}),s(e(ae),{align:"end"},{default:l(()=>[s(e(oe),null,{default:l(()=>[...i[2]||(i[2]=[o("Actions",-1)])]),_:1}),s(e(E),{"as-child":""},{default:l(()=>[s(e(q),{href:e($)("admin.system.faculty-structures.show",{structure:c.structure.id})},{default:l(()=>[s(e(z),{class:"mr-2 h-4 w-4"}),i[3]||(i[3]=o(" Manage Chapters ",-1))]),_:1},8,["href"])]),_:1}),s(e(E),{onClick:i[0]||(i[0]=x=>e(h)?.(c.structure))},{default:l(()=>[s(e(G),{class:"mr-2 h-4 w-4"}),i[4]||(i[4]=o(" Edit ",-1))]),_:1}),s(e(ue)),s(e(E),{onClick:w,class:"text-rose-600 focus:text-rose-600 focus:bg-rose-50"},{default:l(()=>[s(e(Y),{class:"mr-2 h-4 w-4"}),i[5]||(i[5]=o(" Delete ",-1))]),_:1})]),_:1})]),_:1}))}}),Ce=(u,c)=>{j.put($("admin.system.faculty-structures.toggle-active",{structure:u.id}),{is_active:c},{preserveScroll:!0})},Ue=[{accessorKey:"faculty_name",header:({column:u})=>f(b,{variant:"ghost",class:"-ml-2 text-xs hover:bg-muted/50",onClick:()=>u.toggleSorting(u.getIsSorted()==="asc")},()=>["Faculty",f(T,{class:"ml-2 h-3 w-3"})]),cell:({row:u})=>{const c=u.original;return f("div",{class:"flex flex-col"},[f("span",{class:"font-medium"},c.faculty_name),f("span",{class:"text-xs text-muted-foreground"},c.faculty_slug)])}},{id:"levels",header:"Levels",cell:({row:u})=>{const c=(u.original.academic_levels??[]).slice(0,3);return c.length?f("div",{class:"flex flex-wrap gap-1"},c.map(h=>f(re,{variant:"outline",class:"capitalize"},()=>h))):f("span",{class:"text-xs text-muted-foreground"},"â€”")}},{accessorKey:"chapters_count",header:({column:u})=>f(b,{variant:"ghost",class:"-ml-2 text-xs hover:bg-muted/50",onClick:()=>u.toggleSorting(u.getIsSorted()==="asc")},()=>["Chapters",f(T,{class:"ml-2 h-3 w-3"})]),cell:({row:u})=>String(u.original.chapters_count??0)},{accessorKey:"sort_order",header:"Order",cell:({row:u})=>u.getValue("sort_order")},{accessorKey:"is_active",header:"Active",cell:({row:u})=>f(I,{checked:!!u.original.is_active,"onUpdate:checked":c=>Ce(u.original,c)})},{id:"actions",cell:({row:u})=>f(Ve,{structure:u.original})}],Ee={class:"grid gap-4 py-4"},Fe={class:"grid gap-4 md:grid-cols-2"},Ne={class:"space-y-1"},Oe={key:0,class:"text-xs text-rose-500"},Ae={class:"space-y-1"},De={key:0,class:"text-xs text-rose-500"},Te={class:"space-y-1"},Be={key:0,class:"text-xs text-rose-500"},Je={class:"grid gap-4 md:grid-cols-3"},je={class:"space-y-1"},Ie={key:0,class:"text-xs text-rose-500"},Ke={class:"flex items-center justify-between rounded-md border border-border/70 bg-muted/30 px-3 py-2 text-sm md:col-span-2"},Pe={class:"space-y-2"},Le={class:"flex flex-wrap gap-4"},Me={class:"flex items-center gap-2 text-sm"},qe={class:"flex items-center gap-2 text-sm"},ze={class:"flex items-center gap-2 text-sm"},Ge={key:0,class:"text-xs text-rose-500"},Ye={class:"space-y-1"},He={key:0,class:"text-xs text-rose-500"},Qe={class:"space-y-1"},Re={key:0,class:"text-xs text-rose-500"},We={class:"space-y-1"},Xe={key:0,class:"text-xs text-rose-500"},Ze={class:"space-y-1"},et={key:0,class:"text-xs text-rose-500"},tt={class:"flex justify-end gap-2"},Kt=J({__name:"Index",props:{structures:{}},setup(u){const c=u,h=H(),w=U(()=>h.props.flash),O=U(()=>c.structures??[]),i=B(null),x=B(!1),m=Q({undergraduate:!0,masters:!0,phd:!0}),A=()=>({faculty_name:"",faculty_slug:"",description:"",is_active:!0,sort_order:0,academic_levels:[],default_structure:"",chapter_templates:"",guidance_templates:"",terminology:""}),r=R({...A()}),C=U(()=>i.value!==null),D=()=>{i.value=null,r.clearErrors(),Object.assign(r,A()),m.undergraduate=!0,m.masters=!0,m.phd=!0},S=d=>{if(d==null)return"";if(typeof d=="string")return d;try{return JSON.stringify(d,null,2)}catch{return""}},K=()=>{D(),x.value=!0};W("onEditFacultyStructure",d=>{i.value=d.id,r.clearErrors(),r.faculty_name=d.faculty_name??"",r.faculty_slug=d.faculty_slug??"",r.description=d.description??"",r.is_active=!!d.is_active,r.sort_order=Number(d.sort_order??0),r.default_structure=S(d.default_structure),r.chapter_templates=S(d.chapter_templates),r.guidance_templates=S(d.guidance_templates),r.terminology=S(d.terminology);const t=d.academic_levels??[];m.undergraduate=t.includes("undergraduate"),m.masters=t.includes("masters"),m.phd=t.includes("phd"),x.value=!0});const P=()=>{r.clearErrors(),r.transform(t=>({...t,sort_order:Number(t.sort_order??0),is_active:!!t.is_active,academic_levels:[...m.undergraduate?["undergraduate"]:[],...m.masters?["masters"]:[],...m.phd?["phd"]:[]]}));const d={preserveScroll:!0,onSuccess:()=>{x.value=!1,D()}};C.value&&i.value?r.put($("admin.system.faculty-structures.update",{structure:i.value}),d):r.post($("admin.system.faculty-structures.store"),d)};return(d,t)=>(p(),V(te,{title:"Faculty Structures",subtitle:"Control chapter titles, word counts, and sections per faculty."},{default:l(()=>[w.value?.success?(p(),V(e(fe),{key:0,class:"mb-6 border border-emerald-500/40 bg-emerald-500/10"},{default:l(()=>[s(e(X),{class:"h-4 w-4 text-emerald-500"}),s(e(ge),null,{default:l(()=>[...t[14]||(t[14]=[o("Updated",-1)])]),_:1}),s(e(_e),null,{default:l(()=>[o(_(w.value.success),1)]),_:1})]),_:1})):g("",!0),s(e(de),{class:"border border-border/50 bg-card shadow-sm"},{default:l(()=>[s(e(me),{class:"flex flex-row items-center justify-between pb-3"},{default:l(()=>[n("div",null,[s(e(pe),{class:"text-base font-semibold text-foreground"},{default:l(()=>[...t[15]||(t[15]=[o("Structures",-1)])]),_:1}),s(e(ce),null,{default:l(()=>[...t[16]||(t[16]=[o(" These drive `FacultyStructureService` and therefore the chapter structure used for generation. ",-1)])]),_:1})]),s(e(b),{size:"sm",onClick:K},{default:l(()=>[s(e(Z),{class:"mr-2 h-4 w-4"}),t[17]||(t[17]=o(" Add Structure ",-1))]),_:1})]),_:1}),s(e(ie),null,{default:l(()=>[s(se,{columns:e(Ue),data:O.value,"search-key":"faculty_name","search-placeholder":"Filter structures..."},null,8,["columns","data"])]),_:1})]),_:1}),s(e(ye),{open:x.value,"onUpdate:open":t[13]||(t[13]=a=>x.value=a)},{default:l(()=>[s(e(ve),{class:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto"},{default:l(()=>[s(e(be),null,{default:l(()=>[s(e(he),null,{default:l(()=>[o(_(C.value?"Edit structure":"Create structure"),1)]),_:1}),s(e(xe),null,{default:l(()=>[...t[18]||(t[18]=[o(" Create a faculty structure, then manage its chapters and sections. ",-1)])]),_:1})]),_:1}),n("div",Ee,[n("div",Fe,[n("div",Ne,[s(e(v),null,{default:l(()=>[...t[19]||(t[19]=[o("Faculty Name",-1)])]),_:1}),s(e(F),{modelValue:e(r).faculty_name,"onUpdate:modelValue":t[0]||(t[0]=a=>e(r).faculty_name=a),placeholder:"Social Sciences"},null,8,["modelValue"]),e(r).errors.faculty_name?(p(),y("p",Oe,_(e(r).errors.faculty_name),1)):g("",!0)]),n("div",Ae,[s(e(v),null,{default:l(()=>[...t[20]||(t[20]=[o("Faculty Slug",-1)])]),_:1}),s(e(F),{modelValue:e(r).faculty_slug,"onUpdate:modelValue":t[1]||(t[1]=a=>e(r).faculty_slug=a),placeholder:"social-sciences"},null,8,["modelValue"]),e(r).errors.faculty_slug?(p(),y("p",De,_(e(r).errors.faculty_slug),1)):g("",!0)])]),n("div",Te,[s(e(v),null,{default:l(()=>[...t[21]||(t[21]=[o("Description",-1)])]),_:1}),s(e(k),{modelValue:e(r).description,"onUpdate:modelValue":t[2]||(t[2]=a=>e(r).description=a),rows:"3",placeholder:"Optional description..."},null,8,["modelValue"]),e(r).errors.description?(p(),y("p",Be,_(e(r).errors.description),1)):g("",!0)]),n("div",Je,[n("div",je,[s(e(v),null,{default:l(()=>[...t[22]||(t[22]=[o("Sort Order",-1)])]),_:1}),s(e(F),{modelValue:e(r).sort_order,"onUpdate:modelValue":t[3]||(t[3]=a=>e(r).sort_order=a),type:"number",min:"0",max:"1000"},null,8,["modelValue"]),e(r).errors.sort_order?(p(),y("p",Ie,_(e(r).errors.sort_order),1)):g("",!0)]),n("label",Ke,[t[23]||(t[23]=n("span",{class:"text-foreground"},"Active",-1)),s(e(I),{checked:e(r).is_active,"onUpdate:checked":t[4]||(t[4]=a=>e(r).is_active=a)},null,8,["checked"])])]),n("div",Pe,[s(e(v),null,{default:l(()=>[...t[24]||(t[24]=[o("Academic Levels",-1)])]),_:1}),n("div",Le,[n("label",Me,[s(e(N),{checked:m.undergraduate,"onUpdate:checked":t[5]||(t[5]=a=>m.undergraduate=a)},null,8,["checked"]),t[25]||(t[25]=o(" Undergraduate ",-1))]),n("label",qe,[s(e(N),{checked:m.masters,"onUpdate:checked":t[6]||(t[6]=a=>m.masters=a)},null,8,["checked"]),t[26]||(t[26]=o(" Masters ",-1))]),n("label",ze,[s(e(N),{checked:m.phd,"onUpdate:checked":t[7]||(t[7]=a=>m.phd=a)},null,8,["checked"]),t[27]||(t[27]=o(" PhD ",-1))])]),e(r).errors.academic_levels?(p(),y("p",Ge,_(e(r).errors.academic_levels),1)):g("",!0)]),s(e(ke),{type:"multiple",class:"w-full"},{default:l(()=>[s(e($e),{value:"advanced"},{default:l(()=>[s(e(we),null,{default:l(()=>[...t[28]||(t[28]=[o("Advanced JSON (optional)",-1)])]),_:1}),s(e(Se),{class:"space-y-4"},{default:l(()=>[n("div",Ye,[s(e(v),null,{default:l(()=>[...t[29]||(t[29]=[o("Default Structure (JSON)",-1)])]),_:1}),s(e(k),{modelValue:e(r).default_structure,"onUpdate:modelValue":t[8]||(t[8]=a=>e(r).default_structure=a),rows:"6",class:"font-mono text-sm",placeholder:"{}"},null,8,["modelValue"]),e(r).errors.default_structure?(p(),y("p",He,_(e(r).errors.default_structure),1)):g("",!0)]),n("div",Qe,[s(e(v),null,{default:l(()=>[...t[30]||(t[30]=[o("Chapter Templates (JSON)",-1)])]),_:1}),s(e(k),{modelValue:e(r).chapter_templates,"onUpdate:modelValue":t[9]||(t[9]=a=>e(r).chapter_templates=a),rows:"6",class:"font-mono text-sm",placeholder:"{}"},null,8,["modelValue"]),e(r).errors.chapter_templates?(p(),y("p",Re,_(e(r).errors.chapter_templates),1)):g("",!0)]),n("div",We,[s(e(v),null,{default:l(()=>[...t[31]||(t[31]=[o("Guidance Templates (JSON)",-1)])]),_:1}),s(e(k),{modelValue:e(r).guidance_templates,"onUpdate:modelValue":t[10]||(t[10]=a=>e(r).guidance_templates=a),rows:"6",class:"font-mono text-sm",placeholder:"{}"},null,8,["modelValue"]),e(r).errors.guidance_templates?(p(),y("p",Xe,_(e(r).errors.guidance_templates),1)):g("",!0)]),n("div",Ze,[s(e(v),null,{default:l(()=>[...t[32]||(t[32]=[o("Terminology (JSON)",-1)])]),_:1}),s(e(k),{modelValue:e(r).terminology,"onUpdate:modelValue":t[11]||(t[11]=a=>e(r).terminology=a),rows:"6",class:"font-mono text-sm",placeholder:"{}"},null,8,["modelValue"]),e(r).errors.terminology?(p(),y("p",et,_(e(r).errors.terminology),1)):g("",!0)])]),_:1})]),_:1})]),_:1})]),n("div",tt,[s(e(b),{variant:"ghost",onClick:t[12]||(t[12]=a=>x.value=!1)},{default:l(()=>[...t[33]||(t[33]=[o("Cancel",-1)])]),_:1}),s(e(b),{disabled:e(r).processing,onClick:P},{default:l(()=>[e(r).processing?(p(),V(e(ee),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):g("",!0),n("span",null,_(C.value?"Update structure":"Add structure"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["open"])]),_:1}))}});export{Kt as default};
