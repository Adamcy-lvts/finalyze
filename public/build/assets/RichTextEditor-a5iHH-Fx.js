import{c as z,o as w,K as u,d as je,y as h,a as F,F as Oe,G as Wt,C as de,E as i,O as U,n as b,M as D,u as t,a3 as Ce,w as le,q as ot,H as a,A as Je,L as jt,_ as st,B as qt,Q as We,P as x,ad as lt,f as Fe,aE as Nt,S as Gt}from"./app-Bo8mbAfA.js";import{aL as Kt,aM as Xt,aN as Yt,aO as Zt,aP as qe,aQ as it,aR as dt,aS as ut,aT as ct,aU as gt,aV as Ne,aW as Qt,aX as Jt,an as ea,ap as ta,aq as aa,ar as ra,as as na,aY as oa,aZ as sa,au as la,av as ia,aw as da,ax as ua,ay as ca,ao as ga,a_ as fa,az as ma,aA as pa}from"./index-ClYkR1f9.js";import{_ as et}from"./Progress.vue_vue_type_script_setup_true_lang-PLcmb06L.js";import{_ as Ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{c as V,_ as p}from"./index-BhKU_YgD.js";import{_ as ie}from"./Input.vue_vue_type_script_setup_true_lang-DMYtADRd.js";import{_ as $e,a as Ie}from"./DialogContent.vue_vue_type_script_setup_true_lang-D__DE2lJ.js";import{_ as Re}from"./DialogDescription.vue_vue_type_script_setup_true_lang-xBPkVSpt.js";import{_ as Ee}from"./DialogFooter.vue_vue_type_script_setup_true_lang-DrhYcgd0.js";import{_ as _e,a as Ve}from"./DialogTitle.vue_vue_type_script_setup_true_lang-S9WogxKM.js";import{_ as me}from"./Label.vue_vue_type_script_setup_true_lang-jtmjM8B2.js";import{L as ft}from"./loader-circle-CTShm-CK.js";import{T as mt,L as ha}from"./type-BMN8IGkD.js";import{T as va}from"./trash-2-D6zuQNGS.js";import{a as tt,b as at,d as N,e as He,f as rt}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-Baa0XZcP.js";import{M as xa}from"./minus-NbNpMYjc.js";import{P as ba}from"./plus-C3UDVPn1.js";import{L as ya}from"./list-Cg0Sa8mO.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=V("AlignCenterIcon",[["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 18H5",key:"18s9l3"}],["path",{d:"M21 6H3",key:"1jwq7v"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=V("AlignJustifyIcon",[["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 18h18",key:"1h113x"}],["path",{d:"M3 6h18",key:"d0wm0j"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=V("AlignLeftIcon",[["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 18H3",key:"1amg6g"}],["path",{d:"M21 6H3",key:"1jwq7v"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=V("AlignRightIcon",[["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 18H7",key:"1ygte8"}],["path",{d:"M21 6H3",key:"1jwq7v"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=V("BoldIcon",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=V("CodeIcon",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=V("HighlighterIcon",[["path",{d:"m9 11-6 6v3h9l3-3",key:"1a3l36"}],["path",{d:"m22 12-4.6 4.6a2 2 0 0 1-2.8 0l-5.2-5.2a2 2 0 0 1 0-2.8L14 4",key:"14a9rk"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=V("ItalicIcon",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=V("ListOrderedIcon",[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const za=V("PaletteIcon",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=V("QuoteIcon",[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=V("RedoIcon",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ha=V("StrikethroughIcon",[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=V("TableIcon",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=V("UnderlineIcon",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=V("UndoIcon",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=V("UploadIcon",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var _a=Kt,Va=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,Pa=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,Da=Xt.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:n=>n.getAttribute("data-color")||n.style.backgroundColor,renderHTML:n=>n.color?{"data-color":n.color,style:`background-color: ${n.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:n}){return["mark",qe(this.options.HTMLAttributes,n),0]},addCommands(){return{setHighlight:n=>({commands:s})=>s.setMark(this.name,n),toggleHighlight:n=>({commands:s})=>s.toggleMark(this.name,n),unsetHighlight:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[Zt({find:Va,type:this.type})]},addPasteRules(){return[Yt({find:Pa,type:this.type})]}});function Ua(n,s){return w(),z("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[u("path",{"fill-rule":"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z","clip-rule":"evenodd"})])}function Ba(n,s){return w(),z("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[u("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 6a.75.75 0 0 0-1.5 0v6c0 .414.336.75.75.75h4.5a.75.75 0 0 0 0-1.5h-3.75V6Z","clip-rule":"evenodd"})])}function Fa(n,s){return w(),z("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[u("path",{"fill-rule":"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z","clip-rule":"evenodd"})])}const Oa={class:"space-y-2"},Wa={class:"font-semibold text-sm"},ja={key:0,class:"text-xs text-gray-600 dark:text-gray-300"},qa={class:"flex items-center space-x-2 text-xs"},Na={key:0,class:"text-gray-500"},Ga={key:1,class:"text-xs text-blue-600 dark:text-blue-400"},Ka={class:"flex space-x-2 pt-2 border-t"},Xa=je({__name:"CitationNodeView",props:{node:{type:Object,required:!0},editor:{type:Object,required:!0},getPos:{type:Function,required:!0},updateAttributes:{type:Function,required:!0}},emits:["verify","edit","remove"],setup(n,{emit:s}){const c=n,C=s,f=h(!1),A=h({top:"0px",left:"0px"}),B=F(()=>c.node.attrs.text||"[Citation]"),T=F(()=>c.node.attrs.verified===!1&&c.node.attrs.confidence<.8),S=F(()=>({"citation-verified":c.node.attrs.verified,"citation-unverified":T.value,"citation-pending":!c.node.attrs.verified&&!T.value})),L=F(()=>c.node.attrs.verified?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 border border-green-300 dark:border-green-700":T.value?"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 border border-red-300 dark:border-red-700":"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 border border-yellow-300 dark:border-yellow-700"),O=F(()=>c.node.attrs.verified?"text-green-600 dark:text-green-400":T.value?"text-red-600 dark:text-red-400":"text-yellow-600 dark:text-yellow-400"),W=F(()=>c.node.attrs.verified?"Verified":T.value?"Needs Review":"Pending"),X=F(()=>c.node.attrs.verified?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":T.value?"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200":"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200"),j=k=>{if(k.stopPropagation(),f.value)$();else{const ue=k.target.getBoundingClientRect();A.value={top:`${ue.height+5}px`,left:"0px"},f.value=!0}},$=()=>{f.value=!1},te=async()=>{try{const k=await axios.post("/api/citations/verify",{citation_id:c.node.attrs.id,citation_text:c.node.attrs.text});k.data.verified&&c.updateAttributes({verified:!0,confidence:k.data.confidence,data:k.data.citation,doi:k.data.citation.doi}),C("verify",k.data),$()}catch(k){console.error("Failed to verify citation:",k)}},Y=()=>{C("edit",{id:c.node.attrs.id,text:c.node.attrs.text,attributes:c.node.attrs}),$()},r=()=>{if(confirm("Are you sure you want to remove this citation?")){const k=c.getPos();c.editor.commands.deleteRange({from:k,to:k+1}),C("remove",c.node.attrs.id)}$()},ae=k=>{k.key==="Enter"||k.key===" "?(k.preventDefault(),j(k)):k.key==="Escape"&&$()};return Oe(()=>{document.addEventListener("keydown",ae)}),Wt(()=>{document.removeEventListener("keydown",ae)}),(k,ue)=>(w(),de(t(it),{class:b(["citation-node inline-block relative cursor-pointer",S.value]),onClick:j},{default:i(()=>[u("span",{class:b(["citation-text px-2 py-1 rounded text-sm font-medium transition-all duration-200",L.value])},D(B.value),3),u("span",{class:b(["verification-indicator ml-1",O.value])},[n.node.attrs.verified?(w(),de(t(Ua),{key:0,class:"w-3 h-3"})):T.value?(w(),de(t(Fa),{key:1,class:"w-3 h-3"})):(w(),de(t(Ba),{key:2,class:"w-3 h-3"}))],2),f.value?(w(),z("div",{key:0,class:"citation-popover absolute z-50 mt-2 p-4 bg-white dark:bg-gray-800 rounded-lg shadow-lg border max-w-sm",style:Ce(A.value)},[u("div",Oa,[u("div",Wa,D(n.node.attrs.text||"[Citation]"),1),n.node.attrs.data&&n.node.attrs.data.title?(w(),z("div",ja,D(n.node.attrs.data.title),1)):U("",!0),u("div",qa,[u("span",{class:b(["px-2 py-1 rounded",X.value])},D(W.value),3),n.node.attrs.confidence?(w(),z("span",Na,D(Math.round(n.node.attrs.confidence*100))+"% confidence ",1)):U("",!0)]),n.node.attrs.doi?(w(),z("div",Ga," DOI: "+D(n.node.attrs.doi),1)):U("",!0),u("div",Ka,[n.node.attrs.verified?U("",!0):(w(),z("button",{key:0,onClick:te,class:"text-xs px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700"}," Verify ")),u("button",{onClick:Y,class:"text-xs px-2 py-1 bg-gray-600 text-white rounded hover:bg-gray-700"}," Edit "),u("button",{onClick:r,class:"text-xs px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700"}," Remove ")])])],4)):U("",!0),f.value?(w(),z("div",{key:1,class:"fixed inset-0 z-40",onClick:$})):U("",!0)]),_:1},8,["class"]))}}),Ya=Ge(Xa,[["__scopeId","data-v-4fc4981e"]]),Za=dt.create({name:"citation",group:"inline",inline:!0,atom:!0,addAttributes(){return{id:{default:null},text:{default:""},verified:{default:!1},confidence:{default:0},format:{default:"apa"},doi:{default:null},data:{default:{}}}},parseHTML(){return[{tag:"span[data-citation]"}]},renderHTML({HTMLAttributes:n}){return["span",qe(n,{"data-citation":""})]},addNodeView(){return ut(Ya)},addCommands(){return{insertCitation:n=>({commands:s})=>s.insertContent({type:this.name,attrs:n}),updateCitation:(n,s)=>({state:c,dispatch:C})=>{const{doc:f,tr:A}=c;let B=!1;return f.descendants((T,S)=>{if(T.type.name===this.name&&T.attrs.id===n)return A.setNodeMarkup(S,null,{...T.attrs,...s}),B=!0,!1}),B?(C(A),!0):!1}}},addKeyboardShortcuts(){return{"Mod-Shift-c":()=>this.editor.commands.insertCitation({text:"[Citation]",verified:!1})}}}),Qa={class:"text-muted-foreground text-xs mt-1 truncate max-w-full"},Ja=["src","alt","title"],er={key:2,class:"mt-2 w-full"},tr={key:3,class:"mt-2 text-center text-sm text-muted-foreground italic"},ar={key:5,class:"absolute -top-12 left-1/2 -translate-x-1/2 flex items-center gap-1.5 px-3 py-1.5 bg-background/95 backdrop-blur-md rounded-lg border border-border shadow-lg z-10 min-w-max"},rr={class:"text-xs text-muted-foreground whitespace-nowrap"},nr={class:"grid gap-4 py-4"},or={class:"grid gap-2"},sr={class:"grid gap-2"},lr=je({__name:"ImageNodeView",props:{node:{},updateAttributes:{type:Function},deleteNode:{type:Function},selected:{type:Boolean},editor:{}},setup(n){const s=n,c=h(null),C=h(null),f=h(!1),A=h(null),B=h(0),T=h(0),S=h(0),L=h(0),O=h(s.node.attrs.width||400),W=h(s.node.attrs.height||300),X=h(!0),j=h(!1),$=h(!1),te=h(""),Y=h(""),r=h(s.node.attrs.caption||""),ae=F(()=>{switch(s.node.attrs.alignment){case"left":return"mr-auto";case"right":return"ml-auto";default:return"mx-auto"}}),k=F(()=>({width:`${O.value}px`,height:`${W.value}px`,maxWidth:"100%"})),ue=()=>{if(X.value=!1,j.value=!1,c.value&&!s.node.attrs.width){const m=c.value.naturalWidth,l=c.value.naturalHeight,g=600;if(m>g){const q=g/m;O.value=g,W.value=Math.round(l*q)}else O.value=m,W.value=l;s.updateAttributes({width:O.value,height:W.value,aspectRatio:m/l})}},pe=()=>{X.value=!1,j.value=!0},H=(m,l)=>{if(!s.selected)return;l.preventDefault(),l.stopPropagation(),f.value=!0,A.value=m;const g="touches"in l?l.touches[0].clientX:l.clientX,q="touches"in l?l.touches[0].clientY:l.clientY;B.value=g,T.value=q,S.value=O.value,L.value=W.value,document.addEventListener("mousemove",Z),document.addEventListener("mouseup",Q),document.addEventListener("touchmove",Z),document.addEventListener("touchend",Q)},Z=m=>{if(!f.value)return;const l="touches"in m?m.touches[0].clientX:m.clientX,g="touches"in m?m.touches[0].clientY:m.clientY,q=l-B.value,ve=g-T.value,xe=s.node.attrs.aspectRatio||S.value/L.value,ne=A.value;let K=S.value,J=L.value;ne?.includes("e")&&(K=Math.max(100,S.value+q)),ne?.includes("w")&&(K=Math.max(100,S.value-q)),ne?.includes("s")&&(J=Math.max(100,L.value+ve)),ne?.includes("n")&&(J=Math.max(100,L.value-ve)),ne?.length===2&&(Math.abs(q)>Math.abs(ve)?J=Math.round(K/xe):K=Math.round(J*xe));const Ae=800;K>Ae&&(K=Ae,J=Math.round(K/xe)),O.value=K,W.value=J},Q=()=>{f.value&&(f.value=!1,A.value=null,s.updateAttributes({width:O.value,height:W.value}),document.removeEventListener("mousemove",Z),document.removeEventListener("mouseup",Q),document.removeEventListener("touchmove",Z),document.removeEventListener("touchend",Q))},he=m=>{s.updateAttributes({alignment:m})},Pe=()=>{te.value=s.node.attrs.alt||"",Y.value=s.node.attrs.title||"",$.value=!0},De=()=>{s.updateAttributes({alt:te.value,title:Y.value}),$.value=!1},Te=()=>{s.updateAttributes({caption:r.value})},re=async()=>{const m=s.node.attrs.src;if(m&&m.startsWith("/storage/"))try{await lt.delete("/editor/images",{data:{url:m}})}catch(l){console.warn("Failed to delete image from storage:",l)}s.deleteNode()};return le(()=>s.node.attrs.caption,m=>{m!==r.value&&(r.value=m||"")}),le(()=>[s.node.attrs.width,s.node.attrs.height],([m,l])=>{m&&!f.value&&(O.value=m),l&&!f.value&&(W.value=l)},{immediate:!0}),ot(()=>{document.removeEventListener("mousemove",Z),document.removeEventListener("mouseup",Q),document.removeEventListener("touchmove",Z),document.removeEventListener("touchend",Q)}),(m,l)=>(w(),de(t(it),{class:"resizable-image-wrapper my-4"},{default:i(()=>[u("figure",{ref_key:"containerRef",ref:C,class:b(["relative inline-block",[ae.value,{"ring-2 ring-primary ring-offset-2":m.selected}]])},[X.value?(w(),z("div",{key:0,class:"flex items-center justify-center bg-muted/50 rounded-lg",style:Ce(k.value)},[a(t(ft),{class:"w-8 h-8 animate-spin text-muted-foreground"})],4)):j.value?(w(),z("div",{key:1,class:"flex flex-col items-center justify-center bg-destructive/10 border border-destructive/30 rounded-lg p-4",style:Ce(k.value)},[l[24]||(l[24]=u("span",{class:"text-destructive text-sm"},"Failed to load image",-1)),u("span",Qa,D(m.node.attrs.src),1)],4)):U("",!0),Je(u("img",{ref_key:"imageRef",ref:c,src:m.node.attrs.src,alt:m.node.attrs.alt,title:m.node.attrs.title,style:Ce(k.value),class:b(["block rounded-lg object-contain",{"cursor-move":m.selected}]),onLoad:ue,onError:pe,draggable:"false"},null,46,Ja),[[jt,!X.value&&!j.value]]),m.selected&&!j.value?(w(),z("div",er,[Je(u("input",{"onUpdate:modelValue":l[0]||(l[0]=g=>r.value=g),type:"text",placeholder:"Add a caption...",class:"w-full text-center text-sm text-muted-foreground bg-transparent border-none focus:outline-none focus:ring-0 placeholder:text-muted-foreground/50",onBlur:Te,onKeydown:st(Te,["enter"])},null,544),[[qt,r.value]])])):m.node.attrs.caption&&!j.value?(w(),z("figcaption",tr,D(m.node.attrs.caption),1)):U("",!0),m.selected&&!j.value&&!X.value?(w(),z(We,{key:4},[u("div",{class:"absolute -top-1.5 -left-1.5 w-3 h-3 bg-primary border-2 border-background rounded-full cursor-nw-resize z-20 hover:scale-125 transition-transform",onMousedown:l[1]||(l[1]=g=>H("nw",g)),onTouchstart:l[2]||(l[2]=g=>H("nw",g))},null,32),u("div",{class:"absolute -top-1.5 -right-1.5 w-3 h-3 bg-primary border-2 border-background rounded-full cursor-ne-resize z-20 hover:scale-125 transition-transform",onMousedown:l[3]||(l[3]=g=>H("ne",g)),onTouchstart:l[4]||(l[4]=g=>H("ne",g))},null,32),u("div",{class:"absolute -bottom-1.5 -left-1.5 w-3 h-3 bg-primary border-2 border-background rounded-full cursor-sw-resize z-20 hover:scale-125 transition-transform",onMousedown:l[5]||(l[5]=g=>H("sw",g)),onTouchstart:l[6]||(l[6]=g=>H("sw",g))},null,32),u("div",{class:"absolute -bottom-1.5 -right-1.5 w-3 h-3 bg-primary border-2 border-background rounded-full cursor-se-resize z-20 hover:scale-125 transition-transform",onMousedown:l[7]||(l[7]=g=>H("se",g)),onTouchstart:l[8]||(l[8]=g=>H("se",g))},null,32),u("div",{class:"absolute top-1/2 -left-1.5 w-3 h-3 bg-primary border-2 border-background rounded-full cursor-w-resize z-20 -translate-y-1/2 hover:scale-125 transition-transform",onMousedown:l[9]||(l[9]=g=>H("w",g)),onTouchstart:l[10]||(l[10]=g=>H("w",g))},null,32),u("div",{class:"absolute top-1/2 -right-1.5 w-3 h-3 bg-primary border-2 border-background rounded-full cursor-e-resize z-20 -translate-y-1/2 hover:scale-125 transition-transform",onMousedown:l[11]||(l[11]=g=>H("e",g)),onTouchstart:l[12]||(l[12]=g=>H("e",g))},null,32),u("div",{class:"absolute -top-1.5 left-1/2 w-3 h-3 bg-primary border-2 border-background rounded-full cursor-n-resize z-20 -translate-x-1/2 hover:scale-125 transition-transform",onMousedown:l[13]||(l[13]=g=>H("n",g)),onTouchstart:l[14]||(l[14]=g=>H("n",g))},null,32),u("div",{class:"absolute -bottom-1.5 left-1/2 w-3 h-3 bg-primary border-2 border-background rounded-full cursor-s-resize z-20 -translate-x-1/2 hover:scale-125 transition-transform",onMousedown:l[15]||(l[15]=g=>H("s",g)),onTouchstart:l[16]||(l[16]=g=>H("s",g))},null,32)],64)):U("",!0),m.selected?(w(),z("div",ar,[j.value?U("",!0):(w(),z(We,{key:0},[a(t(p),{variant:"ghost",size:"sm",class:b(["h-7 w-7 p-0",{"bg-primary/10 text-primary":m.node.attrs.alignment==="left"}]),onClick:l[17]||(l[17]=g=>he("left"))},{default:i(()=>[a(t(ht),{class:"w-4 h-4"})]),_:1},8,["class"]),a(t(p),{variant:"ghost",size:"sm",class:b(["h-7 w-7 p-0",{"bg-primary/10 text-primary":m.node.attrs.alignment==="center"}]),onClick:l[18]||(l[18]=g=>he("center"))},{default:i(()=>[a(t(pt),{class:"w-4 h-4"})]),_:1},8,["class"]),a(t(p),{variant:"ghost",size:"sm",class:b(["h-7 w-7 p-0",{"bg-primary/10 text-primary":m.node.attrs.alignment==="right"}]),onClick:l[19]||(l[19]=g=>he("right"))},{default:i(()=>[a(t(vt),{class:"w-4 h-4"})]),_:1},8,["class"]),l[26]||(l[26]=u("div",{class:"w-px h-5 bg-border mx-1"},null,-1)),a(t(p),{variant:"ghost",size:"sm",class:"h-7 px-2 text-xs gap-1",onClick:Pe},{default:i(()=>[a(t(mt),{class:"w-3 h-3"}),l[25]||(l[25]=x(" Alt ",-1))]),_:1}),l[27]||(l[27]=u("div",{class:"w-px h-5 bg-border mx-1"},null,-1)),u("span",rr,D(Math.round(O.value))+" x "+D(Math.round(W.value)),1),l[28]||(l[28]=u("div",{class:"w-px h-5 bg-border mx-1"},null,-1))],64)),a(t(p),{variant:"ghost",size:"sm",class:"h-7 w-7 p-0 text-destructive hover:text-destructive",onClick:re},{default:i(()=>[a(t(va),{class:"w-4 h-4"})]),_:1})])):U("",!0)],2),a(t($e),{open:$.value,"onUpdate:open":l[23]||(l[23]=g=>$.value=g)},{default:i(()=>[a(t(Ie),null,{default:i(()=>[a(t(_e),null,{default:i(()=>[a(t(Ve),null,{default:i(()=>[...l[29]||(l[29]=[x("Image Properties",-1)])]),_:1}),a(t(Re),null,{default:i(()=>[...l[30]||(l[30]=[x("Edit the alt text and title for this image.",-1)])]),_:1})]),_:1}),u("div",nr,[u("div",or,[a(t(me),{for:"alt-text"},{default:i(()=>[...l[31]||(l[31]=[x("Alt Text",-1)])]),_:1}),a(t(ie),{id:"alt-text",modelValue:te.value,"onUpdate:modelValue":l[20]||(l[20]=g=>te.value=g),placeholder:"Describe this image for accessibility..."},null,8,["modelValue"]),l[32]||(l[32]=u("p",{class:"text-xs text-muted-foreground"}," Alt text helps screen readers describe the image to visually impaired users. ",-1))]),u("div",sr,[a(t(me),{for:"title-text"},{default:i(()=>[...l[33]||(l[33]=[x("Title",-1)])]),_:1}),a(t(ie),{id:"title-text",modelValue:Y.value,"onUpdate:modelValue":l[21]||(l[21]=g=>Y.value=g),placeholder:"Optional title shown on hover..."},null,8,["modelValue"])])]),a(t(Ee),null,{default:i(()=>[a(t(p),{variant:"outline",onClick:l[22]||(l[22]=g=>$.value=!1)},{default:i(()=>[...l[34]||(l[34]=[x("Cancel",-1)])]),_:1}),a(t(p),{onClick:De},{default:i(()=>[...l[35]||(l[35]=[x("Save",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]),_:1}))}}),ir=Ge(lr,[["__scopeId","data-v-bc29ad5b"]]),dr=dt.create({name:"resizableImage",group:"block",atom:!0,draggable:!0,addOptions(){return{HTMLAttributes:{class:"resizable-image-block"},maxWidth:800}},addAttributes(){return{src:{default:null,parseHTML:n=>n.querySelector("img")?.getAttribute("src")||n.getAttribute("src")},alt:{default:"",parseHTML:n=>n.querySelector("img")?.getAttribute("alt")||n.getAttribute("alt")||""},title:{default:"",parseHTML:n=>n.querySelector("img")?.getAttribute("title")||n.getAttribute("title")||""},width:{default:null,parseHTML:n=>{const c=n.querySelector("img")?.getAttribute("width")||n.getAttribute("data-width");return c?parseInt(c,10):null}},height:{default:null,parseHTML:n=>{const c=n.querySelector("img")?.getAttribute("height")||n.getAttribute("data-height");return c?parseInt(c,10):null}},alignment:{default:"center",parseHTML:n=>n.getAttribute("data-alignment")||"center"},aspectRatio:{default:null,parseHTML:n=>{const s=n.getAttribute("data-aspect-ratio");return s?parseFloat(s):null}},caption:{default:"",parseHTML:n=>n.querySelector("figcaption")?.textContent||n.getAttribute("data-caption")||""}}},parseHTML(){return[{tag:"figure[data-resizable-image]"},{tag:"div[data-resizable-image]"},{tag:"img[src]",getAttrs:n=>{if(typeof n=="string")return!1;const s=n;return{src:s.getAttribute("src"),alt:s.getAttribute("alt"),title:s.getAttribute("title"),width:s.getAttribute("width")?parseInt(s.getAttribute("width"),10):null,height:s.getAttribute("height")?parseInt(s.getAttribute("height"),10):null}}}]},renderHTML({HTMLAttributes:n,node:s}){const c=qe(this.options.HTMLAttributes,{"data-resizable-image":"","data-alignment":s.attrs.alignment,"data-width":s.attrs.width,"data-height":s.attrs.height,"data-aspect-ratio":s.attrs.aspectRatio,"data-caption":s.attrs.caption||""}),C={src:n.src||s.attrs.src,alt:s.attrs.alt||"",title:s.attrs.title||""};s.attrs.width&&(C.width=s.attrs.width),s.attrs.height&&(C.height=s.attrs.height);const f=[["img",C]];return s.attrs.caption&&f.push(["figcaption",{},s.attrs.caption]),["figure",c,...f]},addNodeView(){return ut(ir)},addCommands(){return{setImage:n=>({commands:s})=>s.insertContent({type:this.name,attrs:{src:n.src,alt:n.alt||"",title:n.title||"",width:n.width||null,height:n.height||null,caption:n.caption||"",aspectRatio:n.width&&n.height?n.width/n.height:null}}),updateImageSize:n=>({commands:s})=>s.updateAttributes(this.name,{width:n.width,height:n.height}),setImageAlignment:n=>({commands:s})=>s.updateAttributes(this.name,{alignment:n})}},addProseMirrorPlugins(){return[new ct({key:new gt("resizableImageDropPaste"),props:{handleDrop:(n,s,c,C)=>{if(C||!s.dataTransfer?.files?.length)return!1;const f=s.dataTransfer.files[0];return f.type.startsWith("image/")?(s.preventDefault(),document.dispatchEvent(new CustomEvent("tiptap-image-drop",{detail:{file:f,view:n,pos:n.posAtCoords({left:s.clientX,top:s.clientY})}})),!0):!1},handlePaste:(n,s)=>{const c=s.clipboardData?.items;if(!c)return!1;for(const C of c)if(C.type.startsWith("image/")){s.preventDefault();const f=C.getAsFile();return f&&document.dispatchEvent(new CustomEvent("tiptap-image-paste",{detail:{file:f,view:n}})),!0}return!1}}})]}}),ee=new gt("ghostText"),ur=Ne.create({name:"ghostText",addOptions(){return{onManualTrigger:null,onAccepted:null,onDismissed:null}},addCommands(){return{setGhostText:({text:n,position:s,format:c})=>({tr:C,state:f,dispatch:A})=>{const B=typeof s=="number"?s:f.selection.to;return C.setMeta(ee,{type:"set",text:n,format:c??"text",position:B}),A?.(C),!0},clearGhostText:()=>({tr:n,dispatch:s})=>(n.setMeta(ee,{type:"clear"}),s?.(n),!0)}},addKeyboardShortcuts(){return{Tab:()=>{const n=ee.getState(this.editor.state);if(!n?.isVisible||!n.text||!this.editor.state.selection.empty)return!1;const s=n.position,c=n.text;return this.editor.chain().focus().insertContentAt({from:s,to:s},c).command(({tr:C,dispatch:f})=>(C.setMeta(ee,{type:"clear"}),f?.(C),!0)).run(),this.options.onAccepted?.(c),!0},Escape:()=>ee.getState(this.editor.state)?.isVisible?(this.editor.commands.clearGhostText(),this.options.onDismissed?.(),!0):!1,"Mod-Space":()=>(this.options.onManualTrigger?.(),!0)}},addProseMirrorPlugins(){return[new ct({key:ee,state:{init:()=>({text:null,format:"text",position:0,isVisible:!1}),apply:(n,s)=>{const c=n.getMeta(ee);return c?.type==="clear"?{text:null,format:"text",position:0,isVisible:!1}:c?.type==="set"?{text:c.text,format:c.format,position:c.position,isVisible:!0}:n.docChanged?(s.isVisible&&this.options.onDismissed?.(),{text:null,format:"text",position:0,isVisible:!1}):n.selectionSet&&s.isVisible?(this.options.onDismissed?.(),{text:null,format:"text",position:0,isVisible:!1}):s}},props:{decorations:n=>{const s=ee.getState(n);if(!s?.isVisible||!s.text)return null;const c=Math.min(Math.max(0,s.position),n.doc.content.size),C=Qt.widget(c,()=>{const f=document.createElement("span");if(f.className="tiptap-ghost-text",s.format==="html"&&s.text.includes("<")){const A=document.createElement("div");A.innerHTML=s.text,f.textContent=(A.textContent||"").trim()}else f.textContent=s.text??"";return f},{side:1});return Jt.create(n.doc,[C])}}})]}});var cr=Ne.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:n=>{const s=n.style.textAlign;return this.options.alignments.includes(s)?s:this.options.defaultAlignment},renderHTML:n=>n.textAlign?{style:`text-align: ${n.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:n=>({commands:s})=>this.options.alignments.includes(n)?this.options.types.map(c=>s.updateAttributes(c,{textAlign:n})).some(c=>c):!1,unsetTextAlign:()=>({commands:n})=>this.options.types.map(s=>n.resetAttributes(s,"textAlign")).some(s=>s),toggleTextAlign:n=>({editor:s,commands:c})=>this.options.alignments.includes(n)?s.isActive({textAlign:n})?c.unsetTextAlign():c.setTextAlign(n):!1}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),gr=cr;const fr={class:"relative flex flex-col w-full h-full group bg-background"},mr={class:"flex items-center gap-0.5 border-r border-border/40 pr-1.5 mr-1.5 flex-shrink-0"},pr={class:"flex items-center gap-0.5 border-r border-border/40 pr-1.5 mr-1.5 flex-shrink-0"},hr={class:"text-xs text-zinc-700 dark:text-zinc-100"},vr={class:"flex items-center gap-0.5"},xr={class:"flex h-8 w-9 items-center justify-center border-y border-border/20 bg-muted/20 text-xs font-medium text-foreground"},br={class:"flex items-center gap-0.5 border-r border-border/40 pr-1.5 mr-1.5 flex-shrink-0"},yr={class:"flex items-center gap-0.5 border-r border-border/40 pr-1.5 mr-1.5 flex-shrink-0"},kr={class:"flex items-center gap-0.5 border-l border-border/20 ml-0.5 pl-0.5"},wr={class:"flex items-center gap-0.5 flex-shrink-0"},Cr={class:"relative flex-1 min-h-0"},Tr={key:0,class:"absolute inset-0 z-10 flex flex-col items-center justify-center bg-background/50 backdrop-blur-[2px] transition-all duration-500"},Ar={class:"flex flex-col items-center gap-4 rounded-2xl border border-border/50 bg-background/90 p-8 shadow-xl backdrop-blur-xl"},Mr={class:"relative h-16 w-16"},zr={class:"relative flex h-full w-full items-center justify-center rounded-full bg-primary/10 ring-1 ring-primary/20"},Sr={class:"text-center"},Lr={class:"text-lg font-semibold tracking-tight"},Hr={class:"text-sm text-muted-foreground"},$r={class:"grid gap-4 py-4"},Ir={class:"grid gap-2"},Rr={class:"grid gap-2"},Er={class:"grid gap-4 py-4"},_r={class:"flex items-center gap-4"},Vr={class:"flex flex-wrap gap-2"},Pr=["onClick"],Dr={class:"grid gap-4 py-4"},Ur={class:"grid gap-2"},Br={class:"flex items-center gap-2"},Fr={key:1,class:"text-sm text-destructive"},Or={class:"grid gap-2"},Wr={class:"flex gap-2"},nt=300,jr=je({__name:"RichTextEditor",props:{modelValue:{},placeholder:{default:"Start writing..."},readonly:{type:Boolean,default:!1},minHeight:{default:"200px"},showToolbar:{type:Boolean,default:!0},toolbarTeleportTarget:{default:""},isGenerating:{type:Boolean,default:!1},generationProgress:{default:""},generationPercentage:{default:0},generationPhase:{default:""},streamingMode:{type:Boolean,default:!1},ghostText:{default:null},ghostTextFormat:{default:"text"},ghostTextPosition:{default:null}},emits:["update:modelValue","update:selectedText","update:selectionRange","ghost-manual-trigger","ghost-accepted","ghost-dismissed"],setup(n,{expose:s,emit:c}){const C=ea(pa),f=n,A=h(!1),B=h(0),T=h(""),S=h(null),L=c,O=Ne.create({name:"fontSize",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:o=>{const e=o.style.fontSize;return e||null},renderHTML:o=>o.fontSize?{style:`font-size: ${o.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:o=>({chain:e})=>e().setMark("textStyle",{fontSize:o}).run(),unsetFontSize:()=>({chain:o})=>o().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),W=o=>{if(!o)return"";const e=o.split(`
`);let d=[],y=0;for(;y<e.length;){const I=e[y];if(I.includes("|")){const R=X(e,y);if(R.html){d.push(R.html),y=R.nextIndex;continue}}d.push(I),y++}return d.join(`
`)},X=(o,e)=>{let d=o[e];if(!d||!d.includes("|"))return{html:null,nextIndex:e+1};const y=d.split("|").map(E=>E.trim()).filter(E=>E.length>0);if(y.length===0)return{html:null,nextIndex:e+1};const I=o[e+1];if(!I||!I.includes("|")||!I.includes("-"))return{html:null,nextIndex:e+1};let R=[],v=e+2;for(;v<o.length;){const E=o[v];if(!E||!E.includes("|"))break;const P=E.split("|").map(_=>_.trim()).filter(_=>_.length>0);P.length>0&&R.push(P),v++}let M='<div class="tableWrapper"><table>';return M+="<thead><tr>",y.forEach(E=>{M+=`<th>${E}</th>`}),M+="</tr></thead>",R.length>0&&(M+="<tbody>",R.forEach(E=>{M+="<tr>";for(let P=0;P<y.length;P++){const _=E[P]||"";M+=`<td>${_}</td>`}M+="</tr>"}),M+="</tbody>"),M+="</table></div>",{html:M,nextIndex:v}},j=o=>o?(o=o.replace(/```(\w+)\n?([\s\S]*?)```/g,(e,d,y)=>`<pre><code class="language-${d}">${y.trim()}</code></pre>`),o=o.replace(/```\n?([\s\S]*?)```/g,(e,d)=>`<pre><code>${d.trim()}</code></pre>`),o):"",$=o=>{if(!o)return"";if(o.includes("<p>")||o.includes("<h1>")||o.includes("<h2>")||o.includes("<div>")||o.includes("<div "))return o;let e=o;const d=[];e=e.replace(/```mermaid\n?([\s\S]*?)```/g,(R,v)=>{const M=v.trim(),P=`<div data-mermaid data-mermaid-code="${M.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}" data-view-mode="diagram"><pre><code class="language-mermaid">${M}</code></pre></div>`,_=d.length;return d.push(P),`<!--MERMAID_PLACEHOLDER_${_}-->`}),e=e.replace(/``mermaid\n?([\s\S]*?)``/g,(R,v)=>{const M=v.trim(),P=`<div data-mermaid data-mermaid-code="${M.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}" data-view-mode="diagram"><pre><code class="language-mermaid">${M}</code></pre></div>`,_=d.length;return d.push(P),`<!--MERMAID_PLACEHOLDER_${_}-->`}),e=e.replace(/`mermaid\n([\s\S]*?)`/g,(R,v)=>{const M=v.trim(),P=`<div data-mermaid data-mermaid-code="${M.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}" data-view-mode="diagram"><pre><code class="language-mermaid">${M}</code></pre></div>`,_=d.length;return d.push(P),`<!--MERMAID_PLACEHOLDER_${_}-->`}),e=j(e),e=e.replace(/^### (.*$)/gim,"<h3>$1</h3>"),e=e.replace(/^## (.*$)/gim,"<h2>$1</h2>"),e=e.replace(/^# (.*$)/gim,"<h1>$1</h1>"),e=e.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),e=e.replace(/\*(.*?)\*/g,"<em>$1</em>"),e=e.replace(/`([^`]+)`/g,"<code>$1</code>"),e=W(e);let I=e.split(`

`).filter(R=>R.trim()).map(R=>{const v=R.trim();if(v.startsWith("<h1>")||v.startsWith("<h2>")||v.startsWith("<h3>")||v.startsWith("<div")||v.startsWith("<table")||v.startsWith("<pre")||v.startsWith("<ul")||v.startsWith("<ol")||v.startsWith("<blockquote")||v.startsWith("<!--MERMAID_PLACEHOLDER_"))return v;if(v.includes(`
`)&&(v.match(/^\d+\./)||v.match(/^-\s/)||v.match(/^\*\s/))){const E=v.split(`
`).map(P=>{const _=P.trim();return _.match(/^\d+\.\s/)?`<li>${_.replace(/^\d+\.\s/,"")}</li>`:_.match(/^[-*]\s/)?`<li>${_.replace(/^[-*]\s/,"")}</li>`:_}).filter(P=>P.startsWith("<li>"));return v.match(/^\d+\./)?`<ol>${E.join("")}</ol>`:`<ul>${E.join("")}</ul>`}return`<p>${v.replace(/\n/g,"<br>")}</p>`}).join("");return d.forEach((R,v)=>{I=I.replace(`<!--MERMAID_PLACEHOLDER_${v}-->`,R)}),I},Y=[ta.configure({heading:{levels:[1,2,3]},codeBlock:!1,link:!1}),aa.configure({lowlight:C,HTMLAttributes:{class:"code-block-highlighted"}}),_a.configure({placeholder:f.placeholder}),ra,na,O,oa,Da.configure({multicolor:!0}),sa.configure({openOnClick:!1,HTMLAttributes:{class:"prose-link text-primary hover:text-primary/80 underline decoration-primary/50"}}),la.configure({resizable:!0}),ia,da,ua,Za,ca,dr.configure({maxWidth:800}),gr.configure({types:["heading","paragraph"]}),ur.configure({onManualTrigger:()=>L("ghost-manual-trigger"),onAccepted:o=>L("ghost-accepted",o),onDismissed:()=>L("ghost-dismissed")})].filter((o,e,d)=>e===d.findIndex(y=>y.name===o.name)),r=ga({content:$(f.modelValue),editable:!f.readonly,extensions:Y,editorProps:{attributes:{class:"prose prose-sm dark:prose-invert max-w-none focus:outline-none",style:`min-height: ${f.minHeight}; padding: 12px;`}},onUpdate:({editor:o})=>{L("update:modelValue",o.getHTML()),we()},onSelectionUpdate:({editor:o})=>{we();const{from:e,to:d,empty:y}=o.state.selection;if(y)L("update:selectedText",""),L("update:selectionRange",null),console.log("ðŸ”„ RichTextEditor - No selection, cleared");else{if(!o.state.doc)return;const I=o.state.doc.textBetween(e,d);I.split(/\s+/).filter(v=>v.length>0).length<=200?(L("update:selectedText",I),L("update:selectionRange",{from:e,to:d}),console.log("âœ… RichTextEditor - Selection emitted to parent")):(L("update:selectedText",""),L("update:selectionRange",null),console.log("âŒ RichTextEditor - Selection too long, cleared"))}}});le(()=>f.modelValue,o=>{if(r.value){if(f.streamingMode&&A.value){ue(o);return}if(r.value.getHTML()!==o){const e=$(o);r.value.commands.setContent(e,{emitUpdate:!1}),Fe(()=>{r.value&&L("update:modelValue",r.value.getHTML())})}}}),le([()=>f.ghostText,()=>f.ghostTextFormat,()=>f.ghostTextPosition],([o,e,d])=>{if(!r.value)return;const y=(o??"").toString();if(!y){r.value.commands.clearGhostText?.();return}r.value.commands.setGhostText?.({text:y,format:e??"text",position:typeof d=="number"?d:void 0})},{immediate:!0}),le(()=>f.streamingMode,o=>{o?ae():k()});function ae(){A.value=!0,B.value=0,T.value="",console.log("RichTextEditor: Streaming mode started (throttled)")}function k(){S.value&&(clearTimeout(S.value),S.value=null),T.value&&r.value&&pe(T.value),A.value=!1,T.value="",B.value=0,console.log("RichTextEditor: Streaming mode ended")}function ue(o){if(!r.value||!A.value)return;T.value=o;const d=Date.now()-B.value;if(d>=nt){pe(o);return}if(!S.value){const y=nt-d;S.value=setTimeout(()=>{S.value=null,A.value&&T.value&&pe(T.value)},y)}}function pe(o){if(!r.value)return;B.value=Date.now();const e=$(o);r.value.getHTML()!==e&&r.value.commands.setContent(e,{emitUpdate:!1})}function H(){if(!r.value)return;const o=T.value||f.modelValue,e=$(o);r.value.commands.setContent(e,{emitUpdate:!1})}function Z(){const o=T.value||f.modelValue;return{length:o.length,wordCount:o.split(/\s+/).filter(e=>e.length>0).length}}le(()=>f.readonly,o=>{r.value&&r.value.setEditable(!o)}),Oe(()=>{setTimeout(()=>{r.value&&we()},100),document.addEventListener("tiptap-image-drop",Xe),document.addEventListener("tiptap-image-paste",Ye)}),ot(()=>{S.value&&(clearTimeout(S.value),S.value=null),r.value&&r.value.destroy(),document.removeEventListener("tiptap-image-drop",Xe),document.removeEventListener("tiptap-image-paste",Ye),l()});const Q=()=>r.value?.chain().focus().toggleBold().run(),he=()=>r.value?.chain().focus().toggleItalic().run(),Pe=()=>r.value?.chain().focus().toggleStrike().run(),De=()=>r.value?.chain().focus().toggleCode().run(),Te=()=>{r.value?.chain().focus().insertMermaid().run()},re=h(!1);let m=null;const l=()=>{m&&(m.disconnect(),m=null)},g=()=>{if(typeof document>"u"){re.value=!1;return}re.value=!!(f.toolbarTeleportTarget&&document.querySelector(f.toolbarTeleportTarget))};typeof document<"u"&&g();const q=F(()=>!f.toolbarTeleportTarget||!re.value);F(()=>!q.value);const ve=F(()=>q.value?"body":f.toolbarTeleportTarget||"body"),xe=F(()=>{const o="z-20 flex items-center gap-1 border-border/40 bg-background/95 p-1.5 shadow-sm backdrop-blur-md transition-all duration-200 supports-[backdrop-filter]:bg-background/80 overflow-x-auto no-scrollbar mask-gradient-right";return q.value?`sticky top-0 mx-0 sm:mx-2 md:mx-4 mt-0 sm:mt-1 md:mt-2 mb-2 md:mb-4 rounded-none sm:rounded-lg md:rounded-xl border-y sm:border ${o}`:`w-full ${o} rounded-lg border`});le(()=>f.toolbarTeleportTarget,async()=>{await Fe(),g()},{flush:"post"}),Oe(async()=>{await Fe(),g(),!re.value&&f.toolbarTeleportTarget&&typeof MutationObserver<"u"&&typeof document<"u"&&document.body&&(l(),m=new MutationObserver(()=>{g(),re.value&&l()}),m.observe(document.body,{childList:!0,subtree:!0}))});const ne=()=>r.value?.chain().focus().toggleUnderline().run(),K=()=>r.value?.chain().focus().toggleHeading({level:1}).run(),J=()=>r.value?.chain().focus().toggleHeading({level:2}).run(),Ae=()=>r.value?.chain().focus().toggleHeading({level:3}).run(),xt=()=>r.value?.chain().focus().toggleBulletList().run(),bt=()=>r.value?.chain().focus().toggleOrderedList().run(),yt=()=>r.value?.chain().focus().toggleBlockquote().run(),kt=()=>r.value?.chain().focus().setParagraph().run(),wt=()=>r.value?.chain().focus().undo().run(),Ct=()=>r.value?.chain().focus().redo().run(),be=h(!1),Me=h(!1),G=h({url:"",text:""}),oe=h({color:"#000000"}),Tt=()=>{const{from:o,to:e}=r.value?.state.selection||{from:0,to:0},d=r.value?.state.doc.textBetween(o,e)||"";r.value?.isActive("link")?r.value.chain().focus().unsetLink().run():(G.value.text=d,G.value.url="",be.value=!0)},At=()=>{if(G.value.url){if(G.value.text){const{from:o,to:e}=r.value?.state.selection||{from:0,to:0};r.value?.chain().focus().deleteRange({from:o,to:e}).insertContent(`<a href="${G.value.url}">${G.value.text}</a>`).run()}else r.value?.chain().focus().setLink({href:G.value.url}).run();be.value=!1}},Mt=()=>{Me.value=!0},zt=()=>{oe.value.color&&r.value?.chain().focus().setColor(oe.value.color).run(),Me.value=!1},St=()=>{r.value?.chain().focus().unsetColor().run()},ce=h(!1),ge=h(""),ye=h(!1),ze=h(0),fe=h(""),Se=h(null),Lt=()=>{ge.value="",fe.value="",ce.value=!0},Ke=()=>{ge.value&&(r.value?.chain().focus().setImage({src:ge.value}).run(),ce.value=!1)},Ht=o=>{const d=o.target.files?.[0];d&&Ue(d)},Ue=async o=>{if(!o.type.startsWith("image/")){fe.value="Please select an image file";return}ye.value=!0,fe.value="",ze.value=0;try{const e=new FormData;e.append("image",o);const d=await lt.post("/editor/images",e,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:y=>{y.total&&(ze.value=Math.round(y.loaded*100/y.total))}});d.data.success&&(r.value?.chain().focus().setImage({src:d.data.url,width:d.data.width,height:d.data.height}).run(),ce.value=!1)}catch(e){fe.value=e.response?.data?.message||"Upload failed"}finally{ye.value=!1,ze.value=0,Se.value&&(Se.value.value="")}},Xe=o=>{const{file:e}=o.detail;Ue(e)},Ye=o=>{const{file:e}=o.detail;Ue(e)},Ze=h("#ffff00"),$t=()=>{if(r.value?.isActive("highlight"))r.value.chain().focus().unsetHighlight().run();else{const o=prompt("Enter highlight color (hex, rgb, or color name):",Ze.value);o?(Ze.value=o,r.value?.chain().focus().setHighlight({color:o}).run()):r.value?.chain().focus().setHighlight().run()}},Le=o=>{r.value?.chain().focus().setTextAlign(o).run()},It=()=>{r.value?.chain().focus().insertTable({rows:3,cols:3,withHeaderRow:!0}).run()},Rt=()=>{r.value?.chain().focus().addColumnBefore().run()},Et=()=>{r.value?.chain().focus().addColumnAfter().run()},_t=()=>{r.value?.chain().focus().deleteColumn().run()},Vt=()=>{r.value?.chain().focus().addRowBefore().run()},Pt=()=>{r.value?.chain().focus().addRowAfter().run()},Dt=()=>{r.value?.chain().focus().deleteRow().run()},Ut=()=>{r.value?.chain().focus().deleteTable().run()},se=()=>r.value?.isActive("table")??!1,Qe=h("12pt"),ke=["8pt","9pt","10pt","11pt","12pt","14pt","16pt","18pt","20pt","24pt","28pt","36pt","48pt","72pt"],Bt=()=>{const o=Be(),e=ke.indexOf(o);if(e===-1)r.value?.chain().focus().setFontSize("14pt").run();else if(e<ke.length-1){const d=ke[e+1];r.value?.chain().focus().setFontSize(d).run()}we()},Ft=()=>{const o=Be(),e=ke.indexOf(o);if(e===-1)r.value?.chain().focus().setFontSize("11pt").run();else if(e>0){const d=ke[e-1];r.value?.chain().focus().setFontSize(d).run()}we()},Be=()=>{const{from:o,to:e}=r.value?.state.selection||{from:0,to:0};let d="";return r.value?.state.doc.nodesBetween(o,e,y=>{y.marks&&y.marks.forEach(I=>{I.type.name==="textStyle"&&I.attrs.fontSize&&(d=I.attrs.fontSize)})}),d||"12pt"},we=()=>{const o=Be();Qe.value=o||"12pt"},Ot=F(()=>r.value?r.value.state.doc.textContent.split(/\s+/).filter(e=>e.length>0).length:0);return s({getSelectionRange:()=>{if(!r.value)return null;const{from:o,to:e,empty:d}=r.value.state.selection;return d?null:{from:o,to:e}},getSelectedText:()=>{if(!r.value)return"";const{from:o,to:e}=r.value.state.selection;return r.value.state.doc.textBetween(o,e)},replaceSelection:(o,e)=>{if(!r.value)return console.error("âŒ RichTextEditor - Cannot replace selection: editor not available"),!1;try{const d=e||r.value.state.selection;return console.log("ðŸ”„ RichTextEditor - Starting text replacement:",{range:d,newTextLength:o.length,newTextPreview:o.substring(0,100)+(o.length>100?"...":"")}),r.value.chain().focus().insertContentAt({from:d.from,to:d.to},o,{parseOptions:{preserveWhitespace:"full"}}).run(),console.log("âœ… RichTextEditor - Text replacement successful"),!0}catch(d){return console.error("âŒ RichTextEditor - Error replacing selection:",d),!1}},replaceTextAt:(o,e)=>{if(!r.value)return!1;try{return r.value.chain().focus().insertContentAt(o,e).run(),!0}catch(d){return console.error("Error replacing text at position:",d),!1}},getCursorPosition:()=>r.value?r.value.state.selection.anchor:0,setCursorPosition:o=>{if(!r.value)return!1;try{return r.value.commands.setTextSelection(o),!0}catch(e){return console.error("Error setting cursor position:",e),!1}},focus:()=>r.value?.commands.focus(),blur:()=>r.value?.commands.blur(),getHTML:()=>r.value?.getHTML()||"",getText:()=>r.value?.getText()||"",wordCount:Ot,startStreamingMode:ae,endStreamingMode:k,refreshContent:H,getStreamingInfo:Z,isStreamingActive:()=>A.value,editor:()=>r.value}),(o,e)=>(w(),z("div",fr,[o.showToolbar&&!o.readonly?(w(),de(Nt,{key:0,to:ve.value,disabled:q.value},[u("div",{class:b(xe.value)},[u("div",mr,[a(t(p),{variant:"ghost",size:"icon",class:"h-8 w-8 rounded-lg hover:bg-muted/80 text-zinc-700 dark:text-zinc-300 hover:text-foreground",onClick:wt,disabled:!t(r)?.can().undo()},{default:i(()=>[a(t(Ra),{class:"h-4 w-4"})]),_:1},8,["disabled"]),a(t(p),{variant:"ghost",size:"icon",class:"h-8 w-8 rounded-lg hover:bg-muted/80 text-zinc-700 dark:text-zinc-300 hover:text-foreground",onClick:Ct,disabled:!t(r)?.can().redo()},{default:i(()=>[a(t(La),{class:"h-4 w-4"})]),_:1},8,["disabled"])]),u("div",pr,[a(t(rt),null,{default:i(()=>[a(t(tt),{asChild:""},{default:i(()=>[a(t(p),{variant:"ghost",size:"sm",class:"h-8 gap-1 px-2 font-medium text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80"},{default:i(()=>[u("span",hr,D(t(r)?.isActive("heading",{level:1})?"H1":t(r)?.isActive("heading",{level:2})?"H2":t(r)?.isActive("heading",{level:3})?"H3":"Paragraph"),1),a(t(mt),{class:"h-3.5 w-3.5 opacity-70"})]),_:1})]),_:1}),a(t(at),{align:"start"},{default:i(()=>[a(t(N),{onClick:kt,class:b({"bg-accent":t(r)?.isActive("paragraph")})},{default:i(()=>[...e[15]||(e[15]=[u("span",{class:"text-sm"},"Paragraph",-1)])]),_:1},8,["class"]),a(t(He)),a(t(N),{onClick:K,class:b({"bg-accent":t(r)?.isActive("heading",{level:1})})},{default:i(()=>[...e[16]||(e[16]=[u("span",{class:"text-lg font-bold"},"Heading 1",-1)])]),_:1},8,["class"]),a(t(N),{onClick:J,class:b({"bg-accent":t(r)?.isActive("heading",{level:2})})},{default:i(()=>[...e[17]||(e[17]=[u("span",{class:"text-base font-bold"},"Heading 2",-1)])]),_:1},8,["class"]),a(t(N),{onClick:Ae,class:b({"bg-accent":t(r)?.isActive("heading",{level:3})})},{default:i(()=>[...e[18]||(e[18]=[u("span",{class:"text-sm font-bold"},"Heading 3",-1)])]),_:1},8,["class"])]),_:1})]),_:1}),u("div",vr,[a(t(p),{variant:"ghost",size:"icon",class:"h-8 w-6 rounded-l-lg text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80",onClick:Ft},{default:i(()=>[a(t(xa),{class:"h-3 w-3"})]),_:1}),u("div",xr,D(Qe.value.replace("pt","")),1),a(t(p),{variant:"ghost",size:"icon",class:"h-8 w-6 rounded-r-lg text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80",onClick:Bt},{default:i(()=>[a(t(ba),{class:"h-3 w-3"})]),_:1})])]),u("div",br,[a(t(p),{variant:"ghost",size:"icon",class:b(["h-8 w-8 rounded-lg text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80",{"bg-primary/10 text-primary":t(r)?.isActive("bold")}]),onClick:Q},{default:i(()=>[a(t(wa),{class:"h-4 w-4"})]),_:1},8,["class"]),a(t(p),{variant:"ghost",size:"icon",class:b(["h-8 w-8 rounded-lg text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80",{"bg-primary/10 text-primary":t(r)?.isActive("italic")}]),onClick:he},{default:i(()=>[a(t(Aa),{class:"h-4 w-4"})]),_:1},8,["class"]),a(t(p),{variant:"ghost",size:"icon",class:b(["h-8 w-8 rounded-lg text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80",{"bg-primary/10 text-primary":t(r)?.isActive("underline")}]),onClick:ne},{default:i(()=>[a(t(Ia),{class:"h-4 w-4"})]),_:1},8,["class"]),a(t(p),{variant:"ghost",size:"icon",class:b(["h-8 w-8 rounded-lg text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80",{"bg-primary/10 text-primary":t(r)?.isActive("strike")}]),onClick:Pe},{default:i(()=>[a(t(Ha),{class:"h-4 w-4"})]),_:1},8,["class"]),a(t(p),{variant:"ghost",size:"icon",class:b(["h-8 w-8 rounded-lg text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80",{"bg-primary/10 text-primary":t(r)?.isActive("code")}]),onClick:De},{default:i(()=>[a(t(Ca),{class:"h-4 w-4"})]),_:1},8,["class"])]),u("div",yr,[a(t(p),{variant:"ghost",size:"icon",class:b(["h-8 w-8 rounded-lg text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80",{"bg-primary/10 text-primary":t(r)?.isActive("bulletList")}]),onClick:xt},{default:i(()=>[a(t(ya),{class:"h-4 w-4"})]),_:1},8,["class"]),a(t(p),{variant:"ghost",size:"icon",class:b(["h-8 w-8 rounded-lg text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80",{"bg-primary/10 text-primary":t(r)?.isActive("orderedList")}]),onClick:bt},{default:i(()=>[a(t(Ma),{class:"h-4 w-4"})]),_:1},8,["class"]),a(t(p),{variant:"ghost",size:"icon",class:b(["h-8 w-8 rounded-lg text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80",{"bg-primary/10 text-primary":t(r)?.isActive("blockquote")}]),onClick:yt},{default:i(()=>[a(t(Sa),{class:"h-4 w-4"})]),_:1},8,["class"]),u("div",kr,[a(t(p),{variant:"ghost",size:"icon",class:b(["h-8 w-8 rounded-lg text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80",{"bg-primary/10 text-primary":t(r)?.isActive({textAlign:"left"})}]),onClick:e[0]||(e[0]=d=>Le("left"))},{default:i(()=>[a(t(ht),{class:"h-4 w-4"})]),_:1},8,["class"]),a(t(p),{variant:"ghost",size:"icon",class:b(["h-8 w-8 rounded-lg text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80",{"bg-primary/10 text-primary":t(r)?.isActive({textAlign:"center"})}]),onClick:e[1]||(e[1]=d=>Le("center"))},{default:i(()=>[a(t(pt),{class:"h-4 w-4"})]),_:1},8,["class"]),a(t(p),{variant:"ghost",size:"icon",class:b(["h-8 w-8 rounded-lg text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80",{"bg-primary/10 text-primary":t(r)?.isActive({textAlign:"right"})}]),onClick:e[2]||(e[2]=d=>Le("right"))},{default:i(()=>[a(t(vt),{class:"h-4 w-4"})]),_:1},8,["class"]),a(t(p),{variant:"ghost",size:"icon",class:b(["h-8 w-8 rounded-lg text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80",{"bg-primary/10 text-primary":t(r)?.isActive({textAlign:"justify"})}]),onClick:e[3]||(e[3]=d=>Le("justify"))},{default:i(()=>[a(t(ka),{class:"h-4 w-4"})]),_:1},8,["class"])])]),u("div",wr,[a(t(p),{variant:"ghost",size:"icon",class:"h-8 w-8 rounded-lg text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80",title:"Insert Mermaid diagram (Ctrl/Cmd+Alt+M)",onClick:Te},{default:i(()=>[...e[19]||(e[19]=[u("span",{class:"text-[11px] font-semibold"},"M",-1)])]),_:1}),a(t(p),{variant:"ghost",size:"icon",class:b(["h-8 w-8 rounded-lg text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80",{"bg-primary/10 text-primary":t(r)?.isActive("link")}]),onClick:Tt},{default:i(()=>[a(t(ha),{class:"h-4 w-4"})]),_:1},8,["class"]),a(t(p),{variant:"ghost",size:"icon",class:"h-8 w-8 rounded-lg text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80",title:"Insert image",onClick:Lt},{default:i(()=>[a(t(fa),{class:"h-4 w-4"})]),_:1}),a(t(rt),null,{default:i(()=>[a(t(tt),{asChild:""},{default:i(()=>[a(t(p),{variant:"ghost",size:"icon",class:b(["h-8 w-8 rounded-lg text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80",{"bg-primary/10 text-primary":t(r)?.isActive("table")}])},{default:i(()=>[a(t($a),{class:"h-4 w-4"})]),_:1},8,["class"])]),_:1}),a(t(at),null,{default:i(()=>[a(t(N),{onClick:It},{default:i(()=>[...e[20]||(e[20]=[x("Insert Table (3x3)",-1)])]),_:1}),a(t(He)),a(t(N),{onClick:Rt,disabled:!se()},{default:i(()=>[...e[21]||(e[21]=[x("Add Column Before",-1)])]),_:1},8,["disabled"]),a(t(N),{onClick:Et,disabled:!se()},{default:i(()=>[...e[22]||(e[22]=[x("Add Column After",-1)])]),_:1},8,["disabled"]),a(t(N),{onClick:_t,disabled:!se()},{default:i(()=>[...e[23]||(e[23]=[x("Delete Column",-1)])]),_:1},8,["disabled"]),a(t(He)),a(t(N),{onClick:Vt,disabled:!se()},{default:i(()=>[...e[24]||(e[24]=[x("Add Row Before",-1)])]),_:1},8,["disabled"]),a(t(N),{onClick:Pt,disabled:!se()},{default:i(()=>[...e[25]||(e[25]=[x("Add Row After",-1)])]),_:1},8,["disabled"]),a(t(N),{onClick:Dt,disabled:!se()},{default:i(()=>[...e[26]||(e[26]=[x("Delete Row",-1)])]),_:1},8,["disabled"]),a(t(He)),a(t(N),{onClick:Ut,disabled:!se(),class:"text-destructive"},{default:i(()=>[...e[27]||(e[27]=[x("Delete Table ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1}),a(t(p),{variant:"ghost",size:"icon",class:b(["h-8 w-8 rounded-lg text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80",{"bg-primary/10 text-primary":t(r)?.isActive("highlight")}]),onClick:$t},{default:i(()=>[a(t(Ta),{class:"h-4 w-4"})]),_:1},8,["class"]),a(t(p),{variant:"ghost",size:"icon",class:b(["h-8 w-8 rounded-lg text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/80",{"bg-primary/10 text-primary":t(r)?.getAttributes("textStyle").color}]),onClick:Mt},{default:i(()=>[a(t(za),{class:"h-4 w-4"})]),_:1},8,["class"])])],2)],8,["to","disabled"])):U("",!0),u("div",Cr,[a(t(ma),{editor:t(r),class:"h-full w-full outline-none"},null,8,["editor"]),o.isGenerating?(w(),z("div",Tr,[u("div",Ar,[u("div",Mr,[e[28]||(e[28]=u("div",{class:"absolute inset-0 animate-ping rounded-full bg-primary/20"},null,-1)),u("div",zr,[a(t(ft),{class:"h-8 w-8 animate-spin text-primary"})])]),u("div",Sr,[u("h3",Lr,D(o.generationPhase||"Generating..."),1),u("p",Hr,D(o.generationProgress||"AI is writing your chapter..."),1)]),a(t(et),{"model-value":o.generationPercentage,class:"h-2 w-64"},null,8,["model-value"])])])):U("",!0)]),a(t($e),{open:be.value,"onUpdate:open":e[7]||(e[7]=d=>be.value=d)},{default:i(()=>[a(t(Ie),null,{default:i(()=>[a(t(_e),null,{default:i(()=>[a(t(Ve),null,{default:i(()=>[...e[29]||(e[29]=[x("Insert Link",-1)])]),_:1}),a(t(Re),null,{default:i(()=>[...e[30]||(e[30]=[x("Enter the URL for the link.",-1)])]),_:1})]),_:1}),u("div",$r,[u("div",Ir,[a(t(me),{htmlFor:"link-text"},{default:i(()=>[...e[31]||(e[31]=[x("Text",-1)])]),_:1}),a(t(ie),{id:"link-text",modelValue:G.value.text,"onUpdate:modelValue":e[4]||(e[4]=d=>G.value.text=d),placeholder:"Link text"},null,8,["modelValue"])]),u("div",Rr,[a(t(me),{htmlFor:"link-url"},{default:i(()=>[...e[32]||(e[32]=[x("URL",-1)])]),_:1}),a(t(ie),{id:"link-url",modelValue:G.value.url,"onUpdate:modelValue":e[5]||(e[5]=d=>G.value.url=d),placeholder:"https://example.com"},null,8,["modelValue"])])]),a(t(Ee),null,{default:i(()=>[a(t(p),{variant:"outline",onClick:e[6]||(e[6]=d=>be.value=!1)},{default:i(()=>[...e[33]||(e[33]=[x("Cancel",-1)])]),_:1}),a(t(p),{onClick:At},{default:i(()=>[...e[34]||(e[34]=[x("Insert",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),a(t($e),{open:Me.value,"onUpdate:open":e[10]||(e[10]=d=>Me.value=d)},{default:i(()=>[a(t(Ie),null,{default:i(()=>[a(t(_e),null,{default:i(()=>[a(t(Ve),null,{default:i(()=>[...e[35]||(e[35]=[x("Text Color",-1)])]),_:1}),a(t(Re),null,{default:i(()=>[...e[36]||(e[36]=[x("Choose a color for the selected text.",-1)])]),_:1})]),_:1}),u("div",Er,[u("div",_r,[a(t(ie),{type:"color",modelValue:oe.value.color,"onUpdate:modelValue":e[8]||(e[8]=d=>oe.value.color=d),class:"h-12 w-12 p-1"},null,8,["modelValue"]),a(t(ie),{modelValue:oe.value.color,"onUpdate:modelValue":e[9]||(e[9]=d=>oe.value.color=d),placeholder:"#000000",class:"flex-1"},null,8,["modelValue"])]),u("div",Vr,[(w(),z(We,null,Gt(["#000000","#ef4444","#f97316","#eab308","#22c55e","#3b82f6","#a855f7","#ec4899"],d=>u("button",{key:d,class:"h-8 w-8 rounded-full border border-border shadow-sm transition-transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",style:Ce({backgroundColor:d}),onClick:y=>oe.value.color=d},null,12,Pr)),64))])]),a(t(Ee),null,{default:i(()=>[a(t(p),{variant:"outline",onClick:St},{default:i(()=>[...e[37]||(e[37]=[x("Reset",-1)])]),_:1}),a(t(p),{onClick:zt},{default:i(()=>[...e[38]||(e[38]=[x("Apply",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),a(t($e),{open:ce.value,"onUpdate:open":e[14]||(e[14]=d=>ce.value=d)},{default:i(()=>[a(t(Ie),{class:"sm:max-w-md"},{default:i(()=>[a(t(_e),null,{default:i(()=>[a(t(Ve),null,{default:i(()=>[...e[39]||(e[39]=[x("Insert Image",-1)])]),_:1}),a(t(Re),null,{default:i(()=>[...e[40]||(e[40]=[x("Upload an image or enter a URL.",-1)])]),_:1})]),_:1}),u("div",Dr,[u("div",Ur,[a(t(me),null,{default:i(()=>[...e[41]||(e[41]=[x("Upload from computer",-1)])]),_:1}),u("div",Br,[u("input",{ref_key:"imageFileInput",ref:Se,type:"file",accept:"image/*",class:"hidden",onChange:Ht},null,544),a(t(p),{variant:"outline",class:"w-full",disabled:ye.value,onClick:e[11]||(e[11]=d=>Se.value?.click())},{default:i(()=>[a(t(Ea),{class:"w-4 h-4 mr-2"}),x(" "+D(ye.value?"Uploading...":"Choose File"),1)]),_:1},8,["disabled"])]),ye.value?(w(),de(t(et),{key:0,"model-value":ze.value,class:"h-2"},null,8,["model-value"])):U("",!0),fe.value?(w(),z("p",Fr,D(fe.value),1)):U("",!0)]),e[44]||(e[44]=u("div",{class:"relative"},[u("div",{class:"absolute inset-0 flex items-center"},[u("span",{class:"w-full border-t"})]),u("div",{class:"relative flex justify-center text-xs uppercase"},[u("span",{class:"bg-background px-2 text-muted-foreground"},"Or")])],-1)),u("div",Or,[a(t(me),{for:"image-url"},{default:i(()=>[...e[42]||(e[42]=[x("Image URL",-1)])]),_:1}),u("div",Wr,[a(t(ie),{id:"image-url",modelValue:ge.value,"onUpdate:modelValue":e[12]||(e[12]=d=>ge.value=d),placeholder:"https://example.com/image.jpg",onKeydown:st(Ke,["enter"])},null,8,["modelValue"]),a(t(p),{onClick:Ke,disabled:!ge.value},{default:i(()=>[...e[43]||(e[43]=[x(" Insert ",-1)])]),_:1},8,["disabled"])])])]),a(t(Ee),null,{default:i(()=>[a(t(p),{variant:"outline",onClick:e[13]||(e[13]=d=>ce.value=!1)},{default:i(()=>[...e[45]||(e[45]=[x("Cancel",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]))}}),hn=Ge(jr,[["__scopeId","data-v-e8a2e8aa"]]);export{ht as A,wa as B,Ca as C,Aa as I,Sa as Q,hn as R,Ea as U,_a as i};
