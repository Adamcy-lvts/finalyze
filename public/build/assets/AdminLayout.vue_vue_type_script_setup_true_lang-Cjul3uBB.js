import{bt as T,cn as p,co as i,bE as e,fm as te,d0 as se,cp as t,dx as h,cB as u,cu as I,ch as re,ck as U,bs as j,bA as le,bB as oe,cq as a,dr as b,cr as o,eL as E,cs as f,cS as w,df as B,dl as ie,eD as ne,dm as de,dY as ce,e0 as ue,fK as fe,dK as O,ct as c,di as me,gf as pe,eE as M,dW as _e,gg as ge,e6 as be,e4 as he,dZ as xe,eH as ve,dH as V,f4 as ye,gh as q,cG as _,eG as ke,eF as we,eN as $e,dw as Ce,cb as F}from"./vendor-DwcF3VNb.js";import{e as Se,_ as Ne,a as ze,b as Le,d as G,c as R,f as De}from"./Sonner.vue_vue_type_script_setup_true_lang-kLZ_SglN.js";import{u as je,i as Be,j as Fe,d as P,e as A,f as $,k as Pe,b as W,g as H,c as K,l as Ae,h as Y,_ as Ie,m as Te,n as Ue,o as Ee,p as Oe,q as Me,r as Ve,a as qe}from"./UserInfo.vue_vue_type_script_setup_true_lang-CpzsT-yS.js";import{c as Ge,_ as C}from"./index-BpTO5Kag.js";const Re=T({__name:"SheetClose",props:{asChild:{type:Boolean},as:{}},setup(x){const m=x;return(d,v)=>(i(),p(e(te),se({"data-slot":"sheet-close"},m),{default:t(()=>[h(d.$slots,"default")]),_:3},16))}}),We=T({__name:"SidebarRail",props:{class:{}},setup(x){const m=x,{toggleSidebar:d}=je();return(v,y)=>(i(),u("button",{"data-sidebar":"rail","data-slot":"sidebar-rail","aria-label":"Toggle Sidebar",tabindex:-1,title:"Toggle Sidebar",class:I(e(Ge)("hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex","in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",m.class)),onClick:y[0]||(y[0]=(...k)=>e(d)&&e(d)(...k))},[h(v.$slots,"default")],2))}}),He={class:"flex h-8 w-8 items-center justify-center rounded-lg bg-primary text-primary-foreground"},Ke={class:"font-medium"},Ye={class:"font-medium"},Xe={class:"flex items-center gap-2 px-2 py-2 text-left text-sm"},Ze={class:"sticky top-0 z-10 border-b border-border/40 bg-background/80 backdrop-blur-md supports-[backdrop-filter]:bg-background/60"},Je={class:"max-w-7xl mx-auto px-4 md:px-8 min-h-16 py-3 flex items-center justify-between"},Qe={class:"flex items-center gap-3"},ea={class:"flex flex-col leading-tight"},aa={class:"text-2xl font-bold tracking-tight text-foreground"},ta={key:0,class:"text-muted-foreground text-sm"},sa={class:"flex items-center gap-3 md:gap-6"},ra={key:0,class:"absolute -top-1 -right-1 flex h-4 min-w-4 items-center justify-center rounded-full bg-destructive px-1 text-[10px] font-semibold text-destructive-foreground ring-2 ring-background"},la={class:"hidden md:flex items-center gap-3 text-sm text-muted-foreground"},oa={class:"flex-1 overflow-y-auto"},ia={class:"max-w-7xl mx-auto px-4 md:px-8 py-6 md:py-8"},na={class:"flex items-center justify-between gap-3"},da={class:"space-y-1"},ca={class:"flex items-center gap-2"},ua={class:"flex-1 overflow-y-auto divide-y divide-border/40"},fa={key:0,class:"p-4 text-sm text-muted-foreground flex items-center gap-2"},ma={key:1,class:"p-6 text-sm text-muted-foreground"},pa={class:"flex-1 space-y-1"},_a={class:"text-sm font-semibold text-foreground"},ga={class:"text-xs text-muted-foreground leading-relaxed"},ba={class:"text-[11px] text-muted-foreground"},wa=T({__name:"AdminLayout",props:{title:{},subtitle:{}},setup(x){const m=re(),d=U(()=>m.props.auth?.user),v=[{href:"/admin",label:"Dashboard",icon:E,exact:!0},{href:"/admin/users",label:"Users",icon:ie},{href:"/admin/payments",label:"Payments",icon:ne},{href:"/admin/affiliates",label:"Affiliates",icon:de},{href:"/admin/packages",label:"Packages",icon:ce},{href:"/admin/projects",label:"Projects",icon:ue},{href:"/admin/analytics",label:"Analytics",icon:fe}],y=[{href:"/admin/ai",label:"AI Monitoring",icon:me},{href:"/admin/system/features",label:"Feature Flags",icon:pe},{href:"/admin/system/settings",label:"Settings",icon:M},{href:"/admin/system/cleanup",label:"Data Cleanup",icon:_e},{href:"/admin/system/universities",label:"Universities",icon:ge},{href:"/admin/system/project-categories",label:"Project Categories",icon:be},{href:"/admin/system/faculties",label:"Faculties",icon:he},{href:"/admin/system/departments",label:"Departments",icon:xe},{href:"/admin/system/faculty-structures",label:"Faculty Structure",icon:ve},{href:"/admin/system/prompt-templates",label:"Prompt Templates",icon:V},{href:"/admin/system/prompt-preview",label:"Prompt Preview",icon:V},{href:"/admin/audit",label:"Audit Logs",icon:ye},{href:"/admin/notifications",label:"Notifications",icon:q}],k=(s,r=!1)=>r?m.url===s:m.url.startsWith(s),S=j(!1),n=j([]),N=j(!1),z=async()=>{try{N.value=!0;const s=await F.get("/admin/notifications",{params:{format:"json"}});n.value=s.data.notifications??[]}catch(s){console.error("Failed to load notifications",s)}finally{N.value=!1}},X=async()=>{S.value=!0,await z()},g=U(()=>n.value.filter(s=>!s.is_read&&!s.read_at).length),Z=async s=>{try{await F.post(`/admin/notifications/${s}/read`),n.value=n.value.map(r=>r.id===s?{...r,is_read:!0,read_at:new Date().toISOString()}:r)}catch(r){console.error("Failed to mark notification as read",r)}},J=async()=>{if(n.value.length)try{await F.post("/admin/notifications/read-all"),n.value=n.value.map(s=>({...s,is_read:!0,read_at:new Date().toISOString()}))}catch(s){console.error("Failed to mark all notifications as read",s)}},Q=s=>s?s.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase()):"Notification",ee=s=>{if(!s)return"";const r=new Date(s);return new Intl.DateTimeFormat("en",{dateStyle:"medium",timeStyle:"short"}).format(r)};let L=null,D=null;const ae=s=>{if(!s?.id)return;if(n.value.findIndex(l=>l.id===s.id)!==-1){n.value=n.value.map(l=>l.id===s.id?s:l);return}n.value=[s,...n.value].slice(0,50)};return le(()=>{z(),L=window.Echo?.private("admin.ai"),L?.listen(".ai.provisioning.updated",()=>{z()}),D=window.Echo?.private("admin.notifications"),D?.listen(".admin.notification.created",s=>{ae(s?.notification)})}),oe(()=>{L?.stopListening(".ai.provisioning.updated"),D?.stopListening(".admin.notification.created")}),(s,r)=>(i(),u(w,null,[a(e(qe),null,{default:t(()=>[a(e(Be),{collapsible:"icon",variant:"inset",class:"border-r border-border/60 bg-sidebar/95 backdrop-blur-xl supports-[backdrop-filter]:bg-sidebar/80"},{default:t(()=>[a(e(Fe),{class:"h-16 flex items-center justify-center border-b border-border/50 px-4"},{default:t(()=>[a(e(P),null,{default:t(()=>[a(e(A),null,{default:t(()=>[a(e($),{size:"lg",class:"hover:bg-transparent data-[state=open]:bg-transparent"},{default:t(()=>[a(e(b),{href:"/admin",class:"flex items-center gap-3 w-full"},{default:t(()=>[o("div",He,[a(e(E),{class:"h-5 w-5"})]),r[1]||(r[1]=o("div",{class:"flex flex-col gap-0.5 leading-none"},[o("span",{class:"font-semibold text-foreground"},"Admin Panel"),o("span",{class:"text-xs text-muted-foreground"},"v1.0.0")],-1))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(e(Pe),{class:"py-4"},{default:t(()=>[a(e(W),null,{default:t(()=>[a(e(H),{class:"px-4 text-xs font-medium text-muted-foreground/70 uppercase tracking-wider mb-2"},{default:t(()=>[...r[2]||(r[2]=[f(" Platform",-1)])]),_:1}),a(e(K),null,{default:t(()=>[a(e(P),null,{default:t(()=>[(i(),u(w,null,B(v,l=>a(e(A),{key:l.href},{default:t(()=>[a(e($),{"as-child":"","is-active":k(l.href,l.exact),tooltip:l.label,class:"px-4 py-2 h-auto transition-colors hover:bg-muted/50 data-[active=true]:bg-primary/10 data-[active=true]:text-primary"},{default:t(()=>[a(e(b),{href:l.href,class:"flex items-center gap-3"},{default:t(()=>[(i(),p(O(l.icon),{class:"h-4 w-4"})),o("span",Ke,c(l.label),1)]),_:2},1032,["href"])]),_:2},1032,["is-active","tooltip"])]),_:2},1024)),64))]),_:1})]),_:1})]),_:1}),a(e(W),{class:"mt-4"},{default:t(()=>[a(e(H),{class:"px-4 text-xs font-medium text-muted-foreground/70 uppercase tracking-wider mb-2"},{default:t(()=>[...r[3]||(r[3]=[f(" System",-1)])]),_:1}),a(e(K),null,{default:t(()=>[a(e(P),null,{default:t(()=>[(i(),u(w,null,B(y,l=>a(e(A),{key:l.href},{default:t(()=>[a(e($),{"as-child":"","is-active":k(l.href),tooltip:l.label,class:"px-4 py-2 h-auto transition-colors hover:bg-muted/50 data-[active=true]:bg-primary/10 data-[active=true]:text-primary"},{default:t(()=>[a(e(b),{href:l.href,class:"flex items-center gap-3"},{default:t(()=>[(i(),p(O(l.icon),{class:"h-4 w-4"})),o("span",Ye,c(l.label),1)]),_:2},1032,["href"])]),_:2},1032,["is-active","tooltip"])]),_:2},1024)),64))]),_:1})]),_:1})]),_:1})]),_:1}),a(e(Ae),{class:"border-t border-border/50 p-4"},{default:t(()=>[a(e(Se),null,{default:t(()=>[a(e(Ne),{"as-child":""},{default:t(()=>[a(e($),{size:"lg",class:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground hover:bg-muted/50 transition-colors"},{default:t(()=>[d.value?(i(),p(Y,{key:0,user:d.value},null,8,["user"])):_("",!0),a(e(ke),{class:"ml-auto size-4 text-muted-foreground"})]),_:1})]),_:1}),a(e(ze),{class:"w-[--radix-dropdown-menu-trigger-width] min-w-56 rounded-lg",side:"top",align:"start","side-offset":8},{default:t(()=>[a(e(Le),{class:"p-0 font-normal"},{default:t(()=>[o("div",Xe,[d.value?(i(),p(Y,{key:0,user:d.value,"show-email":!0},null,8,["user"])):_("",!0)])]),_:1}),a(e(G)),a(e(R),{"as-child":!0},{default:t(()=>[a(e(b),{class:"block w-full cursor-pointer",href:s.route("profile.edit"),prefetch:"",as:"button"},{default:t(()=>[a(e(M),{class:"mr-2 h-4 w-4"}),r[4]||(r[4]=f(" Settings ",-1))]),_:1},8,["href"])]),_:1}),a(e(G)),a(e(R),{"as-child":!0},{default:t(()=>[a(e(b),{class:"block w-full cursor-pointer text-rose-500 focus:text-rose-500",method:"post",href:s.route("logout"),as:"button"},{default:t(()=>[a(e(we),{class:"mr-2 h-4 w-4"}),r[5]||(r[5]=f(" Log out ",-1))]),_:1},8,["href"])]),_:1})]),_:1})]),_:1})]),_:1}),a(e(We))]),_:1}),a(e(Ie),{class:"bg-background text-foreground flex min-h-screen flex-col"},{default:t(()=>[o("header",Ze,[o("div",Je,[o("div",Qe,[a(e(Te)),h(s.$slots,"title",{},()=>[o("div",ea,[o("h2",aa,c(s.title??"Admin"),1),s.subtitle?(i(),u("p",ta,c(s.subtitle),1)):_("",!0)])])]),o("div",sa,[h(s.$slots,"actions",{},()=>[a(e(C),{variant:"ghost",size:"icon",class:"relative text-muted-foreground hover:text-foreground transition-colors",onClick:X},{default:t(()=>[a(e(q),{class:"h-5 w-5"}),g.value>0?(i(),u("span",ra,c(g.value>99?"99+":g.value),1)):_("",!0),r[6]||(r[6]=o("span",{class:"sr-only"},"Notifications",-1))]),_:1})]),o("div",la,[o("span",null,c(d.value?.name),1),r[7]||(r[7]=o("span",{class:"text-muted-foreground/50"},"â€¢",-1)),r[8]||(r[8]=o("a",{href:"/dashboard",class:"text-primary hover:text-primary/80 text-xs font-medium transition-colors"},"Back to app",-1))])])])]),o("main",oa,[o("div",ia,[h(s.$slots,"default")])]),a(e(Ue),{open:S.value,"onUpdate:open":r[0]||(r[0]=l=>S.value=l)},{default:t(()=>[a(e(Ee),{class:"w-full sm:max-w-md p-0 flex flex-col h-full bg-background/95 backdrop-blur-sm shadow-2xl border-l-primary/10"},{default:t(()=>[a(e(Oe),{class:"px-6 py-4 border-b bg-muted/30 sticky top-0 z-10"},{default:t(()=>[o("div",na,[o("div",da,[a(e(Me),{class:"text-xl font-bold"},{default:t(()=>[...r[9]||(r[9]=[f("Notifications",-1)])]),_:1}),a(e(Ve),null,{default:t(()=>[f("You have "+c(g.value)+" unread messages",1)]),_:1})]),o("div",ca,[g.value>0?(i(),p(e(C),{key:0,variant:"outline",size:"sm",class:"text-xs",onClick:J},{default:t(()=>[...r[10]||(r[10]=[f(" Mark all read ",-1)])]),_:1})):_("",!0),a(e(Re),{"as-child":""},{default:t(()=>[a(e(C),{variant:"ghost",size:"icon"},{default:t(()=>[a(e($e),{class:"h-4 w-4"})]),_:1})]),_:1})])])]),_:1}),o("div",ua,[N.value?(i(),u("div",fa,[a(e(Ce),{class:"h-4 w-4 animate-spin"}),r[11]||(r[11]=f(" Loading notifications... ",-1))])):n.value.length?(i(!0),u(w,{key:2},B(n.value,l=>(i(),u("div",{key:l.id,class:I(["flex items-start gap-3 p-4 hover:bg-muted/40 transition-colors",{"bg-primary/5":!l.is_read&&!l.read_at}])},[o("span",{class:I(["mt-1 h-2.5 w-2.5 rounded-full",l.is_read||l.read_at?"bg-muted-foreground/40":"bg-primary"])},null,2),o("div",pa,[o("p",_a,c(l.title??Q(l.type)),1),o("p",ga,c(l.message??l.data?.message??"No details provided"),1),o("div",ba,c(ee(l.created_at)),1)]),!l.is_read&&!l.read_at?(i(),p(e(C),{key:0,variant:"ghost",size:"sm",class:"text-xs",onClick:ha=>Z(l.id)},{default:t(()=>[...r[12]||(r[12]=[f(" Mark read ",-1)])]),_:2},1032,["onClick"])):_("",!0)],2))),128)):(i(),u("div",ma," No notifications yet. "))])]),_:1})]),_:1},8,["open"])]),_:3})]),_:3}),a(e(De),{position:"top-right",expand:!1,"rich-colors":!0,"close-button":!0})],64))}});export{wa as _};
