import{d as ve,r as F,Q as ye,q as Y,J as _e,ax as ge,m as xe,ar as be,an as ke,ay as we,az as Ce,aw as P,g as u,o as d,w as s,b as n,c as y,F as w,f as C,u as e,e as r,h as o,t as c,aA as he,n as T,aB as $e,aC as Re,a as V,aD as Te,aE as Ve,aF as Ne,aG as De,aH as Se,aI as b,_ as Ue}from"./vendor-Bi-OfESq.js";import{s as ee}from"./app-BXCYb-rZ.js";import{C as te,r as Ae}from"./chart-Zj-L_LRF.js";import{_ as Ie}from"./AdminLayout.vue_vue_type_script_setup_true_lang-SkSjBj8N.js";import{_ as N,a as D}from"./CardContent.vue_vue_type_script_setup_true_lang-hI6CIJ8Y.js";import{_ as z}from"./CardDescription.vue_vue_type_script_setup_true_lang-C0xkupM9.js";import{_ as S,a as U}from"./CardTitle.vue_vue_type_script_setup_true_lang-B2K6zULM.js";import{d as se,_ as re,b as h,e as $,a as ae,c as _}from"./TableHeader.vue_vue_type_script_setup_true_lang-CaM13-VK.js";import{_ as p}from"./index-Bt90G_JS.js";import{_ as H}from"./Input.vue_vue_type_script_setup_true_lang-DQnvOcR-.js";import{_ as G}from"./Label.vue_vue_type_script_setup_true_lang-B0S6IESV.js";import{_ as O}from"./index-Isya7Tix.js";import{d as Fe,u as ze,F as le,c as Ee}from"./index-CLOl789g.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BzGYI4X_.js";import"./index-CAP3Ft32.js";import"./Presence-CF0v4nrQ.js";import"./useForwardExpose-RFhk291K.js";import"./DialogTitle-DkxZZug9.js";import"./VisuallyHidden-CHAFMzXk.js";import"./UserInfo.vue_vue_type_script_setup_true_lang-DcY1sPuq.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-DDlQqk4-.js";const Le={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-8"},je={class:"text-2xl font-bold"},Be={class:"text-xs text-muted-foreground mt-1 flex items-center gap-1"},Me={class:"grid gap-4 lg:grid-cols-2"},Pe={class:"flex items-start justify-between gap-4"},He={class:"flex items-center gap-2"},Ge={class:"h-[320px] w-full"},Oe={class:"flex items-start justify-between gap-4"},We={class:"flex items-center gap-2"},qe={class:"h-[320px] w-full"},Je={class:"mt-8"},Qe={class:"flex items-start justify-between gap-4"},Ze={class:"grid gap-4 md:grid-cols-3"},Ke={class:"grid gap-2"},Xe={class:"grid gap-2"},Ye={class:"grid gap-2"},et={class:"flex flex-wrap items-center gap-3"},tt={key:0,class:"text-sm text-destructive"},st={class:"rounded-md border border-border"},rt={key:0},at={class:"flex justify-end gap-2"},lt={class:"mt-8"},nt={class:"flex items-center justify-between"},ot={class:"rounded-md border border-border"},Nt=ve({__name:"Dashboard",props:{inviteOnlyEnabled:{type:Boolean},stats:{},recentActivity:{},invites:{},charts:{}},setup(ne){const m=ne,v=l=>Number(l??0).toLocaleString(),oe=l=>new Date(l).toLocaleString();te.register(...Ae);const g=F("30d"),x=F("30d"),E=F(null),L=F(null);let A=null,I=null;const W=l=>{const t=new Date(`${l}T00:00:00`);return Number.isNaN(t.getTime())?l:new Intl.DateTimeFormat("en",{month:"short",day:"2-digit"}).format(t)},q=l=>{const t=new Date(`${l}-01T00:00:00`);return Number.isNaN(t.getTime())?l:new Intl.DateTimeFormat("en",{month:"short",year:"2-digit"}).format(t)},J=(l,t,a,i)=>{const M={type:"line",data:{labels:t,datasets:[{label:i.label,data:a,borderColor:i.color,backgroundColor:`${i.color}22`,borderWidth:2,pointRadius:0,tension:.35,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{display:!1},tooltip:{callbacks:{title:k=>{const R=String(k?.[0]?.label??"");return i.formatTick(R)},label:k=>{const R=i.valuePrefix??"",ce=i.valueSuffix??"",pe=typeof k.parsed.y=="number"?k.parsed.y:Number(k.parsed.y??0);return`${R}${pe.toLocaleString()}${ce}`}}}},scales:{x:{ticks:{maxTicksLimit:8,callback:(k,R)=>i.formatTick(String(t[R]??""))},grid:{display:!1}},y:{beginAtZero:!0,grid:{color:"rgba(148,163,184,0.15)"},ticks:{precision:0}}}}};return new te(l,M)},Q=()=>{if(!E.value)return;A?.destroy();const l=g.value==="30d"?m.charts.revenue.daily:m.charts.revenue.monthly,t=g.value==="30d"?W:q;A=J(E.value,l.labels,l.data,{label:"Revenue",color:"#6366f1",formatTick:t,valuePrefix:"₦"})},Z=()=>{if(!L.value)return;I?.destroy();const l=x.value==="30d"?m.charts.registrations.daily:m.charts.registrations.monthly,t=x.value==="30d"?W:q;I=J(L.value,l.labels,l.data,{label:"Registrations",color:"#10b981",formatTick:t})};ye(()=>{Q(),Z()}),Y(g,()=>Q()),Y(x,()=>Z()),_e(()=>{A?.destroy(),I?.destroy(),A=null,I=null});const f=ge({count:1,max_uses:1,expires_in_days:7}),ie=()=>{f.post(ee("admin.invites.store"),{preserveScroll:!0,onSuccess:()=>{b.success("Invite(s) created")}})},de=l=>{Ue.post(ee("admin.invites.revoke",{invite:l}),void 0,{preserveScroll:!0,onSuccess:()=>{b.success("Invite revoked")}})},K=async(l,t)=>{const a=String(l??"");if(!a){b.error("Nothing to copy");return}try{if(window.isSecureContext&&navigator.clipboard?.writeText){await navigator.clipboard.writeText(a),b.success(t);return}}catch{}try{const i=document.createElement("textarea");i.value=a,i.setAttribute("readonly","true"),i.style.position="fixed",i.style.top="-9999px",i.style.left="-9999px",document.body.appendChild(i),i.focus(),i.select();const M=document.execCommand("copy");document.body.removeChild(i),M?b.success(t):b.error("Copy failed (browser blocked)")}catch{b.error("Copy failed")}},ue=l=>l==="active"?"Active":l==="expired"?"Expired":l==="revoked"?"Revoked":l==="used_up"?"Used up":l,me=l=>l==="active"?"default":l==="expired"||l==="used_up"?"secondary":l==="revoked"?"destructive":"secondary",fe=xe(()=>[{title:"Total Users",value:v(m.stats.users.total),icon:be,trend:`+${v(m.stats.users.today)}`,trendUp:!0},{title:"Total Revenue",value:`₦${v(m.stats.revenue.total)}`,icon:ke,trend:`+₦${v(m.stats.revenue.today)}`,trendUp:!0},{title:"Active Projects",value:v(m.stats.projects.total),icon:we,trend:`+${v(m.stats.projects.today)}`,trendUp:!0},{title:"Words Generated",value:v(m.stats.words.total),icon:Ce,trend:`+${v(m.stats.words.today)}`,trendUp:!0}]),j=Fe(),X=[j.accessor("type",{header:"Type",cell:l=>{const t=l.getValue();return P(O,{variant:"secondary"},()=>t)}}),j.accessor("message",{header:"Activity",cell:l=>P("div",{class:"font-medium text-foreground"},l.getValue())}),j.accessor("time",{header:"Time",cell:l=>P("div",{class:"text-muted-foreground text-sm"},l.getValue())})],B=ze({get data(){return m.recentActivity},columns:X,getCoreRowModel:Ee()});return(l,t)=>(d(),u(Ie,{title:"Dashboard",subtitle:"Overview of your system's performance."},{default:s(()=>[n("div",Le,[(d(!0),y(w,null,C(fe.value,a=>(d(),u(e(N),{key:a.title,class:"bg-card text-card-foreground border-border/50 shadow-sm hover:shadow-md transition-all duration-200"},{default:s(()=>[r(e(S),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[r(e(U),{class:"text-sm font-medium text-muted-foreground"},{default:s(()=>[o(c(a.title),1)]),_:2},1024),(d(),u(he(a.icon),{class:"h-4 w-4 text-muted-foreground"}))]),_:2},1024),r(e(D),null,{default:s(()=>[n("div",je,c(a.value),1),n("p",Be,[n("span",{class:T([a.trendUp?"text-emerald-500":"text-rose-500","flex items-center"])},[a.trendUp?(d(),u(e($e),{key:0,class:"h-3 w-3 mr-0.5"})):(d(),u(e(Re),{key:1,class:"h-3 w-3 mr-0.5"})),o(" "+c(a.trend),1)],2),t[7]||(t[7]=n("span",{class:"opacity-70"},"from yesterday",-1))])]),_:2},1024)]),_:2},1024))),128))]),n("div",Me,[r(e(N),{class:"border-border/50 shadow-sm"},{default:s(()=>[r(e(S),null,{default:s(()=>[n("div",Pe,[n("div",null,[r(e(U),null,{default:s(()=>[...t[8]||(t[8]=[o("Revenue",-1)])]),_:1}),r(e(z),null,{default:s(()=>[...t[9]||(t[9]=[o("Track successful payments over time.",-1)])]),_:1})]),n("div",He,[r(e(p),{size:"sm",variant:"outline",class:T(g.value==="30d"?"border-primary/40 bg-primary/10 text-primary":""),onClick:t[0]||(t[0]=a=>g.value="30d")},{default:s(()=>[...t[10]||(t[10]=[o(" 30d ",-1)])]),_:1},8,["class"]),r(e(p),{size:"sm",variant:"outline",class:T(g.value==="monthly"?"border-primary/40 bg-primary/10 text-primary":""),onClick:t[1]||(t[1]=a=>g.value="monthly")},{default:s(()=>[...t[11]||(t[11]=[o(" Monthly ",-1)])]),_:1},8,["class"])])])]),_:1}),r(e(D),null,{default:s(()=>[n("div",Ge,[n("canvas",{ref_key:"revenueCanvas",ref:E},null,512)])]),_:1})]),_:1}),r(e(N),{class:"border-border/50 shadow-sm"},{default:s(()=>[r(e(S),null,{default:s(()=>[n("div",Oe,[n("div",null,[r(e(U),null,{default:s(()=>[...t[12]||(t[12]=[o("User Registrations",-1)])]),_:1}),r(e(z),null,{default:s(()=>[...t[13]||(t[13]=[o("New user signups over time.",-1)])]),_:1})]),n("div",We,[r(e(p),{size:"sm",variant:"outline",class:T(x.value==="30d"?"border-primary/40 bg-primary/10 text-primary":""),onClick:t[2]||(t[2]=a=>x.value="30d")},{default:s(()=>[...t[14]||(t[14]=[o(" 30d ",-1)])]),_:1},8,["class"]),r(e(p),{size:"sm",variant:"outline",class:T(x.value==="monthly"?"border-primary/40 bg-primary/10 text-primary":""),onClick:t[3]||(t[3]=a=>x.value="monthly")},{default:s(()=>[...t[15]||(t[15]=[o(" Monthly ",-1)])]),_:1},8,["class"])])])]),_:1}),r(e(D),null,{default:s(()=>[n("div",qe,[n("canvas",{ref_key:"registrationsCanvas",ref:L},null,512)])]),_:1})]),_:1})]),n("div",Je,[r(e(N),{class:"border-border/50 shadow-sm"},{default:s(()=>[r(e(S),null,{default:s(()=>[n("div",Qe,[n("div",null,[r(e(U),null,{default:s(()=>[...t[16]||(t[16]=[o("Registration Invites",-1)])]),_:1}),r(e(z),null,{default:s(()=>[...t[17]||(t[17]=[o(" Generate invite codes/links to control who can register while testing. ",-1)])]),_:1})]),r(e(O),{variant:l.inviteOnlyEnabled?"default":"secondary"},{default:s(()=>[o(c(l.inviteOnlyEnabled?"Invite-only enabled":"Invite-only disabled"),1)]),_:1},8,["variant"])])]),_:1}),r(e(D),{class:"space-y-6"},{default:s(()=>[n("div",Ze,[n("div",Ke,[r(e(G),{for:"count"},{default:s(()=>[...t[18]||(t[18]=[o("How many",-1)])]),_:1}),r(e(H),{id:"count",type:"number",min:"1",max:"25",modelValue:e(f).count,"onUpdate:modelValue":t[4]||(t[4]=a=>e(f).count=a)},null,8,["modelValue"])]),n("div",Xe,[r(e(G),{for:"max_uses"},{default:s(()=>[...t[19]||(t[19]=[o("Max uses",-1)])]),_:1}),r(e(H),{id:"max_uses",type:"number",min:"1",max:"1000",modelValue:e(f).max_uses,"onUpdate:modelValue":t[5]||(t[5]=a=>e(f).max_uses=a)},null,8,["modelValue"])]),n("div",Ye,[r(e(G),{for:"expires_in_days"},{default:s(()=>[...t[20]||(t[20]=[o("Expires in (days)",-1)])]),_:1}),r(e(H),{id:"expires_in_days",type:"number",min:"1",max:"365",modelValue:e(f).expires_in_days,"onUpdate:modelValue":t[6]||(t[6]=a=>e(f).expires_in_days=a)},null,8,["modelValue"])])]),n("div",et,[r(e(p),{size:"sm",class:"gap-2",disabled:e(f).processing,onClick:ie},{default:s(()=>[r(e(Te),{class:"h-4 w-4"}),o(" Generate invite"+c(Number(e(f).count)===1?"":"s"),1)]),_:1},8,["disabled"]),e(f).hasErrors?(d(),y("div",tt," Please fix the invite form errors. ")):V("",!0)]),n("div",st,[r(e(se),null,{default:s(()=>[r(e(re),null,{default:s(()=>[r(e(h),null,{default:s(()=>[r(e($),null,{default:s(()=>[...t[21]||(t[21]=[o("Code",-1)])]),_:1}),r(e($),null,{default:s(()=>[...t[22]||(t[22]=[o("Status",-1)])]),_:1}),r(e($),null,{default:s(()=>[...t[23]||(t[23]=[o("Uses",-1)])]),_:1}),r(e($),null,{default:s(()=>[...t[24]||(t[24]=[o("Expires",-1)])]),_:1}),r(e($),{class:"text-right"},{default:s(()=>[...t[25]||(t[25]=[o("Actions",-1)])]),_:1})]),_:1})]),_:1}),r(e(ae),null,{default:s(()=>[(d(!0),y(w,null,C(l.invites,a=>(d(),u(e(h),{key:a.id},{default:s(()=>[r(e(_),{class:"font-mono text-sm"},{default:s(()=>[o(c(a.code),1)]),_:2},1024),r(e(_),null,{default:s(()=>[r(e(O),{variant:me(a.status)},{default:s(()=>[o(c(ue(a.status)),1)]),_:2},1032,["variant"])]),_:2},1024),r(e(_),{class:"text-sm text-muted-foreground"},{default:s(()=>[o(c(a.uses),1),a.max_uses?(d(),y("span",rt," / "+c(a.max_uses),1)):V("",!0)]),_:2},1024),r(e(_),{class:"text-sm text-muted-foreground"},{default:s(()=>[o(c(a.expires_at?oe(a.expires_at):"—"),1)]),_:2},1024),r(e(_),{class:"text-right"},{default:s(()=>[n("div",at,[r(e(p),{variant:"outline",size:"sm",class:"h-8 gap-1",onClick:i=>K(a.code,"Invite code copied")},{default:s(()=>[r(e(Ve),{class:"h-3.5 w-3.5"}),t[26]||(t[26]=n("span",{class:"hidden sm:inline"},"Copy",-1))]),_:2},1032,["onClick"]),r(e(p),{variant:"outline",size:"sm",class:"h-8 gap-1",onClick:i=>K(a.link,"Invite link copied")},{default:s(()=>[r(e(Ne),{class:"h-3.5 w-3.5"}),t[27]||(t[27]=n("span",{class:"hidden sm:inline"},"Link",-1))]),_:2},1032,["onClick"]),a.status==="active"?(d(),u(e(p),{key:0,variant:"destructive",size:"sm",class:"h-8 gap-1",onClick:i=>de(a.id)},{default:s(()=>[r(e(De),{class:"h-3.5 w-3.5"}),t[28]||(t[28]=n("span",{class:"hidden sm:inline"},"Revoke",-1))]),_:2},1032,["onClick"])):V("",!0)])]),_:2},1024)]),_:2},1024))),128)),l.invites.length?V("",!0):(d(),u(e(h),{key:0},{default:s(()=>[r(e(_),{colspan:"5",class:"h-24 text-center text-muted-foreground"},{default:s(()=>[...t[29]||(t[29]=[o(" No invites yet. ",-1)])]),_:1})]),_:1}))]),_:1})]),_:1})])]),_:1})]),_:1})]),n("div",lt,[r(e(N),{class:"border-border/50 shadow-sm"},{default:s(()=>[r(e(S),null,{default:s(()=>[n("div",nt,[n("div",null,[r(e(U),null,{default:s(()=>[...t[30]||(t[30]=[o("Recent Activity",-1)])]),_:1}),r(e(z),null,{default:s(()=>[...t[31]||(t[31]=[o("Latest actions performed across the platform.",-1)])]),_:1})]),r(e(p),{variant:"outline",size:"sm",class:"h-8 gap-1"},{default:s(()=>[r(e(Se),{class:"h-3.5 w-3.5"}),t[32]||(t[32]=n("span",{class:"sr-only sm:not-sr-only sm:whitespace-nowrap"},"Filter",-1))]),_:1})])]),_:1}),r(e(D),null,{default:s(()=>[n("div",ot,[r(e(se),null,{default:s(()=>[r(e(re),null,{default:s(()=>[(d(!0),y(w,null,C(e(B).getHeaderGroups(),a=>(d(),u(e(h),{key:a.id},{default:s(()=>[(d(!0),y(w,null,C(a.headers,i=>(d(),u(e($),{key:i.id},{default:s(()=>[i.isPlaceholder?V("",!0):(d(),u(e(le),{key:0,render:i.column.columnDef.header,props:i.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),r(e(ae),null,{default:s(()=>[e(B).getRowModel().rows?.length?(d(!0),y(w,{key:0},C(e(B).getRowModel().rows,a=>(d(),u(e(h),{key:a.id,"data-state":a.getIsSelected()?"selected":void 0},{default:s(()=>[(d(!0),y(w,null,C(a.getVisibleCells(),i=>(d(),u(e(_),{key:i.id},{default:s(()=>[r(e(le),{render:i.column.columnDef.cell,props:i.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(d(),u(e(h),{key:1},{default:s(()=>[r(e(_),{colspan:X.length,class:"h-24 text-center"},{default:s(()=>[...t[33]||(t[33]=[o(" No results. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1}))}});export{Nt as default};
