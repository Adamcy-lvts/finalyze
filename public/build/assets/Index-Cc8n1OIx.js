import{bu as T,dO as L,cn as V,co as p,cp as l,cq as s,bF as e,cr as n,dP as M,cs as o,dV as q,cl as $,dY as z,dn as G,dQ as H,ce as j,by as f,dR as B,ch as Q,ck as U,bt as J,bx as R,dA as W,bv as Y,cI as g,cN as X,ct as _,dH as Z,cD as y,dW as ee}from"./vendor-B5jlBrgV.js";import{_ as te}from"./AdminLayout.vue_vue_type_script_setup_true_lang-CPIybYU8.js";import{_ as se}from"./DataTable.vue_vue_type_script_setup_true_lang-BobueDQz.js";import{_ as re}from"./index-DCGYk7ZE.js";import{_ as I}from"./Switch.vue_vue_type_script_setup_true_lang-siBQm0EZ.js";import{_ as b}from"./index-D4mJyiz8.js";import{_ as le,a as ae,b as oe,c as N,d as ue,e as ne}from"./Sonner.vue_vue_type_script_setup_true_lang-sxjlERgN.js";import{_ as de,a as ie}from"./CardContent.vue_vue_type_script_setup_true_lang-CtTakpSW.js";import{_ as ce}from"./CardDescription.vue_vue_type_script_setup_true_lang-Xz6hS9KU.js";import{_ as me,a as pe}from"./CardTitle.vue_vue_type_script_setup_true_lang-XJ5or5ZK.js";import{_ as E}from"./Input.vue_vue_type_script_setup_true_lang-xMT9dCF9.js";import{_ as v}from"./Label.vue_vue_type_script_setup_true_lang-BlhK8lFl.js";import{_ as k}from"./Textarea.vue_vue_type_script_setup_true_lang-D-HGaF7N.js";import{_ as F}from"./Checkbox.vue_vue_type_script_setup_true_lang-jW0orlWc.js";import{_ as fe,a as _e}from"./index-DEDCgojD.js";import{_ as ge}from"./AlertTitle.vue_vue_type_script_setup_true_lang-BKv9M6Wg.js";import{_ as ye,a as ve}from"./DialogContent.vue_vue_type_script_setup_true_lang-DATQht2f.js";import{_ as xe}from"./DialogDescription.vue_vue_type_script_setup_true_lang-DsP71UmP.js";import{_ as be,a as he}from"./DialogTitle.vue_vue_type_script_setup_true_lang-Cb9j7AhV.js";import{_ as ke,a as $e,b as Se,c as we}from"./AccordionTrigger.vue_vue_type_script_setup_true_lang-BsveGrF7.js";import"./UserInfo.vue_vue_type_script_setup_true_lang-w4YHLOMg.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-C5iiu9qR.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-DBGQTHPc.js";const Ve=T({__name:"StructureActions",props:{structure:{}},setup(u){const c=u,h=L("onEditFacultyStructure"),S=()=>{confirm(`Delete ${c.structure.faculty_name}? This will also delete chapters/sections.`)&&j.delete($("admin.system.faculty-structures.destroy",{structure:c.structure.id}),{preserveScroll:!0})};return(O,i)=>(p(),V(e(ne),null,{default:l(()=>[s(e(le),{"as-child":""},{default:l(()=>[s(e(b),{variant:"ghost",class:"h-8 w-8 p-0"},{default:l(()=>[i[1]||(i[1]=n("span",{class:"sr-only"},"Open menu",-1)),s(e(M),{class:"h-4 w-4"})]),_:1})]),_:1}),s(e(ae),{align:"end"},{default:l(()=>[s(e(oe),null,{default:l(()=>[...i[2]||(i[2]=[o("Actions",-1)])]),_:1}),s(e(N),{"as-child":""},{default:l(()=>[s(e(q),{href:e($)("admin.system.faculty-structures.show",{structure:c.structure.id})},{default:l(()=>[s(e(z),{class:"mr-2 h-4 w-4"}),i[3]||(i[3]=o(" Manage Chapters ",-1))]),_:1},8,["href"])]),_:1}),s(e(N),{onClick:i[0]||(i[0]=x=>e(h)?.(c.structure))},{default:l(()=>[s(e(G),{class:"mr-2 h-4 w-4"}),i[4]||(i[4]=o(" Edit ",-1))]),_:1}),s(e(ue)),s(e(N),{onClick:S,class:"text-rose-600 focus:text-rose-600 focus:bg-rose-50"},{default:l(()=>[s(e(H),{class:"mr-2 h-4 w-4"}),i[5]||(i[5]=o(" Delete ",-1))]),_:1})]),_:1})]),_:1}))}}),Ce=(u,c)=>{j.put($("admin.system.faculty-structures.toggle-active",{structure:u.id}),{is_active:c},{preserveScroll:!0})},Ue=[{accessorKey:"faculty_name",header:({column:u})=>f(b,{variant:"ghost",class:"-ml-2 text-xs hover:bg-muted/50",onClick:()=>u.toggleSorting(u.getIsSorted()==="asc")},()=>["Faculty",f(B,{class:"ml-2 h-3 w-3"})]),cell:({row:u})=>{const c=u.original;return f("div",{class:"flex flex-col"},[f("span",{class:"font-medium"},c.faculty_name),f("span",{class:"text-xs text-muted-foreground"},c.faculty_slug)])}},{id:"levels",header:"Levels",cell:({row:u})=>{const c=(u.original.academic_levels??[]).slice(0,3);return c.length?f("div",{class:"flex flex-wrap gap-1"},c.map(h=>f(re,{variant:"outline",class:"capitalize"},()=>h))):f("span",{class:"text-xs text-muted-foreground"},"â€”")}},{accessorKey:"chapters_count",header:({column:u})=>f(b,{variant:"ghost",class:"-ml-2 text-xs hover:bg-muted/50",onClick:()=>u.toggleSorting(u.getIsSorted()==="asc")},()=>["Chapters",f(B,{class:"ml-2 h-3 w-3"})]),cell:({row:u})=>String(u.original.chapters_count??0)},{accessorKey:"sort_order",header:"Order",cell:({row:u})=>u.getValue("sort_order")},{accessorKey:"is_active",header:"Active",cell:({row:u})=>f(I,{checked:!!u.original.is_active,"onUpdate:checked":c=>Ce(u.original,c)})},{id:"actions",cell:({row:u})=>f(Ve,{structure:u.original})}],Ne={class:"grid gap-4 py-4"},Ee={class:"grid gap-4 md:grid-cols-2"},Fe={class:"space-y-1"},Oe={key:0,class:"text-xs text-rose-500"},Ae={class:"space-y-1"},De={key:0,class:"text-xs text-rose-500"},Be={class:"space-y-1"},Je={key:0,class:"text-xs text-rose-500"},Te={class:"grid gap-4 md:grid-cols-3"},je={class:"space-y-1"},Ie={key:0,class:"text-xs text-rose-500"},Pe={class:"flex items-center justify-between rounded-md border border-border/70 bg-muted/30 px-3 py-2 text-sm md:col-span-2"},Ke={class:"space-y-2"},Le={class:"flex flex-wrap gap-4"},Me={class:"flex items-center gap-2 text-sm"},qe={class:"flex items-center gap-2 text-sm"},ze={class:"flex items-center gap-2 text-sm"},Ge={key:0,class:"text-xs text-rose-500"},He={class:"space-y-1"},Qe={key:0,class:"text-xs text-rose-500"},Re={class:"space-y-1"},We={key:0,class:"text-xs text-rose-500"},Ye={class:"space-y-1"},Xe={key:0,class:"text-xs text-rose-500"},Ze={class:"space-y-1"},et={key:0,class:"text-xs text-rose-500"},tt={class:"flex justify-end gap-2"},Vt=T({__name:"Index",props:{structures:{}},setup(u){const c=u,h=Q(),S=U(()=>h.props.flash),O=U(()=>c.structures??[]),i=J(null),x=J(!1),m=R({undergraduate:!0,masters:!0,phd:!0}),A=()=>({faculty_name:"",faculty_slug:"",description:"",is_active:!0,sort_order:0,academic_levels:[],default_structure:"",chapter_templates:"",guidance_templates:"",terminology:""}),r=W({...A()}),C=U(()=>i.value!==null),D=()=>{i.value=null,r.clearErrors(),Object.assign(r,A()),m.undergraduate=!0,m.masters=!0,m.phd=!0},w=d=>{if(d==null)return"";if(typeof d=="string")return d;try{return JSON.stringify(d,null,2)}catch{return""}},P=()=>{D(),x.value=!0};Y("onEditFacultyStructure",d=>{i.value=d.id,r.clearErrors(),r.faculty_name=d.faculty_name??"",r.faculty_slug=d.faculty_slug??"",r.description=d.description??"",r.is_active=!!d.is_active,r.sort_order=Number(d.sort_order??0),r.default_structure=w(d.default_structure),r.chapter_templates=w(d.chapter_templates),r.guidance_templates=w(d.guidance_templates),r.terminology=w(d.terminology);const t=d.academic_levels??[];m.undergraduate=t.includes("undergraduate"),m.masters=t.includes("masters"),m.phd=t.includes("phd"),x.value=!0});const K=()=>{r.clearErrors(),r.transform(t=>({...t,sort_order:Number(t.sort_order??0),is_active:!!t.is_active,academic_levels:[...m.undergraduate?["undergraduate"]:[],...m.masters?["masters"]:[],...m.phd?["phd"]:[]]}));const d={preserveScroll:!0,onSuccess:()=>{x.value=!1,D()}};C.value&&i.value?r.put($("admin.system.faculty-structures.update",{structure:i.value}),d):r.post($("admin.system.faculty-structures.store"),d)};return(d,t)=>(p(),V(te,{title:"Faculty Structures",subtitle:"Control chapter titles, word counts, and sections per faculty."},{default:l(()=>[S.value?.success?(p(),V(e(fe),{key:0,class:"mb-6 border border-emerald-500/40 bg-emerald-500/10"},{default:l(()=>[s(e(X),{class:"h-4 w-4 text-emerald-500"}),s(e(ge),null,{default:l(()=>[...t[14]||(t[14]=[o("Updated",-1)])]),_:1}),s(e(_e),null,{default:l(()=>[o(_(S.value.success),1)]),_:1})]),_:1})):g("",!0),s(e(de),{class:"border border-border/50 bg-card shadow-sm"},{default:l(()=>[s(e(me),{class:"flex flex-row items-center justify-between pb-3"},{default:l(()=>[n("div",null,[s(e(pe),{class:"text-base font-semibold text-foreground"},{default:l(()=>[...t[15]||(t[15]=[o("Structures",-1)])]),_:1}),s(e(ce),null,{default:l(()=>[...t[16]||(t[16]=[o(" These drive `FacultyStructureService` and therefore the chapter structure used for generation. ",-1)])]),_:1})]),s(e(b),{size:"sm",onClick:P},{default:l(()=>[s(e(Z),{class:"mr-2 h-4 w-4"}),t[17]||(t[17]=o(" Add Structure ",-1))]),_:1})]),_:1}),s(e(ie),null,{default:l(()=>[s(se,{columns:e(Ue),data:O.value,"search-key":"faculty_name","search-placeholder":"Filter structures..."},null,8,["columns","data"])]),_:1})]),_:1}),s(e(ye),{open:x.value,"onUpdate:open":t[13]||(t[13]=a=>x.value=a)},{default:l(()=>[s(e(ve),{class:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto"},{default:l(()=>[s(e(be),null,{default:l(()=>[s(e(he),null,{default:l(()=>[o(_(C.value?"Edit structure":"Create structure"),1)]),_:1}),s(e(xe),null,{default:l(()=>[...t[18]||(t[18]=[o(" Create a faculty structure, then manage its chapters and sections. ",-1)])]),_:1})]),_:1}),n("div",Ne,[n("div",Ee,[n("div",Fe,[s(e(v),null,{default:l(()=>[...t[19]||(t[19]=[o("Faculty Name",-1)])]),_:1}),s(e(E),{modelValue:e(r).faculty_name,"onUpdate:modelValue":t[0]||(t[0]=a=>e(r).faculty_name=a),placeholder:"Social Sciences"},null,8,["modelValue"]),e(r).errors.faculty_name?(p(),y("p",Oe,_(e(r).errors.faculty_name),1)):g("",!0)]),n("div",Ae,[s(e(v),null,{default:l(()=>[...t[20]||(t[20]=[o("Faculty Slug",-1)])]),_:1}),s(e(E),{modelValue:e(r).faculty_slug,"onUpdate:modelValue":t[1]||(t[1]=a=>e(r).faculty_slug=a),placeholder:"social-sciences"},null,8,["modelValue"]),e(r).errors.faculty_slug?(p(),y("p",De,_(e(r).errors.faculty_slug),1)):g("",!0)])]),n("div",Be,[s(e(v),null,{default:l(()=>[...t[21]||(t[21]=[o("Description",-1)])]),_:1}),s(e(k),{modelValue:e(r).description,"onUpdate:modelValue":t[2]||(t[2]=a=>e(r).description=a),rows:"3",placeholder:"Optional description..."},null,8,["modelValue"]),e(r).errors.description?(p(),y("p",Je,_(e(r).errors.description),1)):g("",!0)]),n("div",Te,[n("div",je,[s(e(v),null,{default:l(()=>[...t[22]||(t[22]=[o("Sort Order",-1)])]),_:1}),s(e(E),{modelValue:e(r).sort_order,"onUpdate:modelValue":t[3]||(t[3]=a=>e(r).sort_order=a),type:"number",min:"0",max:"1000"},null,8,["modelValue"]),e(r).errors.sort_order?(p(),y("p",Ie,_(e(r).errors.sort_order),1)):g("",!0)]),n("label",Pe,[t[23]||(t[23]=n("span",{class:"text-foreground"},"Active",-1)),s(e(I),{checked:e(r).is_active,"onUpdate:checked":t[4]||(t[4]=a=>e(r).is_active=a)},null,8,["checked"])])]),n("div",Ke,[s(e(v),null,{default:l(()=>[...t[24]||(t[24]=[o("Academic Levels",-1)])]),_:1}),n("div",Le,[n("label",Me,[s(e(F),{checked:m.undergraduate,"onUpdate:checked":t[5]||(t[5]=a=>m.undergraduate=a)},null,8,["checked"]),t[25]||(t[25]=o(" Undergraduate ",-1))]),n("label",qe,[s(e(F),{checked:m.masters,"onUpdate:checked":t[6]||(t[6]=a=>m.masters=a)},null,8,["checked"]),t[26]||(t[26]=o(" Masters ",-1))]),n("label",ze,[s(e(F),{checked:m.phd,"onUpdate:checked":t[7]||(t[7]=a=>m.phd=a)},null,8,["checked"]),t[27]||(t[27]=o(" PhD ",-1))])]),e(r).errors.academic_levels?(p(),y("p",Ge,_(e(r).errors.academic_levels),1)):g("",!0)]),s(e(ke),{type:"multiple",class:"w-full"},{default:l(()=>[s(e($e),{value:"advanced"},{default:l(()=>[s(e(Se),null,{default:l(()=>[...t[28]||(t[28]=[o("Advanced JSON (optional)",-1)])]),_:1}),s(e(we),{class:"space-y-4"},{default:l(()=>[n("div",He,[s(e(v),null,{default:l(()=>[...t[29]||(t[29]=[o("Default Structure (JSON)",-1)])]),_:1}),s(e(k),{modelValue:e(r).default_structure,"onUpdate:modelValue":t[8]||(t[8]=a=>e(r).default_structure=a),rows:"6",class:"font-mono text-sm",placeholder:"{}"},null,8,["modelValue"]),e(r).errors.default_structure?(p(),y("p",Qe,_(e(r).errors.default_structure),1)):g("",!0)]),n("div",Re,[s(e(v),null,{default:l(()=>[...t[30]||(t[30]=[o("Chapter Templates (JSON)",-1)])]),_:1}),s(e(k),{modelValue:e(r).chapter_templates,"onUpdate:modelValue":t[9]||(t[9]=a=>e(r).chapter_templates=a),rows:"6",class:"font-mono text-sm",placeholder:"{}"},null,8,["modelValue"]),e(r).errors.chapter_templates?(p(),y("p",We,_(e(r).errors.chapter_templates),1)):g("",!0)]),n("div",Ye,[s(e(v),null,{default:l(()=>[...t[31]||(t[31]=[o("Guidance Templates (JSON)",-1)])]),_:1}),s(e(k),{modelValue:e(r).guidance_templates,"onUpdate:modelValue":t[10]||(t[10]=a=>e(r).guidance_templates=a),rows:"6",class:"font-mono text-sm",placeholder:"{}"},null,8,["modelValue"]),e(r).errors.guidance_templates?(p(),y("p",Xe,_(e(r).errors.guidance_templates),1)):g("",!0)]),n("div",Ze,[s(e(v),null,{default:l(()=>[...t[32]||(t[32]=[o("Terminology (JSON)",-1)])]),_:1}),s(e(k),{modelValue:e(r).terminology,"onUpdate:modelValue":t[11]||(t[11]=a=>e(r).terminology=a),rows:"6",class:"font-mono text-sm",placeholder:"{}"},null,8,["modelValue"]),e(r).errors.terminology?(p(),y("p",et,_(e(r).errors.terminology),1)):g("",!0)])]),_:1})]),_:1})]),_:1})]),n("div",tt,[s(e(b),{variant:"ghost",onClick:t[12]||(t[12]=a=>x.value=!1)},{default:l(()=>[...t[33]||(t[33]=[o("Cancel",-1)])]),_:1}),s(e(b),{disabled:e(r).processing,onClick:K},{default:l(()=>[e(r).processing?(p(),V(e(ee),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):g("",!0),n("span",null,_(C.value?"Update structure":"Add structure"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["open"])]),_:1}))}});export{Vt as default};
