import{bt as $e,bs as $,ck as ne,bA as Pe,cB as f,co as l,cS as R,cG as k,cn as w,cq as s,cr as t,bE as e,cN as te,cp as n,cs as p,ct as d,eK as Le,eE as de,cE as le,cu as O,df as H,cJ as he,eP as ve,du as W,d1 as ge,cL as se,dg as _e,fb as ye,dU as be,fc as ce,cY as ze,cb as J,cj as i,dL as oe,dM as ae,fd as we,db as Re,fe as ue,ff as re,dF as Ce,cl as K}from"./vendor-DTjPma1U.js";import{_ as I}from"./index-3KGx5n4o.js";import{_ as h}from"./index-mwxrBKxi.js";import{_ as Ee,a as Fe}from"./CardContent.vue_vue_type_script_setup_true_lang-I4CEGKdn.js";import{_ as Oe,a as Te}from"./CardTitle.vue_vue_type_script_setup_true_lang-CV0UXs4e.js";import{_ as Ie,a as Me,b as Ne}from"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-DUd-t3t3.js";import{_ as ke}from"./Input.vue_vue_type_script_setup_true_lang-DAeY8mMm.js";import{_ as fe}from"./ScrollArea.vue_vue_type_script_setup_true_lang-BYcw9oF-.js";import{_ as X}from"./Separator.vue_vue_type_script_setup_true_lang-BR3TqgAU.js";import{_ as He,a as Be,b as Ge,c as Ve,d as Xe,e as We,f as qe,g as Je}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-DLCPkSzL.js";import{_ as Ke}from"./Checkbox.vue_vue_type_script_setup_true_lang-Z5kjwJ2x.js";import{_ as Ze,a as Qe}from"./DialogContent.vue_vue_type_script_setup_true_lang-3pmUscSv.js";import{_ as Ye}from"./DialogDescription.vue_vue_type_script_setup_true_lang-krf9iH0t.js";import{_ as et}from"./DialogFooter.vue_vue_type_script_setup_true_lang-Djbi9e8D.js";import{_ as tt,a as st}from"./DialogTitle.vue_vue_type_script_setup_true_lang-DT1UgW8j.js";import{e as ot,_ as at,a as rt,b as pe,c as Z,d as je}from"./Sonner.vue_vue_type_script_setup_true_lang-D0ynKKgD.js";const nt={key:0,class:"sticky top-0 z-10 bg-background border-b border-border/60"},lt={class:"flex items-center justify-between p-4"},it={class:"flex items-center gap-3"},dt={key:1,class:"p-6 space-y-4"},ct={class:"space-y-2"},ut={class:"flex items-center gap-2"},pt={key:0,class:"space-y-2 pl-6"},ft={class:"flex gap-2"},mt={class:"text-xs text-muted-foreground"},xt={class:"space-y-2"},ht={class:"flex items-center gap-2"},vt={key:0,class:"pl-6"},gt={class:"flex gap-2"},_t={class:"space-y-4"},yt={class:"text-sm font-semibold text-foreground flex items-center gap-2"},bt={class:"font-medium"},wt={key:0,class:"space-y-3 mt-4"},Ct={class:"flex items-center justify-between"},kt={class:"text-sm font-medium text-amber-600 dark:text-amber-400 flex items-center gap-2"},jt={class:"flex gap-4 max-h-[500px]"},$t={class:"w-1/2 overflow-y-auto pr-2 custom-scrollbar space-y-2"},Et=["onClick"],Ft={class:"text-sm font-medium text-foreground leading-snug line-clamp-3"},Dt={class:"flex items-center gap-2 mt-2"},St={key:0,class:"text-xs text-muted-foreground"},Ut={class:"w-1/2 overflow-y-auto pl-2 custom-scrollbar"},At={key:0,class:"space-y-3"},Pt={class:"text-xs text-muted-foreground mb-2"},Lt={class:"text-sm font-medium text-foreground leading-snug"},zt={class:"text-xs text-muted-foreground"},Rt={class:"flex items-center gap-2"},Ot={key:0,class:"text-xs text-muted-foreground"},Tt={class:"flex gap-2 mt-2"},It={key:0,class:"text-sm text-muted-foreground text-center py-4"},Mt={key:1,class:"flex items-center justify-center h-full text-muted-foreground"},Nt={class:"text-center py-8"},Ht={key:1,class:"text-center py-6"},Bt={key:0,class:"space-y-3"},Gt={class:"flex items-center justify-between"},Vt={class:"text-sm font-semibold text-foreground flex items-center gap-2"},Xt={class:"space-y-2 max-h-[200px] overflow-y-auto pr-2 custom-scrollbar"},Wt=["onClick"],qt={class:"text-sm font-medium text-foreground truncate"},Jt={class:"text-xs text-muted-foreground"},Kt={class:"flex items-center gap-2"},Zt={class:"flex items-center gap-1"},Qt={class:"rounded-lg bg-gradient-to-r from-amber-50 to-indigo-50 dark:from-amber-950/20 dark:to-indigo-950/20 border border-amber-200/50 dark:border-amber-800/50 p-3"},Yt={class:"flex items-start gap-2"},es={class:"space-y-3"},ts={class:"space-y-2"},ss={class:"text-xs font-medium text-muted-foreground flex items-center gap-1"},os={class:"flex gap-1"},as={class:"rounded-lg bg-muted/30 p-2"},rs={class:"text-xs font-medium text-foreground mb-1"},ns={class:"text-xs text-muted-foreground mb-2"},ls={class:"text-xs text-muted-foreground font-mono bg-background p-2 rounded border"},is={class:"space-y-3"},ds={class:"text-xs font-medium text-muted-foreground flex items-center gap-1"},cs={class:"flex gap-2"},us={class:"space-y-3"},ps={class:"flex items-center justify-between"},fs={class:"text-xs font-medium text-muted-foreground flex items-center gap-1"},ms={class:"text-xs font-medium"},xs={key:0,class:"space-y-2 mt-3"},hs={class:"flex items-center justify-between"},vs={class:"text-xs font-medium text-amber-600 dark:text-amber-400 flex items-center gap-1"},gs={class:"space-y-2 pr-2"},_s=["onClick"],ys={class:"flex items-start gap-2"},bs={class:"flex-1 min-w-0"},ws={class:"text-xs font-medium text-foreground line-clamp-2"},Cs={class:"text-[10px] text-muted-foreground mt-1"},ks={class:"flex items-center gap-2 mt-1"},js={class:"text-[10px] text-muted-foreground"},$s={key:0,class:"border-t bg-muted/10 p-3 space-y-2"},Es={class:"text-xs font-medium text-foreground line-clamp-2"},Fs={class:"text-[10px] text-muted-foreground"},Ds={class:"flex items-center gap-2 mt-1"},Ss={key:0,class:"text-[9px] text-muted-foreground"},Us={class:"flex gap-1 mt-2"},As={key:1,class:"border-t bg-muted/10 p-3"},Ps={class:"text-xs text-muted-foreground text-center py-2"},Ls={class:"font-medium"},zs={key:1,class:"text-center py-4"},Rs={key:0,class:"space-y-3"},Os={class:"flex items-center justify-between"},Ts={class:"text-xs font-medium text-muted-foreground flex items-center gap-1"},Is={class:"space-y-2 pr-2"},Ms=["onClick"],Ns={class:"flex items-start justify-between gap-2"},Hs={class:"flex-1 min-w-0"},Bs={class:"text-xs font-medium text-foreground truncate"},Gs={class:"text-xs text-muted-foreground mt-1"},Vs={class:"flex items-center gap-2 mt-1"},Xs={class:"text-xs text-muted-foreground"},Ws={class:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity"},qs={key:0,class:"mt-3 pt-3 border-t"},Js={class:"bg-muted/30 rounded p-2"},Ks={class:"text-xs font-medium text-foreground mb-1"},Zs={class:"text-xs text-muted-foreground font-mono leading-relaxed"},Qs={class:"flex gap-2 mt-3"},Ys={key:1,class:"py-8 text-center"},Do=$e({__name:"CitationHelper",props:{showCitationHelper:{type:Boolean},chapterContent:{},chapterId:{},citationOperationMode:{type:Boolean,default:!1}},emits:["update:showCitationHelper","insert-citation","enter-operation-mode","exit-operation-mode"],setup(q,{emit:_}){const v=q,m=_,j=$("apa"),U=$(""),z=$(!1),M=$(!1),B=$(!1),D=$([]),V=$(null),P=$(!1),Q=$(!1),b=$([]),T=$(!1),F=$(null),x=$(null),r=$(!0),u=$(!0),C=async()=>{if(v.chapterId){Q.value=!0;try{const c=await J.get("/api/citations/detected-claims",{params:{chapter_id:v.chapterId}});c.data.success&&c.data.has_detection&&(b.value=c.data.claims||[],x.value=c.data.detected_at,T.value=b.value.length>0)}catch(c){console.error("Failed to load saved detections:",c)}finally{Q.value=!1}}},g=async()=>{if(!v.chapterContent||v.chapterContent.trim().length<100){i.error("Please add more content before detecting citations (minimum 100 characters)");return}if(!v.chapterId){i.error("Chapter ID is required for detection");return}P.value=!0,b.value=[],T.value=!0;try{const c=await J.post("/api/citations/detect-claims",{content:v.chapterContent,chapter_id:v.chapterId});c.data.success?(b.value=c.data.claims||[],x.value=c.data.detected_at,b.value.length===0?i.info("No claims requiring citations were detected"):i.success(`Found ${b.value.length} claims that may need citations`)):i.error("Failed to detect claims")}catch(c){console.error("Failed to detect claims:",c),i.error("Failed to analyze content for citations")}finally{P.value=!1}},E=c=>{F.value=F.value===c?null:c},S=(c,o)=>{const a=c.style[j.value];m("insert-citation",a,o),i.success("Citation inserted into document")},A=c=>{const o=c.style[j.value];navigator.clipboard.writeText(o),i.success("Citation copied to clipboard")},L=c=>{c&&window.open(c,"_blank")},N={apa:{name:"APA Style",description:"American Psychological Association",example:"Smith, J. (2023). Research methods. Journal of Science, 15(3), 123-145."},harvard:{name:"Harvard Style",description:"Author-date referencing system",example:'Smith, J. (2023) "Research methods", Journal of Science, 15(3), pp. 123-145.'},ieee:{name:"IEEE Style",description:"Institute of Electrical and Electronics Engineers",example:'J. Smith, "Research methods," Journal of Science, vol. 15, no. 3, pp. 123-145, 2023.'}},G=ne(()=>N[j.value]),De=c=>{m("update:showCitationHelper",c)},Se=c=>{V.value=V.value===c?null:c},Y=async()=>{if(!U.value.trim()){i.error("Please enter a URL, DOI, or search term");return}z.value=!0;try{const c=await J.post("/api/citations/generate",{input:U.value.trim()});if(c.data.success){const o=c.data.citation,a={id:o.id.toString(),title:o.title,authors:o.authors,year:o.year,journal:o.journal,url:o.url,doi:o.doi,type:o.type,style:{apa:o.style.apa,harvard:o.style.harvard,ieee:o.style.ieee},createdAt:new Date(o.created_at)};D.value.unshift(a),U.value="",i.success("Citation generated successfully!")}else i.error("Failed to generate citation")}catch(c){console.error("Failed to search citation:",c),c.response?.status===422?i.error("Invalid input format"):i.error("Failed to generate citation")}finally{z.value=!1}},ie=c=>{const o=c.style[j.value];m("insert-citation",o),i.success("Citation inserted into document")},me=c=>{const o=c.style[j.value];navigator.clipboard.writeText(o),i.success("Citation copied to clipboard")},xe=()=>{if(!D.value.length){i.error("No citations to clear");return}B.value=!0},Ue=async()=>{M.value=!0,B.value=!1;try{(await J.delete("/api/citations/clear")).data.success?(D.value=[],V.value=null,i.success("All citations cleared successfully")):i.error("Failed to clear citations")}catch(c){console.error("Failed to clear citations:",c),i.error("Failed to clear citations")}finally{M.value=!1}},Ae=async()=>{try{const c=await J.get("/api/citations/recent",{params:{limit:10}});c.data.success&&(D.value=c.data.citations.map(o=>({id:o.id.toString(),title:o.title,authors:o.authors,year:o.year,journal:o.journal,url:o.url,doi:o.doi,type:o.type,style:{apa:o.style.apa,harvard:o.style.harvard,ieee:o.style.ieee},createdAt:new Date(o.created_at)})))}catch(c){console.error("Failed to load recent citations:",c)}};return Pe(()=>{Ae(),C()}),(c,o)=>(l(),f(R,null,[c.citationOperationMode?(l(),f("div",nt,[t("div",lt,[t("div",it,[s(e(te),{class:"h-5 w-5 text-primary"}),o[10]||(o[10]=t("h2",{class:"text-lg font-semibold text-foreground"},"Citation Helper",-1)),s(e(I),{variant:"secondary",class:"ml-1"},{default:n(()=>[p(d(j.value.toUpperCase()),1)]),_:1})]),s(e(h),{onClick:o[0]||(o[0]=a=>m("exit-operation-mode")),variant:"ghost",size:"sm",class:"gap-2 text-muted-foreground hover:text-foreground"},{default:n(()=>[s(e(Le),{class:"h-4 w-4"}),o[11]||(o[11]=p(" Close ",-1))]),_:1})])])):k("",!0),c.citationOperationMode?(l(),f("div",dt,[t("div",ct,[t("button",{onClick:o[1]||(o[1]=a=>r.value=!r.value),class:"w-full flex items-center justify-between text-sm font-semibold text-foreground hover:text-primary transition-colors"},[t("span",ut,[s(e(de),{class:"h-4 w-4"}),o[12]||(o[12]=p(" Citation Style ",-1)),s(e(I),{variant:"outline",class:"text-xs"},{default:n(()=>[p(d(j.value.toUpperCase()),1)]),_:1})]),s(e(le),{class:O(["h-4 w-4 transition-transform",r.value?"rotate-180":""])},null,8,["class"])]),r.value?(l(),f("div",pt,[t("div",ft,[(l(!0),f(R,null,H(Object.keys(N),a=>(l(),w(e(h),{key:a,onClick:y=>j.value=a,variant:j.value===a?"default":"outline",size:"sm",class:"flex-1"},{default:n(()=>[p(d(a.toUpperCase()),1)]),_:2},1032,["onClick","variant"]))),128))]),t("p",mt,d(G.value.description),1)])):k("",!0)]),s(e(X)),t("div",xt,[t("button",{onClick:o[2]||(o[2]=a=>u.value=!u.value),class:"w-full flex items-center justify-between text-sm font-semibold text-foreground hover:text-primary transition-colors"},[t("span",ht,[s(e(he),{class:"h-4 w-4"}),o[13]||(o[13]=p(" Generate Citation ",-1))]),s(e(le),{class:O(["h-4 w-4 transition-transform",u.value?"rotate-180":""])},null,8,["class"])]),u.value?(l(),f("div",vt,[t("div",gt,[s(e(ke),{modelValue:U.value,"onUpdate:modelValue":o[3]||(o[3]=a=>U.value=a),placeholder:"URL, DOI, or search...",class:"flex-1",onKeyup:ve(Y,["enter"]),disabled:z.value},null,8,["modelValue","disabled"]),s(e(h),{onClick:Y,disabled:z.value||!U.value.trim(),size:"sm"},{default:n(()=>[z.value?(l(),w(e(W),{key:0,class:"h-4 w-4 animate-spin"})):(l(),w(e(ge),{key:1,class:"h-4 w-4"}))]),_:1},8,["disabled"])])])):k("",!0)]),s(e(X)),t("div",_t,[t("h3",yt,[s(e(se),{class:"h-4 w-4 text-purple-500"}),o[14]||(o[14]=p(" Auto-Detect Citations ",-1))]),s(e(h),{onClick:g,disabled:P.value,class:"w-full gap-2 h-12 text-base bg-gradient-to-r from-purple-500 to-indigo-500 hover:from-purple-600 hover:to-indigo-600 text-white"},{default:n(()=>[P.value?(l(),w(e(W),{key:0,class:"h-5 w-5 animate-spin"})):(l(),w(e(se),{key:1,class:"h-5 w-5"})),t("span",bt,d(P.value?"Scanning content for claims...":"Scan for Missing Citations"),1)]),_:1},8,["disabled"]),o[20]||(o[20]=t("p",{class:"text-sm text-muted-foreground"}," ðŸ” AI analyzes your chapter content to find claims that need academic references, then searches multiple databases for relevant papers. ",-1)),T.value&&b.value.length>0?(l(),f("div",wt,[t("div",Ct,[t("span",kt,[s(e(_e),{class:"h-4 w-4"}),p(" "+d(b.value.length)+" claims need citations ",1)]),s(e(h),{variant:"outline",size:"sm",onClick:o[4]||(o[4]=a=>{T.value=!1,b.value=[]})},{default:n(()=>[...o[15]||(o[15]=[p(" Clear Results ",-1)])]),_:1})]),t("div",jt,[t("div",$t,[(l(!0),f(R,null,H(b.value,a=>(l(),f("div",{key:a.id,onClick:y=>F.value=F.value===a.id?null:a.id,class:O(["rounded-lg border p-3 cursor-pointer transition-all",F.value===a.id?"bg-primary/10 border-primary":"bg-card hover:bg-muted/50 border-border"])},[t("p",Ft,' "'+d(a.text)+'" ',1),t("div",Dt,[s(e(I),{variant:"outline",class:O([a.confidence>.8?"border-red-300 text-red-600":a.confidence>.6?"border-amber-300 text-amber-600":"border-gray-300 text-gray-600","text-xs"])},{default:n(()=>[p(d(Math.round(a.confidence*100))+"% ",1)]),_:2},1032,["class"]),a.suggestions?.length?(l(),f("span",St,d(a.suggestions.length)+" suggestions ",1)):k("",!0)])],10,Et))),128))]),t("div",Ut,[F.value&&b.value.find(a=>a.id===F.value)?(l(),f("div",At,[t("div",Pt,d(b.value.find(a=>a.id===F.value)?.reason),1),o[17]||(o[17]=t("p",{class:"text-xs font-medium text-foreground"},"Suggested Citations:",-1)),(l(!0),f(R,null,H(b.value.find(a=>a.id===F.value)?.suggestions,a=>(l(),f("div",{key:a.id,class:"rounded-lg border bg-card p-3 space-y-2"},[t("p",Lt,d(a.title),1),t("p",zt,d(a.authors?.join(", "))+" ("+d(a.year)+") ",1),t("div",Rt,[s(e(I),{variant:"secondary",class:"text-xs"},{default:n(()=>[p(d(a.source),1)]),_:2},1024),a.citation_count?(l(),f("span",Ot,d(a.citation_count)+" citations ",1)):k("",!0)]),t("div",Tt,[s(e(h),{onClick:y=>S(a,b.value.find(ee=>ee.id===F.value)?.text),size:"sm",class:"flex-1"},{default:n(()=>[s(e(oe),{class:"h-4 w-4 mr-1"}),o[16]||(o[16]=p(" Insert ",-1))]),_:2},1032,["onClick"]),s(e(h),{onClick:y=>A(a),size:"sm",variant:"outline"},{default:n(()=>[s(e(ae),{class:"h-4 w-4"})]),_:2},1032,["onClick"]),a.url?(l(),w(e(h),{key:0,onClick:y=>L(a.url),size:"sm",variant:"outline"},{default:n(()=>[s(e(we),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):k("",!0)])]))),128)),b.value.find(a=>a.id===F.value)?.suggestions?.length?k("",!0):(l(),f("div",It," No matching papers found. Try manual search. "))])):(l(),f("div",Mt,[t("div",Nt,[s(e(te),{class:"h-8 w-8 mx-auto mb-2 opacity-30"}),o[18]||(o[18]=t("p",{class:"text-sm"},"Select a claim to view suggestions",-1))])]))])])])):T.value&&b.value.length===0&&!P.value?(l(),f("div",Ht,[...o[19]||(o[19]=[t("p",{class:"text-sm text-green-600 dark:text-green-400"}," âœ… No claims requiring citations were detected in your content! ",-1)])])):k("",!0)]),s(e(X)),D.value.length?(l(),f("div",Bt,[t("div",Gt,[t("h3",Vt,[s(e(ye),{class:"h-4 w-4"}),p(" Recent Citations ("+d(D.value.length)+") ",1)]),s(e(h),{onClick:xe,disabled:M.value,variant:"ghost",size:"sm"},{default:n(()=>[M.value?(l(),w(e(W),{key:0,class:"h-4 w-4 animate-spin"})):(l(),w(e(be),{key:1,class:"h-4 w-4 mr-1"})),o[21]||(o[21]=p(" Clear All ",-1))]),_:1},8,["disabled"])]),t("div",Xt,[(l(!0),f(R,null,H(D.value,a=>(l(),f("div",{key:a.id,class:"rounded border bg-muted/30 p-3 cursor-pointer hover:bg-muted/50 transition-colors",onClick:y=>ie(a)},[t("p",qt,d(a.title),1),t("p",Jt,d(a.authors.join(", "))+" ("+d(a.year)+") ",1)],8,Wt))),128))])])):k("",!0)])):k("",!0),c.citationOperationMode?k("",!0):(l(),w(e(Ee),{key:2,class:"border border-border/60 shadow-sm dark:border-border/50 dark:shadow-none transition-all duration-300 hover:shadow-md"},{default:n(()=>[s(e(Ie),{open:c.showCitationHelper,"onUpdate:open":De},{default:n(()=>[s(e(Me),{class:"w-full"},{default:n(()=>[s(e(Oe),{class:"pb-3 transition-colors bg-muted/40 hover:bg-muted/60 dark:bg-transparent dark:hover:bg-muted/30"},{default:n(()=>[s(e(Te),{class:"flex items-center justify-between text-sm"},{default:n(()=>[t("span",Kt,[s(e(te),{class:"h-4 w-4 text-muted-foreground"}),o[22]||(o[22]=p(" Citation Helper ",-1)),s(e(I),{variant:"secondary",class:"ml-1 text-xs"},{default:n(()=>[p(d(j.value.toUpperCase()),1)]),_:1})]),t("div",Zt,[c.showCitationHelper?(l(),w(e(h),{key:0,onClick:o[5]||(o[5]=ce(a=>m("enter-operation-mode"),["stop"])),variant:"ghost",size:"icon",class:"h-6 w-6 text-muted-foreground hover:text-primary",title:"Expand to Split View"},{default:n(()=>[s(e(ze),{class:"h-3 w-3"})]),_:1})):k("",!0),s(e(le),{class:O(["h-4 w-4 text-muted-foreground transition-transform",c.showCitationHelper?"rotate-180":""])},null,8,["class"])])]),_:1})]),_:1})]),_:1}),s(e(Ne),null,{default:n(()=>[s(e(Fe),{class:"space-y-4 pt-0"},{default:n(()=>[t("div",Qt,[t("div",Yt,[s(e(de),{class:"h-4 w-4 text-amber-600 dark:text-amber-400 mt-0.5 flex-shrink-0"}),o[23]||(o[23]=t("div",{class:"text-xs leading-relaxed"},[t("p",{class:"font-medium text-amber-900 dark:text-amber-100 mb-1"},"Smart Citation Assistant "),t("p",{class:"text-amber-700 dark:text-amber-300"},"Automatically formats citations in your preferred academic style."),t("p",{class:"mt-1 text-amber-600 dark:text-amber-400"},"ðŸ’¡ Click citations to insert them directly into your document.")],-1))])]),t("div",es,[t("div",ts,[t("h4",ss,[s(e(de),{class:"h-3 w-3"}),o[24]||(o[24]=p(" Citation Style ",-1))]),t("div",os,[(l(!0),f(R,null,H(Object.keys(N),a=>(l(),w(e(h),{key:a,onClick:y=>j.value=a,variant:j.value===a?"default":"outline",size:"sm",class:"text-xs flex-1"},{default:n(()=>[p(d(a.toUpperCase()),1)]),_:2},1032,["onClick","variant"]))),128))])]),t("div",as,[t("p",rs,d(G.value.name),1),t("p",ns,d(G.value.description),1),t("p",ls,d(G.value.example),1)])]),s(e(X)),t("div",is,[t("h4",ds,[s(e(he),{class:"h-3 w-3"}),o[25]||(o[25]=p(" Generate Citation ",-1))]),t("div",cs,[s(e(ke),{modelValue:U.value,"onUpdate:modelValue":o[6]||(o[6]=a=>U.value=a),placeholder:"Enter URL, DOI, or search term...",class:"text-xs",onKeyup:ve(Y,["enter"]),disabled:z.value},null,8,["modelValue","disabled"]),s(e(h),{onClick:Y,size:"sm",disabled:z.value||!U.value.trim()},{default:n(()=>[z.value?(l(),w(e(W),{key:0,class:"h-3 w-3 animate-spin"})):(l(),w(e(ge),{key:1,class:"h-3 w-3"}))]),_:1},8,["disabled"])]),o[26]||(o[26]=t("p",{class:"text-xs text-muted-foreground"}," ðŸ’¡ Paste a journal URL, DOI, or search for papers by keywords ",-1))]),s(e(X)),t("div",us,[t("div",ps,[t("h4",fs,[s(e(se),{class:"h-3 w-3"}),o[27]||(o[27]=p(" Auto-Detect Citations ",-1))])]),s(e(h),{onClick:g,disabled:P.value,variant:"outline",class:"w-full gap-2 bg-gradient-to-r from-purple-500/10 to-indigo-500/10 border-purple-200/50 dark:border-purple-800/50 hover:from-purple-500/20 hover:to-indigo-500/20"},{default:n(()=>[P.value?(l(),w(e(W),{key:0,class:"h-4 w-4 animate-spin"})):(l(),w(e(se),{key:1,class:"h-4 w-4 text-purple-500"})),t("span",ms,d(P.value?"Scanning content...":"Scan for Missing Citations"),1)]),_:1},8,["disabled"]),o[33]||(o[33]=t("p",{class:"text-xs text-muted-foreground"}," ðŸ” AI analyzes your content to find claims that need academic references ",-1)),T.value&&b.value.length>0?(l(),f("div",xs,[t("div",hs,[t("span",vs,[s(e(_e),{class:"h-3 w-3"}),p(" "+d(b.value.length)+" claims need citations ",1)]),s(e(h),{variant:"ghost",size:"sm",class:"h-6 text-xs",onClick:o[7]||(o[7]=a=>{T.value=!1,b.value=[]})},{default:n(()=>[...o[28]||(o[28]=[p(" Clear ",-1)])]),_:1})]),s(e(fe),{class:"h-[280px]"},{default:n(()=>[t("div",gs,[(l(!0),f(R,null,H(b.value,a=>(l(),f("div",{key:a.id,class:"rounded-lg border bg-background overflow-hidden"},[t("div",{onClick:y=>E(a.id),class:O(["cursor-pointer p-3 hover:bg-muted/30 transition-colors",F.value===a.id?"bg-muted/20":""])},[t("div",ys,[s(e(Re),{class:O(["h-4 w-4 mt-0.5 text-muted-foreground transition-transform flex-shrink-0",F.value===a.id?"rotate-90":""])},null,8,["class"]),t("div",bs,[t("p",ws,' "'+d(a.text)+'" ',1),t("p",Cs,d(a.reason),1),t("div",ks,[s(e(I),{variant:"outline",class:O(["text-[10px] h-4",a.confidence>.8?"border-red-300 text-red-600":a.confidence>.6?"border-amber-300 text-amber-600":"border-gray-300 text-gray-600"])},{default:n(()=>[p(d(Math.round(a.confidence*100))+"% confidence ",1)]),_:2},1032,["class"]),t("span",js,d(a.suggestions?.length||0)+" suggestions ",1)])])])],10,_s),F.value===a.id&&a.suggestions?.length>0?(l(),f("div",$s,[o[30]||(o[30]=t("p",{class:"text-[10px] font-medium text-muted-foreground mb-2"}," Suggested Citations: ",-1)),(l(!0),f(R,null,H(a.suggestions,y=>(l(),f("div",{key:y.id,class:"rounded border bg-background p-2 space-y-1"},[t("p",Es,d(y.title),1),t("p",Fs,d(y.authors?.join(", "))+" ("+d(y.year)+") ",1),t("div",Ds,[s(e(I),{variant:"secondary",class:"text-[9px] h-4"},{default:n(()=>[p(d(y.source),1)]),_:2},1024),y.citation_count?(l(),f("span",Ss,d(y.citation_count)+" citations ",1)):k("",!0)]),t("div",Us,[s(e(h),{onClick:ee=>S(y,a.text),size:"sm",class:"flex-1 h-7 text-xs"},{default:n(()=>[s(e(oe),{class:"h-3 w-3 mr-1"}),o[29]||(o[29]=p(" Insert ",-1))]),_:2},1032,["onClick"]),s(e(h),{onClick:ee=>A(y),size:"sm",variant:"outline",class:"h-7 text-xs"},{default:n(()=>[s(e(ae),{class:"h-3 w-3"})]),_:2},1032,["onClick"]),y.url?(l(),w(e(h),{key:0,onClick:ee=>L(y.url),size:"sm",variant:"outline",class:"h-7 text-xs"},{default:n(()=>[s(e(we),{class:"h-3 w-3"})]),_:2},1032,["onClick"])):k("",!0)])]))),128))])):k("",!0),F.value===a.id&&(!a.suggestions||a.suggestions.length===0)?(l(),f("div",As,[t("p",Ps,[o[31]||(o[31]=p(" No suggestions found. Try searching manually with keywords: ",-1)),t("span",Ls,d(a.search_keywords?.join(", ")),1)])])):k("",!0)]))),128))])]),_:1})])):T.value&&b.value.length===0&&!P.value?(l(),f("div",zs,[...o[32]||(o[32]=[t("p",{class:"text-xs text-green-600 dark:text-green-400"}," âœ… No claims requiring citations were detected! ",-1)])])):k("",!0)]),D.value.length?(l(),f("div",Rs,[s(e(X)),t("div",Os,[t("h4",Ts,[s(e(ye),{class:"h-3 w-3"}),p(" Recent Citations ("+d(D.value.length)+") ",1)]),s(e(h),{onClick:xe,disabled:M.value,variant:"ghost",size:"icon",class:"h-6 w-6 hover:bg-destructive/10 hover:text-destructive"},{default:n(()=>[M.value?(l(),w(e(W),{key:0,class:"h-3 w-3 animate-spin"})):(l(),w(e(be),{key:1,class:"h-3 w-3"}))]),_:1},8,["disabled"])]),s(e(fe),{class:"h-[300px]"},{default:n(()=>[t("div",Is,[(l(!0),f(R,null,H(D.value,a=>(l(),f("div",{key:a.id,class:"group"},[t("div",{onClick:y=>Se(a.id),class:O(["cursor-pointer rounded-lg border bg-background p-3 hover:bg-muted/30 transition-colors",V.value===a.id?"ring-2 ring-primary":""])},[t("div",Ns,[t("div",Hs,[t("p",Bs,d(a.title),1),t("p",Gs,d(a.authors.join(", "))+" ("+d(a.year)+") ",1),t("div",Vs,[s(e(I),{variant:"outline",class:"text-xs"},{default:n(()=>[p(d(a.type),1)]),_:2},1024),t("span",Xs,d(a.createdAt.toLocaleDateString()),1)])]),t("div",Ws,[s(e(h),{onClick:ce(y=>ie(a),["stop"]),variant:"ghost",size:"icon",class:"h-6 w-6"},{default:n(()=>[s(e(oe),{class:"h-3 w-3"})]),_:2},1032,["onClick"]),s(e(h),{onClick:ce(y=>me(a),["stop"]),variant:"ghost",size:"icon",class:"h-6 w-6"},{default:n(()=>[s(e(ae),{class:"h-3 w-3"})]),_:2},1032,["onClick"])])]),V.value===a.id?(l(),f("div",qs,[t("div",Js,[t("p",Ks,d(j.value.toUpperCase())+" Format: ",1),t("p",Zs,d(a.style[j.value]),1)]),t("div",Qs,[s(e(h),{onClick:y=>ie(a),size:"sm",class:"flex-1 text-xs"},{default:n(()=>[s(e(oe),{class:"mr-1 h-3 w-3"}),o[34]||(o[34]=p(" Insert ",-1))]),_:2},1032,["onClick"]),s(e(h),{onClick:y=>me(a),size:"sm",variant:"outline",class:"flex-1 text-xs"},{default:n(()=>[s(e(ae),{class:"mr-1 h-3 w-3"}),o[35]||(o[35]=p(" Copy ",-1))]),_:2},1032,["onClick"])])])):k("",!0)],10,Ms)]))),128))])]),_:1})])):(l(),f("div",Ys,[s(e(te),{class:"mx-auto h-12 w-12 text-muted-foreground/30 mb-3"}),o[36]||(o[36]=t("p",{class:"text-xs text-muted-foreground mb-1"}," No citations yet ",-1)),o[37]||(o[37]=t("p",{class:"text-xs text-muted-foreground/80"}," Generate your first citation using the search above ",-1))]))]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})),s(e(He),{open:B.value,"onUpdate:open":o[9]||(o[9]=a=>B.value=a)},{default:n(()=>[s(e(Be),null,{default:n(()=>[s(e(Ge),null,{default:n(()=>[s(e(Ve),null,{default:n(()=>[...o[38]||(o[38]=[p("Clear All Citations",-1)])]),_:1}),s(e(Xe),null,{default:n(()=>[p(" Are you sure you want to clear all "+d(D.value.length)+" citations? This action cannot be undone and will permanently remove all citations from your library. ",1)]),_:1})]),_:1}),s(e(We),null,{default:n(()=>[s(e(qe),{onClick:o[8]||(o[8]=a=>B.value=!1)},{default:n(()=>[...o[39]||(o[39]=[p("Cancel",-1)])]),_:1}),s(e(Je),{onClick:Ue,class:"bg-destructive text-destructive-foreground hover:bg-destructive/90"},{default:n(()=>[...o[40]||(o[40]=[p(" Clear All Citations ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])],64))}}),eo={class:"inline-flex"},to={class:"space-y-4"},so={class:"flex items-center justify-between"},oo={class:"flex items-center gap-2 text-sm text-muted-foreground"},ao={class:"flex items-center gap-2"},ro={class:"space-y-2"},no={class:"flex items-start gap-3"},lo={class:"flex-1 min-w-0"},io={class:"flex items-center gap-2 mb-1"},co={class:"font-medium truncate"},uo={class:"flex items-center gap-4 text-sm text-muted-foreground"},po={key:0},So=$e({__name:"ExportMenu",props:{project:{},currentChapter:{},allChapters:{},triggerElement:{default:"button"},size:{default:"default"},variant:{default:"outline"},buttonClass:{default:""}},setup(q){const _=q,v=$(!1),m=$([]),j=ne(()=>_.allChapters.filter(x=>x.content&&x.content.trim().length>0)),U=ne(()=>m.value.length),z=ne(()=>_.allChapters.filter(x=>m.value.includes(x.chapter_number)).reduce((x,r)=>x+r.word_count,0)),M=async()=>{i.loading("Exporting chapter...",{id:"export-chapter"});const x=K("export.chapter.word",{project:_.project.slug,chapterNumber:_.currentChapter.chapter_number});try{const r=await fetch(x,{method:"GET",headers:{Accept:"application/json"}});if(r.ok){const u=r.headers.get("content-type");if(u&&u.includes("application/json")){const L=await r.json();i.error("Export Failed",{id:"export-chapter",description:L.message||"An error occurred during export."});return}if(u&&u.includes("text/html")){const L=await r.text();i.error("Export Failed",{id:"export-chapter",description:`Server returned HTML instead of DOCX. ${L.slice(0,80)}`});return}const C=await r.blob(),g=new Uint8Array(await C.slice(0,2).arrayBuffer());if(!(g.length===2&&g[0]===80&&g[1]===75)){i.error("Export Failed",{id:"export-chapter",description:"Downloaded file is not a valid DOCX (missing PK zip header)."});return}const S=window.URL.createObjectURL(C),A=document.createElement("a");A.href=S,A.download=`${_.project.slug}-chapter-${_.currentChapter.chapter_number}.docx`,document.body.appendChild(A),A.click(),document.body.removeChild(A),window.URL.revokeObjectURL(S),i.success("Chapter exported successfully!",{id:"export-chapter",description:`${_.currentChapter.title} has been downloaded.`})}else try{const u=await r.json();i.error("Export Failed",{id:"export-chapter",description:u.message||"An error occurred during export."})}catch{i.error("Export Failed",{id:"export-chapter",description:"Unable to export chapter. Please try again."})}}catch{i.error("Export Failed",{id:"export-chapter",description:"Network error occurred. Please check your connection and try again."})}},B=async()=>{i.loading("Exporting full project...",{id:"export-project"});const x=K("export.project.word",{project:_.project.slug});try{const r=await fetch(x,{method:"GET",headers:{Accept:"application/json"}});if(r.ok){const u=r.headers.get("content-type");if(u&&u.includes("application/json")){const L=await r.json();i.error("Export Failed",{id:"export-project",description:L.message||"An error occurred during export."});return}if(u&&u.includes("text/html")){const L=await r.text();i.error("Export Failed",{id:"export-project",description:`Server returned HTML instead of DOCX. ${L.slice(0,80)}`});return}const C=await r.blob(),g=new Uint8Array(await C.slice(0,2).arrayBuffer());if(!(g.length===2&&g[0]===80&&g[1]===75)){i.error("Export Failed",{id:"export-project",description:"Downloaded file is not a valid DOCX (missing PK zip header)."});return}const S=window.URL.createObjectURL(C),A=document.createElement("a");A.href=S,A.download=`${_.project.slug}.docx`,document.body.appendChild(A),A.click(),document.body.removeChild(A),window.URL.revokeObjectURL(S),i.success("Project exported successfully!",{id:"export-project",description:`${_.project.title} has been downloaded.`})}else try{const u=await r.json();i.error("Export Failed",{id:"export-project",description:u.message||"An error occurred during export."})}catch{i.error("Export Failed",{id:"export-project",description:"Unable to export project. Please try again."})}}catch{i.error("Export Failed",{id:"export-project",description:"Network error occurred. Please check your connection and try again."})}},D=async()=>{i.loading("Generating project PDF...",{id:"export-project-pdf"});const x=K("export.project.pdf",{project:_.project.slug});try{const r=await fetch(x,{method:"GET",headers:{Accept:"application/pdf"}});if(r.ok){const u=r.headers.get("content-type");if(u&&u.includes("application/json")){const S=await r.json();i.error("Export Failed",{id:"export-project-pdf",description:S.message||"An error occurred during PDF export."});return}const C=await r.blob(),g=window.URL.createObjectURL(C),E=document.createElement("a");E.href=g,E.download=`${_.project.slug}_full_project.pdf`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(g),i.success("Project PDF exported successfully!",{id:"export-project-pdf",description:`${_.project.title} has been downloaded as PDF.`})}else try{const u=await r.json();i.error("Export Failed",{id:"export-project-pdf",description:u.message||"An error occurred during PDF export."})}catch{i.error("Export Failed",{id:"export-project-pdf",description:"Unable to export project as PDF. Please try again."})}}catch{i.error("Export Failed",{id:"export-project-pdf",description:"Network error occurred. Please check your connection and try again."})}},V=async()=>{if(m.value.length===0){i.error("No chapters selected",{description:"Please select at least one chapter to export."});return}try{i.loading(`Exporting ${m.value.length} chapters...`,{id:"export-chapters"});const x=K("export.chapters.word",{project:_.project.slug}),r=new FormData;m.value.forEach(g=>{r.append("chapters[]",g.toString())});const u=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");u&&r.append("_token",u);const C=await fetch(x,{method:"POST",body:r,headers:{Accept:"application/json"}});if(C.ok){const g=C.headers.get("content-type");if(g&&g.includes("application/json")){const G=await C.json();i.error("Export Failed",{id:"export-chapters",description:G.message||"An error occurred during export."});return}if(g&&g.includes("text/html")){const G=await C.text();i.error("Export Failed",{id:"export-chapters",description:`Server returned HTML instead of DOCX. ${G.slice(0,80)}`});return}const E=await C.blob(),S=new Uint8Array(await E.slice(0,2).arrayBuffer());if(!(S.length===2&&S[0]===80&&S[1]===75)){i.error("Export Failed",{id:"export-chapters",description:"Downloaded file is not a valid DOCX (missing PK zip header)."});return}const L=window.URL.createObjectURL(E),N=document.createElement("a");N.href=L,N.download=`${_.project.slug}-chapters-${m.value.join("-")}.docx`,document.body.appendChild(N),N.click(),document.body.removeChild(N),window.URL.revokeObjectURL(L),i.success("Selected chapters exported successfully!",{id:"export-chapters",description:`${m.value.length} chapters exported to Word.`}),m.value=[],v.value=!1}else try{const g=await C.json();i.error("Export Failed",{id:"export-chapters",description:g.message||"An error occurred during export."})}catch{i.error("Export Failed",{id:"export-chapters",description:"Unable to export selected chapters. Please try again."})}}catch{i.error("Export Failed",{id:"export-chapters",description:"Network error occurred. Please check your connection and try again."})}},P=x=>{const r=m.value.indexOf(x);r>-1?m.value.splice(r,1):m.value.push(x)},Q=()=>{m.value=j.value.map(x=>x.chapter_number)},b=()=>{m.value=[]},T=()=>{m.value=[],v.value=!0},F=async()=>{i.loading("Generating PDF...",{id:"export-chapter-pdf"});const x=K("export.chapter.pdf",{project:_.project.slug,chapterNumber:_.currentChapter.chapter_number});try{const r=await fetch(x,{method:"GET",headers:{Accept:"application/pdf"}});if(r.ok){const u=r.headers.get("content-type");if(u&&u.includes("application/json")){const S=await r.json();i.error("Export Failed",{id:"export-chapter-pdf",description:S.message||"An error occurred during PDF export."});return}const C=await r.blob(),g=window.URL.createObjectURL(C),E=document.createElement("a");E.href=g,E.download=`chapter_${_.currentChapter.chapter_number}_${_.currentChapter.title.toLowerCase().replace(/\s+/g,"_")}.pdf`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL(g),i.success("PDF exported successfully!",{id:"export-chapter-pdf",description:`${_.currentChapter.title} has been downloaded as PDF.`})}else try{const u=await r.json();i.error("Export Failed",{id:"export-chapter-pdf",description:u.message||"An error occurred during PDF export."})}catch{i.error("Export Failed",{id:"export-chapter-pdf",description:"Unable to export chapter as PDF. Please try again."})}}catch{i.error("Export Failed",{id:"export-chapter-pdf",description:"Network error occurred. Please check your connection and try again."})}};return(x,r)=>(l(),f("div",eo,[s(e(ot),null,{default:n(()=>[s(e(at),{asChild:""},{default:n(()=>[s(e(h),{variant:x.variant,size:x.size,class:O(["gap-2",x.buttonClass])},{default:n(()=>[x.triggerElement==="button"?(l(),f(R,{key:0},[s(e(ue),{class:"h-4 w-4"}),r[2]||(r[2]=p(" Export ",-1)),s(e(le),{class:"h-3 w-3"})],64)):(l(),w(e(ue),{key:1,class:"h-4 w-4"}))]),_:1},8,["variant","size","class"])]),_:1}),s(e(rt),{align:"end",class:"w-64"},{default:n(()=>[s(e(pe),null,{default:n(()=>[...r[3]||(r[3]=[p("Current Chapter",-1)])]),_:1}),s(e(Z),{onClick:M,class:"gap-2"},{default:n(()=>[s(e(re),{class:"h-4 w-4"}),r[4]||(r[4]=t("div",{class:"flex flex-col"},[t("span",{class:"font-medium"},"Export as Word"),t("span",{class:"text-xs text-muted-foreground"}," DOCX with chapter references at end ")],-1))]),_:1}),s(e(Z),{onClick:F,class:"gap-2"},{default:n(()=>[s(e(Ce),{class:"h-4 w-4"}),r[5]||(r[5]=t("div",{class:"flex flex-col"},[t("span",{class:"font-medium"},"Export as PDF"),t("span",{class:"text-xs text-muted-foreground"}," With chapter references at end ")],-1))]),_:1}),s(e(je)),s(e(pe),null,{default:n(()=>[...r[6]||(r[6]=[p("Full Project",-1)])]),_:1}),s(e(Z),{onClick:B,class:"gap-2"},{default:n(()=>[s(e(re),{class:"h-4 w-4"}),r[7]||(r[7]=t("div",{class:"flex flex-col"},[t("span",{class:"font-medium"},"Export as Word"),t("span",{class:"text-xs text-muted-foreground"}," All references collected and sorted ")],-1))]),_:1}),s(e(Z),{onClick:D,class:"gap-2"},{default:n(()=>[s(e(Ce),{class:"h-4 w-4"}),r[8]||(r[8]=t("div",{class:"flex flex-col"},[t("span",{class:"font-medium"},"Export as PDF"),t("span",{class:"text-xs text-muted-foreground"}," All references collected & sorted alphabetically ")],-1))]),_:1}),s(e(je)),s(e(pe),null,{default:n(()=>[...r[9]||(r[9]=[p("Selected Chapters",-1)])]),_:1}),s(e(Z),{onClick:T,class:"gap-2"},{default:n(()=>[s(e(re),{class:"h-4 w-4"}),r[10]||(r[10]=t("div",{class:"flex flex-col"},[t("span",{class:"font-medium"},"Export selected as Word"),t("span",{class:"text-xs text-muted-foreground"}," Pick chapters to include in DOCX ")],-1))]),_:1})]),_:1})]),_:1}),s(e(Ze),{open:v.value,"onUpdate:open":r[1]||(r[1]=u=>v.value=u)},{default:n(()=>[s(e(Qe),{class:"max-w-2xl"},{default:n(()=>[s(e(tt),null,{default:n(()=>[s(e(st),{class:"flex items-center gap-2"},{default:n(()=>[s(e(re),{class:"h-5 w-5"}),r[11]||(r[11]=p(" Select Chapters to Export ",-1))]),_:1}),s(e(Ye),null,{default:n(()=>[...r[12]||(r[12]=[p(" Choose which chapters you want to include in your Word export. Only chapters with content can be exported. ",-1)])]),_:1})]),_:1}),t("div",to,[t("div",so,[t("div",oo,[t("span",null,d(U.value)+" of "+d(j.value.length)+" chapters selected",1),z.value>0?(l(),w(e(I),{key:0,variant:"outline",class:"text-xs"},{default:n(()=>[p(d(z.value.toLocaleString())+" words ",1)]),_:1})):k("",!0)]),t("div",ao,[s(e(h),{onClick:Q,variant:"ghost",size:"sm"},{default:n(()=>[...r[13]||(r[13]=[p(" Select All ",-1)])]),_:1}),s(e(h),{onClick:b,variant:"ghost",size:"sm"},{default:n(()=>[...r[14]||(r[14]=[p(" Clear ",-1)])]),_:1})])]),s(e(X)),s(e(fe),{class:"h-[300px]"},{default:n(()=>[t("div",ro,[(l(!0),f(R,null,H(j.value,u=>(l(),w(e(Ee),{key:u.id,class:O(["cursor-pointer transition-colors hover:bg-muted/50",{"ring-2 ring-primary":m.value.includes(u.chapter_number),"bg-muted/30":m.value.includes(u.chapter_number)}]),onClick:C=>P(u.chapter_number)},{default:n(()=>[s(e(Fe),{class:"p-4"},{default:n(()=>[t("div",no,[s(e(Ke),{checked:m.value.includes(u.chapter_number),"onUpdate:checked":C=>P(u.chapter_number),class:"mt-1"},null,8,["checked","onUpdate:checked"]),t("div",lo,[t("div",io,[t("h4",co," Chapter "+d(u.chapter_number)+": "+d(u.title),1),s(e(I),{variant:u.status==="approved"?"default":"secondary",class:"text-xs"},{default:n(()=>[p(d(u.status.replace("_"," ")),1)]),_:2},1032,["variant"])]),t("div",uo,[t("span",null,d(u.word_count.toLocaleString())+" words",1),u.word_count>0?(l(),f("span",po,d(Math.ceil(u.word_count/250))+" pages approx. ",1)):k("",!0)])])])]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))])]),_:1})]),s(e(et),null,{default:n(()=>[s(e(h),{onClick:r[0]||(r[0]=u=>v.value=!1),variant:"outline"},{default:n(()=>[...r[15]||(r[15]=[p(" Cancel ",-1)])]),_:1}),s(e(h),{onClick:V,disabled:U.value===0,class:"gap-2"},{default:n(()=>[s(e(ue),{class:"h-4 w-4"}),p(" Export "+d(U.value)+" Chapter"+d(U.value===1?"":"s"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]))}});function Uo(q="",_=50){const v=$([q]),m=$(0);return{contentHistory:v,historyIndex:m,addToHistory:D=>{v.value[m.value]!==D&&(v.value=v.value.slice(0,m.value+1),v.value.push(D),v.value.length>_?v.value.shift():m.value++)},undo:()=>m.value>0?(m.value--,v.value[m.value]):null,redo:()=>m.value<v.value.length-1?(m.value++,v.value[m.value]):null,canUndo:()=>m.value>0,canRedo:()=>m.value<v.value.length-1}}export{Do as _,So as a,Uo as u};
