import{z as R,g as I,h as Ce,j as Se,af as je,C as te,d as Pe,y as B,c as w,o as p,w as v,f as o,k as h,u as i,a as y,q as k,n as S,t as x,T as $e,s as P,F as me,A as _e,R as Le,X as Te,ag as Fe,x as ve}from"./app-f2LOotth.js";import{_ as Ge}from"./index-BjFOURpu.js";import{c as ze,_ as J,L as ee}from"./index-dTYPSduZ.js";import{_ as be}from"./CardContent.vue_vue_type_script_setup_true_lang-CrxnEQrS.js";import{_ as xe,a as ye}from"./index-D8jqLK6T.js";import{_ as Ie}from"./AlertTitle.vue_vue_type_script_setup_true_lang-DYYRipNV.js";import{u as Me,_ as We}from"./AppLayout.vue_vue_type_script_setup_true_lang-Bizodsrf.js";import{_ as Ae}from"./SafeHtmlText.vue_vue_type_script_setup_true_lang-BqUqPXeU.js";import{t as $}from"./Sonner.vue_vue_type_script_setup_true_lang-zs0gmLY3.js";import{_ as Ee}from"./PurchaseModal.vue_vue_type_script_setup_true_lang-rhnIy1hj.js";import{A as Re}from"./arrow-left-DnNY_2Rp.js";import{T as fe}from"./triangle-alert-DuDDyyQi.js";import{C as qe}from"./check-Dut3DGyw.js";import{C as Oe}from"./clock-0V2bZONH.js";import{P as Be}from"./play-BFz84yrV.js";import{S as Ne}from"./square-pen-DkEnxJNn.js";import{F as we}from"./file-text-CtHdjGG8.js";import{S as Ue}from"./search-C2v79RKc.js";import{S as Ve}from"./sparkles-WCKbcs3P.js";import{_ as Ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useForwardExpose-P7ffnFn1.js";import"./UserInfo.vue_vue_type_script_setup_true_lang-FbaaEFh8.js";import"./VisuallyHidden-oDUPfO_9.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BvX0qSLf.js";import"./coins-9eB20Gjy.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CGQwE3Zd.js";import"./plus-C1nQ-2Wm.js";import"./chevron-right-CccQI9wO.js";import"./circle-check-D7rvtcRW.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-BiX3oaaL.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-2TDaNIHN.js";import"./arrow-right-BJl291D4.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=ze("TerminalIcon",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);function He(N){const a=R({status:"not_started",progress:0,currentStage:"",message:"",isConnected:!1,error:null}),c=R([]),L=R([]),u=R({}),T=R(null),G=new Set;let C=null,g=null,M=null;const q=5e3;let O=null;const re=2e3,U=I(()=>["pending","processing"].includes(a.value.status)),V=I(()=>a.value.status==="completed"),K=I(()=>a.value.status==="failed"),se=I(()=>a.value.status==="failed"&&a.value.progress>0),oe=I(()=>{if(V.value)return"Completed";if(K.value)return"Stopped";if(!U.value)return"Est. 15-20m";const e=u.value.chapter_timings||{},r=Object.keys(e).length,t=u.value.total_chapters||5;if(r>0){const F=Object.values(e).reduce((E,ge)=>E+ge,0)/r,X=(t-r)*F+60;return X<60?"< 1 min remaining":`~${Math.ceil(X/60)} min${X>=120?"s":""} remaining`}const n=100-a.value.progress,d=Math.ceil(n/100*20);return`~${d} min${d>1?"s":""} remaining`}),Q=()=>{if(C){console.warn("Already connected to WebSocket");return}try{C=new je({broadcaster:"reverb",key:"c8a608e4ba2640154b0daedb18c40f09",wsHost:"finalyze.live",wsPort:"443",wssPort:"443",forceTLS:!0,enabledTransports:["ws","wss"]}),g=C.private(`project.${N}.generation`),g.subscribed(()=>{console.log("âœ… Connected to generation channel"),a.value.isConnected=!0,a.value.error=null}),g.error(e=>{console.error("âŒ Channel error:",e),a.value.error="WebSocket connection error"}),ae(),console.log("ðŸ”Œ Connecting to WebSocket channel...")}catch(e){console.error("Failed to initialize WebSocket:",e),a.value.error="Failed to connect to real-time updates"}},ae=()=>{g&&(g.listen(".generation.started",e=>{console.log("ðŸ“¡ Generation started:",e),W(e)}),g.listen(".generation.literature_mining",e=>{console.log("ðŸ“š Literature mining:",e),A(e)}),g.listen(".generation.chapter.started",e=>{console.log("ðŸ“ Chapter started:",e),ne(e)}),g.listen(".generation.chapter.progress",e=>{console.log("â³ Chapter progress:",e),Z(e)}),g.listen(".generation.chapter.completed",e=>{console.log("âœ… Chapter completed:",e),ie(e)}),g.listen(".generation.completed",e=>{console.log("ðŸŽ‰ Generation completed:",e),le(e)}),g.listen(".generation.failed",e=>{console.log("âŒ Generation failed:",e),ce(e)}))},W=e=>{a.value.status="processing",a.value.progress=e.progress,a.value.currentStage=e.current_stage,a.value.message=e.message,u.value={...u.value,total_chapters:e.total_chapters,is_resume:e.is_resume,estimated_duration:e.estimated_duration},D(e.total_chapters||5),s(),z({type:e.is_resume?"info":"stage",message:e.is_resume?"ðŸ”„ Resuming generation sequence...":"ðŸš€ Starting generation sequence..."})},A=e=>{a.value.progress=e.progress,a.value.currentStage="literature_mining",a.value.message=e.message;const r=c.value.find(t=>t.id==="literature_mining");r&&(r.status="active",r.progress=(e.progress-0)/20*100,r.description=e.message),z({type:"mining",message:e.message,source:e.source}),e.sub_stage==="completed"&&e.source==="complete"&&r&&(r.status="completed",r.progress=100)},ne=e=>{const r=e.chapter_number;f(),a.value.progress=e.progress,a.value.currentStage=`chapter_generation_${r}`,a.value.message=e.message,u.value={...u.value,current_chapter:r,total_chapters:e.total_chapters},de(r,e.chapter_title,e.target_word_count),pe(r);const t=c.value.find(n=>n.id===`chapter_generation_${r}`);t&&(t.status="active",t.progress=0,t.chapterProgress=20),Y(r,80),z({type:"chapter_progress",message:`ðŸ“ Starting Chapter ${r}: ${e.chapter_title}`,chapter:r})},Z=e=>{const r=e.chapter_number;if(a.value.progress=e.progress,a.value.message=e.stage_description||e.message,r>0){const t=c.value.find(n=>n.id===`chapter_generation_${r}`);t&&(t.chapterProgress=e.chapter_progress,t.wordCount=e.current_word_count,t.description=e.stage_description||t.description),u.value={...u.value,chapter_progress:e.chapter_progress,current_word_count:e.current_word_count}}},ie=e=>{const r=e.chapter_number;f(),a.value.progress=e.progress,a.value.message=e.message;const t=c.value.find(d=>d.id===`chapter_generation_${r}`);t&&(t.status="completed",t.progress=100,t.chapterProgress=100,t.wordCount=e.word_count,t.generationTime=e.generation_time);const n=u.value.chapter_timings||{};n[r]=e.generation_time,u.value={...u.value,chapter_timings:n,chapters_completed:e.chapters_completed},z({type:"chapter_completed",message:`âœ… Chapter ${r} completed (${e.word_count?.toLocaleString()} words in ${e.generation_time}s)`,chapter:r,generationTime:e.generation_time})},le=e=>{a.value.status="completed",a.value.progress=100,a.value.currentStage="completed",a.value.message="Project generation completed successfully!",_(),f();const r=c.value.find(t=>t.id==="html_conversion");r&&(r.status="completed",r.progress=100),T.value=e.download_links||null,u.value={...u.value,total_word_count:e.total_word_count,total_duration:e.total_duration,papers_collected:e.papers_collected},z({type:"success",message:`ðŸŽ‰ Project generation completed! (${e.total_word_count?.toLocaleString()} words in ${Math.round(e.total_duration||0)}s)`})},ce=e=>{a.value.status="failed",a.value.message=e.error_message||"Generation failed",a.value.error=e.error_message||null,_(),f();const r=c.value.find(t=>t.id===e.failed_stage);r&&(r.status="error"),u.value={...u.value,can_resume:e.can_resume,last_successful_chapter:e.last_successful_chapter},z({type:"error",message:`âŒ Generation failed: ${e.error_message}`,chapter:e.failed_chapter})},D=e=>{const r=75/e;c.value=[{id:"literature_mining",name:"Literature Mining",description:"Collecting research papers from academic databases",status:"pending",progress:0,range:[0,20]}];for(let t=1;t<=e;t++){const n=20+(t-1)*r,d=20+t*r;c.value.push({id:`chapter_generation_${t}`,name:`Chapter ${t}`,description:`Chapter ${t}`,status:"pending",progress:0,chapterProgress:0,wordCount:0,targetWordCount:0,range:[n,d]}),G.add(t)}c.value.push({id:"html_conversion",name:"Finalizing Project",description:"Formatting content and preparing final document",status:"pending",progress:0,range:[95,100]})},de=(e,r,t)=>{if(G.has(e)){const E=c.value.find(ge=>ge.id===`chapter_generation_${e}`);E&&(E.description=r,E.targetWordCount=t);return}const d=75/Math.max(G.size+1,e),j=20+(e-1)*d,F=20+e*d,he={id:`chapter_generation_${e}`,name:`Chapter ${e}`,description:r,status:"pending",progress:0,chapterProgress:0,wordCount:0,targetWordCount:t,range:[j,F]},X=c.value.findIndex(E=>E.id==="html_conversion");c.value.splice(X,0,he),G.add(e),ue()},ue=()=>{const e=c.value.filter(n=>n.id.startsWith("chapter_generation_")),t=75/e.length;e.forEach((n,d)=>{const j=20+d*t,F=20+(d+1)*t;n.range=[j,F]})},pe=e=>{const r=c.value.find(t=>t.id==="literature_mining");r&&r.status!=="completed"&&(r.status="completed",r.progress=100);for(let t=1;t<e;t++){const n=c.value.find(d=>d.id===`chapter_generation_${t}`);n&&n.status!=="completed"&&(n.status="completed",n.progress=100,n.chapterProgress=100)}},z=e=>{L.value.unshift({...e,timestamp:new Date().toISOString()}),L.value.length>100&&L.value.pop()},m=e=>{switch(e){case"success":return"success";case"error":return"error";case"chapter_completed":return"chapter_completed";case"chapter_started":case"chapter_progress":return"chapter_progress";case"mining":return"mining";case"conversion":return"conversion";case"stage":return"stage";default:return"info"}},l=e=>{a.value.status=e.status,a.value.progress=e.progress??0,a.value.currentStage=e.current_stage||"",a.value.message=e.message||"",a.value.error=e.status==="failed"?e.message:null,u.value=e.metadata||{},T.value=e.download_links||null,G.clear();const r=e.chapter_statuses?.length||u.value.total_chapters||5;if(D(r),u.value={...u.value,total_chapters:u.value.total_chapters||r},e.chapter_statuses?.forEach(t=>{const n=c.value.find(d=>d.id===`chapter_generation_${t.chapter_number}`);n&&(n.description=t.title||n.description,n.targetWordCount=t.target_word_count??n.targetWordCount,(t.is_completed||t.status==="completed")&&(n.status="completed",n.progress=100,n.chapterProgress=100,n.wordCount=t.word_count,n.generationTime=u.value?.chapter_timings?.[t.chapter_number]))}),["processing","pending"].includes(e.status)){if(e.current_stage){const t=c.value.find(n=>n.id===e.current_stage);if(t&&(t.status="active",t.id.startsWith("chapter_generation_"))){const n=Number(e.current_stage.replace("chapter_generation_","")),d=e.metadata?.chapter_progress??u.value.chapter_progress??0,j=e.metadata?.current_word_count??u.value.current_word_count;u.value={...u.value,current_chapter:n,chapter_progress:d,current_word_count:j},t.chapterProgress=d,t.wordCount=j??t.wordCount,Y(n,80)}if(e.current_stage.includes("chapter_generation")){const n=c.value.find(d=>d.id==="literature_mining");n&&(n.status="completed",n.progress=100)}if(e.current_stage==="html_conversion"){const n=c.value.find(d=>d.id==="html_conversion");n&&(n.status="active",n.progress=e.progress||n.progress)}}s()}if(e.status==="completed"&&(a.value.progress=100,c.value.forEach(t=>{t.status="completed",t.progress=100,t.chapterProgress!==void 0&&(t.chapterProgress=100)})),e.status==="failed"&&e.current_stage){const t=c.value.find(n=>n.id===e.current_stage);t&&(t.status="error")}e.details?.length&&(L.value=e.details.map(t=>({timestamp:t.timestamp,type:m(t.type),message:t.message,chapter:t.chapter,generationTime:t.generation_time,source:t.source})).reverse())},s=()=>{M||(console.log("ðŸ“¡ Starting polling fallback"),M=setInterval(async()=>{if(!U.value){_();return}try{const r=(await te.get(`/api/projects/${N}/bulk-generate/status`)).data;if(r.progress>a.value.progress||r.status!==a.value.status){if(console.log("ðŸ“Š Polling update received:",{progress:r.progress,status:r.status,stage:r.current_stage}),a.value.progress=r.progress,a.value.status=r.status,a.value.message=r.message,a.value.currentStage=r.current_stage,r.metadata&&(u.value={...u.value,...r.metadata},r.metadata.chapter_progress!==void 0&&r.metadata.current_chapter)){const t=r.metadata.current_chapter,n=c.value.find(d=>d.id===`chapter_generation_${t}`);n&&(n.chapterProgress=r.metadata.chapter_progress,n.wordCount=r.metadata.current_word_count||0)}r.status==="completed"&&(T.value=r.download_links,_()),r.status==="failed"&&(a.value.error=r.message,_())}}catch(e){console.warn("Polling request failed:",e)}},q))},_=()=>{M&&(clearInterval(M),M=null,console.log("ðŸ“¡ Polling stopped"))},Y=(e,r=80)=>{if(f(),!c.value.find(d=>d.id===`chapter_generation_${e}`))return;const n=3;console.log(`ðŸŽ¬ Starting progress animation for Chapter ${e}`),O=setInterval(()=>{const d=c.value.find(F=>F.id===`chapter_generation_${e}`);if(!d||d.status!=="active"){f();return}const j=d.chapterProgress||0;if(j<r&&(d.chapterProgress=Math.min(j+n,r),d.targetWordCount)){const F=Math.floor(d.chapterProgress/100*d.targetWordCount);d.wordCount=F}},re)},f=()=>{O&&(clearInterval(O),O=null)},b=()=>{_(),f(),g&&(g.stopListening(".generation.started"),g.stopListening(".generation.literature_mining"),g.stopListening(".generation.chapter.started"),g.stopListening(".generation.chapter.progress"),g.stopListening(".generation.chapter.completed"),g.stopListening(".generation.completed"),g.stopListening(".generation.failed")),C&&(C.leave(`project.${N}.generation`),C=null),g=null,a.value.isConnected=!1,console.log("ðŸ”Œ Disconnected from generation channel")},H=()=>{a.value={status:"not_started",progress:0,currentStage:"",message:"",isConnected:a.value.isConnected,error:null},c.value=[],L.value=[],u.value={},T.value=null,G.clear()};return Ce(()=>{Q()}),Se(()=>{b()}),{state:a,stages:c,activityLog:L,metadata:u,downloadLinks:T,isGenerating:U,isCompleted:V,hasFailed:K,canResume:se,estimatedTimeRemaining:oe,connect:Q,disconnect:b,restoreFromApiData:l,reset:H,startPolling:s}}const Xe={class:"relative min-h-screen p-4 md:p-8 lg:p-12"},Je={class:"max-w-5xl mx-auto space-y-8"},Ke={class:"flex flex-col gap-6"},Qe={class:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4"},Ze={class:"flex items-center gap-3 px-4 py-2 rounded-full border border-border/50 bg-background/50 backdrop-blur-md shadow-sm self-end md:self-auto"},De={class:"relative flex h-3 w-3"},et={key:0,class:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"},tt={class:"space-y-2"},rt={class:"text-xl text-muted-foreground font-light tracking-wide"},st={class:"grid lg:grid-cols-12 gap-8 items-start relative"},ot={class:"lg:col-span-7 space-y-8 order-2 lg:order-1"},at={class:"space-y-6 pl-2 z-10 relative"},nt={class:"relative space-y-0"},it={class:"flex flex-col items-center"},lt={key:0,class:"w-full h-full bg-gradient-to-b from-primary to-transparent animate-pulse shadow-[0_0_10px_rgba(var(--primary),0.5)]"},ct={class:"flex items-center justify-between gap-4 p-4 rounded-xl border border-border/10 bg-card/10 backdrop-blur-md hover:border-primary/20 hover:bg-card/30 hover:shadow-[0_0_20px_rgba(var(--primary),0.1)] transition-all duration-300 group-hover:bg-card/20"},dt={class:"space-y-1 flex-1"},ut={class:"flex items-center gap-2"},pt={key:0,class:"mt-3 bg-secondary/30 rounded-lg p-3 space-y-2.5 border border-border/30 shadow-inner"},gt={class:"flex justify-between text-xs font-medium text-muted-foreground"},mt={class:"font-mono text-xs tracking-tight"},ft={class:"h-2 w-full overflow-hidden rounded-full bg-background/50 border border-white/5"},ht={key:0,class:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent skew-x-[-20deg] animate-shimmer",style:{"background-size":"200% 100%"}},_t={key:0,class:"text-primary hidden sm:block"},vt={class:"lg:col-span-5 flex flex-col gap-6 lg:sticky lg:top-24 lg:h-[calc(100vh-6rem)] order-1 lg:order-2"},bt={class:"group relative z-20"},xt={class:"space-y-6 md:space-y-8"},yt={class:"flex flex-col items-center justify-center py-6"},wt={class:"relative w-48 h-48"},kt={class:"w-full h-full -rotate-90",viewBox:"0 0 100 100"},Ct=["stroke-dasharray","stroke-dashoffset"],St={class:"absolute inset-0 flex flex-col items-center justify-center"},jt={class:"text-4xl font-bold tabular-nums tracking-tighter"},Pt={class:"text-xs font-medium uppercase tracking-widest text-muted-foreground/80 mt-1"},$t={class:"mt-6 text-center space-y-2"},Lt={class:"text-base text-muted-foreground leading-relaxed animate-pulse-slow"},Tt={class:"flex items-center justify-center gap-2 text-sm text-muted-foreground bg-secondary/30 px-3 py-1 rounded-full w-fit mx-auto"},Ft={class:"font-mono"},Gt={class:"flex flex-col gap-4 pt-4 border-t border-border/50"},zt={class:"grid grid-cols-2 gap-3"},It={class:"hidden lg:flex flex-col flex-1 min-h-0 relative"},Mt={class:"flex items-center justify-between px-1 bg-background pb-2"},Wt={class:"flex items-center gap-2"},At={class:"flex-1 overflow-y-auto p-4 font-mono text-xs md:text-sm scrollbar-hide relative"},Et={key:"empty",class:"absolute inset-0 flex flex-col items-center justify-center text-gray-700 select-none"},Rt={class:"animate-pulse flex flex-col items-center gap-2"},qt={class:"shrink-0 text-gray-600 select-none text-[10px] mt-[3px]"},Ot={key:0,class:"text-gray-500 mr-2"},Bt=Pe({__name:"BulkGeneration",props:{project:{}},setup(N){const a=N,{state:c,stages:L,activityLog:u,metadata:T,downloadLinks:G,isGenerating:C,isCompleted:g,hasFailed:M,canResume:q,estimatedTimeRemaining:O,restoreFromApiData:re,reset:U}=He(a.project.id),{showPurchaseModal:V,requiredWordsForModal:K,actionDescriptionForModal:se,checkAndPrompt:oe,closePurchaseModal:Q,estimates:ae}=Me(),W=R(!1),A=R(!1),ne=I(()=>c.value.isConnected?"text-green-500":c.value.error?"text-red-500":"text-yellow-500"),Z=I(()=>g.value?"Project Ready!":C.value?"Generating Your Project":q.value?"Resume Generation":"Ready to Generate"),ie=I(()=>{if(g.value)return"Your project has been successfully generated. You can now download it or view the chapters.";if(T.value?.current_chapter){const m=T.value.current_chapter,l=T.value.chapter_progress||0;return`Generating Chapter ${m} (${l}% complete)...`}return c.value.currentStage==="literature_mining"?"Analyzing academic databases and collecting relevant sources...":c.value.currentStage?.includes("chapter_generation")?"Writing your chapters with proper citations and formatting...":c.value.currentStage==="html_conversion"?"Finalizing formatting and preparing your document...":M.value?"Generation failed. You can resume from where it left off.":q.value?'Click "Resume Generation" to continue from the last completed step.':"Click the button below to start generating your complete project."}),le=m=>m==="literature_mining"?Ue:m==="html_conversion"?Ve:we,ce=async(m=!1)=>{if(W.value||C.value)return;const l=a.project.chapters?.filter(f=>f.status!=="completed"&&(f.word_count??0)<=0).length||a.project.chapters?.length||1,s=(()=>{const f=(a.project.chapters||[]).map(b=>b.target_word_count).filter(b=>typeof b=="number"&&b>0);return f.length>0?Math.ceil(f.reduce((b,H)=>b+H,0)/f.length):2e3})(),_=ae.chapter(s)*l;if(oe(_,m?"resume bulk generation":"bulk generate chapters")){W.value=!0,m||U();try{if((await te.post(B("api.projects.bulk-generate.start",a.project.slug),{resume:m})).data.generation_id)$.success(m?"Resuming generation...":"Generation started!");else throw new Error("No generation ID returned")}catch(f){console.error("Failed to start generation:",f),$.error(f.response?.data?.message||"Failed to start generation"),c.value.error=f.response?.data?.message||"Failed to start generation"}finally{W.value=!1}}},D=async()=>{try{await te.post(B("api.projects.bulk-generate.cancel",a.project.slug)),$.info("Generation cancelled")}catch(m){console.error("Failed to cancel generation:",m),$.error("Failed to cancel generation")}},de=async()=>{if(A.value)return;const m=G.value?.pdf||B("export.project.pdf",{project:a.project.slug}),l=a.project.title||a.project.topic||"Project";A.value=!0,$.loading("Generating project PDF...",{id:"download-project-pdf"});try{const s=await fetch(m,{method:"GET",headers:{Accept:"application/pdf"}});if(s.ok){const _=s.headers.get("content-type");if(_&&_.includes("application/json")){const H=await s.json();$.error("Export Failed",{id:"download-project-pdf",description:H.message||"An error occurred during PDF export."});return}const Y=await s.blob(),f=window.URL.createObjectURL(Y),b=document.createElement("a");b.href=f,b.download=`${a.project.slug}_full_project.pdf`,document.body.appendChild(b),b.click(),document.body.removeChild(b),window.URL.revokeObjectURL(f),$.success("Project PDF exported successfully!",{id:"download-project-pdf",description:`${l} has been downloaded as PDF.`})}else try{const _=await s.json();$.error("Export Failed",{id:"download-project-pdf",description:_.message||"An error occurred during PDF export."})}catch{$.error("Export Failed",{id:"download-project-pdf",description:"Unable to export project as PDF. Please try again."})}}catch{$.error("Export Failed",{id:"download-project-pdf",description:"Network error occurred. Please check your connection and try again."})}finally{A.value=!1}},ue=()=>{ve.visit(B("projects.show",a.project.slug))},pe=()=>{ve.visit(B("projects.writing",a.project.slug))},z=m=>new Date(m).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"});return Ce(async()=>{try{const m=await te.get(B("api.projects.bulk-generate.status",a.project.slug));m.data.status!=="not_started"&&re(m.data)}catch(m){console.error("Failed to check generation status:",m)}}),(m,l)=>(p(),w(We,{title:Z.value},{default:v(()=>[l[19]||(l[19]=o("div",{class:"fixed inset-0 overflow-hidden pointer-events-none"},[o("div",{class:"absolute top-[-10%] right-[-5%] w-[500px] h-[500px] bg-primary/10 rounded-full blur-[100px] mix-blend-screen animate-pulse duration-3000"}),o("div",{class:"absolute bottom-[-10%] left-[-5%] w-[600px] h-[600px] bg-blue-600/5 rounded-full blur-[120px] mix-blend-screen"})],-1)),o("div",Xe,[o("div",Je,[o("div",Ke,[o("div",Qe,[h(i(J),{variant:"outline",size:"icon",onClick:pe,class:"rounded-xl border-dashed border-gray-600/30 hover:bg-gray-100/10 hover:border-primary/50 transition-all shrink-0"},{default:v(()=>[h(i(Re),{class:"h-5 w-5"})]),_:1}),o("div",Ze,[o("div",De,[i(c).isConnected?(p(),y("span",et)):k("",!0),o("span",{class:S(["relative inline-flex rounded-full h-3 w-3",i(c).isConnected?"bg-green-500":"bg-red-500"])},null,2)]),o("span",{class:S(["text-sm font-medium",ne.value])},x(i(c).isConnected?"System Online":"Connecting..."),3)])]),o("div",tt,[h(Ae,{as:"h1",class:"text-2xl md:text-3xl font-bold tracking-tight bg-gradient-to-r from-foreground to-foreground/60 bg-clip-text text-transparent leading-tight",content:m.project.title||m.project.topic},null,8,["content"]),o("p",rt,x(Z.value),1)])]),h($e,{"enter-active-class":"transition duration-300 ease-out","enter-from-class":"transform -translate-y-2 opacity-0","enter-to-class":"transform translate-y-0 opacity-100","leave-active-class":"transition duration-200 ease-in","leave-from-class":"transform translate-y-0 opacity-100","leave-to-class":"transform -translate-y-2 opacity-0"},{default:v(()=>[i(c).error&&!i(C)?(p(),w(i(xe),{key:0,variant:"destructive",class:"border-red-500/50 bg-red-500/10"},{default:v(()=>[h(i(fe),{class:"h-4 w-4"}),h(i(Ie),null,{default:v(()=>[...l[2]||(l[2]=[P("Execution Error",-1)])]),_:1}),h(i(ye),null,{default:v(()=>[P(x(i(c).error),1)]),_:1})]),_:1})):k("",!0)]),_:1}),o("div",st,[o("div",ot,[o("div",at,[l[6]||(l[6]=o("h2",{class:"text-xl font-semibold tracking-tight"},"Generation Sequence",-1)),o("div",nt,[l[5]||(l[5]=o("div",{class:"absolute left-[19px] top-6 bottom-6 w-0.5 bg-gradient-to-b from-border/50 via-border/30 to-transparent"},null,-1)),(p(!0),y(me,null,_e(i(L),(s,_)=>(p(),y("div",{key:s.id,class:"relative flex gap-4 group"},[o("div",it,[o("div",{class:S(["relative z-10 flex h-8 w-8 items-center justify-center rounded-full border-2 shadow-sm transition-all duration-500",{"border-muted bg-card scale-95 opacity-70":s.status==="pending","border-primary bg-background ring-2 ring-primary/20 scale-110 shadow-[0_0_10px_rgba(var(--primary),0.3)]":s.status==="active","border-green-500 bg-green-500 text-white scale-100 shadow-green-500/20":s.status==="completed","border-red-500 bg-red-500/10 text-red-500":s.status==="error"}])},[s.status==="completed"?(p(),w(i(qe),{key:0,class:"h-4 w-4 stroke-[3]"})):s.status==="active"?(p(),w(i(ee),{key:1,class:"h-4 w-4 animate-spin text-primary"})):s.status==="error"?(p(),w(i(fe),{key:2,class:"h-4 w-4"})):(p(),w(Le(le(s.id)),{key:3,class:"h-3.5 w-3.5 text-muted-foreground"}))],2),_<i(L).length-1?(p(),y("div",{key:0,class:S(["w-0.5 flex-1 transition-all duration-700 ease-in-out mt-[-1px] mb-[-1px]",{"bg-gradient-to-b from-green-500 to-transparent":s.status==="completed","bg-transparent":s.status!=="completed"}])},[s.status==="active"?(p(),y("div",lt)):k("",!0)],2)):k("",!0)]),o("div",{class:S(["flex-1 pb-6 min-w-0 transition-opacity duration-300",{"opacity-50 hover:opacity-100":s.status==="pending"}])},[o("div",ct,[o("div",dt,[o("div",ut,[o("h3",{class:S(["font-semibold text-base tracking-tight",{"text-foreground":s.status==="active"||s.status==="completed","text-muted-foreground":s.status==="pending","text-red-500":s.status==="error"}])},x(s.name),3),s.status==="completed"&&s.generationTime?(p(),w(i(Ge),{key:0,variant:"secondary",class:"text-[10px] h-5 px-1.5 font-mono bg-secondary/50 text-secondary-foreground/70"},{default:v(()=>[P(x(s.generationTime)+"s ",1)]),_:2},1024)):k("",!0)]),o("p",{class:S(["text-sm text-balance leading-relaxed",{"text-muted-foreground/80":s.status!=="active","text-primary/90 font-medium":s.status==="active"}])},x(s.description),3),s.id.startsWith("chapter_generation_")&&(s.status==="active"||s.status==="completed")?(p(),y("div",pt,[o("div",gt,[l[4]||(l[4]=o("span",{class:"uppercase tracking-wider text-[10px]"},"Progress",-1)),o("span",mt,[o("span",{class:S({"text-primary font-bold":s.status==="active","text-green-500 font-bold":s.status==="completed"})},x(s.wordCount?.toLocaleString()??0),3),l[3]||(l[3]=o("span",{class:"opacity-50 mx-1"},"/",-1)),P(" "+x(s.targetWordCount?.toLocaleString()??0)+" words ",1)])]),o("div",ft,[o("div",{class:S(["h-full transition-all duration-700 ease-out relative overflow-hidden",{"bg-gradient-to-r from-green-500 to-emerald-400":s.status==="completed","bg-gradient-to-r from-blue-500 to-indigo-500":s.status==="active"}]),style:Te({width:s.status==="completed"?"100%":`${s.chapterProgress}%`})},[s.status==="active"?(p(),y("div",ht)):k("",!0)],6)])])):k("",!0)]),s.status==="active"?(p(),y("div",_t,[h(i(ee),{class:"h-4 w-4 animate-spin"})])):k("",!0)])],2)]))),128))])])]),o("div",vt,[o("div",bt,[l[13]||(l[13]=o("div",{class:"absolute -inset-0.5 bg-gradient-to-r from-primary/30 to-purple-500/30 rounded-2xl blur opacity-30 group-hover:opacity-50 transition duration-1000"},null,-1)),h(i(be),{class:"relative p-6 md:p-8 border-border/50 bg-card/80 backdrop-blur-xl transition-all duration-300 shadow-2xl"},{default:v(()=>[o("div",xt,[o("div",yt,[o("div",wt,[(p(),y("svg",kt,[l[7]||(l[7]=o("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"currentColor",class:"text-secondary/30","stroke-width":"8"},null,-1)),o("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"url(#progress-gradient)","stroke-width":"8","stroke-linecap":"round",class:"transition-all duration-1000 ease-out","stroke-dasharray":2*Math.PI*45,"stroke-dashoffset":2*Math.PI*45*(1-i(c).progress/100)},null,8,Ct),l[8]||(l[8]=o("defs",null,[o("linearGradient",{id:"progress-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%"},[o("stop",{offset:"0%","stop-color":"#3b82f6"}),o("stop",{offset:"50%","stop-color":"#6366f1"}),o("stop",{offset:"100%","stop-color":"#a855f7"})])],-1))])),o("div",St,[o("span",jt,x(Math.round(i(c).progress))+"%",1),o("span",Pt,x(i(g)?"Complete":"Progress"),1)])]),o("div",$t,[o("p",Lt,x(ie.value),1),o("div",Tt,[h(i(Oe),{class:"h-4 w-4 text-primary"}),o("span",Ft,x(i(O)),1)])])]),o("div",Gt,[!i(C)&&!i(g)?(p(),w(i(J),{key:0,onClick:l[0]||(l[0]=s=>ce(i(q))),disabled:W.value||!i(c).isConnected,size:"lg",class:"w-full rounded-xl shadow-lg shadow-primary/20 transition-all hover:scale-[1.02] active:scale-[0.98] text-base font-semibold py-6"},{default:v(()=>[W.value?(p(),w(i(ee),{key:0,class:"mr-2 h-5 w-5 animate-spin"})):(p(),w(i(Be),{key:1,class:"mr-2 h-5 w-5 fill-current"})),P(" "+x(i(q)?"Resume Operation":"Initialize Generation"),1)]),_:1},8,["disabled"])):k("",!0),i(C)?(p(),w(i(J),{key:1,variant:"destructive",size:"lg",onClick:D,class:"w-full rounded-xl shadow-lg shadow-destructive/20 hover:bg-destructive/90 py-6"},{default:v(()=>[...l[9]||(l[9]=[P(" Cancel Process ",-1)])]),_:1})):k("",!0),i(g)?(p(),y(me,{key:2},[o("div",zt,[h(i(J),{onClick:ue,size:"lg",class:"rounded-xl shadow-lg shadow-primary/20 hover:scale-[1.02] transition-all text-base py-6"},{default:v(()=>[h(i(Ne),{class:"mr-2 h-5 w-5"}),l[10]||(l[10]=P(" View in Editor ",-1))]),_:1}),h(i(J),{variant:"secondary",size:"lg",onClick:de,disabled:A.value,class:"rounded-xl hover:bg-secondary/80 py-6"},{default:v(()=>[A.value?(p(),w(i(ee),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):(p(),w(i(we),{key:1,class:"mr-2 h-4 w-4"})),l[11]||(l[11]=P(" Export PDF ",-1))]),_:1},8,["disabled"])]),h(i(xe),{variant:"default",class:"bg-yellow-500/10 border-yellow-500/20 text-yellow-500"},{default:v(()=>[h(i(fe),{class:"h-4 w-4"}),h(i(ye),{class:"text-xs leading-relaxed"},{default:v(()=>[...l[12]||(l[12]=[P(" AI is not perfect and can make mistakes. Please review each chapter and make adjustments where necessary. This will also help you know the project well enough to defend it. ",-1)])]),_:1})]),_:1})],64)):k("",!0)])])]),_:1})]),o("div",It,[o("div",Mt,[o("div",Wt,[h(i(ke),{class:"h-5 w-5 text-muted-foreground"}),l[14]||(l[14]=o("h2",{class:"text-lg font-semibold tracking-tight"},"System Logs",-1))]),l[15]||(l[15]=o("div",{class:"flex gap-1.5"},[o("div",{class:"w-3 h-3 rounded-full bg-red-500/80"}),o("div",{class:"w-3 h-3 rounded-full bg-yellow-500/80"}),o("div",{class:"w-3 h-3 rounded-full bg-green-500/80"})],-1))]),h(i(be),{class:"flex-1 overflow-hidden bg-[#0c0c0c] border-gray-800 shadow-2xl rounded-xl flex flex-col"},{default:v(()=>[l[18]||(l[18]=o("div",{class:"bg-gray-900/50 border-b border-gray-800 p-2 flex justify-center shrink-0"},[o("span",{class:"text-[10px] uppercase font-mono tracking-widest text-gray-500"},"generation-task.sh")],-1)),o("div",At,[h(Fe,{name:"list",tag:"div",class:"space-y-2"},{default:v(()=>[i(u).length===0?(p(),y("div",Et,[o("div",Rt,[h(i(ke),{class:"h-10 w-10 opacity-20"}),l[16]||(l[16]=o("p",{class:"font-sans text-sm"},"Waiting for initialization...",-1))])])):k("",!0),(p(!0),y(me,null,_e(i(u),(s,_)=>(p(),y("div",{key:_,class:S(["flex gap-3 items-start border-l-2 pl-3 py-0.5 transition-all hover:bg-white/5",{"border-blue-500/50":s.type==="info","border-green-500/50":s.type==="success"||s.type==="chapter_completed","border-red-500/50":s.type==="error","border-purple-500/50":s.type==="stage","border-transparent":!["info","success","chapter_completed","error","stage"].includes(s.type)}])},[o("span",qt,x(z(s.timestamp)),1),o("span",{class:S(["break-words leading-tight",{"text-blue-400":s.type==="info","text-green-400 font-medium":s.type==="success"||s.type==="chapter_completed","text-red-400 font-bold bg-red-900/10 px-1 rounded":s.type==="error","text-purple-400 font-bold":s.type==="stage","text-cyan-400":s.type==="chapter_progress","text-amber-400":s.type==="mining","text-pink-400":s.type==="conversion","text-gray-300":!s.type}])},[s.type==="stage"?(p(),y("span",Ot,"$")):k("",!0),P(" "+x(s.message),1)],2)],2))),128)),l[17]||(l[17]=o("div",{key:"cursor",class:"h-4 w-2 bg-gray-500 animate-pulse mt-2 inline-block"},null,-1))]),_:1})])]),_:1})])])])])]),h(Ee,{open:i(V),"current-balance":0,"required-words":i(K),"action-description":i(se),"onUpdate:open":l[1]||(l[1]=s=>V.value=s),onClose:i(Q)},null,8,["open","required-words","action-description","onClose"])]),_:1},8,["title"]))}}),yr=Ye(Bt,[["__scopeId","data-v-97ffb228"]]);export{yr as default};
