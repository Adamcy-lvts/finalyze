import{ak as ai,b as Q,U as bt,d as Pg,S as Fg,t as li,e as dr,p as Au,T as ra,a4 as Wg,c as at,o as re,k as S,g as b,u as g,a0 as Bg,j as oe,X as Qt,z as me,y as wn,i as lt,f as ft,n as Gn,aa as ia,F as Ug}from"./app-C4Yg38RJ.js";import{t as te}from"./index-C7EEW2-P.js";import{_ as xe}from"./index-D5k4420Y.js";import{_ as Dg}from"./index-Bwvau0Ya.js";import{_ as Wt}from"./Separator.vue_vue_type_script_setup_true_lang-Z9Nd3zlo.js";import{_ as zg}from"./Progress.vue_vue_type_script_setup_true_lang-BLXPTf21.js";import{aa as Ng}from"./RichTextEditor-UCZfYbOg.js";import{d as Vt,u as $g,a as kg,c as Gg,b as qg,_ as Hg,M as Kg}from"./useManualEditorSuggestions-D5uiyREU.js";import{_ as Yg}from"./ChapterNavigation.vue_vue_type_script_setup_true_lang-C8y6jX27.js";import{u as Zg,M as Jg,a as Xg,P as Qg,_ as Vg,b as ua}from"./useTextHistory-BK-KoLAX.js";import{_ as jg}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CF7qarPd.js";import{e as e_}from"./WordBalanceDisplay.vue_vue_type_script_setup_true_lang-5leGFbHt.js";import{r as Tu,u as t_}from"./useWordBalance-BDf4wK_z.js";import{_ as n_}from"./PurchaseModal.vue_vue_type_script_setup_true_lang-DHfiJ_fK.js";import{A as oa}from"./arrow-left-5P1B6ZPc.js";import{M as r_}from"./menu-DWOAWLfo.js";import{S as Eu}from"./save-6DaTu7NN.js";import{M as sa}from"./message-square-DL76dtXI.js";import{C as i_}from"./chevron-left-CIXsyiyM.js";import{C as u_}from"./chevron-right-DWz1EY8d.js";import{a as o_,P as s_}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-BIK8O0Qc.js";import{L as a_}from"./loader-circle-D0mA_mCq.js";import{M as l_,S as f_}from"./sun-C9T5JmNf.js";import{M as c_}from"./minimize-2-CV7CNtq0.js";import{B as h_}from"./brain-BJCA96Mb.js";import{C as d_}from"./circle-check-big-DAHts8Q9.js";import{_ as p_}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-BVtTWkvO.js";import"./Separator-BFlEuDhk.js";import"./Presence-Bg4JRrHR.js";import"./useForwardExpose-B0LRJfHl.js";import"./nullish-CHIgUVhi.js";import"./purify.es-DxJI3Wx7.js";import"./index-BWEDi_FC.js";import"./step-DrZ9DcYd.js";import"./chart-column-CBvQpicn.js";import"./calendar-D6kMWK1-.js";import"./users-D8JdotqH.js";import"./circle-alert-C9OagM7Y.js";import"./eye-DWbenqO0.js";import"./check-NjhrG_Ed.js";import"./type-C3pA5IMm.js";import"./download-BwFq65nG.js";import"./trash-2-mqN3ZeR-.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-D7mpGJIc.js";import"./DialogTitle-BhsPRZdQ.js";import"./x-CpmNAXg6.js";import"./DialogDescription.vue_vue_type_script_setup_true_lang-DuCwZhx2.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-Dmitwsg3.js";import"./Input.vue_vue_type_script_setup_true_lang-B_hbsX1Z.js";import"./Label.vue_vue_type_script_setup_true_lang-C0GS_IoN.js";import"./minus-KBh4sp4X.js";import"./plus-C3vmXQEs.js";import"./list-BXt-O05F.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-TUg2c5sd.js";import"./SafeHtmlText.vue_vue_type_script_setup_true_lang-QFivA_Ft.js";import"./lightbulb-B_SdX3s4.js";import"./chevron-down-DZu_M8WP.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-CH2qJBJt.js";import"./ohash.D__AXeF1-C-E83dC9.js";import"./VisuallyHiddenInput-xDJyy767.js";import"./VisuallyHidden-ClD5PwBy.js";import"./RovingFocusItem-3cLQFLJh.js";import"./target-B1UY1Tl9.js";import"./circle-D7kYcoEL.js";import"./sparkles-kjhXVihk.js";import"./DefensePreparationPanel.vue_vue_type_script_setup_true_lang-D_KsBL7T.js";import"./index-rVVA8_vj.js";import"./CardContent.vue_vue_type_script_setup_true_lang-CDIY1Fom.js";import"./CardTitle.vue_vue_type_script_setup_true_lang-Dgp96WVn.js";import"./ScrollArea.vue_vue_type_script_setup_true_lang-DmgOws5s.js";import"./useNonce-ByL5GjBB.js";import"./Switch.vue_vue_type_script_setup_true_lang-D3Pg6Qmp.js";import"./refresh-cw-Bz_MNg1I.js";import"./DialogTrigger-TZrKBRdw.js";import"./lock-BR6tBuSp.js";import"./book-open-OrFrSF-d.js";import"./search-BKIO81nh.js";import"./file-text-VIk9l4Ed.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-DGA408pa.js";import"./coins-CPkLLPmI.js";import"./arrow-right-CTr1CAIU.js";var pr={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var g_=pr.exports,aa;function __(){return aa||(aa=1,(function(ct,R){(function(){var s,le="4.17.21",Ct=200,jt="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",de="Expected a function",en="Invalid `variable` option passed into `_.template`",je="__lodash_hash_undefined__",yn=500,et="__lodash_placeholder__",N=1,ht=2,fe=4,tt=1,St=2,we=1,ke=2,j=4,Ce=8,dt=16,Te=32,pt=64,Ge=128,gt=256,bn=512,$=30,z="...",pe=800,We=16,Bt=1,_t=2,tn=3,Y=1/0,ge=9007199254740991,Z=17976931348623157e292,k=NaN,B=4294967295,qn=B-1,Cn=B>>>1,Ut=[["ary",Ge],["bind",we],["bindKey",ke],["curry",Ce],["curryRight",dt],["flip",bn],["partial",Te],["partialRight",pt],["rearg",gt]],qe="[object Arguments]",Re="[object Array]",Ru="[object AsyncFunction]",nt="[object Boolean]",nn="[object Date]",fi="[object DOMException]",rn="[object Error]",Sn="[object Function]",gr="[object GeneratorFunction]",Ie="[object Map]",un="[object Number]",ci="[object Null]",rt="[object Object]",_r="[object Promise]",vr="[object Proxy]",Dt="[object RegExp]",Le="[object Set]",zt="[object String]",on="[object Symbol]",hi="[object Undefined]",Nt="[object WeakMap]",mr="[object WeakSet]",sn="[object ArrayBuffer]",vt="[object DataView]",an="[object Float32Array]",ln="[object Float64Array]",At="[object Int8Array]",An="[object Int16Array]",En="[object Int32Array]",$t="[object Uint8Array]",Hn="[object Uint8ClampedArray]",p="[object Uint16Array]",m="[object Uint32Array]",I=/\b__p \+= '';/g,Tn=/\b(__p \+=) '' \+/g,Kn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Yn=/&(?:amp|lt|gt|quot|#39);/g,Zn=/[&<>"']/g,Jn=RegExp(Yn.source),Iu=RegExp(Zn.source),xr=/<%-([\s\S]+?)%>/g,Xn=/<%([\s\S]+?)%>/g,ce=/<%=([\s\S]+?)%>/g,Rn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,mt=/^\w*$/,fn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Qn=/[\\^$.*+?()[\]{}|]/g,di=RegExp(Qn.source),pi=/^\s+/,fa=/\s/,ca=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ha=/\{\n\/\* \[wrapped with (.+)\] \*/,da=/,? & /,pa=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ga=/[()=,{}\[\]\/\s]/,_a=/\\(\\)?/g,va=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Lu=/\w*$/,ma=/^[-+]0x[0-9a-f]+$/i,xa=/^0b[01]+$/i,wa=/^\[object .+?Constructor\]$/,ya=/^0o[0-7]+$/i,ba=/^(?:0|[1-9]\d*)$/,Ca=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,wr=/($^)/,Sa=/['\n\r\u2028\u2029\\]/g,yr="\\ud800-\\udfff",Aa="\\u0300-\\u036f",Ea="\\ufe20-\\ufe2f",Ta="\\u20d0-\\u20ff",Ou=Aa+Ea+Ta,Mu="\\u2700-\\u27bf",Pu="a-z\\xdf-\\xf6\\xf8-\\xff",Ra="\\xac\\xb1\\xd7\\xf7",Ia="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",La="\\u2000-\\u206f",Oa=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Fu="A-Z\\xc0-\\xd6\\xd8-\\xde",Wu="\\ufe0e\\ufe0f",Bu=Ra+Ia+La+Oa,gi="['’]",Ma="["+yr+"]",Uu="["+Bu+"]",br="["+Ou+"]",Du="\\d+",Pa="["+Mu+"]",zu="["+Pu+"]",Nu="[^"+yr+Bu+Du+Mu+Pu+Fu+"]",_i="\\ud83c[\\udffb-\\udfff]",Fa="(?:"+br+"|"+_i+")",$u="[^"+yr+"]",vi="(?:\\ud83c[\\udde6-\\uddff]){2}",mi="[\\ud800-\\udbff][\\udc00-\\udfff]",In="["+Fu+"]",ku="\\u200d",Gu="(?:"+zu+"|"+Nu+")",Wa="(?:"+In+"|"+Nu+")",qu="(?:"+gi+"(?:d|ll|m|re|s|t|ve))?",Hu="(?:"+gi+"(?:D|LL|M|RE|S|T|VE))?",Ku=Fa+"?",Yu="["+Wu+"]?",Ba="(?:"+ku+"(?:"+[$u,vi,mi].join("|")+")"+Yu+Ku+")*",Ua="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Da="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Zu=Yu+Ku+Ba,za="(?:"+[Pa,vi,mi].join("|")+")"+Zu,Na="(?:"+[$u+br+"?",br,vi,mi,Ma].join("|")+")",$a=RegExp(gi,"g"),ka=RegExp(br,"g"),xi=RegExp(_i+"(?="+_i+")|"+Na+Zu,"g"),Ga=RegExp([In+"?"+zu+"+"+qu+"(?="+[Uu,In,"$"].join("|")+")",Wa+"+"+Hu+"(?="+[Uu,In+Gu,"$"].join("|")+")",In+"?"+Gu+"+"+qu,In+"+"+Hu,Da,Ua,Du,za].join("|"),"g"),qa=RegExp("["+ku+yr+Ou+Wu+"]"),Ha=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ka=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ya=-1,X={};X[an]=X[ln]=X[At]=X[An]=X[En]=X[$t]=X[Hn]=X[p]=X[m]=!0,X[qe]=X[Re]=X[sn]=X[nt]=X[vt]=X[nn]=X[rn]=X[Sn]=X[Ie]=X[un]=X[rt]=X[Dt]=X[Le]=X[zt]=X[Nt]=!1;var J={};J[qe]=J[Re]=J[sn]=J[vt]=J[nt]=J[nn]=J[an]=J[ln]=J[At]=J[An]=J[En]=J[Ie]=J[un]=J[rt]=J[Dt]=J[Le]=J[zt]=J[on]=J[$t]=J[Hn]=J[p]=J[m]=!0,J[rn]=J[Sn]=J[Nt]=!1;var Za={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Ja={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Xa={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Qa={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Va=parseFloat,ja=parseInt,Ju=typeof ai=="object"&&ai&&ai.Object===Object&&ai,el=typeof self=="object"&&self&&self.Object===Object&&self,_e=Ju||el||Function("return this")(),wi=R&&!R.nodeType&&R,cn=wi&&!0&&ct&&!ct.nodeType&&ct,Xu=cn&&cn.exports===wi,yi=Xu&&Ju.process,He=(function(){try{var f=cn&&cn.require&&cn.require("util").types;return f||yi&&yi.binding&&yi.binding("util")}catch{}})(),Qu=He&&He.isArrayBuffer,Vu=He&&He.isDate,ju=He&&He.isMap,eo=He&&He.isRegExp,to=He&&He.isSet,no=He&&He.isTypedArray;function Be(f,d,h){switch(h.length){case 0:return f.call(d);case 1:return f.call(d,h[0]);case 2:return f.call(d,h[0],h[1]);case 3:return f.call(d,h[0],h[1],h[2])}return f.apply(d,h)}function tl(f,d,h,y){for(var L=-1,G=f==null?0:f.length;++L<G;){var se=f[L];d(y,se,h(se),f)}return y}function Ke(f,d){for(var h=-1,y=f==null?0:f.length;++h<y&&d(f[h],h,f)!==!1;);return f}function nl(f,d){for(var h=f==null?0:f.length;h--&&d(f[h],h,f)!==!1;);return f}function ro(f,d){for(var h=-1,y=f==null?0:f.length;++h<y;)if(!d(f[h],h,f))return!1;return!0}function kt(f,d){for(var h=-1,y=f==null?0:f.length,L=0,G=[];++h<y;){var se=f[h];d(se,h,f)&&(G[L++]=se)}return G}function Cr(f,d){var h=f==null?0:f.length;return!!h&&Ln(f,d,0)>-1}function bi(f,d,h){for(var y=-1,L=f==null?0:f.length;++y<L;)if(h(d,f[y]))return!0;return!1}function V(f,d){for(var h=-1,y=f==null?0:f.length,L=Array(y);++h<y;)L[h]=d(f[h],h,f);return L}function Gt(f,d){for(var h=-1,y=d.length,L=f.length;++h<y;)f[L+h]=d[h];return f}function Ci(f,d,h,y){var L=-1,G=f==null?0:f.length;for(y&&G&&(h=f[++L]);++L<G;)h=d(h,f[L],L,f);return h}function rl(f,d,h,y){var L=f==null?0:f.length;for(y&&L&&(h=f[--L]);L--;)h=d(h,f[L],L,f);return h}function Si(f,d){for(var h=-1,y=f==null?0:f.length;++h<y;)if(d(f[h],h,f))return!0;return!1}var il=Ai("length");function ul(f){return f.split("")}function ol(f){return f.match(pa)||[]}function io(f,d,h){var y;return h(f,function(L,G,se){if(d(L,G,se))return y=G,!1}),y}function Sr(f,d,h,y){for(var L=f.length,G=h+(y?1:-1);y?G--:++G<L;)if(d(f[G],G,f))return G;return-1}function Ln(f,d,h){return d===d?ml(f,d,h):Sr(f,uo,h)}function sl(f,d,h,y){for(var L=h-1,G=f.length;++L<G;)if(y(f[L],d))return L;return-1}function uo(f){return f!==f}function oo(f,d){var h=f==null?0:f.length;return h?Ti(f,d)/h:k}function Ai(f){return function(d){return d==null?s:d[f]}}function Ei(f){return function(d){return f==null?s:f[d]}}function so(f,d,h,y,L){return L(f,function(G,se,K){h=y?(y=!1,G):d(h,G,se,K)}),h}function al(f,d){var h=f.length;for(f.sort(d);h--;)f[h]=f[h].value;return f}function Ti(f,d){for(var h,y=-1,L=f.length;++y<L;){var G=d(f[y]);G!==s&&(h=h===s?G:h+G)}return h}function Ri(f,d){for(var h=-1,y=Array(f);++h<f;)y[h]=d(h);return y}function ll(f,d){return V(d,function(h){return[h,f[h]]})}function ao(f){return f&&f.slice(0,ho(f)+1).replace(pi,"")}function Ue(f){return function(d){return f(d)}}function Ii(f,d){return V(d,function(h){return f[h]})}function Vn(f,d){return f.has(d)}function lo(f,d){for(var h=-1,y=f.length;++h<y&&Ln(d,f[h],0)>-1;);return h}function fo(f,d){for(var h=f.length;h--&&Ln(d,f[h],0)>-1;);return h}function fl(f,d){for(var h=f.length,y=0;h--;)f[h]===d&&++y;return y}var cl=Ei(Za),hl=Ei(Ja);function dl(f){return"\\"+Qa[f]}function pl(f,d){return f==null?s:f[d]}function On(f){return qa.test(f)}function gl(f){return Ha.test(f)}function _l(f){for(var d,h=[];!(d=f.next()).done;)h.push(d.value);return h}function Li(f){var d=-1,h=Array(f.size);return f.forEach(function(y,L){h[++d]=[L,y]}),h}function co(f,d){return function(h){return f(d(h))}}function qt(f,d){for(var h=-1,y=f.length,L=0,G=[];++h<y;){var se=f[h];(se===d||se===et)&&(f[h]=et,G[L++]=h)}return G}function Ar(f){var d=-1,h=Array(f.size);return f.forEach(function(y){h[++d]=y}),h}function vl(f){var d=-1,h=Array(f.size);return f.forEach(function(y){h[++d]=[y,y]}),h}function ml(f,d,h){for(var y=h-1,L=f.length;++y<L;)if(f[y]===d)return y;return-1}function xl(f,d,h){for(var y=h+1;y--;)if(f[y]===d)return y;return y}function Mn(f){return On(f)?yl(f):il(f)}function it(f){return On(f)?bl(f):ul(f)}function ho(f){for(var d=f.length;d--&&fa.test(f.charAt(d)););return d}var wl=Ei(Xa);function yl(f){for(var d=xi.lastIndex=0;xi.test(f);)++d;return d}function bl(f){return f.match(xi)||[]}function Cl(f){return f.match(Ga)||[]}var Sl=(function f(d){d=d==null?_e:Pn.defaults(_e.Object(),d,Pn.pick(_e,Ka));var h=d.Array,y=d.Date,L=d.Error,G=d.Function,se=d.Math,K=d.Object,Oi=d.RegExp,Al=d.String,Ye=d.TypeError,Er=h.prototype,El=G.prototype,Fn=K.prototype,Tr=d["__core-js_shared__"],Rr=El.toString,H=Fn.hasOwnProperty,Tl=0,po=(function(){var e=/[^.]+$/.exec(Tr&&Tr.keys&&Tr.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""})(),Ir=Fn.toString,Rl=Rr.call(K),Il=_e._,Ll=Oi("^"+Rr.call(H).replace(Qn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Lr=Xu?d.Buffer:s,Ht=d.Symbol,Or=d.Uint8Array,go=Lr?Lr.allocUnsafe:s,Mr=co(K.getPrototypeOf,K),_o=K.create,vo=Fn.propertyIsEnumerable,Pr=Er.splice,mo=Ht?Ht.isConcatSpreadable:s,jn=Ht?Ht.iterator:s,hn=Ht?Ht.toStringTag:s,Fr=(function(){try{var e=vn(K,"defineProperty");return e({},"",{}),e}catch{}})(),Ol=d.clearTimeout!==_e.clearTimeout&&d.clearTimeout,Ml=y&&y.now!==_e.Date.now&&y.now,Pl=d.setTimeout!==_e.setTimeout&&d.setTimeout,Wr=se.ceil,Br=se.floor,Mi=K.getOwnPropertySymbols,Fl=Lr?Lr.isBuffer:s,xo=d.isFinite,Wl=Er.join,Bl=co(K.keys,K),ae=se.max,ye=se.min,Ul=y.now,Dl=d.parseInt,wo=se.random,zl=Er.reverse,Pi=vn(d,"DataView"),er=vn(d,"Map"),Fi=vn(d,"Promise"),Wn=vn(d,"Set"),tr=vn(d,"WeakMap"),nr=vn(K,"create"),Ur=tr&&new tr,Bn={},Nl=mn(Pi),$l=mn(er),kl=mn(Fi),Gl=mn(Wn),ql=mn(tr),Dr=Ht?Ht.prototype:s,rr=Dr?Dr.valueOf:s,yo=Dr?Dr.toString:s;function u(e){if(ne(e)&&!O(e)&&!(e instanceof U)){if(e instanceof Ze)return e;if(H.call(e,"__wrapped__"))return bs(e)}return new Ze(e)}var Un=(function(){function e(){}return function(t){if(!ee(t))return{};if(_o)return _o(t);e.prototype=t;var n=new e;return e.prototype=s,n}})();function zr(){}function Ze(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=s}u.templateSettings={escape:xr,evaluate:Xn,interpolate:ce,variable:"",imports:{_:u}},u.prototype=zr.prototype,u.prototype.constructor=u,Ze.prototype=Un(zr.prototype),Ze.prototype.constructor=Ze;function U(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=B,this.__views__=[]}function Hl(){var e=new U(this.__wrapped__);return e.__actions__=Oe(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Oe(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Oe(this.__views__),e}function Kl(){if(this.__filtered__){var e=new U(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Yl(){var e=this.__wrapped__.value(),t=this.__dir__,n=O(e),r=t<0,i=n?e.length:0,o=oc(0,i,this.__views__),a=o.start,l=o.end,c=l-a,_=r?l:a-1,v=this.__iteratees__,x=v.length,w=0,C=ye(c,this.__takeCount__);if(!n||!r&&i==c&&C==c)return Ho(e,this.__actions__);var E=[];e:for(;c--&&w<C;){_+=t;for(var P=-1,T=e[_];++P<x;){var W=v[P],D=W.iteratee,Ne=W.type,Ee=D(T);if(Ne==_t)T=Ee;else if(!Ee){if(Ne==Bt)continue e;break e}}E[w++]=T}return E}U.prototype=Un(zr.prototype),U.prototype.constructor=U;function dn(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Zl(){this.__data__=nr?nr(null):{},this.size=0}function Jl(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Xl(e){var t=this.__data__;if(nr){var n=t[e];return n===je?s:n}return H.call(t,e)?t[e]:s}function Ql(e){var t=this.__data__;return nr?t[e]!==s:H.call(t,e)}function Vl(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=nr&&t===s?je:t,this}dn.prototype.clear=Zl,dn.prototype.delete=Jl,dn.prototype.get=Xl,dn.prototype.has=Ql,dn.prototype.set=Vl;function Et(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function jl(){this.__data__=[],this.size=0}function ef(e){var t=this.__data__,n=Nr(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():Pr.call(t,n,1),--this.size,!0}function tf(e){var t=this.__data__,n=Nr(t,e);return n<0?s:t[n][1]}function nf(e){return Nr(this.__data__,e)>-1}function rf(e,t){var n=this.__data__,r=Nr(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}Et.prototype.clear=jl,Et.prototype.delete=ef,Et.prototype.get=tf,Et.prototype.has=nf,Et.prototype.set=rf;function Tt(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function uf(){this.size=0,this.__data__={hash:new dn,map:new(er||Et),string:new dn}}function of(e){var t=Vr(this,e).delete(e);return this.size-=t?1:0,t}function sf(e){return Vr(this,e).get(e)}function af(e){return Vr(this,e).has(e)}function lf(e,t){var n=Vr(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}Tt.prototype.clear=uf,Tt.prototype.delete=of,Tt.prototype.get=sf,Tt.prototype.has=af,Tt.prototype.set=lf;function pn(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new Tt;++t<n;)this.add(e[t])}function ff(e){return this.__data__.set(e,je),this}function cf(e){return this.__data__.has(e)}pn.prototype.add=pn.prototype.push=ff,pn.prototype.has=cf;function ut(e){var t=this.__data__=new Et(e);this.size=t.size}function hf(){this.__data__=new Et,this.size=0}function df(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function pf(e){return this.__data__.get(e)}function gf(e){return this.__data__.has(e)}function _f(e,t){var n=this.__data__;if(n instanceof Et){var r=n.__data__;if(!er||r.length<Ct-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Tt(r)}return n.set(e,t),this.size=n.size,this}ut.prototype.clear=hf,ut.prototype.delete=df,ut.prototype.get=pf,ut.prototype.has=gf,ut.prototype.set=_f;function bo(e,t){var n=O(e),r=!n&&xn(e),i=!n&&!r&&Xt(e),o=!n&&!r&&!i&&$n(e),a=n||r||i||o,l=a?Ri(e.length,Al):[],c=l.length;for(var _ in e)(t||H.call(e,_))&&!(a&&(_=="length"||i&&(_=="offset"||_=="parent")||o&&(_=="buffer"||_=="byteLength"||_=="byteOffset")||Ot(_,c)))&&l.push(_);return l}function Co(e){var t=e.length;return t?e[Hi(0,t-1)]:s}function vf(e,t){return jr(Oe(e),gn(t,0,e.length))}function mf(e){return jr(Oe(e))}function Wi(e,t,n){(n!==s&&!ot(e[t],n)||n===s&&!(t in e))&&Rt(e,t,n)}function ir(e,t,n){var r=e[t];(!(H.call(e,t)&&ot(r,n))||n===s&&!(t in e))&&Rt(e,t,n)}function Nr(e,t){for(var n=e.length;n--;)if(ot(e[n][0],t))return n;return-1}function xf(e,t,n,r){return Kt(e,function(i,o,a){t(r,i,n(i),a)}),r}function So(e,t){return e&&wt(t,he(t),e)}function wf(e,t){return e&&wt(t,Pe(t),e)}function Rt(e,t,n){t=="__proto__"&&Fr?Fr(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Bi(e,t){for(var n=-1,r=t.length,i=h(r),o=e==null;++n<r;)i[n]=o?s:_u(e,t[n]);return i}function gn(e,t,n){return e===e&&(n!==s&&(e=e<=n?e:n),t!==s&&(e=e>=t?e:t)),e}function Je(e,t,n,r,i,o){var a,l=t&N,c=t&ht,_=t&fe;if(n&&(a=i?n(e,r,i,o):n(e)),a!==s)return a;if(!ee(e))return e;var v=O(e);if(v){if(a=ac(e),!l)return Oe(e,a)}else{var x=be(e),w=x==Sn||x==gr;if(Xt(e))return Zo(e,l);if(x==rt||x==qe||w&&!i){if(a=c||w?{}:ds(e),!l)return c?Qf(e,wf(a,e)):Xf(e,So(a,e))}else{if(!J[x])return i?e:{};a=lc(e,x,l)}}o||(o=new ut);var C=o.get(e);if(C)return C;o.set(e,a),ks(e)?e.forEach(function(T){a.add(Je(T,t,n,T,e,o))}):Ns(e)&&e.forEach(function(T,W){a.set(W,Je(T,t,n,W,e,o))});var E=_?c?nu:tu:c?Pe:he,P=v?s:E(e);return Ke(P||e,function(T,W){P&&(W=T,T=e[W]),ir(a,W,Je(T,t,n,W,e,o))}),a}function yf(e){var t=he(e);return function(n){return Ao(n,e,t)}}function Ao(e,t,n){var r=n.length;if(e==null)return!r;for(e=K(e);r--;){var i=n[r],o=t[i],a=e[i];if(a===s&&!(i in e)||!o(a))return!1}return!0}function Eo(e,t,n){if(typeof e!="function")throw new Ye(de);return cr(function(){e.apply(s,n)},t)}function ur(e,t,n,r){var i=-1,o=Cr,a=!0,l=e.length,c=[],_=t.length;if(!l)return c;n&&(t=V(t,Ue(n))),r?(o=bi,a=!1):t.length>=Ct&&(o=Vn,a=!1,t=new pn(t));e:for(;++i<l;){var v=e[i],x=n==null?v:n(v);if(v=r||v!==0?v:0,a&&x===x){for(var w=_;w--;)if(t[w]===x)continue e;c.push(v)}else o(t,x,r)||c.push(v)}return c}var Kt=jo(xt),To=jo(Di,!0);function bf(e,t){var n=!0;return Kt(e,function(r,i,o){return n=!!t(r,i,o),n}),n}function $r(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],a=t(o);if(a!=null&&(l===s?a===a&&!ze(a):n(a,l)))var l=a,c=o}return c}function Cf(e,t,n,r){var i=e.length;for(n=M(n),n<0&&(n=-n>i?0:i+n),r=r===s||r>i?i:M(r),r<0&&(r+=i),r=n>r?0:qs(r);n<r;)e[n++]=t;return e}function Ro(e,t){var n=[];return Kt(e,function(r,i,o){t(r,i,o)&&n.push(r)}),n}function ve(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=cc),i||(i=[]);++o<a;){var l=e[o];t>0&&n(l)?t>1?ve(l,t-1,n,r,i):Gt(i,l):r||(i[i.length]=l)}return i}var Ui=es(),Io=es(!0);function xt(e,t){return e&&Ui(e,t,he)}function Di(e,t){return e&&Io(e,t,he)}function kr(e,t){return kt(t,function(n){return Mt(e[n])})}function _n(e,t){t=Zt(t,e);for(var n=0,r=t.length;e!=null&&n<r;)e=e[yt(t[n++])];return n&&n==r?e:s}function Lo(e,t,n){var r=t(e);return O(e)?r:Gt(r,n(e))}function Se(e){return e==null?e===s?hi:ci:hn&&hn in K(e)?uc(e):mc(e)}function zi(e,t){return e>t}function Sf(e,t){return e!=null&&H.call(e,t)}function Af(e,t){return e!=null&&t in K(e)}function Ef(e,t,n){return e>=ye(t,n)&&e<ae(t,n)}function Ni(e,t,n){for(var r=n?bi:Cr,i=e[0].length,o=e.length,a=o,l=h(o),c=1/0,_=[];a--;){var v=e[a];a&&t&&(v=V(v,Ue(t))),c=ye(v.length,c),l[a]=!n&&(t||i>=120&&v.length>=120)?new pn(a&&v):s}v=e[0];var x=-1,w=l[0];e:for(;++x<i&&_.length<c;){var C=v[x],E=t?t(C):C;if(C=n||C!==0?C:0,!(w?Vn(w,E):r(_,E,n))){for(a=o;--a;){var P=l[a];if(!(P?Vn(P,E):r(e[a],E,n)))continue e}w&&w.push(E),_.push(C)}}return _}function Tf(e,t,n,r){return xt(e,function(i,o,a){t(r,n(i),o,a)}),r}function or(e,t,n){t=Zt(t,e),e=vs(e,t);var r=e==null?e:e[yt(Qe(t))];return r==null?s:Be(r,e,n)}function Oo(e){return ne(e)&&Se(e)==qe}function Rf(e){return ne(e)&&Se(e)==sn}function If(e){return ne(e)&&Se(e)==nn}function sr(e,t,n,r,i){return e===t?!0:e==null||t==null||!ne(e)&&!ne(t)?e!==e&&t!==t:Lf(e,t,n,r,sr,i)}function Lf(e,t,n,r,i,o){var a=O(e),l=O(t),c=a?Re:be(e),_=l?Re:be(t);c=c==qe?rt:c,_=_==qe?rt:_;var v=c==rt,x=_==rt,w=c==_;if(w&&Xt(e)){if(!Xt(t))return!1;a=!0,v=!1}if(w&&!v)return o||(o=new ut),a||$n(e)?fs(e,t,n,r,i,o):rc(e,t,c,n,r,i,o);if(!(n&tt)){var C=v&&H.call(e,"__wrapped__"),E=x&&H.call(t,"__wrapped__");if(C||E){var P=C?e.value():e,T=E?t.value():t;return o||(o=new ut),i(P,T,n,r,o)}}return w?(o||(o=new ut),ic(e,t,n,r,i,o)):!1}function Of(e){return ne(e)&&be(e)==Ie}function $i(e,t,n,r){var i=n.length,o=i,a=!r;if(e==null)return!o;for(e=K(e);i--;){var l=n[i];if(a&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++i<o;){l=n[i];var c=l[0],_=e[c],v=l[1];if(a&&l[2]){if(_===s&&!(c in e))return!1}else{var x=new ut;if(r)var w=r(_,v,c,e,t,x);if(!(w===s?sr(v,_,tt|St,r,x):w))return!1}}return!0}function Mo(e){if(!ee(e)||dc(e))return!1;var t=Mt(e)?Ll:wa;return t.test(mn(e))}function Mf(e){return ne(e)&&Se(e)==Dt}function Pf(e){return ne(e)&&be(e)==Le}function Ff(e){return ne(e)&&ui(e.length)&&!!X[Se(e)]}function Po(e){return typeof e=="function"?e:e==null?Fe:typeof e=="object"?O(e)?Bo(e[0],e[1]):Wo(e):ta(e)}function ki(e){if(!fr(e))return Bl(e);var t=[];for(var n in K(e))H.call(e,n)&&n!="constructor"&&t.push(n);return t}function Wf(e){if(!ee(e))return vc(e);var t=fr(e),n=[];for(var r in e)r=="constructor"&&(t||!H.call(e,r))||n.push(r);return n}function Gi(e,t){return e<t}function Fo(e,t){var n=-1,r=Me(e)?h(e.length):[];return Kt(e,function(i,o,a){r[++n]=t(i,o,a)}),r}function Wo(e){var t=iu(e);return t.length==1&&t[0][2]?gs(t[0][0],t[0][1]):function(n){return n===e||$i(n,e,t)}}function Bo(e,t){return ou(e)&&ps(t)?gs(yt(e),t):function(n){var r=_u(n,e);return r===s&&r===t?vu(n,e):sr(t,r,tt|St)}}function Gr(e,t,n,r,i){e!==t&&Ui(t,function(o,a){if(i||(i=new ut),ee(o))Bf(e,t,a,n,Gr,r,i);else{var l=r?r(au(e,a),o,a+"",e,t,i):s;l===s&&(l=o),Wi(e,a,l)}},Pe)}function Bf(e,t,n,r,i,o,a){var l=au(e,n),c=au(t,n),_=a.get(c);if(_){Wi(e,n,_);return}var v=o?o(l,c,n+"",e,t,a):s,x=v===s;if(x){var w=O(c),C=!w&&Xt(c),E=!w&&!C&&$n(c);v=c,w||C||E?O(l)?v=l:ie(l)?v=Oe(l):C?(x=!1,v=Zo(c,!0)):E?(x=!1,v=Jo(c,!0)):v=[]:hr(c)||xn(c)?(v=l,xn(l)?v=Hs(l):(!ee(l)||Mt(l))&&(v=ds(c))):x=!1}x&&(a.set(c,v),i(v,c,r,o,a),a.delete(c)),Wi(e,n,v)}function Uo(e,t){var n=e.length;if(n)return t+=t<0?n:0,Ot(t,n)?e[t]:s}function Do(e,t,n){t.length?t=V(t,function(o){return O(o)?function(a){return _n(a,o.length===1?o[0]:o)}:o}):t=[Fe];var r=-1;t=V(t,Ue(A()));var i=Fo(e,function(o,a,l){var c=V(t,function(_){return _(o)});return{criteria:c,index:++r,value:o}});return al(i,function(o,a){return Jf(o,a,n)})}function Uf(e,t){return zo(e,t,function(n,r){return vu(e,r)})}function zo(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],l=_n(e,a);n(l,a)&&ar(o,Zt(a,e),l)}return o}function Df(e){return function(t){return _n(t,e)}}function qi(e,t,n,r){var i=r?sl:Ln,o=-1,a=t.length,l=e;for(e===t&&(t=Oe(t)),n&&(l=V(e,Ue(n)));++o<a;)for(var c=0,_=t[o],v=n?n(_):_;(c=i(l,v,c,r))>-1;)l!==e&&Pr.call(l,c,1),Pr.call(e,c,1);return e}function No(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;Ot(i)?Pr.call(e,i,1):Zi(e,i)}}return e}function Hi(e,t){return e+Br(wo()*(t-e+1))}function zf(e,t,n,r){for(var i=-1,o=ae(Wr((t-e)/(n||1)),0),a=h(o);o--;)a[r?o:++i]=e,e+=n;return a}function Ki(e,t){var n="";if(!e||t<1||t>ge)return n;do t%2&&(n+=e),t=Br(t/2),t&&(e+=e);while(t);return n}function F(e,t){return lu(_s(e,t,Fe),e+"")}function Nf(e){return Co(kn(e))}function $f(e,t){var n=kn(e);return jr(n,gn(t,0,n.length))}function ar(e,t,n,r){if(!ee(e))return e;t=Zt(t,e);for(var i=-1,o=t.length,a=o-1,l=e;l!=null&&++i<o;){var c=yt(t[i]),_=n;if(c==="__proto__"||c==="constructor"||c==="prototype")return e;if(i!=a){var v=l[c];_=r?r(v,c,l):s,_===s&&(_=ee(v)?v:Ot(t[i+1])?[]:{})}ir(l,c,_),l=l[c]}return e}var $o=Ur?function(e,t){return Ur.set(e,t),e}:Fe,kf=Fr?function(e,t){return Fr(e,"toString",{configurable:!0,enumerable:!1,value:xu(t),writable:!0})}:Fe;function Gf(e){return jr(kn(e))}function Xe(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),n=n>i?i:n,n<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=h(i);++r<i;)o[r]=e[r+t];return o}function qf(e,t){var n;return Kt(e,function(r,i,o){return n=t(r,i,o),!n}),!!n}function qr(e,t,n){var r=0,i=e==null?r:e.length;if(typeof t=="number"&&t===t&&i<=Cn){for(;r<i;){var o=r+i>>>1,a=e[o];a!==null&&!ze(a)&&(n?a<=t:a<t)?r=o+1:i=o}return i}return Yi(e,t,Fe,n)}function Yi(e,t,n,r){var i=0,o=e==null?0:e.length;if(o===0)return 0;t=n(t);for(var a=t!==t,l=t===null,c=ze(t),_=t===s;i<o;){var v=Br((i+o)/2),x=n(e[v]),w=x!==s,C=x===null,E=x===x,P=ze(x);if(a)var T=r||E;else _?T=E&&(r||w):l?T=E&&w&&(r||!C):c?T=E&&w&&!C&&(r||!P):C||P?T=!1:T=r?x<=t:x<t;T?i=v+1:o=v}return ye(o,qn)}function ko(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n],l=t?t(a):a;if(!n||!ot(l,c)){var c=l;o[i++]=a===0?0:a}}return o}function Go(e){return typeof e=="number"?e:ze(e)?k:+e}function De(e){if(typeof e=="string")return e;if(O(e))return V(e,De)+"";if(ze(e))return yo?yo.call(e):"";var t=e+"";return t=="0"&&1/e==-Y?"-0":t}function Yt(e,t,n){var r=-1,i=Cr,o=e.length,a=!0,l=[],c=l;if(n)a=!1,i=bi;else if(o>=Ct){var _=t?null:tc(e);if(_)return Ar(_);a=!1,i=Vn,c=new pn}else c=t?[]:l;e:for(;++r<o;){var v=e[r],x=t?t(v):v;if(v=n||v!==0?v:0,a&&x===x){for(var w=c.length;w--;)if(c[w]===x)continue e;t&&c.push(x),l.push(v)}else i(c,x,n)||(c!==l&&c.push(x),l.push(v))}return l}function Zi(e,t){return t=Zt(t,e),e=vs(e,t),e==null||delete e[yt(Qe(t))]}function qo(e,t,n,r){return ar(e,t,n(_n(e,t)),r)}function Hr(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?Xe(e,r?0:o,r?o+1:i):Xe(e,r?o+1:0,r?i:o)}function Ho(e,t){var n=e;return n instanceof U&&(n=n.value()),Ci(t,function(r,i){return i.func.apply(i.thisArg,Gt([r],i.args))},n)}function Ji(e,t,n){var r=e.length;if(r<2)return r?Yt(e[0]):[];for(var i=-1,o=h(r);++i<r;)for(var a=e[i],l=-1;++l<r;)l!=i&&(o[i]=ur(o[i]||a,e[l],t,n));return Yt(ve(o,1),t,n)}function Ko(e,t,n){for(var r=-1,i=e.length,o=t.length,a={};++r<i;){var l=r<o?t[r]:s;n(a,e[r],l)}return a}function Xi(e){return ie(e)?e:[]}function Qi(e){return typeof e=="function"?e:Fe}function Zt(e,t){return O(e)?e:ou(e,t)?[e]:ys(q(e))}var Hf=F;function Jt(e,t,n){var r=e.length;return n=n===s?r:n,!t&&n>=r?e:Xe(e,t,n)}var Yo=Ol||function(e){return _e.clearTimeout(e)};function Zo(e,t){if(t)return e.slice();var n=e.length,r=go?go(n):new e.constructor(n);return e.copy(r),r}function Vi(e){var t=new e.constructor(e.byteLength);return new Or(t).set(new Or(e)),t}function Kf(e,t){var n=t?Vi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function Yf(e){var t=new e.constructor(e.source,Lu.exec(e));return t.lastIndex=e.lastIndex,t}function Zf(e){return rr?K(rr.call(e)):{}}function Jo(e,t){var n=t?Vi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Xo(e,t){if(e!==t){var n=e!==s,r=e===null,i=e===e,o=ze(e),a=t!==s,l=t===null,c=t===t,_=ze(t);if(!l&&!_&&!o&&e>t||o&&a&&c&&!l&&!_||r&&a&&c||!n&&c||!i)return 1;if(!r&&!o&&!_&&e<t||_&&n&&i&&!r&&!o||l&&n&&i||!a&&i||!c)return-1}return 0}function Jf(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,a=i.length,l=n.length;++r<a;){var c=Xo(i[r],o[r]);if(c){if(r>=l)return c;var _=n[r];return c*(_=="desc"?-1:1)}}return e.index-t.index}function Qo(e,t,n,r){for(var i=-1,o=e.length,a=n.length,l=-1,c=t.length,_=ae(o-a,0),v=h(c+_),x=!r;++l<c;)v[l]=t[l];for(;++i<a;)(x||i<o)&&(v[n[i]]=e[i]);for(;_--;)v[l++]=e[i++];return v}function Vo(e,t,n,r){for(var i=-1,o=e.length,a=-1,l=n.length,c=-1,_=t.length,v=ae(o-l,0),x=h(v+_),w=!r;++i<v;)x[i]=e[i];for(var C=i;++c<_;)x[C+c]=t[c];for(;++a<l;)(w||i<o)&&(x[C+n[a]]=e[i++]);return x}function Oe(e,t){var n=-1,r=e.length;for(t||(t=h(r));++n<r;)t[n]=e[n];return t}function wt(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var l=t[o],c=r?r(n[l],e[l],l,n,e):s;c===s&&(c=e[l]),i?Rt(n,l,c):ir(n,l,c)}return n}function Xf(e,t){return wt(e,uu(e),t)}function Qf(e,t){return wt(e,cs(e),t)}function Kr(e,t){return function(n,r){var i=O(n)?tl:xf,o=t?t():{};return i(n,e,A(r,2),o)}}function Dn(e){return F(function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:s,a=i>2?n[2]:s;for(o=e.length>3&&typeof o=="function"?(i--,o):s,a&&Ae(n[0],n[1],a)&&(o=i<3?s:o,i=1),t=K(t);++r<i;){var l=n[r];l&&e(t,l,r,o)}return t})}function jo(e,t){return function(n,r){if(n==null)return n;if(!Me(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=K(n);(t?o--:++o<i)&&r(a[o],o,a)!==!1;);return n}}function es(e){return function(t,n,r){for(var i=-1,o=K(t),a=r(t),l=a.length;l--;){var c=a[e?l:++i];if(n(o[c],c,o)===!1)break}return t}}function Vf(e,t,n){var r=t&we,i=lr(e);function o(){var a=this&&this!==_e&&this instanceof o?i:e;return a.apply(r?n:this,arguments)}return o}function ts(e){return function(t){t=q(t);var n=On(t)?it(t):s,r=n?n[0]:t.charAt(0),i=n?Jt(n,1).join(""):t.slice(1);return r[e]()+i}}function zn(e){return function(t){return Ci(js(Vs(t).replace($a,"")),e,"")}}function lr(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Un(e.prototype),r=e.apply(n,t);return ee(r)?r:n}}function jf(e,t,n){var r=lr(e);function i(){for(var o=arguments.length,a=h(o),l=o,c=Nn(i);l--;)a[l]=arguments[l];var _=o<3&&a[0]!==c&&a[o-1]!==c?[]:qt(a,c);if(o-=_.length,o<n)return os(e,t,Yr,i.placeholder,s,a,_,s,s,n-o);var v=this&&this!==_e&&this instanceof i?r:e;return Be(v,this,a)}return i}function ns(e){return function(t,n,r){var i=K(t);if(!Me(t)){var o=A(n,3);t=he(t),n=function(l){return o(i[l],l,i)}}var a=e(t,n,r);return a>-1?i[o?t[a]:a]:s}}function rs(e){return Lt(function(t){var n=t.length,r=n,i=Ze.prototype.thru;for(e&&t.reverse();r--;){var o=t[r];if(typeof o!="function")throw new Ye(de);if(i&&!a&&Qr(o)=="wrapper")var a=new Ze([],!0)}for(r=a?r:n;++r<n;){o=t[r];var l=Qr(o),c=l=="wrapper"?ru(o):s;c&&su(c[0])&&c[1]==(Ge|Ce|Te|gt)&&!c[4].length&&c[9]==1?a=a[Qr(c[0])].apply(a,c[3]):a=o.length==1&&su(o)?a[l]():a.thru(o)}return function(){var _=arguments,v=_[0];if(a&&_.length==1&&O(v))return a.plant(v).value();for(var x=0,w=n?t[x].apply(this,_):v;++x<n;)w=t[x].call(this,w);return w}})}function Yr(e,t,n,r,i,o,a,l,c,_){var v=t&Ge,x=t&we,w=t&ke,C=t&(Ce|dt),E=t&bn,P=w?s:lr(e);function T(){for(var W=arguments.length,D=h(W),Ne=W;Ne--;)D[Ne]=arguments[Ne];if(C)var Ee=Nn(T),$e=fl(D,Ee);if(r&&(D=Qo(D,r,i,C)),o&&(D=Vo(D,o,a,C)),W-=$e,C&&W<_){var ue=qt(D,Ee);return os(e,t,Yr,T.placeholder,n,D,ue,l,c,_-W)}var st=x?n:this,Ft=w?st[e]:e;return W=D.length,l?D=xc(D,l):E&&W>1&&D.reverse(),v&&c<W&&(D.length=c),this&&this!==_e&&this instanceof T&&(Ft=P||lr(Ft)),Ft.apply(st,D)}return T}function is(e,t){return function(n,r){return Tf(n,e,t(r),{})}}function Zr(e,t){return function(n,r){var i;if(n===s&&r===s)return t;if(n!==s&&(i=n),r!==s){if(i===s)return r;typeof n=="string"||typeof r=="string"?(n=De(n),r=De(r)):(n=Go(n),r=Go(r)),i=e(n,r)}return i}}function ji(e){return Lt(function(t){return t=V(t,Ue(A())),F(function(n){var r=this;return e(t,function(i){return Be(i,r,n)})})})}function Jr(e,t){t=t===s?" ":De(t);var n=t.length;if(n<2)return n?Ki(t,e):t;var r=Ki(t,Wr(e/Mn(t)));return On(t)?Jt(it(r),0,e).join(""):r.slice(0,e)}function ec(e,t,n,r){var i=t&we,o=lr(e);function a(){for(var l=-1,c=arguments.length,_=-1,v=r.length,x=h(v+c),w=this&&this!==_e&&this instanceof a?o:e;++_<v;)x[_]=r[_];for(;c--;)x[_++]=arguments[++l];return Be(w,i?n:this,x)}return a}function us(e){return function(t,n,r){return r&&typeof r!="number"&&Ae(t,n,r)&&(n=r=s),t=Pt(t),n===s?(n=t,t=0):n=Pt(n),r=r===s?t<n?1:-1:Pt(r),zf(t,n,r,e)}}function Xr(e){return function(t,n){return typeof t=="string"&&typeof n=="string"||(t=Ve(t),n=Ve(n)),e(t,n)}}function os(e,t,n,r,i,o,a,l,c,_){var v=t&Ce,x=v?a:s,w=v?s:a,C=v?o:s,E=v?s:o;t|=v?Te:pt,t&=~(v?pt:Te),t&j||(t&=-4);var P=[e,t,i,C,x,E,w,l,c,_],T=n.apply(s,P);return su(e)&&ms(T,P),T.placeholder=r,xs(T,e,t)}function eu(e){var t=se[e];return function(n,r){if(n=Ve(n),r=r==null?0:ye(M(r),292),r&&xo(n)){var i=(q(n)+"e").split("e"),o=t(i[0]+"e"+(+i[1]+r));return i=(q(o)+"e").split("e"),+(i[0]+"e"+(+i[1]-r))}return t(n)}}var tc=Wn&&1/Ar(new Wn([,-0]))[1]==Y?function(e){return new Wn(e)}:bu;function ss(e){return function(t){var n=be(t);return n==Ie?Li(t):n==Le?vl(t):ll(t,e(t))}}function It(e,t,n,r,i,o,a,l){var c=t&ke;if(!c&&typeof e!="function")throw new Ye(de);var _=r?r.length:0;if(_||(t&=-97,r=i=s),a=a===s?a:ae(M(a),0),l=l===s?l:M(l),_-=i?i.length:0,t&pt){var v=r,x=i;r=i=s}var w=c?s:ru(e),C=[e,t,n,r,i,v,x,o,a,l];if(w&&_c(C,w),e=C[0],t=C[1],n=C[2],r=C[3],i=C[4],l=C[9]=C[9]===s?c?0:e.length:ae(C[9]-_,0),!l&&t&(Ce|dt)&&(t&=-25),!t||t==we)var E=Vf(e,t,n);else t==Ce||t==dt?E=jf(e,t,l):(t==Te||t==(we|Te))&&!i.length?E=ec(e,t,n,r):E=Yr.apply(s,C);var P=w?$o:ms;return xs(P(E,C),e,t)}function as(e,t,n,r){return e===s||ot(e,Fn[n])&&!H.call(r,n)?t:e}function ls(e,t,n,r,i,o){return ee(e)&&ee(t)&&(o.set(t,e),Gr(e,t,s,ls,o),o.delete(t)),e}function nc(e){return hr(e)?s:e}function fs(e,t,n,r,i,o){var a=n&tt,l=e.length,c=t.length;if(l!=c&&!(a&&c>l))return!1;var _=o.get(e),v=o.get(t);if(_&&v)return _==t&&v==e;var x=-1,w=!0,C=n&St?new pn:s;for(o.set(e,t),o.set(t,e);++x<l;){var E=e[x],P=t[x];if(r)var T=a?r(P,E,x,t,e,o):r(E,P,x,e,t,o);if(T!==s){if(T)continue;w=!1;break}if(C){if(!Si(t,function(W,D){if(!Vn(C,D)&&(E===W||i(E,W,n,r,o)))return C.push(D)})){w=!1;break}}else if(!(E===P||i(E,P,n,r,o))){w=!1;break}}return o.delete(e),o.delete(t),w}function rc(e,t,n,r,i,o,a){switch(n){case vt:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case sn:return!(e.byteLength!=t.byteLength||!o(new Or(e),new Or(t)));case nt:case nn:case un:return ot(+e,+t);case rn:return e.name==t.name&&e.message==t.message;case Dt:case zt:return e==t+"";case Ie:var l=Li;case Le:var c=r&tt;if(l||(l=Ar),e.size!=t.size&&!c)return!1;var _=a.get(e);if(_)return _==t;r|=St,a.set(e,t);var v=fs(l(e),l(t),r,i,o,a);return a.delete(e),v;case on:if(rr)return rr.call(e)==rr.call(t)}return!1}function ic(e,t,n,r,i,o){var a=n&tt,l=tu(e),c=l.length,_=tu(t),v=_.length;if(c!=v&&!a)return!1;for(var x=c;x--;){var w=l[x];if(!(a?w in t:H.call(t,w)))return!1}var C=o.get(e),E=o.get(t);if(C&&E)return C==t&&E==e;var P=!0;o.set(e,t),o.set(t,e);for(var T=a;++x<c;){w=l[x];var W=e[w],D=t[w];if(r)var Ne=a?r(D,W,w,t,e,o):r(W,D,w,e,t,o);if(!(Ne===s?W===D||i(W,D,n,r,o):Ne)){P=!1;break}T||(T=w=="constructor")}if(P&&!T){var Ee=e.constructor,$e=t.constructor;Ee!=$e&&"constructor"in e&&"constructor"in t&&!(typeof Ee=="function"&&Ee instanceof Ee&&typeof $e=="function"&&$e instanceof $e)&&(P=!1)}return o.delete(e),o.delete(t),P}function Lt(e){return lu(_s(e,s,As),e+"")}function tu(e){return Lo(e,he,uu)}function nu(e){return Lo(e,Pe,cs)}var ru=Ur?function(e){return Ur.get(e)}:bu;function Qr(e){for(var t=e.name+"",n=Bn[t],r=H.call(Bn,t)?n.length:0;r--;){var i=n[r],o=i.func;if(o==null||o==e)return i.name}return t}function Nn(e){var t=H.call(u,"placeholder")?u:e;return t.placeholder}function A(){var e=u.iteratee||wu;return e=e===wu?Po:e,arguments.length?e(arguments[0],arguments[1]):e}function Vr(e,t){var n=e.__data__;return hc(t)?n[typeof t=="string"?"string":"hash"]:n.map}function iu(e){for(var t=he(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,ps(i)]}return t}function vn(e,t){var n=pl(e,t);return Mo(n)?n:s}function uc(e){var t=H.call(e,hn),n=e[hn];try{e[hn]=s;var r=!0}catch{}var i=Ir.call(e);return r&&(t?e[hn]=n:delete e[hn]),i}var uu=Mi?function(e){return e==null?[]:(e=K(e),kt(Mi(e),function(t){return vo.call(e,t)}))}:Cu,cs=Mi?function(e){for(var t=[];e;)Gt(t,uu(e)),e=Mr(e);return t}:Cu,be=Se;(Pi&&be(new Pi(new ArrayBuffer(1)))!=vt||er&&be(new er)!=Ie||Fi&&be(Fi.resolve())!=_r||Wn&&be(new Wn)!=Le||tr&&be(new tr)!=Nt)&&(be=function(e){var t=Se(e),n=t==rt?e.constructor:s,r=n?mn(n):"";if(r)switch(r){case Nl:return vt;case $l:return Ie;case kl:return _r;case Gl:return Le;case ql:return Nt}return t});function oc(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=ye(t,e+a);break;case"takeRight":e=ae(e,t-a);break}}return{start:e,end:t}}function sc(e){var t=e.match(ha);return t?t[1].split(da):[]}function hs(e,t,n){t=Zt(t,e);for(var r=-1,i=t.length,o=!1;++r<i;){var a=yt(t[r]);if(!(o=e!=null&&n(e,a)))break;e=e[a]}return o||++r!=i?o:(i=e==null?0:e.length,!!i&&ui(i)&&Ot(a,i)&&(O(e)||xn(e)))}function ac(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&H.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function ds(e){return typeof e.constructor=="function"&&!fr(e)?Un(Mr(e)):{}}function lc(e,t,n){var r=e.constructor;switch(t){case sn:return Vi(e);case nt:case nn:return new r(+e);case vt:return Kf(e,n);case an:case ln:case At:case An:case En:case $t:case Hn:case p:case m:return Jo(e,n);case Ie:return new r;case un:case zt:return new r(e);case Dt:return Yf(e);case Le:return new r;case on:return Zf(e)}}function fc(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(ca,`{
/* [wrapped with `+t+`] */
`)}function cc(e){return O(e)||xn(e)||!!(mo&&e&&e[mo])}function Ot(e,t){var n=typeof e;return t=t??ge,!!t&&(n=="number"||n!="symbol"&&ba.test(e))&&e>-1&&e%1==0&&e<t}function Ae(e,t,n){if(!ee(n))return!1;var r=typeof t;return(r=="number"?Me(n)&&Ot(t,n.length):r=="string"&&t in n)?ot(n[t],e):!1}function ou(e,t){if(O(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||ze(e)?!0:mt.test(e)||!Rn.test(e)||t!=null&&e in K(t)}function hc(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function su(e){var t=Qr(e),n=u[t];if(typeof n!="function"||!(t in U.prototype))return!1;if(e===n)return!0;var r=ru(n);return!!r&&e===r[0]}function dc(e){return!!po&&po in e}var pc=Tr?Mt:Su;function fr(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Fn;return e===n}function ps(e){return e===e&&!ee(e)}function gs(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==s||e in K(n))}}function gc(e){var t=ri(e,function(r){return n.size===yn&&n.clear(),r}),n=t.cache;return t}function _c(e,t){var n=e[1],r=t[1],i=n|r,o=i<(we|ke|Ge),a=r==Ge&&n==Ce||r==Ge&&n==gt&&e[7].length<=t[8]||r==(Ge|gt)&&t[7].length<=t[8]&&n==Ce;if(!(o||a))return e;r&we&&(e[2]=t[2],i|=n&we?0:j);var l=t[3];if(l){var c=e[3];e[3]=c?Qo(c,l,t[4]):l,e[4]=c?qt(e[3],et):t[4]}return l=t[5],l&&(c=e[5],e[5]=c?Vo(c,l,t[6]):l,e[6]=c?qt(e[5],et):t[6]),l=t[7],l&&(e[7]=l),r&Ge&&(e[8]=e[8]==null?t[8]:ye(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=i,e}function vc(e){var t=[];if(e!=null)for(var n in K(e))t.push(n);return t}function mc(e){return Ir.call(e)}function _s(e,t,n){return t=ae(t===s?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=ae(r.length-t,0),a=h(o);++i<o;)a[i]=r[t+i];i=-1;for(var l=h(t+1);++i<t;)l[i]=r[i];return l[t]=n(a),Be(e,this,l)}}function vs(e,t){return t.length<2?e:_n(e,Xe(t,0,-1))}function xc(e,t){for(var n=e.length,r=ye(t.length,n),i=Oe(e);r--;){var o=t[r];e[r]=Ot(o,n)?i[o]:s}return e}function au(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var ms=ws($o),cr=Pl||function(e,t){return _e.setTimeout(e,t)},lu=ws(kf);function xs(e,t,n){var r=t+"";return lu(e,fc(r,wc(sc(r),n)))}function ws(e){var t=0,n=0;return function(){var r=Ul(),i=We-(r-n);if(n=r,i>0){if(++t>=pe)return arguments[0]}else t=0;return e.apply(s,arguments)}}function jr(e,t){var n=-1,r=e.length,i=r-1;for(t=t===s?r:t;++n<t;){var o=Hi(n,i),a=e[o];e[o]=e[n],e[n]=a}return e.length=t,e}var ys=gc(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(fn,function(n,r,i,o){t.push(i?o.replace(_a,"$1"):r||n)}),t});function yt(e){if(typeof e=="string"||ze(e))return e;var t=e+"";return t=="0"&&1/e==-Y?"-0":t}function mn(e){if(e!=null){try{return Rr.call(e)}catch{}try{return e+""}catch{}}return""}function wc(e,t){return Ke(Ut,function(n){var r="_."+n[0];t&n[1]&&!Cr(e,r)&&e.push(r)}),e.sort()}function bs(e){if(e instanceof U)return e.clone();var t=new Ze(e.__wrapped__,e.__chain__);return t.__actions__=Oe(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function yc(e,t,n){(n?Ae(e,t,n):t===s)?t=1:t=ae(M(t),0);var r=e==null?0:e.length;if(!r||t<1)return[];for(var i=0,o=0,a=h(Wr(r/t));i<r;)a[o++]=Xe(e,i,i+=t);return a}function bc(e){for(var t=-1,n=e==null?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i}function Cc(){var e=arguments.length;if(!e)return[];for(var t=h(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return Gt(O(n)?Oe(n):[n],ve(t,1))}var Sc=F(function(e,t){return ie(e)?ur(e,ve(t,1,ie,!0)):[]}),Ac=F(function(e,t){var n=Qe(t);return ie(n)&&(n=s),ie(e)?ur(e,ve(t,1,ie,!0),A(n,2)):[]}),Ec=F(function(e,t){var n=Qe(t);return ie(n)&&(n=s),ie(e)?ur(e,ve(t,1,ie,!0),s,n):[]});function Tc(e,t,n){var r=e==null?0:e.length;return r?(t=n||t===s?1:M(t),Xe(e,t<0?0:t,r)):[]}function Rc(e,t,n){var r=e==null?0:e.length;return r?(t=n||t===s?1:M(t),t=r-t,Xe(e,0,t<0?0:t)):[]}function Ic(e,t){return e&&e.length?Hr(e,A(t,3),!0,!0):[]}function Lc(e,t){return e&&e.length?Hr(e,A(t,3),!0):[]}function Oc(e,t,n,r){var i=e==null?0:e.length;return i?(n&&typeof n!="number"&&Ae(e,t,n)&&(n=0,r=i),Cf(e,t,n,r)):[]}function Cs(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var i=n==null?0:M(n);return i<0&&(i=ae(r+i,0)),Sr(e,A(t,3),i)}function Ss(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var i=r-1;return n!==s&&(i=M(n),i=n<0?ae(r+i,0):ye(i,r-1)),Sr(e,A(t,3),i,!0)}function As(e){var t=e==null?0:e.length;return t?ve(e,1):[]}function Mc(e){var t=e==null?0:e.length;return t?ve(e,Y):[]}function Pc(e,t){var n=e==null?0:e.length;return n?(t=t===s?1:M(t),ve(e,t)):[]}function Fc(e){for(var t=-1,n=e==null?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r}function Es(e){return e&&e.length?e[0]:s}function Wc(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var i=n==null?0:M(n);return i<0&&(i=ae(r+i,0)),Ln(e,t,i)}function Bc(e){var t=e==null?0:e.length;return t?Xe(e,0,-1):[]}var Uc=F(function(e){var t=V(e,Xi);return t.length&&t[0]===e[0]?Ni(t):[]}),Dc=F(function(e){var t=Qe(e),n=V(e,Xi);return t===Qe(n)?t=s:n.pop(),n.length&&n[0]===e[0]?Ni(n,A(t,2)):[]}),zc=F(function(e){var t=Qe(e),n=V(e,Xi);return t=typeof t=="function"?t:s,t&&n.pop(),n.length&&n[0]===e[0]?Ni(n,s,t):[]});function Nc(e,t){return e==null?"":Wl.call(e,t)}function Qe(e){var t=e==null?0:e.length;return t?e[t-1]:s}function $c(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var i=r;return n!==s&&(i=M(n),i=i<0?ae(r+i,0):ye(i,r-1)),t===t?xl(e,t,i):Sr(e,uo,i,!0)}function kc(e,t){return e&&e.length?Uo(e,M(t)):s}var Gc=F(Ts);function Ts(e,t){return e&&e.length&&t&&t.length?qi(e,t):e}function qc(e,t,n){return e&&e.length&&t&&t.length?qi(e,t,A(n,2)):e}function Hc(e,t,n){return e&&e.length&&t&&t.length?qi(e,t,s,n):e}var Kc=Lt(function(e,t){var n=e==null?0:e.length,r=Bi(e,t);return No(e,V(t,function(i){return Ot(i,n)?+i:i}).sort(Xo)),r});function Yc(e,t){var n=[];if(!(e&&e.length))return n;var r=-1,i=[],o=e.length;for(t=A(t,3);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}return No(e,i),n}function fu(e){return e==null?e:zl.call(e)}function Zc(e,t,n){var r=e==null?0:e.length;return r?(n&&typeof n!="number"&&Ae(e,t,n)?(t=0,n=r):(t=t==null?0:M(t),n=n===s?r:M(n)),Xe(e,t,n)):[]}function Jc(e,t){return qr(e,t)}function Xc(e,t,n){return Yi(e,t,A(n,2))}function Qc(e,t){var n=e==null?0:e.length;if(n){var r=qr(e,t);if(r<n&&ot(e[r],t))return r}return-1}function Vc(e,t){return qr(e,t,!0)}function jc(e,t,n){return Yi(e,t,A(n,2),!0)}function eh(e,t){var n=e==null?0:e.length;if(n){var r=qr(e,t,!0)-1;if(ot(e[r],t))return r}return-1}function th(e){return e&&e.length?ko(e):[]}function nh(e,t){return e&&e.length?ko(e,A(t,2)):[]}function rh(e){var t=e==null?0:e.length;return t?Xe(e,1,t):[]}function ih(e,t,n){return e&&e.length?(t=n||t===s?1:M(t),Xe(e,0,t<0?0:t)):[]}function uh(e,t,n){var r=e==null?0:e.length;return r?(t=n||t===s?1:M(t),t=r-t,Xe(e,t<0?0:t,r)):[]}function oh(e,t){return e&&e.length?Hr(e,A(t,3),!1,!0):[]}function sh(e,t){return e&&e.length?Hr(e,A(t,3)):[]}var ah=F(function(e){return Yt(ve(e,1,ie,!0))}),lh=F(function(e){var t=Qe(e);return ie(t)&&(t=s),Yt(ve(e,1,ie,!0),A(t,2))}),fh=F(function(e){var t=Qe(e);return t=typeof t=="function"?t:s,Yt(ve(e,1,ie,!0),s,t)});function ch(e){return e&&e.length?Yt(e):[]}function hh(e,t){return e&&e.length?Yt(e,A(t,2)):[]}function dh(e,t){return t=typeof t=="function"?t:s,e&&e.length?Yt(e,s,t):[]}function cu(e){if(!(e&&e.length))return[];var t=0;return e=kt(e,function(n){if(ie(n))return t=ae(n.length,t),!0}),Ri(t,function(n){return V(e,Ai(n))})}function Rs(e,t){if(!(e&&e.length))return[];var n=cu(e);return t==null?n:V(n,function(r){return Be(t,s,r)})}var ph=F(function(e,t){return ie(e)?ur(e,t):[]}),gh=F(function(e){return Ji(kt(e,ie))}),_h=F(function(e){var t=Qe(e);return ie(t)&&(t=s),Ji(kt(e,ie),A(t,2))}),vh=F(function(e){var t=Qe(e);return t=typeof t=="function"?t:s,Ji(kt(e,ie),s,t)}),mh=F(cu);function xh(e,t){return Ko(e||[],t||[],ir)}function wh(e,t){return Ko(e||[],t||[],ar)}var yh=F(function(e){var t=e.length,n=t>1?e[t-1]:s;return n=typeof n=="function"?(e.pop(),n):s,Rs(e,n)});function Is(e){var t=u(e);return t.__chain__=!0,t}function bh(e,t){return t(e),e}function ei(e,t){return t(e)}var Ch=Lt(function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(o){return Bi(o,e)};return t>1||this.__actions__.length||!(r instanceof U)||!Ot(n)?this.thru(i):(r=r.slice(n,+n+(t?1:0)),r.__actions__.push({func:ei,args:[i],thisArg:s}),new Ze(r,this.__chain__).thru(function(o){return t&&!o.length&&o.push(s),o}))});function Sh(){return Is(this)}function Ah(){return new Ze(this.value(),this.__chain__)}function Eh(){this.__values__===s&&(this.__values__=Gs(this.value()));var e=this.__index__>=this.__values__.length,t=e?s:this.__values__[this.__index__++];return{done:e,value:t}}function Th(){return this}function Rh(e){for(var t,n=this;n instanceof zr;){var r=bs(n);r.__index__=0,r.__values__=s,t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__}return i.__wrapped__=e,t}function Ih(){var e=this.__wrapped__;if(e instanceof U){var t=e;return this.__actions__.length&&(t=new U(this)),t=t.reverse(),t.__actions__.push({func:ei,args:[fu],thisArg:s}),new Ze(t,this.__chain__)}return this.thru(fu)}function Lh(){return Ho(this.__wrapped__,this.__actions__)}var Oh=Kr(function(e,t,n){H.call(e,n)?++e[n]:Rt(e,n,1)});function Mh(e,t,n){var r=O(e)?ro:bf;return n&&Ae(e,t,n)&&(t=s),r(e,A(t,3))}function Ph(e,t){var n=O(e)?kt:Ro;return n(e,A(t,3))}var Fh=ns(Cs),Wh=ns(Ss);function Bh(e,t){return ve(ti(e,t),1)}function Uh(e,t){return ve(ti(e,t),Y)}function Dh(e,t,n){return n=n===s?1:M(n),ve(ti(e,t),n)}function Ls(e,t){var n=O(e)?Ke:Kt;return n(e,A(t,3))}function Os(e,t){var n=O(e)?nl:To;return n(e,A(t,3))}var zh=Kr(function(e,t,n){H.call(e,n)?e[n].push(t):Rt(e,n,[t])});function Nh(e,t,n,r){e=Me(e)?e:kn(e),n=n&&!r?M(n):0;var i=e.length;return n<0&&(n=ae(i+n,0)),oi(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&Ln(e,t,n)>-1}var $h=F(function(e,t,n){var r=-1,i=typeof t=="function",o=Me(e)?h(e.length):[];return Kt(e,function(a){o[++r]=i?Be(t,a,n):or(a,t,n)}),o}),kh=Kr(function(e,t,n){Rt(e,n,t)});function ti(e,t){var n=O(e)?V:Fo;return n(e,A(t,3))}function Gh(e,t,n,r){return e==null?[]:(O(t)||(t=t==null?[]:[t]),n=r?s:n,O(n)||(n=n==null?[]:[n]),Do(e,t,n))}var qh=Kr(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});function Hh(e,t,n){var r=O(e)?Ci:so,i=arguments.length<3;return r(e,A(t,4),n,i,Kt)}function Kh(e,t,n){var r=O(e)?rl:so,i=arguments.length<3;return r(e,A(t,4),n,i,To)}function Yh(e,t){var n=O(e)?kt:Ro;return n(e,ii(A(t,3)))}function Zh(e){var t=O(e)?Co:Nf;return t(e)}function Jh(e,t,n){(n?Ae(e,t,n):t===s)?t=1:t=M(t);var r=O(e)?vf:$f;return r(e,t)}function Xh(e){var t=O(e)?mf:Gf;return t(e)}function Qh(e){if(e==null)return 0;if(Me(e))return oi(e)?Mn(e):e.length;var t=be(e);return t==Ie||t==Le?e.size:ki(e).length}function Vh(e,t,n){var r=O(e)?Si:qf;return n&&Ae(e,t,n)&&(t=s),r(e,A(t,3))}var jh=F(function(e,t){if(e==null)return[];var n=t.length;return n>1&&Ae(e,t[0],t[1])?t=[]:n>2&&Ae(t[0],t[1],t[2])&&(t=[t[0]]),Do(e,ve(t,1),[])}),ni=Ml||function(){return _e.Date.now()};function ed(e,t){if(typeof t!="function")throw new Ye(de);return e=M(e),function(){if(--e<1)return t.apply(this,arguments)}}function Ms(e,t,n){return t=n?s:t,t=e&&t==null?e.length:t,It(e,Ge,s,s,s,s,t)}function Ps(e,t){var n;if(typeof t!="function")throw new Ye(de);return e=M(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=s),n}}var hu=F(function(e,t,n){var r=we;if(n.length){var i=qt(n,Nn(hu));r|=Te}return It(e,r,t,n,i)}),Fs=F(function(e,t,n){var r=we|ke;if(n.length){var i=qt(n,Nn(Fs));r|=Te}return It(t,r,e,n,i)});function Ws(e,t,n){t=n?s:t;var r=It(e,Ce,s,s,s,s,s,t);return r.placeholder=Ws.placeholder,r}function Bs(e,t,n){t=n?s:t;var r=It(e,dt,s,s,s,s,s,t);return r.placeholder=Bs.placeholder,r}function Us(e,t,n){var r,i,o,a,l,c,_=0,v=!1,x=!1,w=!0;if(typeof e!="function")throw new Ye(de);t=Ve(t)||0,ee(n)&&(v=!!n.leading,x="maxWait"in n,o=x?ae(Ve(n.maxWait)||0,t):o,w="trailing"in n?!!n.trailing:w);function C(ue){var st=r,Ft=i;return r=i=s,_=ue,a=e.apply(Ft,st),a}function E(ue){return _=ue,l=cr(W,t),v?C(ue):a}function P(ue){var st=ue-c,Ft=ue-_,na=t-st;return x?ye(na,o-Ft):na}function T(ue){var st=ue-c,Ft=ue-_;return c===s||st>=t||st<0||x&&Ft>=o}function W(){var ue=ni();if(T(ue))return D(ue);l=cr(W,P(ue))}function D(ue){return l=s,w&&r?C(ue):(r=i=s,a)}function Ne(){l!==s&&Yo(l),_=0,r=c=i=l=s}function Ee(){return l===s?a:D(ni())}function $e(){var ue=ni(),st=T(ue);if(r=arguments,i=this,c=ue,st){if(l===s)return E(c);if(x)return Yo(l),l=cr(W,t),C(c)}return l===s&&(l=cr(W,t)),a}return $e.cancel=Ne,$e.flush=Ee,$e}var td=F(function(e,t){return Eo(e,1,t)}),nd=F(function(e,t,n){return Eo(e,Ve(t)||0,n)});function rd(e){return It(e,bn)}function ri(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new Ye(de);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(ri.Cache||Tt),n}ri.Cache=Tt;function ii(e){if(typeof e!="function")throw new Ye(de);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function id(e){return Ps(2,e)}var ud=Hf(function(e,t){t=t.length==1&&O(t[0])?V(t[0],Ue(A())):V(ve(t,1),Ue(A()));var n=t.length;return F(function(r){for(var i=-1,o=ye(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return Be(e,this,r)})}),du=F(function(e,t){var n=qt(t,Nn(du));return It(e,Te,s,t,n)}),Ds=F(function(e,t){var n=qt(t,Nn(Ds));return It(e,pt,s,t,n)}),od=Lt(function(e,t){return It(e,gt,s,s,s,t)});function sd(e,t){if(typeof e!="function")throw new Ye(de);return t=t===s?t:M(t),F(e,t)}function ad(e,t){if(typeof e!="function")throw new Ye(de);return t=t==null?0:ae(M(t),0),F(function(n){var r=n[t],i=Jt(n,0,t);return r&&Gt(i,r),Be(e,this,i)})}function ld(e,t,n){var r=!0,i=!0;if(typeof e!="function")throw new Ye(de);return ee(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Us(e,t,{leading:r,maxWait:t,trailing:i})}function fd(e){return Ms(e,1)}function cd(e,t){return du(Qi(t),e)}function hd(){if(!arguments.length)return[];var e=arguments[0];return O(e)?e:[e]}function dd(e){return Je(e,fe)}function pd(e,t){return t=typeof t=="function"?t:s,Je(e,fe,t)}function gd(e){return Je(e,N|fe)}function _d(e,t){return t=typeof t=="function"?t:s,Je(e,N|fe,t)}function vd(e,t){return t==null||Ao(e,t,he(t))}function ot(e,t){return e===t||e!==e&&t!==t}var md=Xr(zi),xd=Xr(function(e,t){return e>=t}),xn=Oo((function(){return arguments})())?Oo:function(e){return ne(e)&&H.call(e,"callee")&&!vo.call(e,"callee")},O=h.isArray,wd=Qu?Ue(Qu):Rf;function Me(e){return e!=null&&ui(e.length)&&!Mt(e)}function ie(e){return ne(e)&&Me(e)}function yd(e){return e===!0||e===!1||ne(e)&&Se(e)==nt}var Xt=Fl||Su,bd=Vu?Ue(Vu):If;function Cd(e){return ne(e)&&e.nodeType===1&&!hr(e)}function Sd(e){if(e==null)return!0;if(Me(e)&&(O(e)||typeof e=="string"||typeof e.splice=="function"||Xt(e)||$n(e)||xn(e)))return!e.length;var t=be(e);if(t==Ie||t==Le)return!e.size;if(fr(e))return!ki(e).length;for(var n in e)if(H.call(e,n))return!1;return!0}function Ad(e,t){return sr(e,t)}function Ed(e,t,n){n=typeof n=="function"?n:s;var r=n?n(e,t):s;return r===s?sr(e,t,s,n):!!r}function pu(e){if(!ne(e))return!1;var t=Se(e);return t==rn||t==fi||typeof e.message=="string"&&typeof e.name=="string"&&!hr(e)}function Td(e){return typeof e=="number"&&xo(e)}function Mt(e){if(!ee(e))return!1;var t=Se(e);return t==Sn||t==gr||t==Ru||t==vr}function zs(e){return typeof e=="number"&&e==M(e)}function ui(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=ge}function ee(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function ne(e){return e!=null&&typeof e=="object"}var Ns=ju?Ue(ju):Of;function Rd(e,t){return e===t||$i(e,t,iu(t))}function Id(e,t,n){return n=typeof n=="function"?n:s,$i(e,t,iu(t),n)}function Ld(e){return $s(e)&&e!=+e}function Od(e){if(pc(e))throw new L(jt);return Mo(e)}function Md(e){return e===null}function Pd(e){return e==null}function $s(e){return typeof e=="number"||ne(e)&&Se(e)==un}function hr(e){if(!ne(e)||Se(e)!=rt)return!1;var t=Mr(e);if(t===null)return!0;var n=H.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&Rr.call(n)==Rl}var gu=eo?Ue(eo):Mf;function Fd(e){return zs(e)&&e>=-ge&&e<=ge}var ks=to?Ue(to):Pf;function oi(e){return typeof e=="string"||!O(e)&&ne(e)&&Se(e)==zt}function ze(e){return typeof e=="symbol"||ne(e)&&Se(e)==on}var $n=no?Ue(no):Ff;function Wd(e){return e===s}function Bd(e){return ne(e)&&be(e)==Nt}function Ud(e){return ne(e)&&Se(e)==mr}var Dd=Xr(Gi),zd=Xr(function(e,t){return e<=t});function Gs(e){if(!e)return[];if(Me(e))return oi(e)?it(e):Oe(e);if(jn&&e[jn])return _l(e[jn]());var t=be(e),n=t==Ie?Li:t==Le?Ar:kn;return n(e)}function Pt(e){if(!e)return e===0?e:0;if(e=Ve(e),e===Y||e===-Y){var t=e<0?-1:1;return t*Z}return e===e?e:0}function M(e){var t=Pt(e),n=t%1;return t===t?n?t-n:t:0}function qs(e){return e?gn(M(e),0,B):0}function Ve(e){if(typeof e=="number")return e;if(ze(e))return k;if(ee(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ee(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=ao(e);var n=xa.test(e);return n||ya.test(e)?ja(e.slice(2),n?2:8):ma.test(e)?k:+e}function Hs(e){return wt(e,Pe(e))}function Nd(e){return e?gn(M(e),-ge,ge):e===0?e:0}function q(e){return e==null?"":De(e)}var $d=Dn(function(e,t){if(fr(t)||Me(t)){wt(t,he(t),e);return}for(var n in t)H.call(t,n)&&ir(e,n,t[n])}),Ks=Dn(function(e,t){wt(t,Pe(t),e)}),si=Dn(function(e,t,n,r){wt(t,Pe(t),e,r)}),kd=Dn(function(e,t,n,r){wt(t,he(t),e,r)}),Gd=Lt(Bi);function qd(e,t){var n=Un(e);return t==null?n:So(n,t)}var Hd=F(function(e,t){e=K(e);var n=-1,r=t.length,i=r>2?t[2]:s;for(i&&Ae(t[0],t[1],i)&&(r=1);++n<r;)for(var o=t[n],a=Pe(o),l=-1,c=a.length;++l<c;){var _=a[l],v=e[_];(v===s||ot(v,Fn[_])&&!H.call(e,_))&&(e[_]=o[_])}return e}),Kd=F(function(e){return e.push(s,ls),Be(Ys,s,e)});function Yd(e,t){return io(e,A(t,3),xt)}function Zd(e,t){return io(e,A(t,3),Di)}function Jd(e,t){return e==null?e:Ui(e,A(t,3),Pe)}function Xd(e,t){return e==null?e:Io(e,A(t,3),Pe)}function Qd(e,t){return e&&xt(e,A(t,3))}function Vd(e,t){return e&&Di(e,A(t,3))}function jd(e){return e==null?[]:kr(e,he(e))}function ep(e){return e==null?[]:kr(e,Pe(e))}function _u(e,t,n){var r=e==null?s:_n(e,t);return r===s?n:r}function tp(e,t){return e!=null&&hs(e,t,Sf)}function vu(e,t){return e!=null&&hs(e,t,Af)}var np=is(function(e,t,n){t!=null&&typeof t.toString!="function"&&(t=Ir.call(t)),e[t]=n},xu(Fe)),rp=is(function(e,t,n){t!=null&&typeof t.toString!="function"&&(t=Ir.call(t)),H.call(e,t)?e[t].push(n):e[t]=[n]},A),ip=F(or);function he(e){return Me(e)?bo(e):ki(e)}function Pe(e){return Me(e)?bo(e,!0):Wf(e)}function up(e,t){var n={};return t=A(t,3),xt(e,function(r,i,o){Rt(n,t(r,i,o),r)}),n}function op(e,t){var n={};return t=A(t,3),xt(e,function(r,i,o){Rt(n,i,t(r,i,o))}),n}var sp=Dn(function(e,t,n){Gr(e,t,n)}),Ys=Dn(function(e,t,n,r){Gr(e,t,n,r)}),ap=Lt(function(e,t){var n={};if(e==null)return n;var r=!1;t=V(t,function(o){return o=Zt(o,e),r||(r=o.length>1),o}),wt(e,nu(e),n),r&&(n=Je(n,N|ht|fe,nc));for(var i=t.length;i--;)Zi(n,t[i]);return n});function lp(e,t){return Zs(e,ii(A(t)))}var fp=Lt(function(e,t){return e==null?{}:Uf(e,t)});function Zs(e,t){if(e==null)return{};var n=V(nu(e),function(r){return[r]});return t=A(t),zo(e,n,function(r,i){return t(r,i[0])})}function cp(e,t,n){t=Zt(t,e);var r=-1,i=t.length;for(i||(i=1,e=s);++r<i;){var o=e==null?s:e[yt(t[r])];o===s&&(r=i,o=n),e=Mt(o)?o.call(e):o}return e}function hp(e,t,n){return e==null?e:ar(e,t,n)}function dp(e,t,n,r){return r=typeof r=="function"?r:s,e==null?e:ar(e,t,n,r)}var Js=ss(he),Xs=ss(Pe);function pp(e,t,n){var r=O(e),i=r||Xt(e)||$n(e);if(t=A(t,4),n==null){var o=e&&e.constructor;i?n=r?new o:[]:ee(e)?n=Mt(o)?Un(Mr(e)):{}:n={}}return(i?Ke:xt)(e,function(a,l,c){return t(n,a,l,c)}),n}function gp(e,t){return e==null?!0:Zi(e,t)}function _p(e,t,n){return e==null?e:qo(e,t,Qi(n))}function vp(e,t,n,r){return r=typeof r=="function"?r:s,e==null?e:qo(e,t,Qi(n),r)}function kn(e){return e==null?[]:Ii(e,he(e))}function mp(e){return e==null?[]:Ii(e,Pe(e))}function xp(e,t,n){return n===s&&(n=t,t=s),n!==s&&(n=Ve(n),n=n===n?n:0),t!==s&&(t=Ve(t),t=t===t?t:0),gn(Ve(e),t,n)}function wp(e,t,n){return t=Pt(t),n===s?(n=t,t=0):n=Pt(n),e=Ve(e),Ef(e,t,n)}function yp(e,t,n){if(n&&typeof n!="boolean"&&Ae(e,t,n)&&(t=n=s),n===s&&(typeof t=="boolean"?(n=t,t=s):typeof e=="boolean"&&(n=e,e=s)),e===s&&t===s?(e=0,t=1):(e=Pt(e),t===s?(t=e,e=0):t=Pt(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var i=wo();return ye(e+i*(t-e+Va("1e-"+((i+"").length-1))),t)}return Hi(e,t)}var bp=zn(function(e,t,n){return t=t.toLowerCase(),e+(n?Qs(t):t)});function Qs(e){return mu(q(e).toLowerCase())}function Vs(e){return e=q(e),e&&e.replace(Ca,cl).replace(ka,"")}function Cp(e,t,n){e=q(e),t=De(t);var r=e.length;n=n===s?r:gn(M(n),0,r);var i=n;return n-=t.length,n>=0&&e.slice(n,i)==t}function Sp(e){return e=q(e),e&&Iu.test(e)?e.replace(Zn,hl):e}function Ap(e){return e=q(e),e&&di.test(e)?e.replace(Qn,"\\$&"):e}var Ep=zn(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),Tp=zn(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),Rp=ts("toLowerCase");function Ip(e,t,n){e=q(e),t=M(t);var r=t?Mn(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Jr(Br(i),n)+e+Jr(Wr(i),n)}function Lp(e,t,n){e=q(e),t=M(t);var r=t?Mn(e):0;return t&&r<t?e+Jr(t-r,n):e}function Op(e,t,n){e=q(e),t=M(t);var r=t?Mn(e):0;return t&&r<t?Jr(t-r,n)+e:e}function Mp(e,t,n){return n||t==null?t=0:t&&(t=+t),Dl(q(e).replace(pi,""),t||0)}function Pp(e,t,n){return(n?Ae(e,t,n):t===s)?t=1:t=M(t),Ki(q(e),t)}function Fp(){var e=arguments,t=q(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var Wp=zn(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()});function Bp(e,t,n){return n&&typeof n!="number"&&Ae(e,t,n)&&(t=n=s),n=n===s?B:n>>>0,n?(e=q(e),e&&(typeof t=="string"||t!=null&&!gu(t))&&(t=De(t),!t&&On(e))?Jt(it(e),0,n):e.split(t,n)):[]}var Up=zn(function(e,t,n){return e+(n?" ":"")+mu(t)});function Dp(e,t,n){return e=q(e),n=n==null?0:gn(M(n),0,e.length),t=De(t),e.slice(n,n+t.length)==t}function zp(e,t,n){var r=u.templateSettings;n&&Ae(e,t,n)&&(t=s),e=q(e),t=si({},t,r,as);var i=si({},t.imports,r.imports,as),o=he(i),a=Ii(i,o),l,c,_=0,v=t.interpolate||wr,x="__p += '",w=Oi((t.escape||wr).source+"|"+v.source+"|"+(v===ce?va:wr).source+"|"+(t.evaluate||wr).source+"|$","g"),C="//# sourceURL="+(H.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ya+"]")+`
`;e.replace(w,function(T,W,D,Ne,Ee,$e){return D||(D=Ne),x+=e.slice(_,$e).replace(Sa,dl),W&&(l=!0,x+=`' +
__e(`+W+`) +
'`),Ee&&(c=!0,x+=`';
`+Ee+`;
__p += '`),D&&(x+=`' +
((__t = (`+D+`)) == null ? '' : __t) +
'`),_=$e+T.length,T}),x+=`';
`;var E=H.call(t,"variable")&&t.variable;if(!E)x=`with (obj) {
`+x+`
}
`;else if(ga.test(E))throw new L(en);x=(c?x.replace(I,""):x).replace(Tn,"$1").replace(Kn,"$1;"),x="function("+(E||"obj")+`) {
`+(E?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(l?", __e = _.escape":"")+(c?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+x+`return __p
}`;var P=ea(function(){return G(o,C+"return "+x).apply(s,a)});if(P.source=x,pu(P))throw P;return P}function Np(e){return q(e).toLowerCase()}function $p(e){return q(e).toUpperCase()}function kp(e,t,n){if(e=q(e),e&&(n||t===s))return ao(e);if(!e||!(t=De(t)))return e;var r=it(e),i=it(t),o=lo(r,i),a=fo(r,i)+1;return Jt(r,o,a).join("")}function Gp(e,t,n){if(e=q(e),e&&(n||t===s))return e.slice(0,ho(e)+1);if(!e||!(t=De(t)))return e;var r=it(e),i=fo(r,it(t))+1;return Jt(r,0,i).join("")}function qp(e,t,n){if(e=q(e),e&&(n||t===s))return e.replace(pi,"");if(!e||!(t=De(t)))return e;var r=it(e),i=lo(r,it(t));return Jt(r,i).join("")}function Hp(e,t){var n=$,r=z;if(ee(t)){var i="separator"in t?t.separator:i;n="length"in t?M(t.length):n,r="omission"in t?De(t.omission):r}e=q(e);var o=e.length;if(On(e)){var a=it(e);o=a.length}if(n>=o)return e;var l=n-Mn(r);if(l<1)return r;var c=a?Jt(a,0,l).join(""):e.slice(0,l);if(i===s)return c+r;if(a&&(l+=c.length-l),gu(i)){if(e.slice(l).search(i)){var _,v=c;for(i.global||(i=Oi(i.source,q(Lu.exec(i))+"g")),i.lastIndex=0;_=i.exec(v);)var x=_.index;c=c.slice(0,x===s?l:x)}}else if(e.indexOf(De(i),l)!=l){var w=c.lastIndexOf(i);w>-1&&(c=c.slice(0,w))}return c+r}function Kp(e){return e=q(e),e&&Jn.test(e)?e.replace(Yn,wl):e}var Yp=zn(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),mu=ts("toUpperCase");function js(e,t,n){return e=q(e),t=n?s:t,t===s?gl(e)?Cl(e):ol(e):e.match(t)||[]}var ea=F(function(e,t){try{return Be(e,s,t)}catch(n){return pu(n)?n:new L(n)}}),Zp=Lt(function(e,t){return Ke(t,function(n){n=yt(n),Rt(e,n,hu(e[n],e))}),e});function Jp(e){var t=e==null?0:e.length,n=A();return e=t?V(e,function(r){if(typeof r[1]!="function")throw new Ye(de);return[n(r[0]),r[1]]}):[],F(function(r){for(var i=-1;++i<t;){var o=e[i];if(Be(o[0],this,r))return Be(o[1],this,r)}})}function Xp(e){return yf(Je(e,N))}function xu(e){return function(){return e}}function Qp(e,t){return e==null||e!==e?t:e}var Vp=rs(),jp=rs(!0);function Fe(e){return e}function wu(e){return Po(typeof e=="function"?e:Je(e,N))}function eg(e){return Wo(Je(e,N))}function tg(e,t){return Bo(e,Je(t,N))}var ng=F(function(e,t){return function(n){return or(n,e,t)}}),rg=F(function(e,t){return function(n){return or(e,n,t)}});function yu(e,t,n){var r=he(t),i=kr(t,r);n==null&&!(ee(t)&&(i.length||!r.length))&&(n=t,t=e,e=this,i=kr(t,he(t)));var o=!(ee(n)&&"chain"in n)||!!n.chain,a=Mt(e);return Ke(i,function(l){var c=t[l];e[l]=c,a&&(e.prototype[l]=function(){var _=this.__chain__;if(o||_){var v=e(this.__wrapped__),x=v.__actions__=Oe(this.__actions__);return x.push({func:c,args:arguments,thisArg:e}),v.__chain__=_,v}return c.apply(e,Gt([this.value()],arguments))})}),e}function ig(){return _e._===this&&(_e._=Il),this}function bu(){}function ug(e){return e=M(e),F(function(t){return Uo(t,e)})}var og=ji(V),sg=ji(ro),ag=ji(Si);function ta(e){return ou(e)?Ai(yt(e)):Df(e)}function lg(e){return function(t){return e==null?s:_n(e,t)}}var fg=us(),cg=us(!0);function Cu(){return[]}function Su(){return!1}function hg(){return{}}function dg(){return""}function pg(){return!0}function gg(e,t){if(e=M(e),e<1||e>ge)return[];var n=B,r=ye(e,B);t=A(t),e-=B;for(var i=Ri(r,t);++n<e;)t(n);return i}function _g(e){return O(e)?V(e,yt):ze(e)?[e]:Oe(ys(q(e)))}function vg(e){var t=++Tl;return q(e)+t}var mg=Zr(function(e,t){return e+t},0),xg=eu("ceil"),wg=Zr(function(e,t){return e/t},1),yg=eu("floor");function bg(e){return e&&e.length?$r(e,Fe,zi):s}function Cg(e,t){return e&&e.length?$r(e,A(t,2),zi):s}function Sg(e){return oo(e,Fe)}function Ag(e,t){return oo(e,A(t,2))}function Eg(e){return e&&e.length?$r(e,Fe,Gi):s}function Tg(e,t){return e&&e.length?$r(e,A(t,2),Gi):s}var Rg=Zr(function(e,t){return e*t},1),Ig=eu("round"),Lg=Zr(function(e,t){return e-t},0);function Og(e){return e&&e.length?Ti(e,Fe):0}function Mg(e,t){return e&&e.length?Ti(e,A(t,2)):0}return u.after=ed,u.ary=Ms,u.assign=$d,u.assignIn=Ks,u.assignInWith=si,u.assignWith=kd,u.at=Gd,u.before=Ps,u.bind=hu,u.bindAll=Zp,u.bindKey=Fs,u.castArray=hd,u.chain=Is,u.chunk=yc,u.compact=bc,u.concat=Cc,u.cond=Jp,u.conforms=Xp,u.constant=xu,u.countBy=Oh,u.create=qd,u.curry=Ws,u.curryRight=Bs,u.debounce=Us,u.defaults=Hd,u.defaultsDeep=Kd,u.defer=td,u.delay=nd,u.difference=Sc,u.differenceBy=Ac,u.differenceWith=Ec,u.drop=Tc,u.dropRight=Rc,u.dropRightWhile=Ic,u.dropWhile=Lc,u.fill=Oc,u.filter=Ph,u.flatMap=Bh,u.flatMapDeep=Uh,u.flatMapDepth=Dh,u.flatten=As,u.flattenDeep=Mc,u.flattenDepth=Pc,u.flip=rd,u.flow=Vp,u.flowRight=jp,u.fromPairs=Fc,u.functions=jd,u.functionsIn=ep,u.groupBy=zh,u.initial=Bc,u.intersection=Uc,u.intersectionBy=Dc,u.intersectionWith=zc,u.invert=np,u.invertBy=rp,u.invokeMap=$h,u.iteratee=wu,u.keyBy=kh,u.keys=he,u.keysIn=Pe,u.map=ti,u.mapKeys=up,u.mapValues=op,u.matches=eg,u.matchesProperty=tg,u.memoize=ri,u.merge=sp,u.mergeWith=Ys,u.method=ng,u.methodOf=rg,u.mixin=yu,u.negate=ii,u.nthArg=ug,u.omit=ap,u.omitBy=lp,u.once=id,u.orderBy=Gh,u.over=og,u.overArgs=ud,u.overEvery=sg,u.overSome=ag,u.partial=du,u.partialRight=Ds,u.partition=qh,u.pick=fp,u.pickBy=Zs,u.property=ta,u.propertyOf=lg,u.pull=Gc,u.pullAll=Ts,u.pullAllBy=qc,u.pullAllWith=Hc,u.pullAt=Kc,u.range=fg,u.rangeRight=cg,u.rearg=od,u.reject=Yh,u.remove=Yc,u.rest=sd,u.reverse=fu,u.sampleSize=Jh,u.set=hp,u.setWith=dp,u.shuffle=Xh,u.slice=Zc,u.sortBy=jh,u.sortedUniq=th,u.sortedUniqBy=nh,u.split=Bp,u.spread=ad,u.tail=rh,u.take=ih,u.takeRight=uh,u.takeRightWhile=oh,u.takeWhile=sh,u.tap=bh,u.throttle=ld,u.thru=ei,u.toArray=Gs,u.toPairs=Js,u.toPairsIn=Xs,u.toPath=_g,u.toPlainObject=Hs,u.transform=pp,u.unary=fd,u.union=ah,u.unionBy=lh,u.unionWith=fh,u.uniq=ch,u.uniqBy=hh,u.uniqWith=dh,u.unset=gp,u.unzip=cu,u.unzipWith=Rs,u.update=_p,u.updateWith=vp,u.values=kn,u.valuesIn=mp,u.without=ph,u.words=js,u.wrap=cd,u.xor=gh,u.xorBy=_h,u.xorWith=vh,u.zip=mh,u.zipObject=xh,u.zipObjectDeep=wh,u.zipWith=yh,u.entries=Js,u.entriesIn=Xs,u.extend=Ks,u.extendWith=si,yu(u,u),u.add=mg,u.attempt=ea,u.camelCase=bp,u.capitalize=Qs,u.ceil=xg,u.clamp=xp,u.clone=dd,u.cloneDeep=gd,u.cloneDeepWith=_d,u.cloneWith=pd,u.conformsTo=vd,u.deburr=Vs,u.defaultTo=Qp,u.divide=wg,u.endsWith=Cp,u.eq=ot,u.escape=Sp,u.escapeRegExp=Ap,u.every=Mh,u.find=Fh,u.findIndex=Cs,u.findKey=Yd,u.findLast=Wh,u.findLastIndex=Ss,u.findLastKey=Zd,u.floor=yg,u.forEach=Ls,u.forEachRight=Os,u.forIn=Jd,u.forInRight=Xd,u.forOwn=Qd,u.forOwnRight=Vd,u.get=_u,u.gt=md,u.gte=xd,u.has=tp,u.hasIn=vu,u.head=Es,u.identity=Fe,u.includes=Nh,u.indexOf=Wc,u.inRange=wp,u.invoke=ip,u.isArguments=xn,u.isArray=O,u.isArrayBuffer=wd,u.isArrayLike=Me,u.isArrayLikeObject=ie,u.isBoolean=yd,u.isBuffer=Xt,u.isDate=bd,u.isElement=Cd,u.isEmpty=Sd,u.isEqual=Ad,u.isEqualWith=Ed,u.isError=pu,u.isFinite=Td,u.isFunction=Mt,u.isInteger=zs,u.isLength=ui,u.isMap=Ns,u.isMatch=Rd,u.isMatchWith=Id,u.isNaN=Ld,u.isNative=Od,u.isNil=Pd,u.isNull=Md,u.isNumber=$s,u.isObject=ee,u.isObjectLike=ne,u.isPlainObject=hr,u.isRegExp=gu,u.isSafeInteger=Fd,u.isSet=ks,u.isString=oi,u.isSymbol=ze,u.isTypedArray=$n,u.isUndefined=Wd,u.isWeakMap=Bd,u.isWeakSet=Ud,u.join=Nc,u.kebabCase=Ep,u.last=Qe,u.lastIndexOf=$c,u.lowerCase=Tp,u.lowerFirst=Rp,u.lt=Dd,u.lte=zd,u.max=bg,u.maxBy=Cg,u.mean=Sg,u.meanBy=Ag,u.min=Eg,u.minBy=Tg,u.stubArray=Cu,u.stubFalse=Su,u.stubObject=hg,u.stubString=dg,u.stubTrue=pg,u.multiply=Rg,u.nth=kc,u.noConflict=ig,u.noop=bu,u.now=ni,u.pad=Ip,u.padEnd=Lp,u.padStart=Op,u.parseInt=Mp,u.random=yp,u.reduce=Hh,u.reduceRight=Kh,u.repeat=Pp,u.replace=Fp,u.result=cp,u.round=Ig,u.runInContext=f,u.sample=Zh,u.size=Qh,u.snakeCase=Wp,u.some=Vh,u.sortedIndex=Jc,u.sortedIndexBy=Xc,u.sortedIndexOf=Qc,u.sortedLastIndex=Vc,u.sortedLastIndexBy=jc,u.sortedLastIndexOf=eh,u.startCase=Up,u.startsWith=Dp,u.subtract=Lg,u.sum=Og,u.sumBy=Mg,u.template=zp,u.times=gg,u.toFinite=Pt,u.toInteger=M,u.toLength=qs,u.toLower=Np,u.toNumber=Ve,u.toSafeInteger=Nd,u.toString=q,u.toUpper=$p,u.trim=kp,u.trimEnd=Gp,u.trimStart=qp,u.truncate=Hp,u.unescape=Kp,u.uniqueId=vg,u.upperCase=Yp,u.upperFirst=mu,u.each=Ls,u.eachRight=Os,u.first=Es,yu(u,(function(){var e={};return xt(u,function(t,n){H.call(u.prototype,n)||(e[n]=t)}),e})(),{chain:!1}),u.VERSION=le,Ke(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){u[e].placeholder=u}),Ke(["drop","take"],function(e,t){U.prototype[e]=function(n){n=n===s?1:ae(M(n),0);var r=this.__filtered__&&!t?new U(this):this.clone();return r.__filtered__?r.__takeCount__=ye(n,r.__takeCount__):r.__views__.push({size:ye(n,B),type:e+(r.__dir__<0?"Right":"")}),r},U.prototype[e+"Right"]=function(n){return this.reverse()[e](n).reverse()}}),Ke(["filter","map","takeWhile"],function(e,t){var n=t+1,r=n==Bt||n==tn;U.prototype[e]=function(i){var o=this.clone();return o.__iteratees__.push({iteratee:A(i,3),type:n}),o.__filtered__=o.__filtered__||r,o}}),Ke(["head","last"],function(e,t){var n="take"+(t?"Right":"");U.prototype[e]=function(){return this[n](1).value()[0]}}),Ke(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");U.prototype[e]=function(){return this.__filtered__?new U(this):this[n](1)}}),U.prototype.compact=function(){return this.filter(Fe)},U.prototype.find=function(e){return this.filter(e).head()},U.prototype.findLast=function(e){return this.reverse().find(e)},U.prototype.invokeMap=F(function(e,t){return typeof e=="function"?new U(this):this.map(function(n){return or(n,e,t)})}),U.prototype.reject=function(e){return this.filter(ii(A(e)))},U.prototype.slice=function(e,t){e=M(e);var n=this;return n.__filtered__&&(e>0||t<0)?new U(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==s&&(t=M(t),n=t<0?n.dropRight(-t):n.take(t-e)),n)},U.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},U.prototype.toArray=function(){return this.take(B)},xt(U.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=u[r?"take"+(t=="last"?"Right":""):t],o=r||/^find/.test(t);i&&(u.prototype[t]=function(){var a=this.__wrapped__,l=r?[1]:arguments,c=a instanceof U,_=l[0],v=c||O(a),x=function(W){var D=i.apply(u,Gt([W],l));return r&&w?D[0]:D};v&&n&&typeof _=="function"&&_.length!=1&&(c=v=!1);var w=this.__chain__,C=!!this.__actions__.length,E=o&&!w,P=c&&!C;if(!o&&v){a=P?a:new U(this);var T=e.apply(a,l);return T.__actions__.push({func:ei,args:[x],thisArg:s}),new Ze(T,w)}return E&&P?e.apply(this,l):(T=this.thru(x),E?r?T.value()[0]:T.value():T)})}),Ke(["pop","push","shift","sort","splice","unshift"],function(e){var t=Er[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);u.prototype[e]=function(){var i=arguments;if(r&&!this.__chain__){var o=this.value();return t.apply(O(o)?o:[],i)}return this[n](function(a){return t.apply(O(a)?a:[],i)})}}),xt(U.prototype,function(e,t){var n=u[t];if(n){var r=n.name+"";H.call(Bn,r)||(Bn[r]=[]),Bn[r].push({name:t,func:n})}}),Bn[Yr(s,ke).name]=[{name:"wrapper",func:s}],U.prototype.clone=Hl,U.prototype.reverse=Kl,U.prototype.value=Yl,u.prototype.at=Ch,u.prototype.chain=Sh,u.prototype.commit=Ah,u.prototype.next=Eh,u.prototype.plant=Rh,u.prototype.reverse=Ih,u.prototype.toJSON=u.prototype.valueOf=u.prototype.value=Lh,u.prototype.first=u.prototype.head,jn&&(u.prototype[jn]=Th),u}),Pn=Sl();cn?((cn.exports=Pn)._=Pn,wi._=Pn):_e._=Pn}).call(g_)})(pr,pr.exports)),pr.exports}var la=__();function v_(ct,R,s){const le=Q(null),Ct=Q(!1),jt=Q(0),de=Q(""),en=Q([]),je=Q(new Set),yn=`progressive-guidance-charged-${ct}-${R}`,et=`progressive-guidance-${ct}-${R}`,N=()=>{try{const $=localStorage.getItem(et);if(!$)return[];const z=JSON.parse($);return Array.isArray(z)?z.filter(pe=>typeof pe=="string"&&pe.length>0):[]}catch{return[]}},ht=$=>{try{localStorage.setItem(et,JSON.stringify(Array.from(new Set($))))}catch{}},fe=()=>{try{localStorage.removeItem(et)}catch{}},tt=async()=>{const $=N();try{await fetch(bt("projects.manual-editor.progressive-guidance.steps",{project:ct,chapter:R}),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.content||""},body:JSON.stringify({completed_step_ids:$})})}catch(z){console.error("Failed to persist completed steps:",z)}},St=la.debounce(tt,400),we=$=>{try{const pe=new DOMParser().parseFromString($||"","text/html");return Array.from(pe.querySelectorAll("h1,h2,h3,h4,h5,h6")).map(_t=>(_t.textContent||"").trim()).filter(Boolean).slice(0,20)}catch{return[]}},ke=$=>{try{const We=(new DOMParser().parseFromString($||"","text/html").body?.textContent||"").replace(/\s+/g," ").trim();return We.length<=2e3?We:We.slice(-2e3)}catch{return($||"").slice(-2e3)}};if(s){le.value=s;const $=Array.isArray(s.completed_step_ids)&&s.completed_step_ids.length?s.completed_step_ids:(s.next_steps||[]).filter(z=>z.completed).map(z=>z.id);$.length&&(en.value=$,ht($))}const j=async($,z)=>{if($.word_count===void 0||$.word_count<0)return;const pe=Date.now();if(!(pe-jt.value<3e3)){Ct.value=!0,jt.value=pe;try{const We=N(),Bt=we(z),_t=ke(z),tn=await fetch(bt("projects.manual-editor.progressive-guidance",{project:ct,chapter:R}),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.content||""},body:JSON.stringify({analysis:{...$,outline:Bt,content_excerpt:_t,completed_step_ids:We}})});if(tn.ok){const Y=await tn.json();le.value=Y,Array.isArray(Y?.completed_step_ids)&&(en.value=Y.completed_step_ids,ht(en.value)),pt();const ge=Number(Y?.guidance_id);if(ge){if(je.value.size===0)try{const Z=localStorage.getItem(yn);if(Z){const k=JSON.parse(Z);Array.isArray(k)&&k.filter(B=>typeof B=="number"&&Number.isFinite(B)).forEach(B=>je.value.add(B))}}catch{}if(!je.value.has(ge)){const Z=Vt(Y?.contextual_tip||"")+Vt(Y?.stage_label||"")+Vt((Y?.next_steps||[]).map(k=>k?.text).join(" "))+Vt((Y?.writing_milestones||[]).map(k=>k?.label).join(" "));if(Z>0){je.value.add(ge);try{localStorage.setItem(yn,JSON.stringify(Array.from(je.value).slice(-50)))}catch{}Tu(Z,"Manual editor: Progressive guidance","chapter").catch(k=>console.error("Failed to record word usage (progressive guidance):",k))}}}else{const Z=JSON.stringify({stage:Y?.stage,completion:Y?.completion_percentage,tip:Y?.contextual_tip,steps:(Y?.next_steps||[]).map(k=>({t:k?.text,a:k?.action}))});if(Z&&Z!==de.value){de.value=Z;const k=Vt(Y?.contextual_tip||"")+Vt(Y?.stage_label||"")+Vt((Y?.next_steps||[]).map(B=>B?.text).join(" "))+Vt((Y?.writing_milestones||[]).map(B=>B?.label).join(" "));k>0&&Tu(k,"Manual editor: Progressive guidance","chapter").catch(B=>console.error("Failed to record word usage (progressive guidance):",B))}}}}catch(We){console.error("Failed to load progressive guidance:",We)}finally{Ct.value=!1}}},Ce=la.debounce(j,5e3),dt=$=>{if(!le.value)return;const z=le.value.next_steps.find(pe=>pe.id===$);z&&(z.completed=!z.completed,Te(),St())},Te=()=>{if(!le.value)return;const $=le.value.next_steps.filter(z=>z.completed).map(z=>z.id);ht($)},pt=()=>{if(!le.value)return;const $=N();$.length&&le.value.next_steps.forEach(z=>{$.includes(z.id)&&(z.completed=!0)})};return{guidance:le,isLoadingGuidance:Ct,requestGuidance:j,debouncedRequestGuidance:Ce,toggleStep:dt,clearCompletedSteps:()=>{le.value&&(le.value.next_steps.forEach($=>{$.completed=!1}),fe(),St())},getCompletionPercentage:()=>le.value?.completion_percentage||0,getCurrentStageLabel:()=>le.value?.stage_label||"Getting Started"}}const m_={class:"manual-editor h-screen flex flex-col bg-background dark:bg-background transition-colors duration-300"},x_={class:"md:hidden border-b h-14 px-3 flex justify-between items-center bg-background/80 backdrop-blur-md sticky top-0 z-50 transition-all duration-200"},w_={class:"flex items-center gap-2"},y_={class:"flex flex-col justify-center min-w-0 flex-1 mx-2"},b_={class:"items-center gap-2 text-xs font-medium text-muted-foreground mb-1 hidden sm:flex"},C_={class:"flex items-center gap-2 -ml-1"},S_={class:"font-bold text-base text-foreground truncate"},A_={class:"truncate"},E_={class:"flex gap-2 items-center"},T_={class:"hidden md:flex flex-col w-full z-50 sticky top-0 bg-background/80 backdrop-blur-md transition-all duration-200 border-b"},R_={class:"h-10 border-b border-border/40 flex items-center justify-center px-4 bg-background/60 relative"},I_={class:"flex items-center gap-2"},L_={class:"flex items-center gap-1 absolute right-4"},O_={class:"h-12 flex items-center justify-between px-4 bg-background/40"},M_={class:"flex items-center gap-3"},P_={class:"flex items-center gap-1"},F_={class:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-muted/30 border border-border/40"},W_={class:"flex items-center gap-1.5"},B_={class:"text-xs font-medium text-muted-foreground"},U_={key:0,class:"flex items-center gap-1.5"},D_={key:1,class:"text-xs text-muted-foreground"},z_={class:"flex items-center gap-3"},N_={class:"flex items-center gap-1 bg-muted/30 p-1 rounded-full border border-border/40"},$_={class:"text-xs font-medium"},k_={class:"w-full bg-background border-b px-3 md:px-6 py-2 flex flex-col gap-1"},G_={class:"flex justify-between items-center text-xs text-muted-foreground mb-1"},q_={class:"flex-1 flex overflow-hidden"},H_={key:0,class:"w-[320px] border-r bg-background/80 backdrop-blur-xl border-border/50 shadow-xl z-20 overflow-y-auto custom-scrollbar"},K_={class:"p-4"},Y_={class:"mb-3"},Z_={class:"text-xs text-muted-foreground"},J_={class:"flex-1 overflow-auto p-2 md:p-6 bg-background"},X_={key:0,class:"w-1/2 flex flex-col bg-background overflow-hidden"},Q_={class:"flex-1 overflow-y-auto custom-scrollbar"},V_={key:0,class:"w-[400px] border-l bg-background/80 backdrop-blur-xl border-border/50 shadow-2xl z-20 overflow-y-auto custom-scrollbar flex flex-col"},j_={class:"p-4 space-y-6"},ev={key:0,class:"space-y-2"},tv={key:1,class:"space-y-2"},nv={class:"flex items-center justify-between"},rv={class:"text-xs whitespace-pre-wrap rounded-lg border border-border/50 bg-muted/30 p-3"},iv={class:"space-y-2"},uv={class:"border-t p-2 md:p-3 flex flex-col gap-3 text-xs md:text-sm bg-muted/30"},ov={class:"flex flex-col sm:flex-row justify-between gap-3 sm:gap-2 items-start sm:items-center w-full"},sv={class:"flex gap-2 md:gap-4 flex-wrap items-center"},av={class:"text-muted-foreground"},lv={class:"text-foreground"},fv={key:0,class:"text-muted-foreground hidden sm:inline"},cv={class:"text-foreground"},hv={key:1,class:"text-muted-foreground hidden md:inline"},dv={class:"text-foreground"},pv={key:2,class:"text-muted-foreground hidden lg:inline"},gv={class:"flex gap-2 items-center w-full sm:w-auto"},_v={class:"text-xs font-medium"},vv=Pg({__name:"ManualEditor",props:{project:{},chapter:{},allChapters:{},facultyChapters:{},currentSuggestion:{},contextAnalysis:{},initialProgressGuidance:{},chatHistory:{}},setup(ct){const R=ct,s=Fg();li(()=>s.props?.flash,p=>{p&&(p.success&&te.success(p.success),p.error&&te.error(p.error))},{deep:!0,immediate:!0});const{wordBalance:le,balance:Ct,showPurchaseModal:jt,requiredWordsForModal:de,actionDescriptionForModal:en,checkAndPrompt:je,closePurchaseModal:yn,refreshBalance:et}=t_(),{content:N,isDirty:ht,isSaving:fe,lastSaved:tt,updateContent:St,manualSave:we}=$g(R.chapter,R.project.slug),{currentSuggestion:ke,currentAnalysis:j,isAnalyzing:Ce,saveSuggestion:dt,clearSuggestion:Te,applySuggestion:pt}=kg(R.chapter,R.project.slug,R.currentSuggestion,N,{onUsageRecorded:()=>et()}),{addToHistory:Ge}=Zg(R.chapter.content||""),gt=Q(!1),bn=Q(R.chapter.title||"");Q(!1),Q(!1),Q("");const $=()=>{gt.value=!gt.value},z=p=>{St(p),Ge(p)};dr(()=>{const p=bn.value?.trim(),m=N.value?.trim();return!!(p&&p.length>0&&m&&m.length>50)});const{guidance:pe,isLoadingGuidance:We,debouncedRequestGuidance:Bt,toggleStep:_t}=v_(R.project.slug,R.chapter.chapter_number,R.initialProgressGuidance||null),tn=Q(!1),Y=()=>typeof window<"u"&&window.innerWidth<1024,ge=(p,m)=>{try{const I=localStorage.getItem(p);return I!==null?I==="true":m}catch{return m}},Z=Q(Y()),k=Q(ge("manualEditor_showLeftSidebar",!Z.value)),B=Q(ge("manualEditor_showRightSidebar",!Z.value)),qn=Q(""),Cn=Q(null),Ut=Q(null),qe=Q("");Q(!1),Q([]),Q(!1);const Re=Q(!0),nt=Q((()=>{try{return localStorage.getItem("citationOperationMode")==="true"}catch{return!1}})()),nn=()=>{nt.value=!0,B.value=!1;try{localStorage.setItem("citationOperationMode","true")}catch{}},fi=()=>{nt.value=!1,B.value=!0;try{localStorage.setItem("citationOperationMode","false")}catch{}},rn=Q(!1),Sn=async()=>{te.info("Fullscreen temporarily disabled")},gr=()=>{Qt.visit(bt("projects.analysis",{project:R.project.slug}))};Au(()=>{}),ra(()=>{});const{isDark:Ie,toggle:un}=Wg(),ci=dr(()=>{const p=j.value?.word_count??R.chapter.word_count,m=R.chapter.target_word_count||1e3;return Math.min(p/m*100,100)});dr(()=>fe.value?"Saving...":tt.value?`Saved ${tt.value}`:"Not saved");const rt=()=>{k.value=!k.value},_r=()=>{B.value=!B.value};li(k,p=>{if(!Z.value)try{localStorage.setItem("manualEditor_showLeftSidebar",String(p))}catch(m){console.error("Failed to save left sidebar state:",m)}}),li(B,p=>{if(!Z.value)try{localStorage.setItem("manualEditor_showRightSidebar",String(p))}catch(m){console.error("Failed to save right sidebar state:",m)}});const vr=p=>{(p.ctrlKey||p.metaKey)&&p.key==="s"&&(p.preventDefault(),$t())};Au(()=>{Z.value=window.innerWidth<1024,Z.value&&(k.value=!1,B.value=!1);const p=()=>{const m=Z.value;Z.value=window.innerWidth<1024,m!==Z.value&&(Z.value?(k.value=!1,B.value=!1):(k.value=ge("manualEditor_showLeftSidebar",!0),B.value=ge("manualEditor_showRightSidebar",!0)))};window.addEventListener("resize",p),window.addEventListener("keydown",vr),ra(()=>{window.removeEventListener("resize",p),window.removeEventListener("keydown",vr)})}),li(()=>j.value,p=>{p&&Bt({word_count:p.word_count,citation_count:p.citation_count,table_count:p.table_count,figure_count:p.figure_count,claim_count:p.claim_count,has_introduction:p.has_introduction,has_conclusion:p.has_conclusion,detected_issues:p.detected_issues,quality_metrics:p.quality_metrics},N.value)},{deep:!0}),Au(()=>{tn.value||!((R.chapter.word_count||0)>50||N.value&&N.value.trim().length>200)||pe.value||(tn.value=!0,Bt({word_count:R.chapter.word_count||0,citation_count:R.contextAnalysis?.citation_count||0,table_count:R.contextAnalysis?.table_count||0,figure_count:R.contextAnalysis?.figure_count||0,claim_count:R.contextAnalysis?.claim_count||0,has_introduction:R.contextAnalysis?.has_introduction||!1,has_conclusion:R.contextAnalysis?.has_conclusion||!1,detected_issues:R.contextAnalysis?.detected_issues||[],quality_metrics:R.contextAnalysis?.quality_metrics||{}},N.value||""))});const Dt=p=>{z(p),te.success("Applied improved text")},Le=p=>{if(Ut.value?.replaceSelection(p,Cn.value||void 0)??!1){te.success("Expanded selection");return}z(`${N.value}

${p}`),te.success("Added expanded text")},zt=p=>{qe.value=p,Re.value=!0;try{navigator.clipboard?.writeText(p)}catch{}te.success("Citation suggestions ready")},on=p=>{if(Ut.value?.replaceSelection(p,Cn.value||void 0)??!1){te.success("Applied rephrased text");return}z(`${N.value}

${p}`),te.success("Added rephrased text")},hi=p=>{const m=pe.value?.next_steps?.find(I=>I?.id===p);if(!(!m||!m.action||m.action==="none")){if(m.action==="open_citation_helper"){Re.value=!0,te.success("Citation helper opened"),_t(p);return}if(m.action==="insert_text"){const I=m?.payload?.text;if(typeof I!="string"||!I.trim()){te.error("Nothing to insert for this step");return}Ut.value?.replaceSelection(I.trim(),Cn.value||void 0)??!1?te.success("Inserted into selection"):(z(`${N.value}

${I.trim()}`),te.success("Inserted into chapter")),_t(p)}}},Nt=(p,m)=>je(p,m),mr=async(p,m)=>{const I=Math.max(0,Math.round(p||0));I&&(await Tu(I,m,"chapter",R.chapter.id),await et())},sn=async()=>{if(qe.value)try{await navigator.clipboard.writeText(qe.value),te.success("Copied citation suggestions")}catch{te.error("Could not copy citation suggestions")}},vt=dr(()=>R.allChapters.find(p=>p.chapter_number===R.chapter.chapter_number-1)),an=dr(()=>R.allChapters.find(p=>p.chapter_number===R.chapter.chapter_number+1)),ln=(p,m)=>{if(m&&N.value){const Tn=m.trim(),Kn=document.createElement("div");Kn.innerHTML=N.value;const Yn=Kn.textContent||Kn.innerText||"",Zn=Yn.indexOf(Tn);if(Zn!==-1){const Jn=Zn+Tn.length,xr=Yn.substring(Jn).match(/^[^.!?]*[.!?]/);let Xn;xr?Xn=Jn+xr[0].length:Xn=Jn;let ce=0,Rn=0;const mt=N.value;for(;ce<mt.length&&Rn<Xn;)if(mt[ce]==="<"){for(;ce<mt.length&&mt[ce]!==">";)ce++;ce++}else if(mt[ce]==="&"){const fn=mt.indexOf(";",ce);fn!==-1&&fn-ce<10?(ce=fn+1,Rn++):(ce++,Rn++)}else ce++,Rn++;if(ce>0){const fn=mt.substring(0,ce),Qn=mt.substring(ce),di=`${fn} ${p}${Qn}`;z(di),te.success("Citation inserted at claim location");return}}}const I=Ut.value?.getCursorPosition?.();if(typeof I=="number"&&(Ut.value?.replaceTextAt?.({from:I,to:I},` ${p} `)??!1)){te.success("Citation inserted at cursor");return}z(`${N.value} ${p}`),te.success("Citation appended to content")},At=p=>{ht.value&&!confirm("You have unsaved changes. Are you sure you want to switch chapters?")||Qt.visit(bt("projects.manual-editor.show",{project:R.project.slug,chapter:p}))},An=()=>{const p=R.chapter.chapter_number+1;R.allChapters.find(I=>I.chapter_number===p)?At(p):te.info("Please create the next chapter from the dashboard first.")},En=p=>{confirm("Are you sure you want to delete this chapter?")&&Qt.delete(bt("chapters.destroy",{project:R.project.slug,chapter:R.allChapters.find(m=>m.id===p)?.slug}),{onSuccess:()=>te.success("Chapter deleted")})},$t=async()=>{try{await we(),te.success("Chapter saved successfully")}catch{te.error("Failed to save chapter")}},Hn=async()=>{console.log("🔵 [MARK COMPLETE] Function called"),console.log("🔵 [MARK COMPLETE] Current word count:",j.value?.word_count??R.chapter.word_count);try{console.log("🔵 [MARK COMPLETE] Saving chapter..."),await we(),console.log("✅ [MARK COMPLETE] Chapter saved");const p=bt("projects.manual-editor.mark-complete",{project:R.project.slug,chapter:R.chapter.chapter_number});console.log("🔵 [MARK COMPLETE] Posting to:",p),Qt.post(p,{},{onSuccess:()=>{console.log("✅ [MARK COMPLETE] Request successful")},onError:m=>{console.error("❌ [MARK COMPLETE] Request failed:",m)}})}catch(p){console.error("❌ [MARK COMPLETE] Error:",p),te.error("Failed to save chapter before marking complete")}};return(p,m)=>(re(),at(Ug,null,[S(g(Bg),{title:`${p.chapter.title} - Manual Editor`},null,8,["title"]),b("div",m_,[b("header",x_,[b("div",w_,[S(g(xe),{variant:"ghost",size:"icon",class:"h-8 w-8 text-zinc-700 dark:text-zinc-300 hover:text-foreground",onClick:m[0]||(m[0]=I=>g(Qt).visit(g(bt)("projects.show",p.project.slug))),title:"Back to Project"},{default:oe(()=>[S(g(oa),{class:"w-4 h-4"})]),_:1}),S(g(Wt),{orientation:"vertical",class:"h-6"}),S(g(xe),{onClick:m[1]||(m[1]=I=>k.value=!0),variant:"ghost",size:"icon",class:"h-8 w-8 lg:hidden text-muted-foreground hover:text-foreground",title:"Open Chapter Navigation"},{default:oe(()=>[S(g(r_),{class:"w-4 h-4"})]),_:1})]),b("div",y_,[b("div",b_,[b("span",{class:"hover:text-foreground transition-colors cursor-pointer truncate",onClick:m[2]||(m[2]=I=>g(Qt).visit(g(bt)("projects.show",p.project.slug)))},me(p.project.title),1)]),b("div",C_,[b("div",S_,[b("span",A_,"Ch. "+me(p.chapter.chapter_number),1)])])]),b("div",E_,[S(g(xe),{variant:"ghost",size:"icon",class:"h-8 w-8",onClick:$t,disabled:g(fe),title:"Save"},{default:oe(()=>[S(g(Eu),{class:"w-4 h-4"})]),_:1},8,["disabled"]),S(g(Wt),{orientation:"vertical",class:"h-6 mx-1 opacity-50"}),S(g(xe),{onClick:m[3]||(m[3]=I=>B.value=!0),variant:"ghost",size:"icon",class:"h-8 w-8 text-muted-foreground hover:text-foreground",title:"Open Tools"},{default:oe(()=>[S(g(sa),{class:"w-4 h-4"})]),_:1})])]),b("div",T_,[b("div",R_,[b("div",I_,[b("h1",{class:"text-sm font-bold text-foreground cursor-pointer hover:text-primary transition-colors",onClick:m[4]||(m[4]=I=>g(Qt).visit(g(bt)("projects.show",p.project.slug)))},me(p.project.title),1),S(g(Dg),{variant:"secondary",class:"h-5 px-2 text-[10px] rounded-full"},{default:oe(()=>[wn("Ch "+me(p.chapter.chapter_number),1)]),_:1})]),b("div",L_,[vt.value?(re(),lt(g(xe),{key:0,variant:"ghost",size:"sm",class:"h-6 px-2 text-zinc-500 hover:text-foreground gap-1 rounded-full text-[10px]",onClick:m[5]||(m[5]=I=>At(vt.value.chapter_number)),title:`Previous: ${vt.value.title}`},{default:oe(()=>[S(g(i_),{class:"w-3 h-3"}),m[17]||(m[17]=wn(" Prev ",-1))]),_:1},8,["title"])):ft("",!0),an.value?(re(),lt(g(xe),{key:1,variant:"ghost",size:"sm",class:"h-6 px-2 text-zinc-500 hover:text-foreground gap-1 rounded-full text-[10px]",onClick:m[6]||(m[6]=I=>At(an.value.chapter_number)),title:`Next: ${an.value.title}`},{default:oe(()=>[m[18]||(m[18]=wn(" Next ",-1)),S(g(u_),{class:"w-3 h-3"})]),_:1},8,["title"])):ft("",!0)])]),b("div",O_,[b("div",M_,[b("div",P_,[S(g(xe),{variant:"ghost",size:"icon",class:"h-8 w-8 text-zinc-700 dark:text-zinc-300 hover:text-foreground rounded-full",onClick:m[7]||(m[7]=I=>g(Qt).visit(g(bt)("projects.show",p.project.slug))),title:"Back to Project"},{default:oe(()=>[S(g(oa),{class:"w-4 h-4"})]),_:1}),m[19]||(m[19]=b("div",{class:"h-4 w-px bg-border/50 mx-1"},null,-1)),S(g(xe),{onClick:rt,variant:"ghost",size:"icon",class:Gn(["h-8 w-8 transition-all duration-300 rounded-full",k.value?"text-primary":"text-zinc-700 dark:text-zinc-300 hover:text-foreground"]),title:"Toggle Chapter Navigation"},{default:oe(()=>[k.value?(re(),lt(g(o_),{key:0,class:"w-4 h-4"})):(re(),lt(g(s_),{key:1,class:"w-4 h-4"}))]),_:1},8,["class"])]),m[21]||(m[21]=b("div",{class:"h-4 w-px bg-border/50"},null,-1)),b("div",F_,[b("div",W_,[b("div",{class:Gn(["w-2 h-2 rounded-full transition-colors duration-300",g(ht)?"bg-amber-500 animate-pulse":"bg-emerald-500"])},null,2),b("span",B_,me(g(ht)?"Unsaved":"Saved"),1)]),S(g(Wt),{orientation:"vertical",class:"h-3"}),g(Ce)?(re(),at("div",U_,[S(g(a_),{class:"w-3 h-3 animate-spin text-primary"}),m[20]||(m[20]=b("span",{class:"text-xs text-muted-foreground"},"Analyzing",-1))])):(re(),at("div",D_,me(g(j)?.word_count??p.chapter.word_count)+" words ",1))])]),m[24]||(m[24]=b("div",{class:"flex-1 px-4 min-w-0"},[b("div",{id:"manual-editor-toolbar",class:"mx-auto max-w-[950px]"})],-1)),b("div",z_,[b("div",N_,[S(g(xe),{variant:"ghost",size:"icon",class:"h-7 w-7 rounded-full text-zinc-700 dark:text-zinc-300 hover:text-foreground",onClick:g(un),title:g(Ie)?"Switch to Light Mode":"Switch to Dark Mode"},{default:oe(()=>[g(Ie)?(re(),lt(g(l_),{key:0,class:"w-4 h-4"})):(re(),lt(g(f_),{key:1,class:"w-4 h-4"}))]),_:1},8,["onClick","title"]),S(g(xe),{variant:"ghost",size:"icon",class:"h-7 w-7 rounded-full text-zinc-700 dark:text-zinc-300 hover:text-foreground",onClick:Sn,title:rn.value?"Exit Full Screen":"Enter Full Screen"},{default:oe(()=>[rn.value?(re(),lt(g(c_),{key:0,class:"w-4 h-4"})):(re(),lt(g(Jg),{key:1,class:"w-4 h-4"}))]),_:1},8,["title"]),S(g(xe),{onClick:$,variant:"ghost",size:"icon",class:Gn(["h-7 w-7 rounded-full transition-all duration-300",gt.value?"bg-background shadow-sm text-primary":"text-zinc-700 dark:text-zinc-300 hover:text-foreground"]),title:"Toggle AI Chat Mode"},{default:oe(()=>[S(g(sa),{class:"w-4 h-4"})]),_:1},8,["class"]),S(g(xe),{onClick:_r,variant:"ghost",size:"icon",class:Gn(["h-7 w-7 rounded-full transition-all duration-300",B.value?"bg-background shadow-sm text-primary":"text-zinc-700 dark:text-zinc-300 hover:text-foreground"]),title:"Toggle Tools Sidebar"},{default:oe(()=>[B.value?(re(),lt(g(Xg),{key:0,class:"w-4 h-4"})):(re(),lt(g(Qg),{key:1,class:"w-4 h-4"}))]),_:1},8,["class"])]),m[23]||(m[23]=b("div",{class:"w-px h-4 bg-border/50"},null,-1)),g(le)?(re(),lt(e_,{key:0,balance:g(le),compact:""},null,8,["balance"])):ft("",!0),S(Vg,{project:p.project,"current-chapter":p.chapter,"all-chapters":p.allChapters,size:"sm",variant:"outline",class:"h-9","button-class":"rounded-full bg-background/50"},null,8,["project","current-chapter","all-chapters"]),S(g(xe),{variant:"ghost",size:"sm",class:"h-9 gap-2 text-zinc-700 dark:text-zinc-300 hover:text-foreground rounded-full bg-background/50 border border-transparent hover:border-border/50",onClick:gr,title:"Open bulk analysis"},{default:oe(()=>[S(g(h_),{class:"w-4 h-4"}),m[22]||(m[22]=b("span",{class:"text-xs font-medium"},"Analyze",-1))]),_:1}),S(g(xe),{variant:"outline",size:"sm",class:"h-9 gap-2 text-zinc-700 dark:text-zinc-300 hover:text-foreground rounded-full bg-background/50",onClick:$t,disabled:g(fe),title:"Save (Ctrl+S)"},{default:oe(()=>[S(g(Eu),{class:"w-4 h-4"}),b("span",$_,me(g(fe)?"Saving...":"Save"),1)]),_:1},8,["disabled"])])])]),b("div",k_,[b("div",G_,[m[25]||(m[25]=b("span",{class:"font-medium"},"Writing Progress",-1)),b("span",null,me(g(j)?.word_count??p.chapter.word_count)+" / "+me(p.chapter.target_word_count)+" words",1)]),S(g(zg),{"model-value":ci.value,class:"h-1.5"},null,8,["model-value"])]),b("div",q_,[S(ia,{"enter-active-class":"transition-all duration-500 cubic-bezier(0.4, 0, 0.2, 1)","enter-from-class":"-ml-[320px] opacity-0","enter-to-class":"ml-0 opacity-100","leave-active-class":"transition-all duration-500 cubic-bezier(0.4, 0, 0.2, 1)","leave-from-class":"ml-0 opacity-100","leave-to-class":"-ml-[320px] opacity-0"},{default:oe(()=>[k.value&&!Z.value?(re(),at("aside",H_,[b("div",K_,[b("div",Y_,[m[26]||(m[26]=b("h2",{class:"text-sm font-semibold text-foreground mb-1"},"Table of Contents",-1)),b("p",Z_,me(p.allChapters.length)+" Chapters",1)]),S(Yg,{"all-chapters":p.allChapters,"current-chapter":p.chapter,project:p.project,outlines:p.project.outlines||[],"faculty-chapters":p.facultyChapters||[],"current-word-count":g(j)?.word_count||p.chapter.word_count,"target-word-count":p.chapter.target_word_count,"writing-quality-score":0,"chapter-content-length":g(N)?.length||0,onGoToChapter:At,onGenerateNextChapter:An,onDeleteChapter:En},null,8,["all-chapters","current-chapter","project","outlines","faculty-chapters","current-word-count","target-word-count","chapter-content-length"])])])):ft("",!0)]),_:1}),b("div",{class:Gn(["flex-1 flex overflow-hidden",nt.value?"flex-row":"flex-col"])},[b("div",{class:Gn(["flex flex-col overflow-hidden",nt.value?"w-1/2 border-r border-border/50":"flex-1"])},[b("div",J_,[S(Ng,{ref_key:"editorRef",ref:Ut,modelValue:g(N),"onUpdate:modelValue":z,"onUpdate:selectedText":m[8]||(m[8]=I=>qn.value=I),"onUpdate:selectionRange":m[9]||(m[9]=I=>Cn.value=I),"manual-mode":!0,"toolbar-teleport-target":Z.value?"":"#manual-editor-toolbar",class:"min-h-full"},null,8,["modelValue","toolbar-teleport-target"])])],2),nt.value?(re(),at("div",X_,[b("div",Q_,[S(ua,{"show-citation-helper":Re.value,"onUpdate:showCitationHelper":m[10]||(m[10]=I=>Re.value=I),"chapter-content":g(N),"chapter-id":p.chapter.id,"citation-operation-mode":!0,onInsertCitation:ln,onExitOperationMode:fi},null,8,["show-citation-helper","chapter-content","chapter-id"])])])):ft("",!0)],2),S(ia,{"enter-active-class":"transition-all duration-500 cubic-bezier(0.4, 0, 0.2, 1)","enter-from-class":"-mr-[400px] opacity-0","enter-to-class":"mr-0 opacity-100","leave-active-class":"transition-all duration-500 cubic-bezier(0.4, 0, 0.2, 1)","leave-from-class":"mr-0 opacity-100","leave-to-class":"-mr-[400px] opacity-0"},{default:oe(()=>[B.value&&!Z.value?(re(),at("aside",V_,[b("div",j_,[g(ke)?(re(),at("div",ev,[S(Gg,{suggestion:g(ke),analysis:g(j),onSave:g(dt),onClear:g(Te),onApply:g(pt)},null,8,["suggestion","analysis","onSave","onClear","onApply"]),S(g(Wt),{class:"bg-border/50"})])):ft("",!0),S(qg,{guidance:g(pe),"is-loading":g(We),"has-content":(g(j)?.word_count??p.chapter.word_count)>50,onToggleStep:g(_t),onGuidanceAction:hi},null,8,["guidance","is-loading","has-content","onToggleStep"]),S(g(Wt),{class:"bg-border/50"}),S(Hg,{"project-slug":p.project.slug,"chapter-number":p.chapter.chapter_number,"selected-text":qn.value,"chapter-content":g(N),"is-processing":g(Ce)||g(fe),"ensure-balance":Nt,"on-usage":mr,onTextImproved:Dt,onTextExpanded:Le,onCitationsSuggested:zt,onTextRephrased:on,onOpenCitationHelper:m[11]||(m[11]=I=>Re.value=!0)},null,8,["project-slug","chapter-number","selected-text","chapter-content","is-processing"]),S(g(Wt),{class:"bg-border/50"}),qe.value?(re(),at("div",tv,[b("div",nv,[m[28]||(m[28]=b("h3",{class:"text-sm font-semibold text-foreground"},"Citation Suggestions",-1)),S(g(xe),{size:"sm",variant:"outline",onClick:sn},{default:oe(()=>[...m[27]||(m[27]=[wn(" Copy ",-1)])]),_:1})]),b("pre",rv,me(qe.value),1),S(g(Wt),{class:"bg-border/50"})])):ft("",!0),b("div",iv,[S(ua,{"show-citation-helper":Re.value,"onUpdate:showCitationHelper":m[12]||(m[12]=I=>Re.value=I),"chapter-content":g(N),"chapter-id":p.chapter.id,onInsertCitation:ln,onEnterOperationMode:nn},null,8,["show-citation-helper","chapter-content","chapter-id"])]),S(g(Wt),{class:"bg-border/50"}),S(g(Wt),{class:"bg-border/50"})])])):ft("",!0)]),_:1}),S(Kg,{"show-left-sidebar":k.value,"show-right-sidebar":B.value,"is-mobile":Z.value,"all-chapters":p.allChapters,"current-chapter":p.chapter,project:p.project,"faculty-chapters":p.facultyChapters,"current-word-count":g(j)?.word_count||p.chapter.word_count,"target-word-count":p.chapter.target_word_count,"chapter-content-length":g(N)?.length||0,"selected-text":qn.value,"is-analyzing":g(Ce),"is-saving":g(fe),"current-suggestion":g(ke),"current-analysis":g(j),guidance:g(pe),"is-loading-guidance":g(We),"chapter-content":g(N),"show-citation-helper":Re.value,"ensure-balance":Nt,"on-usage":mr,"onUpdate:showLeftSidebar":m[13]||(m[13]=I=>k.value=I),"onUpdate:showRightSidebar":m[14]||(m[14]=I=>B.value=I),"onUpdate:showCitationHelper":m[15]||(m[15]=I=>Re.value=I),onGoToChapter:At,onGenerateNextChapter:An,onDeleteChapter:En,onSaveSuggestion:g(dt),onClearSuggestion:g(Te),onApplySuggestion:g(pt),onToggleStep:g(_t),onTextImproved:Dt,onTextExpanded:Le,onCitationsSuggested:zt,onTextRephrased:on,onInsertCitation:ln},null,8,["show-left-sidebar","show-right-sidebar","is-mobile","all-chapters","current-chapter","project","faculty-chapters","current-word-count","target-word-count","chapter-content-length","selected-text","is-analyzing","is-saving","current-suggestion","current-analysis","guidance","is-loading-guidance","chapter-content","show-citation-helper","onSaveSuggestion","onClearSuggestion","onApplySuggestion","onToggleStep"])]),b("footer",uv,[b("div",ov,[b("div",sv,[b("span",av,[m[29]||(m[29]=b("span",{class:"hidden sm:inline"},"Words: ",-1)),b("strong",lv,me(g(j)?.word_count??p.chapter.word_count),1),wn(" / "+me(p.chapter.target_word_count),1)]),g(j)?(re(),at("span",fv,[m[30]||(m[30]=wn(" Citations: ",-1)),b("strong",cv,me(g(j).citation_count),1)])):ft("",!0),g(j)?(re(),at("span",hv,[m[31]||(m[31]=wn(" Tables: ",-1)),b("strong",dv,me(g(j).table_count),1)])):ft("",!0),g(j)?(re(),at("span",pv," Quality: "+me(g(j).quality_metrics.reading_level),1)):ft("",!0)]),b("div",gv,[S(g(xe),{variant:"outline",size:"sm",class:"h-8 md:h-9 gap-2 flex-1 sm:flex-initial",onClick:$t,disabled:g(fe),title:"Save chapter"},{default:oe(()=>[S(g(Eu),{class:"w-3.5 h-3.5 md:w-4 md:h-4"}),b("span",_v,me(g(fe)?"Saving...":"Save"),1)]),_:1},8,["disabled"]),S(g(xe),{variant:"default",size:"sm",class:"h-8 md:h-9 gap-2 flex-1 sm:flex-initial",onClick:Hn,disabled:g(fe),title:"Save and mark chapter as complete"},{default:oe(()=>[S(g(d_),{class:"w-3.5 h-3.5 md:w-4 md:h-4"}),m[32]||(m[32]=b("span",{class:"text-xs font-medium hidden sm:inline"},"Mark Complete",-1)),m[33]||(m[33]=b("span",{class:"text-xs font-medium sm:hidden"},"Complete",-1))]),_:1},8,["disabled"])])])]),S(n_,{open:g(jt),"current-balance":g(Ct),"required-words":g(de),action:g(en),"onUpdate:open":m[16]||(m[16]=I=>jt.value=I),onClose:g(yn)},null,8,["open","current-balance","required-words","action","onClose"]),S(g(jg),{position:"top-center"})])],64))}}),K0=p_(vv,[["__scopeId","data-v-64e687e7"]]);export{K0 as default};
