import{bt as L,bs as k,cn as O,co as u,cp as o,cr as d,cq as t,bE as s,cs as l,cB as m,cG as $,cS as A,df as B,ct as f,cl as v,cj as r,ce as y}from"./vendor-BwJgEX4g.js";import{_ as h}from"./AdminLayout.vue_vue_type_script_setup_true_lang-BzzpffZS.js";import{_ as C,a as V}from"./CardContent.vue_vue_type_script_setup_true_lang-CHCDuRZd.js";import{_ as w}from"./CardDescription.vue_vue_type_script_setup_true_lang-CUZkTCdh.js";import{_ as I,a as T}from"./CardTitle.vue_vue_type_script_setup_true_lang-CFv199a3.js";import{_ as g}from"./index-Dh4Dof5h.js";import{_ as x}from"./Input.vue_vue_type_script_setup_true_lang-BcqgGMan.js";import{_ as p}from"./Label.vue_vue_type_script_setup_true_lang-BCDEh9UE.js";import{_ as q,a as G,b as R,c as J,d as F}from"./SelectValue.vue_vue_type_script_setup_true_lang-DtEl4IcM.js";import{_ as K}from"./index-DXsLaJg_.js";import{_ as X}from"./Switch.vue_vue_type_script_setup_true_lang-Ch_R0qD7.js";import"./Sonner.vue_vue_type_script_setup_true_lang-BX3Dlz2r.js";import"./UserInfo.vue_vue_type_script_setup_true_lang-Be-HwAt8.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-DJ0GQY-9.js";const z={class:"grid gap-6 lg:grid-cols-[1.1fr_1fr]"},M={class:"space-y-2"},P={key:0,class:"space-y-2"},H={class:"space-y-2"},Q={class:"space-y-2"},W={key:0,class:"text-sm text-muted-foreground"},Y={key:1,class:"space-y-4"},Z={class:"flex items-start justify-between gap-4"},ee={class:"flex items-center gap-2"},te={class:"text-sm bg-muted px-2 py-1 rounded"},se={class:"text-xs text-muted-foreground mt-2"},ae={key:0,class:"text-xs text-muted-foreground"},oe={class:"flex items-center gap-2"},xe=L({__name:"Invites",props:{invites:{}},setup(N){const b=N,n=k({type:"single_use",max_uses:null,expires_at:"",note:""}),_=k(!1),S=async()=>{_.value=!0;try{const e=await(await fetch(v("admin.affiliates.invites.store"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({type:n.value.type,max_uses:n.value.type==="reusable"?n.value.max_uses:null,expires_at:n.value.expires_at||null,note:n.value.note||null})})).json();e.success?(r.success("Invite created"),y.reload({only:["invites"]}),n.value={type:"single_use",max_uses:null,expires_at:"",note:""}):r.error(e.message||"Failed to create invite")}catch{r.error("Failed to create invite")}finally{_.value=!1}},E=async(i,e)=>{try{const c=await(await fetch(v("admin.affiliates.invites.update",i.id),{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify(e)})).json();c.success?(r.success("Invite updated"),y.reload({only:["invites"]})):r.error(c.message||"Failed to update invite")}catch{r.error("Failed to update invite")}},U=async i=>{try{const a=await(await fetch(v("admin.affiliates.invites.destroy",i.id),{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}})).json();a.success?(r.success("Invite deleted"),y.reload({only:["invites"]})):r.error(a.message||"Failed to delete invite")}catch{r.error("Failed to delete invite")}},j=async i=>{try{await navigator.clipboard.writeText(`${window.location.origin}/affiliate/invite/${i}`),r.success("Invite link copied")}catch{r.error("Failed to copy invite link")}},D=i=>i?new Date(i).toLocaleDateString("en-NG",{year:"numeric",month:"short",day:"numeric"}):"—";return(i,e)=>(u(),O(h,{title:"Affiliate Invites",subtitle:"Generate and manage affiliate registration invites."},{default:o(()=>[d("div",z,[t(s(C),{class:"border-border/50"},{default:o(()=>[t(s(I),null,{default:o(()=>[t(s(T),null,{default:o(()=>[...e[4]||(e[4]=[l("Create Invite",-1)])]),_:1}),t(s(w),null,{default:o(()=>[...e[5]||(e[5]=[l("Generate single-use or reusable invite links.",-1)])]),_:1})]),_:1}),t(s(V),{class:"space-y-4"},{default:o(()=>[d("div",M,[t(s(p),null,{default:o(()=>[...e[6]||(e[6]=[l("Invite Type",-1)])]),_:1}),t(s(q),{modelValue:n.value.type,"onUpdate:modelValue":e[0]||(e[0]=a=>n.value.type=a)},{default:o(()=>[t(s(G),null,{default:o(()=>[t(s(R))]),_:1}),t(s(J),null,{default:o(()=>[t(s(F),{value:"single_use"},{default:o(()=>[...e[7]||(e[7]=[l("Single Use",-1)])]),_:1}),t(s(F),{value:"reusable"},{default:o(()=>[...e[8]||(e[8]=[l("Reusable",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),n.value.type==="reusable"?(u(),m("div",P,[t(s(p),null,{default:o(()=>[...e[9]||(e[9]=[l("Max Uses",-1)])]),_:1}),t(s(x),{modelValue:n.value.max_uses,"onUpdate:modelValue":e[1]||(e[1]=a=>n.value.max_uses=a),modelModifiers:{number:!0},type:"number",min:"1"},null,8,["modelValue"])])):$("",!0),d("div",H,[t(s(p),null,{default:o(()=>[...e[10]||(e[10]=[l("Expires At",-1)])]),_:1}),t(s(x),{modelValue:n.value.expires_at,"onUpdate:modelValue":e[2]||(e[2]=a=>n.value.expires_at=a),type:"date"},null,8,["modelValue"])]),d("div",Q,[t(s(p),null,{default:o(()=>[...e[11]||(e[11]=[l("Note",-1)])]),_:1}),t(s(x),{modelValue:n.value.note,"onUpdate:modelValue":e[3]||(e[3]=a=>n.value.note=a),placeholder:"For John Doe"},null,8,["modelValue"])]),t(s(g),{class:"w-full",disabled:_.value,onClick:S},{default:o(()=>[...e[12]||(e[12]=[l(" Create Invite ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1}),t(s(C),{class:"border-border/50"},{default:o(()=>[t(s(I),null,{default:o(()=>[t(s(T),null,{default:o(()=>[...e[13]||(e[13]=[l("Invite List",-1)])]),_:1}),t(s(w),null,{default:o(()=>[...e[14]||(e[14]=[l("Track invite usage and status.",-1)])]),_:1})]),_:1}),t(s(V),null,{default:o(()=>[b.invites.data.length===0?(u(),m("div",W,"No invites yet.")):(u(),m("div",Y,[(u(!0),m(A,null,B(b.invites.data,a=>(u(),m("div",{key:a.id,class:"rounded-lg border border-border/50 p-4"},[d("div",Z,[d("div",null,[d("div",ee,[d("code",te,f(a.code),1),t(s(K),{variant:"secondary"},{default:o(()=>[l(f(a.type.replace("_"," ")),1)]),_:2},1024)]),d("p",se," Uses: "+f(a.uses)+f(a.max_uses?` / ${a.max_uses}`:"")+" · Expires: "+f(D(a.expires_at)),1),a.note?(u(),m("p",ae,f(a.note),1)):$("",!0)]),d("div",oe,[t(s(X),{checked:a.is_active,"onUpdate:checked":c=>E(a,{is_active:c})},null,8,["checked","onUpdate:checked"]),t(s(g),{variant:"outline",size:"sm",onClick:c=>j(a.code)},{default:o(()=>[...e[15]||(e[15]=[l("Copy Link",-1)])]),_:2},1032,["onClick"]),t(s(g),{variant:"ghost",size:"sm",onClick:c=>U(a)},{default:o(()=>[...e[16]||(e[16]=[l("Delete",-1)])]),_:2},1032,["onClick"])])])]))),128))]))]),_:1})]),_:1})])]),_:1}))}});export{xe as default};
