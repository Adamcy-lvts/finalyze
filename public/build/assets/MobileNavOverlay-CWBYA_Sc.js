import{bs as C,ck as E,bt as I,ci as F,bA as Q,cB as c,co as u,cr as t,cG as _,cq as i,bE as s,iq as z,ct as f,ir as U,is as M,cS as N,df as G,cu as O,it as V,cj as B,cp as v,cF as $,eN as W,h3 as J,cs as H}from"./vendor-DwcF3VNb.js";import{_ as Y,a as Z}from"./index-cXKiD0GD.js";import{_ as X}from"./index-BpTO5Kag.js";import{A as K}from"./ChapterEditor-B-AXoxJ6.js";import{_ as ee}from"./ChapterNavigation.vue_vue_type_script_setup_true_lang-hz5Za5E4.js";import{_ as te}from"./DefensePreparationPanel.vue_vue_type_script_setup_true_lang-K2GYXvQs.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-BU6y8D-V.js";import"./CardContent.vue_vue_type_script_setup_true_lang-ByVWGonT.js";import"./CardTitle.vue_vue_type_script_setup_true_lang-CANz9L_6.js";import"./ScrollArea.vue_vue_type_script_setup_true_lang-BWjQSeh1.js";import"./Separator.vue_vue_type_script_setup_true_lang-SLoJoobv.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-C_drGNy-.js";import"./WordBalanceDisplay.vue_vue_type_script_setup_true_lang-I6wEMTX2.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-xuKYcCej.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-CCpNTTCf.js";import"./UserInfo.vue_vue_type_script_setup_true_lang-CpzsT-yS.js";import"./Sonner.vue_vue_type_script_setup_true_lang-kLZ_SglN.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-CmpajE6J.js";import"./useAppearance-Cb8BgOEx.js";import"./useWordBalance-BbO0T_xW.js";import"./PWAInstallPrompt.vue_vue_type_script_setup_true_lang-BLWBGKbF.js";import"./PurchaseModal.vue_vue_type_script_setup_true_lang-C8LRBLjI.js";import"./DialogContent.vue_vue_type_script_setup_true_lang-DTGeh0zi.js";import"./DialogDescription.vue_vue_type_script_setup_true_lang-DJcKnsJu.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-gNJW6pFS.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CCtpPhJI.js";import"./useChapterWordCount-CJM1yl8K.js";import"./Input.vue_vue_type_script_setup_true_lang-CQe6L5n4.js";import"./Label.vue_vue_type_script_setup_true_lang-BCx0cnBe.js";import"./RichTextEditor-Cgz2tvdF.js";import"./vendor-tiptap-CikDN_Ib.js";import"./Progress.vue_vue_type_script_setup_true_lang-DMO34aBB.js";import"./MermaidExtension-DKfQSFSI.js";import"./vendor-mermaid-PRLIJyBp.js";import"./SelectLabel.vue_vue_type_script_setup_true_lang-CSvOyFlH.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-wD9LDVUo.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-T3ve2U6-.js";import"./SelectGroup.vue_vue_type_script_setup_true_lang-BMztvDOh.js";import"./useTextHistory-DurNFv9-.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-ia8HOwdx.js";import"./FeedbackPromptModal.vue_vue_type_script_setup_true_lang-By0RlWD5.js";import"./Textarea.vue_vue_type_script_setup_true_lang-CLVewTca.js";import"./AlertDialogTrigger.vue_vue_type_script_setup_true_lang-Dqp7ikD4.js";import"./Switch.vue_vue_type_script_setup_true_lang-1_DMAlPr.js";function re(){const g=C(!1),l=C(null),m=C(null),p=C(null),d=C([]),y=C({}),S=E(()=>m.value?.hasDataCollectionNeeds??!1),R=E(()=>m.value?.types??[]),x=E(()=>p.value?.hasPlaceholder?p.value.detectedType:null),j=E(()=>p.value?.hasPlaceholder?p.value.confidence??0:0);async function w(r){g.value=!0,l.value=null;try{const a=await fetch(`/api/chapters/${r}/detect`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!a.ok)throw new Error("Failed to detect data collection needs");const k=await a.json();m.value=k.detection}catch(a){l.value=a instanceof Error?a.message:"An error occurred",console.error("Error detecting data collection needs:",a)}finally{g.value=!1}}async function b(r){g.value=!0,l.value=null;try{const a=await fetch(`/api/chapters/${r}/placeholder`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!a.ok)throw new Error("Failed to generate placeholder");const k=await a.json();p.value=k.placeholder}catch(a){l.value=a instanceof Error?a.message:"An error occurred",console.error("Error generating placeholder:",a)}finally{g.value=!1}}async function D(r){g.value=!0,l.value=null;try{const a=await fetch(`/api/chapters/${r}/suggestions`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!a.ok)throw new Error("Failed to get suggestions");const k=await a.json();d.value=k.suggestions}catch(a){l.value=a instanceof Error?a.message:"An error occurred",console.error("Error getting suggestions:",a)}finally{g.value=!1}}async function P(){g.value=!0,l.value=null;try{const r=await fetch("/api/data-collection/templates",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!r.ok)throw new Error("Failed to get templates");const a=await r.json();y.value=a.templates}catch(r){l.value=r instanceof Error?r.message:"An error occurred",console.error("Error getting templates:",r)}finally{g.value=!1}}async function T(r){g.value=!0,l.value=null;try{const a=await fetch(`/api/data-collection/template?type=${encodeURIComponent(r)}`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!a.ok)throw new Error("Failed to get template");return(await a.json()).template}catch(a){return l.value=a instanceof Error?a.message:"An error occurred",console.error("Error getting template:",a),null}finally{g.value=!1}}async function q(r,a,k="append"){g.value=!0,l.value=null;try{if(!(await fetch(`/api/chapters/${r}/insert-template`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({type:a,position:k})})).ok)throw new Error("Failed to insert template");return!0}catch(L){return l.value=L instanceof Error?L.message:"An error occurred",console.error("Error inserting template:",L),!1}finally{g.value=!1}}async function A(r){await Promise.all([w(r),b(r),D(r)])}function e(r){return{survey:"Survey/Questionnaire",experiment:"Laboratory Experiment",engineering:"Engineering Design",statistical:"Statistical Analysis",construction:"Construction Project"}[r]||r.charAt(0).toUpperCase()+r.slice(1)}function n(r){return r>=50?"High":r>=25?"Medium":"Low"}function o(r){return r>=50?"text-green-600 dark:text-green-400":r>=25?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"}function h(){m.value=null,p.value=null,d.value=[],l.value=null}return{isLoading:g,error:l,detection:m,placeholder:p,suggestions:d,templates:y,hasDataCollectionNeeds:S,detectedTypes:R,primaryType:x,primaryConfidence:j,detectDataCollectionNeeds:w,generatePlaceholder:b,getSuggestions:D,getAllTemplates:P,getTemplate:T,insertTemplate:q,analyzeChapter:A,getTypeName:e,getConfidenceLevel:n,getConfidenceColor:o,clearData:h}}const ae={class:"space-y-4"},oe={class:"flex items-center justify-between"},ne={class:"flex items-center gap-2"},le=["disabled"],ie={key:0,class:"text-center py-4"},de={key:1,class:"text-center py-4"},ce={key:2},ue={class:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3"},pe={class:"flex items-start gap-2"},ge={class:"min-w-0 flex-1"},he={class:"mt-2 space-y-1"},fe={class:"text-xs text-blue-700 dark:text-blue-300"},me={key:0,class:"border border-gray-200 dark:border-gray-700 rounded-lg p-3"},ye={class:"flex items-center justify-between mb-2"},ve={class:"text-xs px-2 py-1 bg-green-100 text-green-700 rounded dark:bg-green-900/20 dark:text-green-400"},be={class:"text-xs text-gray-600 dark:text-gray-400 mb-3"},xe={class:"flex gap-2"},we=["disabled"],ke={key:0,class:"mt-3 p-2 bg-gray-50 dark:bg-gray-800 rounded text-xs"},Ce={class:"whitespace-pre-wrap text-gray-700 dark:text-gray-300 overflow-auto max-h-32"},_e={key:1,class:"space-y-2"},Se={class:"text-xs font-medium text-gray-700 dark:text-gray-300 mb-2"},Te={class:"space-y-1"},Ae={class:"border border-gray-200 dark:border-gray-700 rounded-lg"},De={class:"p-3 pt-0 space-y-2"},$e={class:"text-xs font-medium text-gray-900 dark:text-gray-100"},Re={class:"text-xs text-gray-600 dark:text-gray-400"},je=["onClick","disabled"],Pe={key:3,class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3"},qe={class:"flex items-start gap-2"},Le={class:"text-xs text-red-600 dark:text-red-400 mt-1"},Ee=I({__name:"DataCollectionPanel",props:{chapterId:{},content:{}},setup(g){const l=g,m=C(!1),{isLoading:p,error:d,placeholder:y,suggestions:S,templates:R,hasDataCollectionNeeds:x,detectedTypes:j,primaryType:w,analyzeChapter:b,insertTemplate:D,getAllTemplates:P,getTypeName:T,getConfidenceColor:q}=re();let A=null;F(()=>l.content,(n,o)=>{!n||n===o||(A&&clearTimeout(A),A=setTimeout(()=>{n&&n.length>500&&b(l.chapterId)},3e3))},{immediate:!1});async function e(n,o,h="append"){await D(n,o,h)?(B.success("Template added successfully"),m.value=!1,setTimeout(()=>{b(n)},1e3)):B.error(d.value||"Failed to insert template")}return Q(async()=>{await P(),l.content&&l.content.length>500&&await b(l.chapterId)}),(n,o)=>(u(),c("div",ae,[t("div",oe,[t("div",ne,[i(s(z),{class:"h-5 w-5 text-blue-600 dark:text-blue-400"}),o[3]||(o[3]=t("h3",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"}," Data Collection Assistant ",-1))]),s(x)?_("",!0):(u(),c("button",{key:0,onClick:o[0]||(o[0]=h=>s(b)(n.chapterId)),disabled:s(p),class:"text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100 disabled:opacity-50 dark:bg-blue-900/20 dark:text-blue-400 dark:hover:bg-blue-900/30"},f(s(p)?"Analyzing...":"Scan for Data Needs"),9,le))]),s(p)&&!s(x)?(u(),c("div",ie,[...o[4]||(o[4]=[t("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"},null,-1),t("p",{class:"text-xs text-gray-500 mt-2"},"Analyzing chapter content...",-1)])])):!s(x)&&!s(p)?(u(),c("div",de,[i(s(U),{class:"h-8 w-8 text-gray-400 mx-auto mb-2"}),o[5]||(o[5]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," No data collection requirements detected in this chapter. ",-1)),o[6]||(o[6]=t("p",{class:"text-xs text-gray-400 mt-1"},' Add keywords like "survey", "experiment", or "statistical analysis" to get assistance. ',-1))])):s(x)?(u(),c("div",ce,[t("div",ue,[t("div",pe,[i(s(M),{class:"h-4 w-4 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),t("div",ge,[o[7]||(o[7]=t("p",{class:"text-sm font-medium text-blue-900 dark:text-blue-100"}," Data Collection Requirements Detected ",-1)),t("div",he,[(u(!0),c(N,null,G(s(j),h=>(u(),c("div",{key:h,class:"flex items-center justify-between"},[t("span",fe,f(s(T)(h)),1),t("span",{class:O(["text-xs font-medium",s(q)(s(y)?.allConfidence?.[h]||0)])},f(s(y)?.allConfidence?.[h]?.toFixed(1))+"% confidence ",3)]))),128))])])])]),s(w)&&s(y)?.template?(u(),c("div",me,[t("div",ye,[o[8]||(o[8]=t("h4",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"}," Recommended Template ",-1)),t("span",ve,f(s(T)(s(w))),1)]),t("p",be,f(s(y).template.title),1),t("div",xe,[t("button",{onClick:o[1]||(o[1]=h=>e(n.chapterId,s(w),"append")),disabled:s(p),class:"flex-1 text-xs px-3 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50"},f(s(p)?"Inserting...":"Add Template"),9,we),t("button",{onClick:o[2]||(o[2]=h=>m.value=!m.value),class:"text-xs px-2 py-1.5 border border-gray-200 text-gray-600 rounded hover:bg-gray-50 dark:border-gray-600 dark:text-gray-400 dark:hover:bg-gray-800"},f(m.value?"Hide":"Preview"),1)]),m.value?(u(),c("div",ke,[t("pre",Ce,f(s(y).template.content.trim()),1)])):_("",!0)])):_("",!0),s(S).length>0?(u(),c("div",_e,[o[9]||(o[9]=t("h4",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"}," Research Guidelines ",-1)),(u(!0),c(N,null,G(s(S),h=>(u(),c("div",{key:h.type,class:"border border-gray-200 dark:border-gray-700 rounded-lg p-3"},[t("h5",Se,f(h.title),1),t("ul",Te,[(u(!0),c(N,null,G(h.suggestions,(r,a)=>(u(),c("li",{key:a,class:"flex items-start gap-1.5 text-xs text-gray-600 dark:text-gray-400"},[i(s(V),{class:"h-3 w-3 text-green-500 mt-0.5 flex-shrink-0"}),t("span",null,f(r),1)]))),128))])]))),128))])):_("",!0),t("details",Ae,[o[10]||(o[10]=t("summary",{class:"p-3 cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"}," Browse All Templates ",-1)),t("div",De,[(u(!0),c(N,null,G(s(R),(h,r)=>(u(),c("div",{key:r,class:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-800 rounded"},[t("div",null,[t("span",$e,f(s(T)(r)),1),t("p",Re,f(h.title),1)]),t("button",{onClick:a=>e(n.chapterId,r,"append"),disabled:s(p),class:"text-xs px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50"}," Add ",8,je)]))),128))])])])):_("",!0),s(d)?(u(),c("div",Pe,[t("div",qe,[i(s(M),{class:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),t("div",null,[o[11]||(o[11]=t("p",{class:"text-sm font-medium text-red-800 dark:text-red-200"}," Analysis Error ",-1)),t("p",Le,f(s(d)),1)])])])):_("",!0)]))}}),Ne={key:0,class:"fixed inset-0 z-50 lg:hidden"},Ge={class:"fixed top-0 left-0 h-full w-80 overflow-y-auto border-r bg-background shadow-xl transform transition-transform"},He={class:"border-b p-3"},Me={class:"flex items-center justify-between"},Be={class:"space-y-4 p-4 mobile-enhanced"},We={key:0,class:"fixed inset-0 z-50 lg:hidden"},Xe={class:"fixed top-0 right-0 h-full w-96 overflow-y-auto border-l bg-background shadow-xl transform transition-transform"},Ie={class:"border-b p-3"},Fe={class:"flex items-center justify-between"},Qe={class:"space-y-4 p-4 mobile-enhanced"},ze=I({__name:"MobileNavOverlay",props:{showLeftSidebar:{type:Boolean},showRightSidebar:{type:Boolean},isMobile:{type:Boolean},allChapters:{},currentChapter:{},project:{},currentWordCount:{},targetWordCount:{},writingQualityScore:{},chapterContentLength:{},isGenerating:{type:Boolean},selectedText:{},isLoadingSuggestions:{type:Boolean},showCitationHelper:{type:Boolean},chapterContent:{},showDefensePrep:{type:Boolean},defenseQuestions:{},isLoadingDefenseQuestions:{type:Boolean},isGeneratingDefenseQuestions:{type:Boolean},meetsDefenseThreshold:{type:Boolean},shouldShowDefenseProgress:{type:Boolean},defenseProgressPercentage:{},defenseWordsRemaining:{},hasTriggeredGeneration:{type:Boolean},outlines:{},facultyChapters:{}},emits:["update:showLeftSidebar","update:showRightSidebar","goToChapter","generateNextChapter","startStreamingGeneration","getAISuggestions","update:showCitationHelper","checkCitations","update:showDefensePrep","generate-more","refresh","mark-helpful","hide-question"],setup(g,{emit:l}){const p=C(g.showDefensePrep??!0),d=l,y=()=>d("update:showLeftSidebar",!1),S=()=>d("update:showRightSidebar",!1),R=e=>d("goToChapter",e),x=()=>d("generateNextChapter"),j=(e,n)=>d("startStreamingGeneration",e,n),w=()=>d("getAISuggestions"),b=e=>d("update:showCitationHelper",e),D=e=>{p.value=e,d("update:showDefensePrep",e)},P=()=>d("generate-more"),T=()=>d("refresh"),q=(e,n)=>d("mark-helpful",e,n),A=e=>d("hide-question",e);return(e,n)=>(u(),c("div",null,[i($,{"enter-active-class":"duration-300 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"duration-200 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:v(()=>[e.showLeftSidebar&&e.isMobile?(u(),c("div",Ne,[i($,{"enter-active-class":"duration-300 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"duration-200 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:v(()=>[t("div",{class:"fixed inset-0 bg-black/50",onClick:y})]),_:1}),i($,{"enter-active-class":"duration-300 ease-out","enter-from-class":"-translate-x-full","enter-to-class":"translate-x-0","leave-active-class":"duration-200 ease-in","leave-from-class":"translate-x-0","leave-to-class":"-translate-x-full"},{default:v(()=>[t("div",Ge,[t("div",He,[t("div",Me,[n[0]||(n[0]=t("h2",{class:"text-base font-semibold"},"Navigation",-1)),i(s(X),{onClick:y,variant:"ghost",size:"sm",class:"h-8 w-8"},{default:v(()=>[i(s(W),{class:"h-4 w-4"})]),_:1})])]),t("div",Be,[i(ee,{"all-chapters":e.allChapters,"current-chapter":e.currentChapter,project:e.project,outlines:e.outlines||[],"faculty-chapters":e.facultyChapters||[],"current-word-count":e.currentWordCount,"target-word-count":e.targetWordCount,"writing-quality-score":e.writingQualityScore,"chapter-content-length":e.chapterContentLength,onGoToChapter:R,onGenerateNextChapter:x},null,8,["all-chapters","current-chapter","project","outlines","faculty-chapters","current-word-count","target-word-count","writing-quality-score","chapter-content-length"]),i(s(Y),{class:"border-border/50"},{default:v(()=>[i(s(J),{class:"h-4 w-4 text-muted-foreground"}),i(s(Z),{class:"text-xs text-muted-foreground"},{default:v(()=>[...n[1]||(n[1]=[t("strong",{class:"text-foreground"},"Pro Tips:",-1),t("br",null,null,-1),H(" • Press Ctrl+S to save",-1),t("br",null,null,-1),H(" • Ctrl+Z/Y for undo/redo",-1),t("br",null,null,-1),H(" • Select text for AI suggestions",-1),t("br",null,null,-1),H(" • F11 for distraction-free mode ",-1)])]),_:1})]),_:1})])])]),_:1})])):_("",!0)]),_:1}),i($,{"enter-active-class":"duration-300 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"duration-200 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:v(()=>[e.showRightSidebar&&e.isMobile?(u(),c("div",We,[i($,{"enter-active-class":"duration-300 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"duration-200 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:v(()=>[t("div",{class:"fixed inset-0 bg-black/50",onClick:S})]),_:1}),i($,{"enter-active-class":"duration-300 ease-out","enter-from-class":"translate-x-full","enter-to-class":"translate-x-0","leave-active-class":"duration-200 ease-in","leave-from-class":"translate-x-0","leave-to-class":"translate-x-full"},{default:v(()=>[t("div",Xe,[t("div",Ie,[t("div",Fe,[n[2]||(n[2]=t("h2",{class:"text-base font-semibold"},"AI Tools",-1)),i(s(X),{onClick:S,variant:"ghost",size:"sm",class:"h-8 w-8"},{default:v(()=>[i(s(W),{class:"h-4 w-4"})]),_:1})])]),t("div",Qe,[i(K,{project:e.project,chapter:e.currentChapter,"is-generating":e.isGenerating,"selected-text":e.selectedText,"is-loading-suggestions":e.isLoadingSuggestions,"show-citation-helper":e.showCitationHelper,"chapter-content":e.chapterContent,"current-word-count":e.currentWordCount,"target-word-count":e.targetWordCount,onStartStreamingGeneration:j,onGetAiSuggestions:w,"onUpdate:showCitationHelper":b},null,8,["project","chapter","is-generating","selected-text","is-loading-suggestions","show-citation-helper","chapter-content","current-word-count","target-word-count"]),i(te,{"show-defense-prep":p.value,questions:e.defenseQuestions??[],"is-loading":e.isLoadingDefenseQuestions??!1,"is-generating":e.isGeneratingDefenseQuestions??!1,"chapter-context":{chapter_number:e.currentChapter.chapter_number,chapter_title:e.currentChapter.title,word_count:e.currentWordCount},"defense-watcher":{meetsThreshold:e.meetsDefenseThreshold??!1,shouldShowProgress:e.shouldShowDefenseProgress??!1,progressPercentage:e.defenseProgressPercentage??0,wordsRemaining:e.defenseWordsRemaining??0,hasTriggeredGeneration:e.hasTriggeredGeneration??!1,threshold:500,statusMessage:e.shouldShowDefenseProgress??!1?`Write ${e.defenseWordsRemaining??0} more words to generate defense questions`:"Ready to generate defense questions"},"onUpdate:showDefensePrep":D,onGenerateMore:P,onRefresh:T,onMarkHelpful:q,onHideQuestion:A},null,8,["show-defense-prep","questions","is-loading","is-generating","chapter-context","defense-watcher"]),i(Ee,{"chapter-id":e.currentChapter.id,content:e.chapterContent},null,8,["chapter-id","content"])])])]),_:1})])):_("",!0)]),_:1})]))}}),Ht=se(ze,[["__scopeId","data-v-295f60c3"]]);export{Ht as default};
