import{d as Fe,B as f,J as Pe,K as Re,f as pe,i as ze,c,o as l,L as r,w as d,H as s,M as b,n as x,a as z,a3 as me,u as o,I as w,N as g,O as V,R as Q,U as A,D as Ve,S as Y,E as Ae,P as N,Q as k}from"./app-Ct4JdCf2.js";import{u as Be,a as He,_ as Ke}from"./AppLayout.vue_vue_type_script_setup_true_lang-CsbmtuMu.js";import{c as Ue,_ as S}from"./index-B0o6wPhL.js";import{_ as We}from"./Input.vue_vue_type_script_setup_true_lang-53cFwZbi.js";import{_ as fe}from"./index-DYiBwM4V.js";import{_ as ve}from"./Textarea.vue_vue_type_script_setup_true_lang-CQ3Y_J4d.js";import{_ as qe}from"./ScrollArea.vue_vue_type_script_setup_true_lang-svO-DDQ7.js";import{d as Je,a as Xe,b as Ge,c as Qe,_ as Ye}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BQTjy89U.js";import{_ as Ze}from"./DialogFooter.vue_vue_type_script_setup_true_lang-aHmPPb_I.js";import{a as et,b as tt,c as st,d as ot,e as rt,f as nt,g as at,_ as it}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-Bf5MxBBh.js";import{_ as lt,a as dt,b as ct}from"./UserInfo.vue_vue_type_script_setup_true_lang-0XCr9O0Q.js";import{_ as oe}from"./SafeHtmlText.vue_vue_type_script_setup_true_lang-BknIWnVy.js";import{t as u}from"./index-t2RagoNK.js";import{S as B}from"./sparkles-KSZUw6wk.js";import{H as re}from"./history-DNLY_Xcx.js";import{P as ge,a as ut}from"./panel-left-open-DQCRy2Ty.js";import{P as pt}from"./plus-BULjuc-R.js";import{C as mt}from"./check-tWjKn0oB.js";import{X as ft}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CIlQgl8g.js";import{P as vt}from"./pencil-DQyg7pJg.js";import{T as be}from"./trash-2-CW32k0yP.js";import{M as gt}from"./message-square-DNPr2jDL.js";import{A as bt}from"./arrow-left-DIqdfEIH.js";import{C as yt}from"./circle-check-B-WWTcZu.js";import{B as ht}from"./bot-ChmrFJaX.js";import{S as ye}from"./save-7iGr4MZo.js";import{U as xt}from"./user-BinPk0FG.js";import{S as wt,a as _t}from"./square-sd0CZ0b7.js";import{_ as kt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useForwardExpose-MN4SHSqo.js";import"./index-GBSv2Ru2.js";import"./coins-9xdK7Lyh.js";import"./log-out-Ba8u0JVy.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CtOfj20i.js";import"./chevron-right-B2PAWNFr.js";import"./VisuallyHidden-DK63HlvY.js";import"./CardContent.vue_vue_type_script_setup_true_lang-BxnX-dqq.js";import"./Sonner.vue_vue_type_script_setup_true_lang-DZoTz-EK.js";import"./triangle-alert-CJ37KKfL.js";import"./useNonce-BwIoHH3c.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=Ue("BookmarkPlusIcon",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}],["line",{x1:"12",x2:"12",y1:"7",y2:"13",key:"1cppfj"}],["line",{x1:"15",x2:"9",y1:"10",y2:"10",key:"1gty7f"}]]),Ct={class:"flex h-[calc(100vh-4rem)] min-h-0 overflow-hidden relative bg-background w-full"},St={class:"min-w-[20rem] h-full flex flex-col"},Tt={class:"p-4 border-b border-border/50"},$t={class:"flex items-center justify-between mb-4"},jt={class:"flex items-center gap-2"},It={class:"p-1.5 bg-primary/10 rounded-md"},Nt={class:"font-semibold text-foreground tracking-tight"},Dt={class:"flex bg-muted rounded-lg p-1"},Ot={key:0,class:"p-3 space-y-2"},Mt={key:0,class:"text-center py-10 text-muted-foreground text-sm flex flex-col items-center"},Et=["onClick"],Lt={class:"flex items-center gap-2"},Ft={key:0,class:"text-[10px] text-muted-foreground font-medium"},Pt={key:1,class:"p-3 space-y-2"},Rt={key:0,class:"text-center py-10 text-muted-foreground text-sm flex flex-col items-center"},zt=["onClick"],Vt=["onKeydown"],At=["onClick"],Bt={key:1,class:"flex flex-col gap-1"},Ht={class:"flex items-start justify-between"},Kt={key:0,class:"flex items-center opacity-0 group-hover:opacity-100 transition-opacity absolute right-2 top-2 bg-card/80 backdrop-blur-sm rounded shadow-sm border border-border/50 p-0.5"},Ut=["onClick"],Wt=["onClick"],qt={class:"flex items-center justify-between text-[10px] text-muted-foreground"},Jt={class:"flex items-center gap-1"},Xt={class:"p-4 border-t border-border/50 bg-background/50 backdrop-blur-sm mt-auto"},Gt={class:"flex-1 flex flex-col min-w-0 bg-background h-full relative z-0"},Qt={class:"h-16 flex-none border-b border-border/50 flex items-center justify-between px-4 sticky top-0 bg-background/80 backdrop-blur-md z-10 transition-all"},Yt={class:"flex items-center gap-3 min-w-0"},Zt={class:"flex flex-col min-w-0"},es={class:"flex items-center gap-2"},ts={class:"text-[10px] text-muted-foreground truncate hidden sm:block"},ss={class:"flex items-center gap-2"},os={class:"hidden md:flex flex-col items-end mr-2 cursor-help"},rs={class:"max-w-3xl mx-auto space-y-6 pb-4"},ns={key:0,class:"mb-8 animate-in fade-in slide-in-from-top-4 duration-700"},as={class:"rounded-xl border border-primary/20 bg-gradient-to-br from-primary/5 via-background to-background p-4 md:p-6 shadow-sm relative overflow-hidden group"},is={class:"absolute top-0 right-0 p-3 opacity-10 group-hover:opacity-20 transition-opacity"},ls={class:"flex items-start gap-4 relative z-10"},ds={class:"p-2 bg-primary/10 rounded-lg text-primary mt-1 shrink-0"},cs={class:"min-w-0 flex-1 space-y-2"},us={key:0,class:"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center shrink-0 border border-primary/20 self-start mt-1"},ps={class:"flex flex-col gap-1 max-w-[85%] md:max-w-[80%] min-w-0"},ms={key:0,class:"flex gap-1 items-center h-5 px-1"},fs={key:1,class:"markdown-body"},vs={key:0,class:"mt-4 pt-3 border-t border-border/30"},gs={class:"text-[10px] uppercase tracking-wider text-muted-foreground mb-2 flex items-center gap-1 font-semibold opacity-70"},bs={class:"flex flex-wrap gap-2"},ys=["onClick"],hs={class:"truncate"},xs=["onClick"],ws=["disabled"],_s={key:1,class:"h-8 w-8 rounded-full bg-muted flex items-center justify-center shrink-0 border border-border self-start mt-1"},ks={class:"p-3 md:p-4 border-t border-border/50 bg-background/80 backdrop-blur-md sticky bottom-0 z-20"},Cs={class:"max-w-3xl mx-auto relative flex flex-col gap-2"},Ss={class:"relative w-full"},Ts={class:"p-2 bg-primary/10 rounded-lg"},$s={class:"space-y-4"},js={class:"space-y-2"},Is={class:"space-y-2"},Ns=Fe({__name:"TopicsLab",props:{project:{},topics:{},sessionId:{},historySessions:{},initialMessages:{},initialTopic:{}},setup(xe){const p=xe,v=f(p.initialTopic||(p.topics&&p.topics.length>0?p.topics[0]:null)),i=f(p.initialMessages||[]),j=f(""),T=f(!1),H=f(null),I=f(!1),y=f(!0),{formattedBalance:we,hasWords:_e}=Be(),Z=()=>{typeof window>"u"||(I.value=window.innerWidth<1024,I.value=window.innerWidth<1024,window.innerWidth<1024||(y.value=!0))};Pe(()=>{Z(),window.addEventListener("resize",Z),E()}),Re(()=>{window.removeEventListener("resize",Z)});const $=f((()=>{if(typeof window<"u"){const n=localStorage.getItem("topicsLab_sidebarMode");if(n==="topics"||n==="history")return n}return"topics"})());pe($,n=>{typeof window<"u"&&localStorage.setItem("topicsLab_sidebarMode",n)});const ke=n=>{N.visit(k("topics.lab",{project:p.project.slug,session_id:n}))},ne=()=>{N.visit(k("topics.lab",{project:p.project.slug,new:"true"}))},Ce=()=>{N.visit(k("projects.topics.index"))},K=f(null),D=f(""),Se=(n,e)=>{e.stopPropagation(),K.value=n.id,D.value=n.title},U=()=>{K.value=null,D.value=""},ae=async n=>{if(!D.value.trim()){U();return}try{(await fetch(k("topics.chat.rename",p.project.slug),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({session_id:n,name:D.value.trim()})})).ok?(u.success("Session renamed!"),N.reload()):u.error("Failed to rename session")}catch{u.error("Failed to rename session")}finally{U()}},ee=f(!1),W=f(null),te=f(!1),Te=n=>{W.value=n,te.value=!0},se=()=>{te.value=!1,W.value=null},$e=async()=>{if(ee.value||!W.value)return;const n=W.value;ee.value=!0;try{(await fetch(k("topics.chat.delete-session",p.project.slug),{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({session_id:n})})).ok?(u.success("Conversation deleted"),se(),n===p.sessionId?ne():N.reload()):u.error("Failed to delete conversation")}catch{u.error("Failed to delete conversation")}finally{ee.value=!1}},je=async n=>{try{const e=n.replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ").trim();await navigator.clipboard.writeText(e),u.success("Copied to clipboard")}catch{u.error("Failed to copy")}},q=f(!1),Ie=async()=>{if(q.value||!v.value)return;const n=i.value.filter(a=>a.role==="user");if(n.length===0){u.error("No message to regenerate");return}const e=i.value.findIndex(a=>a.id===n[n.length-1].id);e>=0&&e<i.value.length-1&&(i.value=i.value.slice(0,e+1)),q.value=!0;const t=Date.now().toString();i.value.push({id:t,role:"assistant",content:"",isTyping:!0}),E();try{const a=await fetch(k("topics.chat",p.project.slug),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({messages:i.value.filter(_=>!_.isTyping).map(_=>({role:_.role,content:_.content})),topic_context:v.value,session_id:p.sessionId})});if(!a.ok)throw new Error(`Server error: ${a.status}`);if(!a.body)throw new Error("No response body");const m=a.body.getReader(),F=new TextDecoder;let h="";for(;;){const{done:_,value:ce}=await m.read();if(_)break;const G=F.decode(ce).split(`

`);for(const P of G)if(P.startsWith("data: "))try{const M=JSON.parse(P.slice(6));if(M.content){h+=M.content;const R=i.value.findIndex(Le=>Le.id===t);R!==-1&&(i.value[R].content=h,i.value[R].isTyping=!1),E()}}catch{}}}catch(a){console.error("Regenerate error:",a),u.error("Failed to regenerate response"),i.value=i.value.filter(m=>m.id!==t)}finally{q.value=!1;const a=i.value.findIndex(m=>m.id===t);a!==-1&&(i.value[a].isTyping=!1)}};let O=null;const Ne=()=>{O&&(O.abort(),O=null,T.value=!1,u.info("Generation stopped"))},E=async()=>{await ze(),H.value&&(H.value.scrollTop=H.value.scrollHeight)},ie=async()=>{if(!j.value.trim()||!v.value||T.value)return;const n={id:Date.now().toString(),role:"user",content:j.value.trim()};i.value.push(n),j.value="",T.value=!0,E();const e=(Date.now()+1).toString();i.value.push({id:e,role:"assistant",content:"",isTyping:!0}),O=new AbortController;try{const t=await fetch(k("topics.chat",p.project.slug),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({messages:i.value.filter(h=>!h.isTyping).map(h=>({role:h.role,content:h.content})),topic_context:v.value,session_id:p.sessionId}),signal:O.signal});if(t.status===402){const h=await t.json();u.error(h.message||"Insufficient word balance"),i.value=i.value.filter(_=>_.id!==e),T.value=!1;return}if(!t.ok)throw new Error(`Server error: ${t.status}`);if(!t.body)throw new Error("No response body");const a=t.body.getReader(),m=new TextDecoder;let F="";for(;;){const{done:h,value:_}=await a.read();if(h)break;const ue=m.decode(_).split(`

`);for(const G of ue)if(G.startsWith("data: "))try{const P=JSON.parse(G.slice(6));if(P.content){F+=P.content;const M=i.value.findIndex(R=>R.id===e);M!==-1&&(i.value[M].content=F,i.value[M].isTyping=!1),E()}}catch{}}}catch(t){if(t.name==="AbortError"){const a=i.value.findIndex(m=>m.id===e);a!==-1&&(i.value[a].content?i.value[a].isTyping=!1:i.value.splice(a,1))}else console.error("Chat error:",t),u.error("Failed to get response")}finally{T.value=!1,O=null;const t=i.value.findIndex(a=>a.id===e);t!==-1&&(i.value[t].isTyping=!1)}},J=n=>{const e=document.createElement("DIV");return e.innerHTML=n,e.textContent||e.innerText||""};let le=!0;pe(v,n=>{if(n){if(le){le=!1,i.value.length===0&&(i.value=[{id:"system-welcome",role:"assistant",content:`Hi! I see you're interested in **${J(n.title||"")}**. How can I help you refine or understand this topic better?`}]);return}i.value=[{id:"system-welcome-"+Date.now(),role:"assistant",content:`Hi! I see you're interested in **${J(n.title||"")}**. How can I help you refine or understand this topic better?`}]}},{immediate:!0});const L=f(!1),C=f({title:"",description:""}),X=f(!1),de=n=>{const e=[],t=/"([^"]{20,200})"/g;let a;for(;(a=t.exec(n))!==null;){const m=a[1].trim();!m.toLowerCase().startsWith("how ")&&!m.toLowerCase().startsWith("what ")&&!m.toLowerCase().startsWith("why ")&&m.length>30&&e.push(m)}return e},De=n=>{C.value={title:n,description:""},L.value=!0},Oe=async()=>{if(!C.value.title.trim()){u.error("Please enter a topic title");return}X.value=!0;try{(await fetch(k("topics.chat.save-topic",p.project.slug),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({title:C.value.title.trim(),description:C.value.description.trim(),session_id:p.sessionId})})).ok?(u.success("Topic saved successfully!"),L.value=!1,N.reload()):u.error("Failed to save topic")}catch{u.error("Failed to save topic")}finally{X.value=!1}},Me=async()=>{if(!v.value)return;const n=u.loading("Setting topic...");try{const e=J(v.value.title);if((await fetch(k("topics.select",p.project.slug),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({topic:e,title:e.substring(0,100),description:v.value.description})})).ok)u.dismiss(n),u.success("Topic selected successfully!"),N.visit(k("projects.topic-approval",p.project.slug));else throw new Error("Failed")}catch{u.dismiss(n),u.error("Failed to select topic")}},Ee=n=>{if(!n)return"";let e=n.replace(/^### (.*$)/gim,"<strong>$1</strong>").replace(/^## (.*$)/gim,'<strong class="text-lg">$1</strong>').replace(/^# (.*$)/gim,'<strong class="text-xl">$1</strong>');return e=e.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),e=e.replace(/^\s*-\s+(.*$)/gim,'<li class="ml-4 list-disc">$1</li>'),e=e.replace(/^\s*\d+\.\s+(.*$)/gim,'<li class="ml-4 list-decimal">$1</li>'),e=e.replace(/\n/g,"<br>"),e};return(n,e)=>(l(),c(V,null,[r(Ke,{title:"Topic Lab"},{default:d(()=>[s("div",Ct,[y.value&&I.value?(l(),c("div",{key:0,class:"absolute inset-0 bg-background/80 backdrop-blur-sm z-30 animate-in fade-in duration-200 lg:hidden",onClick:e[0]||(e[0]=t=>y.value=!1)})):b("",!0),s("aside",{class:x(["flex flex-col border-r border-border/50 bg-muted/10 transition-all duration-300 ease-in-out z-40 h-full","lg:relative absolute inset-y-0 left-0",y.value?"translate-x-0 w-80 shadow-2xl lg:shadow-none":"-translate-x-full lg:translate-x-0 lg:w-0 lg:border-none lg:overflow-hidden"])},[s("div",St,[s("div",Tt,[s("div",$t,[s("div",jt,[s("div",It,[(l(),z(me($.value==="topics"?o(B):o(re)),{class:"h-4 w-4 text-primary"}))]),s("h2",Nt,w($.value==="topics"?"Generated Topics":"History"),1)]),I.value?(l(),z(o(S),{key:0,variant:"ghost",size:"icon",onClick:e[1]||(e[1]=t=>y.value=!1),class:"h-8 w-8 lg:hidden"},{default:d(()=>[r(o(ge),{class:"h-4 w-4"})]),_:1})):b("",!0)]),s("div",Dt,[s("button",{onClick:e[2]||(e[2]=t=>$.value="topics"),class:x(["flex-1 flex items-center justify-center gap-2 text-xs font-medium py-1.5 rounded-md transition-all",$.value==="topics"?"bg-background shadow-sm text-foreground":"text-muted-foreground hover:text-foreground"])},[r(o(B),{class:"h-3 w-3"}),e[14]||(e[14]=g(" Topics ",-1))],2),s("button",{onClick:e[3]||(e[3]=t=>$.value="history"),class:x(["flex-1 flex items-center justify-center gap-2 text-xs font-medium py-1.5 rounded-md transition-all",$.value==="history"?"bg-background shadow-sm text-foreground":"text-muted-foreground hover:text-foreground"])},[r(o(re),{class:"h-3 w-3"}),e[15]||(e[15]=g(" History ",-1))],2)])]),r(o(qe),{class:"flex-1 min-h-0"},{default:d(()=>[$.value==="topics"?(l(),c("div",Ot,[n.topics.length===0?(l(),c("div",Mt,[r(o(B),{class:"h-8 w-8 mb-3 opacity-20"}),e[16]||(e[16]=s("p",null,"No topics available",-1))])):b("",!0),(l(!0),c(V,null,Q(n.topics,t=>(l(),c("div",{key:t.id,onClick:a=>{v.value=t,I.value&&(y.value=!1)},class:x(["p-3 rounded-lg cursor-pointer border transition-all text-left hover:border-primary/30 active:scale-[0.98]",v.value?.id===t.id?"bg-primary/5 border-primary/50 shadow-sm":"bg-card border-transparent hover:bg-card/80"])},[s("h3",{class:x(["text-sm font-medium mb-1.5 line-clamp-2 leading-snug",v.value?.id===t.id?"text-primary":"text-foreground"])},w(J(t.title)),3),s("div",Lt,[r(o(fe),{variant:"outline",class:"text-[10px] h-5 px-1.5 bg-background/50 font-normal border-primary/20"},{default:d(()=>[g(w(t.difficulty||"Intermediate"),1)]),_:2},1024),t.feasibility_score?(l(),c("span",Ft,w(t.feasibility_score)+"% match ",1)):b("",!0)])],10,Et))),128))])):(l(),c("div",Pt,[r(o(S),{variant:"outline",class:"w-full mb-3 justify-start overflow-hidden bg-background/50 hover:bg-background border-dashed",onClick:ne},{default:d(()=>[r(o(pt),{class:"h-4 w-4 mr-2"}),e[17]||(e[17]=g(" New Conversation ",-1))]),_:1}),n.historySessions.length===0?(l(),c("div",Rt,[r(o(re),{class:"h-8 w-8 mb-3 opacity-20"}),e[18]||(e[18]=s("p",null,"No previous conversations",-1))])):b("",!0),(l(!0),c(V,null,Q(n.historySessions,t=>(l(),c("div",{key:t.id,onClick:a=>K.value!==t.id&&(ke(t.id),I.value?y.value=!1:null),class:x(["p-3 rounded-lg cursor-pointer border transition-all text-left hover:border-primary/30 group relative",p.sessionId===t.id?"bg-primary/5 border-primary/50 shadow-sm":"bg-card border-transparent hover:bg-card/80"])},[K.value===t.id?(l(),c("div",{key:0,class:"flex items-center gap-1",onClick:e[5]||(e[5]=A(()=>{},["stop"]))},[Ve(s("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>D.value=a),class:"flex-1 text-sm px-2 py-1 h-7 bg-background border border-primary/50 rounded focus:outline-none focus:ring-1 focus:ring-primary w-full",onKeydown:[Y(a=>ae(t.id),["enter"]),Y(U,["escape"])],autofocus:""},null,40,Vt),[[Ae,D.value]]),s("button",{onClick:a=>ae(t.id),class:"p-1 hover:bg-green-500/20 rounded text-green-500 shrink-0"},[r(o(mt),{class:"h-3.5 w-3.5"})],8,At),s("button",{onClick:U,class:"p-1 hover:bg-red-500/20 rounded text-red-500 shrink-0"},[r(o(ft),{class:"h-3.5 w-3.5"})])])):(l(),c("div",Bt,[s("div",Ht,[s("h3",{class:x(["text-sm font-medium line-clamp-1 break-all",p.sessionId===t.id?"text-primary":"text-foreground"])},w(t.title),3),p.sessionId===t.id||!I.value?(l(),c("div",Kt,[s("button",{onClick:A(a=>Se(t,a),["stop"]),class:"p-1.5 hover:bg-muted rounded text-muted-foreground hover:text-primary transition-colors"},[r(o(vt),{class:"h-3 w-3"})],8,Ut),s("button",{onClick:A(a=>Te(t.id),["stop"]),class:"p-1.5 hover:bg-red-500/10 rounded text-muted-foreground hover:text-red-500 transition-colors"},[r(o(be),{class:"h-3 w-3"})],8,Wt)])):b("",!0)]),s("div",qt,[s("span",Jt,[r(o(gt),{class:"h-3 w-3 opacity-70"}),g(" "+w(t.message_count),1)]),s("span",null,w(t.date),1)])]))],10,zt))),128))]))]),_:1}),s("div",Xt,[r(o(S),{variant:"ghost",class:"w-full justify-start text-muted-foreground hover:text-foreground",onClick:Ce},{default:d(()=>[r(o(bt),{class:"mr-2 h-4 w-4"}),e[19]||(e[19]=g(" Back to Library ",-1))]),_:1})])])],2),s("main",Gt,[s("header",Qt,[s("div",Yt,[r(o(S),{variant:"ghost",size:"icon",class:"shrink-0 -ml-2",onClick:e[6]||(e[6]=t=>y.value=!y.value),title:y.value?"Close sidebar":"Open sidebar"},{default:d(()=>[(l(),z(me(y.value?o(ge):o(ut)),{class:"h-5 w-5 text-muted-foreground"}))]),_:1},8,["title"]),s("div",Zt,[s("div",es,[e[21]||(e[21]=s("h1",{class:"font-semibold text-foreground truncate text-sm md:text-base"}," Topic Laboratory ",-1)),r(o(fe),{variant:"secondary",class:"font-normal text-[10px] hidden sm:inline-flex bg-primary/10 text-primary border-transparent"},{default:d(()=>[...e[20]||(e[20]=[g(" AI Assistant ",-1)])]),_:1})]),s("span",ts,w(n.project.title),1)])]),s("div",ss,[r(o(He),null,{default:d(()=>[r(o(lt),null,{default:d(()=>[r(o(dt),{"as-child":""},{default:d(()=>[s("div",os,[e[22]||(e[22]=s("span",{class:"text-[10px] font-medium uppercase tracking-wider text-muted-foreground"},"Credits",-1)),s("span",{class:x(["text-xs font-bold",o(_e)?"text-primary":"text-red-500"])},w(o(we)),3)])]),_:1}),r(o(ct),null,{default:d(()=>[...e[23]||(e[23]=[s("p",null,"Your word balance",-1)])]),_:1})]),_:1})]),_:1}),r(o(S),{disabled:!v.value||T.value,onClick:Me,class:"shadow-lg shadow-primary/20 h-9 px-4 text-xs md:text-sm"},{default:d(()=>[r(o(yt),{class:"h-4 w-4 mr-2"}),e[24]||(e[24]=s("span",{class:"hidden sm:inline"},"Select Topic",-1)),e[25]||(e[25]=s("span",{class:"sm:hidden"},"Select",-1))]),_:1},8,["disabled"])])]),s("div",{class:"flex-1 overflow-y-auto px-4 py-6 scroll-smooth w-full",ref_key:"chatContainer",ref:H},[s("div",rs,[v.value?(l(),c("div",ns,[s("div",as,[s("div",is,[r(o(B),{class:"w-12 h-12 text-primary rotate-12"})]),s("div",ls,[s("div",ds,[r(o(B),{class:"h-5 w-5"})]),s("div",cs,[r(oe,{content:v.value.title,as:"h3",class:"text-base md:text-lg font-bold text-foreground leading-tight"},null,8,["content"]),r(oe,{content:v.value.description,as:"div",class:"text-xs md:text-sm text-muted-foreground leading-relaxed pl-3 border-l-2 border-primary/20"},null,8,["content"])])])])])):b("",!0),i.value.length?(l(!0),c(V,{key:1},Q(i.value,t=>(l(),c("div",{key:t.id,class:x(["flex gap-3 animate-in fade-in slide-in-from-bottom-2",t.role==="user"?"justify-end":"justify-start"])},[t.role==="assistant"?(l(),c("div",us,[r(o(ht),{class:"h-4 w-4 text-primary"})])):b("",!0),s("div",ps,[s("div",{class:x(["rounded-2xl px-4 md:px-5 py-3 shadow-sm text-sm leading-relaxed overflow-hidden break-words",t.role==="user"?"bg-primary text-primary-foreground rounded-tr-none":"bg-muted/50 border border-border/50 text-foreground rounded-tl-none"])},[t.isTyping?(l(),c("div",ms,[...e[26]||(e[26]=[s("span",{class:"w-1.5 h-1.5 bg-current rounded-full animate-bounce",style:{"animation-delay":"0ms"}},null,-1),s("span",{class:"w-1.5 h-1.5 bg-current rounded-full animate-bounce",style:{"animation-delay":"150ms"}},null,-1),s("span",{class:"w-1.5 h-1.5 bg-current rounded-full animate-bounce",style:{"animation-delay":"300ms"}},null,-1)])])):(l(),c("div",fs,[r(oe,{content:Ee(t.content)},null,8,["content"]),t.role==="assistant"&&de(t.content).length>0?(l(),c("div",vs,[s("div",gs,[r(o(he),{class:"h-3 w-3"}),e[27]||(e[27]=g(" Suggested Topics ",-1))]),s("div",bs,[(l(!0),c(V,null,Q(de(t.content),(a,m)=>(l(),c("button",{key:m,onClick:F=>De(a),class:"text-xs px-3 py-1.5 bg-background hover:bg-primary/10 text-primary border border-primary/20 hover:border-primary/50 rounded-full transition-all flex items-center gap-1.5 shadow-sm active:scale-95 text-left max-w-full"},[r(o(ye),{class:"h-3 w-3 shrink-0"}),s("span",hs,w(a),1)],8,ys))),128))])])):b("",!0)]))],2),t.isTyping?b("",!0):(l(),c("div",{key:0,class:x(["flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",t.role==="user"?"justify-end":"justify-start ml-1"])},[s("button",{onClick:a=>je(t.content),class:"text-[10px] text-muted-foreground hover:text-foreground p-1 transition-colors",title:"Copy"}," Copy ",8,xs),t.role==="assistant"&&t.id===i.value.filter(a=>a.role==="assistant"&&!a.isTyping).slice(-1)[0]?.id?(l(),c("button",{key:0,onClick:Ie,disabled:q.value||T.value,class:"text-[10px] text-muted-foreground hover:text-foreground p-1 transition-colors flex items-center gap-1 disabled:opacity-50",title:"Regenerate"}," Regenerate ",8,ws)):b("",!0)],2))]),t.role==="user"?(l(),c("div",_s,[r(o(xt),{class:"h-4 w-4 text-muted-foreground"})])):b("",!0)],2))),128)):b("",!0)])],512),s("div",ks,[s("div",Cs,[s("div",Ss,[r(o(ve),{modelValue:j.value,"onUpdate:modelValue":e[7]||(e[7]=t=>j.value=t),placeholder:"Refine this topic, ask about methodologies, or check feasibility...",class:"min-h-[3rem] md:min-h-[3.5rem] max-h-32 pr-12 pl-4 py-3 bg-muted/40 hover:bg-muted/60 focus:bg-background focus:ring-1 focus:ring-primary/50 resize-none rounded-xl border-border/50 shadow-sm transition-all",onKeydown:[Y(A(ie,["exact","prevent"]),["enter"]),e[8]||(e[8]=Y(A(t=>j.value+=`
`,["shift","prevent"]),["enter"]))]},null,8,["modelValue","onKeydown"]),T.value?(l(),z(o(S),{key:0,class:"absolute right-2 bottom-2 h-8 w-8 rounded-lg bg-red-500 hover:bg-red-600 shadow-sm transition-transform hover:scale-105",size:"icon",onClick:Ne,title:"Stop"},{default:d(()=>[r(o(wt),{class:"h-4 w-4 fill-current text-white"})]),_:1})):(l(),z(o(S),{key:1,class:"absolute right-2 bottom-2 h-8 w-8 rounded-lg shadow-sm transition-transform hover:scale-105",size:"icon",disabled:!j.value.trim()||!v.value,onClick:ie},{default:d(()=>[r(o(_t),{class:"h-4 w-4"})]),_:1},8,["disabled"]))]),e[28]||(e[28]=s("p",{class:"text-center text-[10px] text-muted-foreground/70 select-none"}," AI may display inaccurate info. ",-1))])])])])]),_:1}),r(o(Ye),{open:L.value,"onUpdate:open":e[12]||(e[12]=t=>L.value=t)},{default:d(()=>[r(o(Je),{class:"sm:max-w-[500px] gap-6"},{default:d(()=>[r(o(Xe),null,{default:d(()=>[r(o(Ge),{class:"flex items-center gap-2"},{default:d(()=>[s("div",Ts,[r(o(he),{class:"h-5 w-5 text-primary"})]),e[29]||(e[29]=g(" Save Refined Topic ",-1))]),_:1}),r(o(Qe),null,{default:d(()=>[...e[30]||(e[30]=[g(" Save this topic to your project's library. ",-1)])]),_:1})]),_:1}),s("div",$s,[s("div",js,[e[31]||(e[31]=s("label",{class:"text-sm font-medium"},"Title",-1)),r(o(We),{modelValue:C.value.title,"onUpdate:modelValue":e[9]||(e[9]=t=>C.value.title=t),placeholder:"Topic title...",class:"w-full"},null,8,["modelValue"])]),s("div",Is,[e[32]||(e[32]=s("label",{class:"text-sm font-medium"},"Description",-1)),r(o(ve),{modelValue:C.value.description,"onUpdate:modelValue":e[10]||(e[10]=t=>C.value.description=t),placeholder:"Optional description...",class:"resize-none",rows:"4"},null,8,["modelValue"])])]),r(o(Ze),null,{default:d(()=>[r(o(S),{variant:"outline",onClick:e[11]||(e[11]=t=>L.value=!1)},{default:d(()=>[...e[33]||(e[33]=[g("Cancel",-1)])]),_:1}),r(o(S),{onClick:Oe,disabled:!C.value.title.trim()||X.value},{default:d(()=>[r(o(ye),{class:"h-4 w-4 mr-2"}),g(" "+w(X.value?"Saving...":"Save"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),r(o(it),{open:te.value,"onUpdate:open":e[13]||(e[13]=t=>{t||se()})},{default:d(()=>[r(o(et),null,{default:d(()=>[r(o(tt),null,{default:d(()=>[r(o(st),{class:"flex items-center gap-2 text-destructive"},{default:d(()=>[r(o(be),{class:"h-5 w-5"}),e[34]||(e[34]=g(" Delete Conversation ",-1))]),_:1}),r(o(ot),null,{default:d(()=>[...e[35]||(e[35]=[g(" Permanent action. Cannot be undone. ",-1)])]),_:1})]),_:1}),r(o(rt),null,{default:d(()=>[r(o(nt),{onClick:se},{default:d(()=>[...e[36]||(e[36]=[g("Cancel",-1)])]),_:1}),r(o(at),{onClick:$e,class:"bg-destructive hover:bg-destructive/90 text-destructive-foreground"},{default:d(()=>[...e[37]||(e[37]=[g(" Delete ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])],64))}}),ho=kt(Ns,[["__scopeId","data-v-168b391b"]]);export{ho as default};
