import{ak as li,b as V,U as xt,d as Pg,S as Fg,t as fi,e as pr,p as Au,T as na,a4 as Wg,c as ut,o as oe,k as S,g as b,u as g,a0 as Bg,j as se,X as Xt,z as ve,y as mn,i as vt,f as mt,n as qn,aa as ra,F as Ug}from"./app-BBTgw0VQ.js";import{t as ne}from"./index-Bggf1O4m.js";import{_ as me}from"./index-rcRsnuzV.js";import{_ as Dg}from"./index-CkracbfL.js";import{_ as Pt}from"./Separator.vue_vue_type_script_setup_true_lang-C7LVdJaG.js";import{_ as zg}from"./Progress.vue_vue_type_script_setup_true_lang-C3HU9bTt.js";import{aa as Ng}from"./RichTextEditor-jdkzAzxe.js";import{d as Qt,u as $g,a as kg,c as Gg,b as qg,_ as Hg,M as Kg}from"./useManualEditorSuggestions-CJklOzWg.js";import{_ as Yg}from"./ChapterNavigation.vue_vue_type_script_setup_true_lang-DgX9vlUh.js";import{u as Zg,M as Jg,a as Xg,P as Qg,_ as Vg,b as ia}from"./useTextHistory-DZtwmufS.js";import{_ as jg}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-D46Clpxu.js";import{r as Tu,u as e_}from"./useWordBalance-BEefHXiv.js";import{_ as t_}from"./PurchaseModal.vue_vue_type_script_setup_true_lang-D6BJx_Qg.js";import{A as ua}from"./arrow-left-C_vFzZ3S.js";import{M as n_}from"./menu-jetUP6f1.js";import{S as Eu}from"./save-Bi55kVz-.js";import{M as oa}from"./message-square-C_-KQ8j3.js";import{C as r_}from"./chevron-left-B_0U83Eu.js";import{C as i_}from"./chevron-right-CDC0NGUP.js";import{a as u_,P as o_}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-D1GiTJSx.js";import{L as s_}from"./loader-circle-MNktTO90.js";import{M as a_,S as l_}from"./sun-CEONacvl.js";import{M as f_}from"./minimize-2-B9R8eOmp.js";import{B as c_}from"./brain-C_nLuphr.js";import{C as h_}from"./circle-check-big-DngiicC_.js";import{_ as d_}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-BDHVX6zL.js";import"./Separator-C5dSivsH.js";import"./Presence-gEud3NKd.js";import"./useForwardExpose-BbYo0QML.js";import"./nullish-CHIgUVhi.js";import"./purify.es-DxJI3Wx7.js";import"./index-BWEDi_FC.js";import"./step-DrZ9DcYd.js";import"./chart-column-BtRDdEFa.js";import"./calendar-Cl5XbbDf.js";import"./users-CJEOmZM3.js";import"./circle-alert-DGY1mAIN.js";import"./eye-DhtserCq.js";import"./check-BErEmU_4.js";import"./type-B4Dl0Efx.js";import"./download-WkyCFkAo.js";import"./trash-2-C8R8x-2d.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CIkQKUfH.js";import"./DialogTitle-Dk9iSiBZ.js";import"./x-BLMrPA5s.js";import"./DialogDescription.vue_vue_type_script_setup_true_lang-CptJa6Yc.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-DUggevkI.js";import"./Input.vue_vue_type_script_setup_true_lang-CfhBmK-T.js";import"./Label.vue_vue_type_script_setup_true_lang-5iYPSLje.js";import"./minus-DJEvR6yD.js";import"./plus-QCry-KPV.js";import"./list-MtMIcvGT.js";import"./SafeHtmlText.vue_vue_type_script_setup_true_lang-CLsECFII.js";import"./lightbulb-BUve5Qh5.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-P__UlkQA.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-D3b8A7oA.js";import"./ohash.D__AXeF1-C-E83dC9.js";import"./VisuallyHiddenInput-DfWwIKUq.js";import"./VisuallyHidden-CMx3DE5j.js";import"./RovingFocusItem-CgVrhKuT.js";import"./target-Dlv2nb8E.js";import"./chevron-down-BXCOFeb4.js";import"./circle-BBSWVwIE.js";import"./sparkles-i6FSwsm_.js";import"./DefensePreparationPanel.vue_vue_type_script_setup_true_lang-C9-V8jQ7.js";import"./index-Dfyy0jm5.js";import"./CardContent.vue_vue_type_script_setup_true_lang-BnemNpOm.js";import"./CardTitle.vue_vue_type_script_setup_true_lang-DGbBZQWe.js";import"./ScrollArea.vue_vue_type_script_setup_true_lang-D5Szcp-d.js";import"./useNonce-JkLECx_T.js";import"./Switch.vue_vue_type_script_setup_true_lang-C_mpGqiz.js";import"./refresh-cw-lY5LZ4Xg.js";import"./DialogTrigger-VcAwAWn9.js";import"./lock-xeasRrNa.js";import"./book-open-CKh8jQqf.js";import"./search-CgNBQEmT.js";import"./file-text-BF5owwXh.js";import"./coins-DAW02RO8.js";import"./arrow-right-Ch_k_87T.js";var gr={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var p_=gr.exports,sa;function g_(){return sa||(sa=1,(function(ot,I){(function(){var s,ce="4.17.21",st=200,xn="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",he="Expected a function",Vt="Invalid `variable` option passed into `_.template`",Ve="__lodash_hash_undefined__",jt=500,G="__lodash_placeholder__",xe=1,we=2,je=4,at=1,lt=2,de=1,Z=2,wt=4,Re=8,ft=16,Ie=32,yt=64,Le=128,Ft=256,wn=512,W=30,N="...",Se=800,Be=16,ct=1,Wt=2,yn=3,q=1/0,K=9007199254740991,j=17976931348623157e292,z=NaN,X=4294967295,bn=X-1,Bt=X>>>1,en=[["ary",Le],["bind",de],["bindKey",Z],["curry",Re],["curryRight",ft],["flip",wn],["partial",Ie],["partialRight",yt],["rearg",Ft]],ye="[object Arguments]",Hn="[object Array]",tn="[object AsyncFunction]",nn="[object Boolean]",rn="[object Date]",_r="[object DOMException]",Cn="[object Error]",Sn="[object Function]",Kn="[object GeneratorFunction]",Ue="[object Map]",un="[object Number]",ci="[object Null]",et="[object Object]",Yn="[object Promise]",vr="[object Proxy]",Ut="[object RegExp]",Oe="[object Set]",Dt="[object String]",An="[object Symbol]",mr="[object Undefined]",zt="[object WeakMap]",hi="[object WeakSet]",bt="[object ArrayBuffer]",ht="[object DataView]",on="[object Float32Array]",Ct="[object Float64Array]",En="[object Int8Array]",Tn="[object Int16Array]",Nt="[object Int32Array]",Zn="[object Uint8Array]",p="[object Uint8ClampedArray]",m="[object Uint16Array]",R="[object Uint32Array]",Rn=/\b__p \+= '';/g,Jn=/\b(__p \+=) '' \+/g,xr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Xn=/&(?:amp|lt|gt|quot|#39);/g,In=/[&<>"']/g,Ru=RegExp(Xn.source),wr=RegExp(In.source),Qn=/<%-([\s\S]+?)%>/g,pe=/<%([\s\S]+?)%>/g,sn=/<%=([\s\S]+?)%>/g,dt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,an=/^\w*$/,di=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Vn=/[\\^$.*+?()[\]{}|]/g,la=RegExp(Vn.source),pi=/^\s+/,fa=/\s/,ca=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ha=/\{\n\/\* \[wrapped with (.+)\] \*/,da=/,? & /,pa=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ga=/[()=,{}\[\]\/\s]/,_a=/\\(\\)?/g,va=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Iu=/\w*$/,ma=/^[-+]0x[0-9a-f]+$/i,xa=/^0b[01]+$/i,wa=/^\[object .+?Constructor\]$/,ya=/^0o[0-7]+$/i,ba=/^(?:0|[1-9]\d*)$/,Ca=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,yr=/($^)/,Sa=/['\n\r\u2028\u2029\\]/g,br="\\ud800-\\udfff",Aa="\\u0300-\\u036f",Ea="\\ufe20-\\ufe2f",Ta="\\u20d0-\\u20ff",Lu=Aa+Ea+Ta,Ou="\\u2700-\\u27bf",Mu="a-z\\xdf-\\xf6\\xf8-\\xff",Ra="\\xac\\xb1\\xd7\\xf7",Ia="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",La="\\u2000-\\u206f",Oa=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Pu="A-Z\\xc0-\\xd6\\xd8-\\xde",Fu="\\ufe0e\\ufe0f",Wu=Ra+Ia+La+Oa,gi="['’]",Ma="["+br+"]",Bu="["+Wu+"]",Cr="["+Lu+"]",Uu="\\d+",Pa="["+Ou+"]",Du="["+Mu+"]",zu="[^"+br+Wu+Uu+Ou+Mu+Pu+"]",_i="\\ud83c[\\udffb-\\udfff]",Fa="(?:"+Cr+"|"+_i+")",Nu="[^"+br+"]",vi="(?:\\ud83c[\\udde6-\\uddff]){2}",mi="[\\ud800-\\udbff][\\udc00-\\udfff]",Ln="["+Pu+"]",$u="\\u200d",ku="(?:"+Du+"|"+zu+")",Wa="(?:"+Ln+"|"+zu+")",Gu="(?:"+gi+"(?:d|ll|m|re|s|t|ve))?",qu="(?:"+gi+"(?:D|LL|M|RE|S|T|VE))?",Hu=Fa+"?",Ku="["+Fu+"]?",Ba="(?:"+$u+"(?:"+[Nu,vi,mi].join("|")+")"+Ku+Hu+")*",Ua="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Da="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Yu=Ku+Hu+Ba,za="(?:"+[Pa,vi,mi].join("|")+")"+Yu,Na="(?:"+[Nu+Cr+"?",Cr,vi,mi,Ma].join("|")+")",$a=RegExp(gi,"g"),ka=RegExp(Cr,"g"),xi=RegExp(_i+"(?="+_i+")|"+Na+Yu,"g"),Ga=RegExp([Ln+"?"+Du+"+"+Gu+"(?="+[Bu,Ln,"$"].join("|")+")",Wa+"+"+qu+"(?="+[Bu,Ln+ku,"$"].join("|")+")",Ln+"?"+ku+"+"+Gu,Ln+"+"+qu,Da,Ua,Uu,za].join("|"),"g"),qa=RegExp("["+$u+br+Lu+Fu+"]"),Ha=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ka=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ya=-1,Q={};Q[on]=Q[Ct]=Q[En]=Q[Tn]=Q[Nt]=Q[Zn]=Q[p]=Q[m]=Q[R]=!0,Q[ye]=Q[Hn]=Q[bt]=Q[nn]=Q[ht]=Q[rn]=Q[Cn]=Q[Sn]=Q[Ue]=Q[un]=Q[et]=Q[Ut]=Q[Oe]=Q[Dt]=Q[zt]=!1;var J={};J[ye]=J[Hn]=J[bt]=J[ht]=J[nn]=J[rn]=J[on]=J[Ct]=J[En]=J[Tn]=J[Nt]=J[Ue]=J[un]=J[et]=J[Ut]=J[Oe]=J[Dt]=J[An]=J[Zn]=J[p]=J[m]=J[R]=!0,J[Cn]=J[Sn]=J[zt]=!1;var Za={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Ja={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Xa={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Qa={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Va=parseFloat,ja=parseInt,Zu=typeof li=="object"&&li&&li.Object===Object&&li,el=typeof self=="object"&&self&&self.Object===Object&&self,ge=Zu||el||Function("return this")(),wi=I&&!I.nodeType&&I,ln=wi&&!0&&ot&&!ot.nodeType&&ot,Ju=ln&&ln.exports===wi,yi=Ju&&Zu.process,qe=(function(){try{var f=ln&&ln.require&&ln.require("util").types;return f||yi&&yi.binding&&yi.binding("util")}catch{}})(),Xu=qe&&qe.isArrayBuffer,Qu=qe&&qe.isDate,Vu=qe&&qe.isMap,ju=qe&&qe.isRegExp,eo=qe&&qe.isSet,to=qe&&qe.isTypedArray;function De(f,d,h){switch(h.length){case 0:return f.call(d);case 1:return f.call(d,h[0]);case 2:return f.call(d,h[0],h[1]);case 3:return f.call(d,h[0],h[1],h[2])}return f.apply(d,h)}function tl(f,d,h,y){for(var L=-1,$=f==null?0:f.length;++L<$;){var ae=f[L];d(y,ae,h(ae),f)}return y}function He(f,d){for(var h=-1,y=f==null?0:f.length;++h<y&&d(f[h],h,f)!==!1;);return f}function nl(f,d){for(var h=f==null?0:f.length;h--&&d(f[h],h,f)!==!1;);return f}function no(f,d){for(var h=-1,y=f==null?0:f.length;++h<y;)if(!d(f[h],h,f))return!1;return!0}function $t(f,d){for(var h=-1,y=f==null?0:f.length,L=0,$=[];++h<y;){var ae=f[h];d(ae,h,f)&&($[L++]=ae)}return $}function Sr(f,d){var h=f==null?0:f.length;return!!h&&On(f,d,0)>-1}function bi(f,d,h){for(var y=-1,L=f==null?0:f.length;++y<L;)if(h(d,f[y]))return!0;return!1}function ee(f,d){for(var h=-1,y=f==null?0:f.length,L=Array(y);++h<y;)L[h]=d(f[h],h,f);return L}function kt(f,d){for(var h=-1,y=d.length,L=f.length;++h<y;)f[L+h]=d[h];return f}function Ci(f,d,h,y){var L=-1,$=f==null?0:f.length;for(y&&$&&(h=f[++L]);++L<$;)h=d(h,f[L],L,f);return h}function rl(f,d,h,y){var L=f==null?0:f.length;for(y&&L&&(h=f[--L]);L--;)h=d(h,f[L],L,f);return h}function Si(f,d){for(var h=-1,y=f==null?0:f.length;++h<y;)if(d(f[h],h,f))return!0;return!1}var il=Ai("length");function ul(f){return f.split("")}function ol(f){return f.match(pa)||[]}function ro(f,d,h){var y;return h(f,function(L,$,ae){if(d(L,$,ae))return y=$,!1}),y}function Ar(f,d,h,y){for(var L=f.length,$=h+(y?1:-1);y?$--:++$<L;)if(d(f[$],$,f))return $;return-1}function On(f,d,h){return d===d?ml(f,d,h):Ar(f,io,h)}function sl(f,d,h,y){for(var L=h-1,$=f.length;++L<$;)if(y(f[L],d))return L;return-1}function io(f){return f!==f}function uo(f,d){var h=f==null?0:f.length;return h?Ti(f,d)/h:z}function Ai(f){return function(d){return d==null?s:d[f]}}function Ei(f){return function(d){return f==null?s:f[d]}}function oo(f,d,h,y,L){return L(f,function($,ae,Y){h=y?(y=!1,$):d(h,$,ae,Y)}),h}function al(f,d){var h=f.length;for(f.sort(d);h--;)f[h]=f[h].value;return f}function Ti(f,d){for(var h,y=-1,L=f.length;++y<L;){var $=d(f[y]);$!==s&&(h=h===s?$:h+$)}return h}function Ri(f,d){for(var h=-1,y=Array(f);++h<f;)y[h]=d(h);return y}function ll(f,d){return ee(d,function(h){return[h,f[h]]})}function so(f){return f&&f.slice(0,co(f)+1).replace(pi,"")}function ze(f){return function(d){return f(d)}}function Ii(f,d){return ee(d,function(h){return f[h]})}function jn(f,d){return f.has(d)}function ao(f,d){for(var h=-1,y=f.length;++h<y&&On(d,f[h],0)>-1;);return h}function lo(f,d){for(var h=f.length;h--&&On(d,f[h],0)>-1;);return h}function fl(f,d){for(var h=f.length,y=0;h--;)f[h]===d&&++y;return y}var cl=Ei(Za),hl=Ei(Ja);function dl(f){return"\\"+Qa[f]}function pl(f,d){return f==null?s:f[d]}function Mn(f){return qa.test(f)}function gl(f){return Ha.test(f)}function _l(f){for(var d,h=[];!(d=f.next()).done;)h.push(d.value);return h}function Li(f){var d=-1,h=Array(f.size);return f.forEach(function(y,L){h[++d]=[L,y]}),h}function fo(f,d){return function(h){return f(d(h))}}function Gt(f,d){for(var h=-1,y=f.length,L=0,$=[];++h<y;){var ae=f[h];(ae===d||ae===G)&&(f[h]=G,$[L++]=h)}return $}function Er(f){var d=-1,h=Array(f.size);return f.forEach(function(y){h[++d]=y}),h}function vl(f){var d=-1,h=Array(f.size);return f.forEach(function(y){h[++d]=[y,y]}),h}function ml(f,d,h){for(var y=h-1,L=f.length;++y<L;)if(f[y]===d)return y;return-1}function xl(f,d,h){for(var y=h+1;y--;)if(f[y]===d)return y;return y}function Pn(f){return Mn(f)?yl(f):il(f)}function tt(f){return Mn(f)?bl(f):ul(f)}function co(f){for(var d=f.length;d--&&fa.test(f.charAt(d)););return d}var wl=Ei(Xa);function yl(f){for(var d=xi.lastIndex=0;xi.test(f);)++d;return d}function bl(f){return f.match(xi)||[]}function Cl(f){return f.match(Ga)||[]}var Sl=(function f(d){d=d==null?ge:Fn.defaults(ge.Object(),d,Fn.pick(ge,Ka));var h=d.Array,y=d.Date,L=d.Error,$=d.Function,ae=d.Math,Y=d.Object,Oi=d.RegExp,Al=d.String,Ke=d.TypeError,Tr=h.prototype,El=$.prototype,Wn=Y.prototype,Rr=d["__core-js_shared__"],Ir=El.toString,H=Wn.hasOwnProperty,Tl=0,ho=(function(){var e=/[^.]+$/.exec(Rr&&Rr.keys&&Rr.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""})(),Lr=Wn.toString,Rl=Ir.call(Y),Il=ge._,Ll=Oi("^"+Ir.call(H).replace(Vn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Or=Ju?d.Buffer:s,qt=d.Symbol,Mr=d.Uint8Array,po=Or?Or.allocUnsafe:s,Pr=fo(Y.getPrototypeOf,Y),go=Y.create,_o=Wn.propertyIsEnumerable,Fr=Tr.splice,vo=qt?qt.isConcatSpreadable:s,er=qt?qt.iterator:s,fn=qt?qt.toStringTag:s,Wr=(function(){try{var e=gn(Y,"defineProperty");return e({},"",{}),e}catch{}})(),Ol=d.clearTimeout!==ge.clearTimeout&&d.clearTimeout,Ml=y&&y.now!==ge.Date.now&&y.now,Pl=d.setTimeout!==ge.setTimeout&&d.setTimeout,Br=ae.ceil,Ur=ae.floor,Mi=Y.getOwnPropertySymbols,Fl=Or?Or.isBuffer:s,mo=d.isFinite,Wl=Tr.join,Bl=fo(Y.keys,Y),le=ae.max,be=ae.min,Ul=y.now,Dl=d.parseInt,xo=ae.random,zl=Tr.reverse,Pi=gn(d,"DataView"),tr=gn(d,"Map"),Fi=gn(d,"Promise"),Bn=gn(d,"Set"),nr=gn(d,"WeakMap"),rr=gn(Y,"create"),Dr=nr&&new nr,Un={},Nl=_n(Pi),$l=_n(tr),kl=_n(Fi),Gl=_n(Bn),ql=_n(nr),zr=qt?qt.prototype:s,ir=zr?zr.valueOf:s,wo=zr?zr.toString:s;function u(e){if(re(e)&&!O(e)&&!(e instanceof U)){if(e instanceof Ye)return e;if(H.call(e,"__wrapped__"))return ys(e)}return new Ye(e)}var Dn=(function(){function e(){}return function(t){if(!te(t))return{};if(go)return go(t);e.prototype=t;var n=new e;return e.prototype=s,n}})();function Nr(){}function Ye(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=s}u.templateSettings={escape:Qn,evaluate:pe,interpolate:sn,variable:"",imports:{_:u}},u.prototype=Nr.prototype,u.prototype.constructor=u,Ye.prototype=Dn(Nr.prototype),Ye.prototype.constructor=Ye;function U(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=X,this.__views__=[]}function Hl(){var e=new U(this.__wrapped__);return e.__actions__=Me(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Me(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Me(this.__views__),e}function Kl(){if(this.__filtered__){var e=new U(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Yl(){var e=this.__wrapped__.value(),t=this.__dir__,n=O(e),r=t<0,i=n?e.length:0,o=oc(0,i,this.__views__),a=o.start,l=o.end,c=l-a,_=r?l:a-1,v=this.__iteratees__,x=v.length,w=0,C=be(c,this.__takeCount__);if(!n||!r&&i==c&&C==c)return qo(e,this.__actions__);var E=[];e:for(;c--&&w<C;){_+=t;for(var P=-1,T=e[_];++P<x;){var B=v[P],D=B.iteratee,ke=B.type,Te=D(T);if(ke==Wt)T=Te;else if(!Te){if(ke==ct)continue e;break e}}E[w++]=T}return E}U.prototype=Dn(Nr.prototype),U.prototype.constructor=U;function cn(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Zl(){this.__data__=rr?rr(null):{},this.size=0}function Jl(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Xl(e){var t=this.__data__;if(rr){var n=t[e];return n===Ve?s:n}return H.call(t,e)?t[e]:s}function Ql(e){var t=this.__data__;return rr?t[e]!==s:H.call(t,e)}function Vl(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=rr&&t===s?Ve:t,this}cn.prototype.clear=Zl,cn.prototype.delete=Jl,cn.prototype.get=Xl,cn.prototype.has=Ql,cn.prototype.set=Vl;function St(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function jl(){this.__data__=[],this.size=0}function ef(e){var t=this.__data__,n=$r(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():Fr.call(t,n,1),--this.size,!0}function tf(e){var t=this.__data__,n=$r(t,e);return n<0?s:t[n][1]}function nf(e){return $r(this.__data__,e)>-1}function rf(e,t){var n=this.__data__,r=$r(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}St.prototype.clear=jl,St.prototype.delete=ef,St.prototype.get=tf,St.prototype.has=nf,St.prototype.set=rf;function At(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function uf(){this.size=0,this.__data__={hash:new cn,map:new(tr||St),string:new cn}}function of(e){var t=jr(this,e).delete(e);return this.size-=t?1:0,t}function sf(e){return jr(this,e).get(e)}function af(e){return jr(this,e).has(e)}function lf(e,t){var n=jr(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}At.prototype.clear=uf,At.prototype.delete=of,At.prototype.get=sf,At.prototype.has=af,At.prototype.set=lf;function hn(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new At;++t<n;)this.add(e[t])}function ff(e){return this.__data__.set(e,Ve),this}function cf(e){return this.__data__.has(e)}hn.prototype.add=hn.prototype.push=ff,hn.prototype.has=cf;function nt(e){var t=this.__data__=new St(e);this.size=t.size}function hf(){this.__data__=new St,this.size=0}function df(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function pf(e){return this.__data__.get(e)}function gf(e){return this.__data__.has(e)}function _f(e,t){var n=this.__data__;if(n instanceof St){var r=n.__data__;if(!tr||r.length<st-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new At(r)}return n.set(e,t),this.size=n.size,this}nt.prototype.clear=hf,nt.prototype.delete=df,nt.prototype.get=pf,nt.prototype.has=gf,nt.prototype.set=_f;function yo(e,t){var n=O(e),r=!n&&vn(e),i=!n&&!r&&Jt(e),o=!n&&!r&&!i&&kn(e),a=n||r||i||o,l=a?Ri(e.length,Al):[],c=l.length;for(var _ in e)(t||H.call(e,_))&&!(a&&(_=="length"||i&&(_=="offset"||_=="parent")||o&&(_=="buffer"||_=="byteLength"||_=="byteOffset")||It(_,c)))&&l.push(_);return l}function bo(e){var t=e.length;return t?e[Hi(0,t-1)]:s}function vf(e,t){return ei(Me(e),dn(t,0,e.length))}function mf(e){return ei(Me(e))}function Wi(e,t,n){(n!==s&&!rt(e[t],n)||n===s&&!(t in e))&&Et(e,t,n)}function ur(e,t,n){var r=e[t];(!(H.call(e,t)&&rt(r,n))||n===s&&!(t in e))&&Et(e,t,n)}function $r(e,t){for(var n=e.length;n--;)if(rt(e[n][0],t))return n;return-1}function xf(e,t,n,r){return Ht(e,function(i,o,a){t(r,i,n(i),a)}),r}function Co(e,t){return e&&gt(t,fe(t),e)}function wf(e,t){return e&&gt(t,Fe(t),e)}function Et(e,t,n){t=="__proto__"&&Wr?Wr(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Bi(e,t){for(var n=-1,r=t.length,i=h(r),o=e==null;++n<r;)i[n]=o?s:_u(e,t[n]);return i}function dn(e,t,n){return e===e&&(n!==s&&(e=e<=n?e:n),t!==s&&(e=e>=t?e:t)),e}function Ze(e,t,n,r,i,o){var a,l=t&xe,c=t&we,_=t&je;if(n&&(a=i?n(e,r,i,o):n(e)),a!==s)return a;if(!te(e))return e;var v=O(e);if(v){if(a=ac(e),!l)return Me(e,a)}else{var x=Ce(e),w=x==Sn||x==Kn;if(Jt(e))return Yo(e,l);if(x==et||x==ye||w&&!i){if(a=c||w?{}:hs(e),!l)return c?Qf(e,wf(a,e)):Xf(e,Co(a,e))}else{if(!J[x])return i?e:{};a=lc(e,x,l)}}o||(o=new nt);var C=o.get(e);if(C)return C;o.set(e,a),$s(e)?e.forEach(function(T){a.add(Ze(T,t,n,T,e,o))}):zs(e)&&e.forEach(function(T,B){a.set(B,Ze(T,t,n,B,e,o))});var E=_?c?nu:tu:c?Fe:fe,P=v?s:E(e);return He(P||e,function(T,B){P&&(B=T,T=e[B]),ur(a,B,Ze(T,t,n,B,e,o))}),a}function yf(e){var t=fe(e);return function(n){return So(n,e,t)}}function So(e,t,n){var r=n.length;if(e==null)return!r;for(e=Y(e);r--;){var i=n[r],o=t[i],a=e[i];if(a===s&&!(i in e)||!o(a))return!1}return!0}function Ao(e,t,n){if(typeof e!="function")throw new Ke(he);return hr(function(){e.apply(s,n)},t)}function or(e,t,n,r){var i=-1,o=Sr,a=!0,l=e.length,c=[],_=t.length;if(!l)return c;n&&(t=ee(t,ze(n))),r?(o=bi,a=!1):t.length>=st&&(o=jn,a=!1,t=new hn(t));e:for(;++i<l;){var v=e[i],x=n==null?v:n(v);if(v=r||v!==0?v:0,a&&x===x){for(var w=_;w--;)if(t[w]===x)continue e;c.push(v)}else o(t,x,r)||c.push(v)}return c}var Ht=Vo(pt),Eo=Vo(Di,!0);function bf(e,t){var n=!0;return Ht(e,function(r,i,o){return n=!!t(r,i,o),n}),n}function kr(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],a=t(o);if(a!=null&&(l===s?a===a&&!$e(a):n(a,l)))var l=a,c=o}return c}function Cf(e,t,n,r){var i=e.length;for(n=M(n),n<0&&(n=-n>i?0:i+n),r=r===s||r>i?i:M(r),r<0&&(r+=i),r=n>r?0:Gs(r);n<r;)e[n++]=t;return e}function To(e,t){var n=[];return Ht(e,function(r,i,o){t(r,i,o)&&n.push(r)}),n}function _e(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=cc),i||(i=[]);++o<a;){var l=e[o];t>0&&n(l)?t>1?_e(l,t-1,n,r,i):kt(i,l):r||(i[i.length]=l)}return i}var Ui=jo(),Ro=jo(!0);function pt(e,t){return e&&Ui(e,t,fe)}function Di(e,t){return e&&Ro(e,t,fe)}function Gr(e,t){return $t(t,function(n){return Lt(e[n])})}function pn(e,t){t=Yt(t,e);for(var n=0,r=t.length;e!=null&&n<r;)e=e[_t(t[n++])];return n&&n==r?e:s}function Io(e,t,n){var r=t(e);return O(e)?r:kt(r,n(e))}function Ae(e){return e==null?e===s?mr:ci:fn&&fn in Y(e)?uc(e):mc(e)}function zi(e,t){return e>t}function Sf(e,t){return e!=null&&H.call(e,t)}function Af(e,t){return e!=null&&t in Y(e)}function Ef(e,t,n){return e>=be(t,n)&&e<le(t,n)}function Ni(e,t,n){for(var r=n?bi:Sr,i=e[0].length,o=e.length,a=o,l=h(o),c=1/0,_=[];a--;){var v=e[a];a&&t&&(v=ee(v,ze(t))),c=be(v.length,c),l[a]=!n&&(t||i>=120&&v.length>=120)?new hn(a&&v):s}v=e[0];var x=-1,w=l[0];e:for(;++x<i&&_.length<c;){var C=v[x],E=t?t(C):C;if(C=n||C!==0?C:0,!(w?jn(w,E):r(_,E,n))){for(a=o;--a;){var P=l[a];if(!(P?jn(P,E):r(e[a],E,n)))continue e}w&&w.push(E),_.push(C)}}return _}function Tf(e,t,n,r){return pt(e,function(i,o,a){t(r,n(i),o,a)}),r}function sr(e,t,n){t=Yt(t,e),e=_s(e,t);var r=e==null?e:e[_t(Xe(t))];return r==null?s:De(r,e,n)}function Lo(e){return re(e)&&Ae(e)==ye}function Rf(e){return re(e)&&Ae(e)==bt}function If(e){return re(e)&&Ae(e)==rn}function ar(e,t,n,r,i){return e===t?!0:e==null||t==null||!re(e)&&!re(t)?e!==e&&t!==t:Lf(e,t,n,r,ar,i)}function Lf(e,t,n,r,i,o){var a=O(e),l=O(t),c=a?Hn:Ce(e),_=l?Hn:Ce(t);c=c==ye?et:c,_=_==ye?et:_;var v=c==et,x=_==et,w=c==_;if(w&&Jt(e)){if(!Jt(t))return!1;a=!0,v=!1}if(w&&!v)return o||(o=new nt),a||kn(e)?ls(e,t,n,r,i,o):rc(e,t,c,n,r,i,o);if(!(n&at)){var C=v&&H.call(e,"__wrapped__"),E=x&&H.call(t,"__wrapped__");if(C||E){var P=C?e.value():e,T=E?t.value():t;return o||(o=new nt),i(P,T,n,r,o)}}return w?(o||(o=new nt),ic(e,t,n,r,i,o)):!1}function Of(e){return re(e)&&Ce(e)==Ue}function $i(e,t,n,r){var i=n.length,o=i,a=!r;if(e==null)return!o;for(e=Y(e);i--;){var l=n[i];if(a&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++i<o;){l=n[i];var c=l[0],_=e[c],v=l[1];if(a&&l[2]){if(_===s&&!(c in e))return!1}else{var x=new nt;if(r)var w=r(_,v,c,e,t,x);if(!(w===s?ar(v,_,at|lt,r,x):w))return!1}}return!0}function Oo(e){if(!te(e)||dc(e))return!1;var t=Lt(e)?Ll:wa;return t.test(_n(e))}function Mf(e){return re(e)&&Ae(e)==Ut}function Pf(e){return re(e)&&Ce(e)==Oe}function Ff(e){return re(e)&&oi(e.length)&&!!Q[Ae(e)]}function Mo(e){return typeof e=="function"?e:e==null?We:typeof e=="object"?O(e)?Wo(e[0],e[1]):Fo(e):ea(e)}function ki(e){if(!cr(e))return Bl(e);var t=[];for(var n in Y(e))H.call(e,n)&&n!="constructor"&&t.push(n);return t}function Wf(e){if(!te(e))return vc(e);var t=cr(e),n=[];for(var r in e)r=="constructor"&&(t||!H.call(e,r))||n.push(r);return n}function Gi(e,t){return e<t}function Po(e,t){var n=-1,r=Pe(e)?h(e.length):[];return Ht(e,function(i,o,a){r[++n]=t(i,o,a)}),r}function Fo(e){var t=iu(e);return t.length==1&&t[0][2]?ps(t[0][0],t[0][1]):function(n){return n===e||$i(n,e,t)}}function Wo(e,t){return ou(e)&&ds(t)?ps(_t(e),t):function(n){var r=_u(n,e);return r===s&&r===t?vu(n,e):ar(t,r,at|lt)}}function qr(e,t,n,r,i){e!==t&&Ui(t,function(o,a){if(i||(i=new nt),te(o))Bf(e,t,a,n,qr,r,i);else{var l=r?r(au(e,a),o,a+"",e,t,i):s;l===s&&(l=o),Wi(e,a,l)}},Fe)}function Bf(e,t,n,r,i,o,a){var l=au(e,n),c=au(t,n),_=a.get(c);if(_){Wi(e,n,_);return}var v=o?o(l,c,n+"",e,t,a):s,x=v===s;if(x){var w=O(c),C=!w&&Jt(c),E=!w&&!C&&kn(c);v=c,w||C||E?O(l)?v=l:ie(l)?v=Me(l):C?(x=!1,v=Yo(c,!0)):E?(x=!1,v=Zo(c,!0)):v=[]:dr(c)||vn(c)?(v=l,vn(l)?v=qs(l):(!te(l)||Lt(l))&&(v=hs(c))):x=!1}x&&(a.set(c,v),i(v,c,r,o,a),a.delete(c)),Wi(e,n,v)}function Bo(e,t){var n=e.length;if(n)return t+=t<0?n:0,It(t,n)?e[t]:s}function Uo(e,t,n){t.length?t=ee(t,function(o){return O(o)?function(a){return pn(a,o.length===1?o[0]:o)}:o}):t=[We];var r=-1;t=ee(t,ze(A()));var i=Po(e,function(o,a,l){var c=ee(t,function(_){return _(o)});return{criteria:c,index:++r,value:o}});return al(i,function(o,a){return Jf(o,a,n)})}function Uf(e,t){return Do(e,t,function(n,r){return vu(e,r)})}function Do(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],l=pn(e,a);n(l,a)&&lr(o,Yt(a,e),l)}return o}function Df(e){return function(t){return pn(t,e)}}function qi(e,t,n,r){var i=r?sl:On,o=-1,a=t.length,l=e;for(e===t&&(t=Me(t)),n&&(l=ee(e,ze(n)));++o<a;)for(var c=0,_=t[o],v=n?n(_):_;(c=i(l,v,c,r))>-1;)l!==e&&Fr.call(l,c,1),Fr.call(e,c,1);return e}function zo(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;It(i)?Fr.call(e,i,1):Zi(e,i)}}return e}function Hi(e,t){return e+Ur(xo()*(t-e+1))}function zf(e,t,n,r){for(var i=-1,o=le(Br((t-e)/(n||1)),0),a=h(o);o--;)a[r?o:++i]=e,e+=n;return a}function Ki(e,t){var n="";if(!e||t<1||t>K)return n;do t%2&&(n+=e),t=Ur(t/2),t&&(e+=e);while(t);return n}function F(e,t){return lu(gs(e,t,We),e+"")}function Nf(e){return bo(Gn(e))}function $f(e,t){var n=Gn(e);return ei(n,dn(t,0,n.length))}function lr(e,t,n,r){if(!te(e))return e;t=Yt(t,e);for(var i=-1,o=t.length,a=o-1,l=e;l!=null&&++i<o;){var c=_t(t[i]),_=n;if(c==="__proto__"||c==="constructor"||c==="prototype")return e;if(i!=a){var v=l[c];_=r?r(v,c,l):s,_===s&&(_=te(v)?v:It(t[i+1])?[]:{})}ur(l,c,_),l=l[c]}return e}var No=Dr?function(e,t){return Dr.set(e,t),e}:We,kf=Wr?function(e,t){return Wr(e,"toString",{configurable:!0,enumerable:!1,value:xu(t),writable:!0})}:We;function Gf(e){return ei(Gn(e))}function Je(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),n=n>i?i:n,n<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=h(i);++r<i;)o[r]=e[r+t];return o}function qf(e,t){var n;return Ht(e,function(r,i,o){return n=t(r,i,o),!n}),!!n}function Hr(e,t,n){var r=0,i=e==null?r:e.length;if(typeof t=="number"&&t===t&&i<=Bt){for(;r<i;){var o=r+i>>>1,a=e[o];a!==null&&!$e(a)&&(n?a<=t:a<t)?r=o+1:i=o}return i}return Yi(e,t,We,n)}function Yi(e,t,n,r){var i=0,o=e==null?0:e.length;if(o===0)return 0;t=n(t);for(var a=t!==t,l=t===null,c=$e(t),_=t===s;i<o;){var v=Ur((i+o)/2),x=n(e[v]),w=x!==s,C=x===null,E=x===x,P=$e(x);if(a)var T=r||E;else _?T=E&&(r||w):l?T=E&&w&&(r||!C):c?T=E&&w&&!C&&(r||!P):C||P?T=!1:T=r?x<=t:x<t;T?i=v+1:o=v}return be(o,bn)}function $o(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n],l=t?t(a):a;if(!n||!rt(l,c)){var c=l;o[i++]=a===0?0:a}}return o}function ko(e){return typeof e=="number"?e:$e(e)?z:+e}function Ne(e){if(typeof e=="string")return e;if(O(e))return ee(e,Ne)+"";if($e(e))return wo?wo.call(e):"";var t=e+"";return t=="0"&&1/e==-q?"-0":t}function Kt(e,t,n){var r=-1,i=Sr,o=e.length,a=!0,l=[],c=l;if(n)a=!1,i=bi;else if(o>=st){var _=t?null:tc(e);if(_)return Er(_);a=!1,i=jn,c=new hn}else c=t?[]:l;e:for(;++r<o;){var v=e[r],x=t?t(v):v;if(v=n||v!==0?v:0,a&&x===x){for(var w=c.length;w--;)if(c[w]===x)continue e;t&&c.push(x),l.push(v)}else i(c,x,n)||(c!==l&&c.push(x),l.push(v))}return l}function Zi(e,t){return t=Yt(t,e),e=_s(e,t),e==null||delete e[_t(Xe(t))]}function Go(e,t,n,r){return lr(e,t,n(pn(e,t)),r)}function Kr(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?Je(e,r?0:o,r?o+1:i):Je(e,r?o+1:0,r?i:o)}function qo(e,t){var n=e;return n instanceof U&&(n=n.value()),Ci(t,function(r,i){return i.func.apply(i.thisArg,kt([r],i.args))},n)}function Ji(e,t,n){var r=e.length;if(r<2)return r?Kt(e[0]):[];for(var i=-1,o=h(r);++i<r;)for(var a=e[i],l=-1;++l<r;)l!=i&&(o[i]=or(o[i]||a,e[l],t,n));return Kt(_e(o,1),t,n)}function Ho(e,t,n){for(var r=-1,i=e.length,o=t.length,a={};++r<i;){var l=r<o?t[r]:s;n(a,e[r],l)}return a}function Xi(e){return ie(e)?e:[]}function Qi(e){return typeof e=="function"?e:We}function Yt(e,t){return O(e)?e:ou(e,t)?[e]:ws(k(e))}var Hf=F;function Zt(e,t,n){var r=e.length;return n=n===s?r:n,!t&&n>=r?e:Je(e,t,n)}var Ko=Ol||function(e){return ge.clearTimeout(e)};function Yo(e,t){if(t)return e.slice();var n=e.length,r=po?po(n):new e.constructor(n);return e.copy(r),r}function Vi(e){var t=new e.constructor(e.byteLength);return new Mr(t).set(new Mr(e)),t}function Kf(e,t){var n=t?Vi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function Yf(e){var t=new e.constructor(e.source,Iu.exec(e));return t.lastIndex=e.lastIndex,t}function Zf(e){return ir?Y(ir.call(e)):{}}function Zo(e,t){var n=t?Vi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Jo(e,t){if(e!==t){var n=e!==s,r=e===null,i=e===e,o=$e(e),a=t!==s,l=t===null,c=t===t,_=$e(t);if(!l&&!_&&!o&&e>t||o&&a&&c&&!l&&!_||r&&a&&c||!n&&c||!i)return 1;if(!r&&!o&&!_&&e<t||_&&n&&i&&!r&&!o||l&&n&&i||!a&&i||!c)return-1}return 0}function Jf(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,a=i.length,l=n.length;++r<a;){var c=Jo(i[r],o[r]);if(c){if(r>=l)return c;var _=n[r];return c*(_=="desc"?-1:1)}}return e.index-t.index}function Xo(e,t,n,r){for(var i=-1,o=e.length,a=n.length,l=-1,c=t.length,_=le(o-a,0),v=h(c+_),x=!r;++l<c;)v[l]=t[l];for(;++i<a;)(x||i<o)&&(v[n[i]]=e[i]);for(;_--;)v[l++]=e[i++];return v}function Qo(e,t,n,r){for(var i=-1,o=e.length,a=-1,l=n.length,c=-1,_=t.length,v=le(o-l,0),x=h(v+_),w=!r;++i<v;)x[i]=e[i];for(var C=i;++c<_;)x[C+c]=t[c];for(;++a<l;)(w||i<o)&&(x[C+n[a]]=e[i++]);return x}function Me(e,t){var n=-1,r=e.length;for(t||(t=h(r));++n<r;)t[n]=e[n];return t}function gt(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var l=t[o],c=r?r(n[l],e[l],l,n,e):s;c===s&&(c=e[l]),i?Et(n,l,c):ur(n,l,c)}return n}function Xf(e,t){return gt(e,uu(e),t)}function Qf(e,t){return gt(e,fs(e),t)}function Yr(e,t){return function(n,r){var i=O(n)?tl:xf,o=t?t():{};return i(n,e,A(r,2),o)}}function zn(e){return F(function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:s,a=i>2?n[2]:s;for(o=e.length>3&&typeof o=="function"?(i--,o):s,a&&Ee(n[0],n[1],a)&&(o=i<3?s:o,i=1),t=Y(t);++r<i;){var l=n[r];l&&e(t,l,r,o)}return t})}function Vo(e,t){return function(n,r){if(n==null)return n;if(!Pe(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=Y(n);(t?o--:++o<i)&&r(a[o],o,a)!==!1;);return n}}function jo(e){return function(t,n,r){for(var i=-1,o=Y(t),a=r(t),l=a.length;l--;){var c=a[e?l:++i];if(n(o[c],c,o)===!1)break}return t}}function Vf(e,t,n){var r=t&de,i=fr(e);function o(){var a=this&&this!==ge&&this instanceof o?i:e;return a.apply(r?n:this,arguments)}return o}function es(e){return function(t){t=k(t);var n=Mn(t)?tt(t):s,r=n?n[0]:t.charAt(0),i=n?Zt(n,1).join(""):t.slice(1);return r[e]()+i}}function Nn(e){return function(t){return Ci(Vs(Qs(t).replace($a,"")),e,"")}}function fr(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Dn(e.prototype),r=e.apply(n,t);return te(r)?r:n}}function jf(e,t,n){var r=fr(e);function i(){for(var o=arguments.length,a=h(o),l=o,c=$n(i);l--;)a[l]=arguments[l];var _=o<3&&a[0]!==c&&a[o-1]!==c?[]:Gt(a,c);if(o-=_.length,o<n)return us(e,t,Zr,i.placeholder,s,a,_,s,s,n-o);var v=this&&this!==ge&&this instanceof i?r:e;return De(v,this,a)}return i}function ts(e){return function(t,n,r){var i=Y(t);if(!Pe(t)){var o=A(n,3);t=fe(t),n=function(l){return o(i[l],l,i)}}var a=e(t,n,r);return a>-1?i[o?t[a]:a]:s}}function ns(e){return Rt(function(t){var n=t.length,r=n,i=Ye.prototype.thru;for(e&&t.reverse();r--;){var o=t[r];if(typeof o!="function")throw new Ke(he);if(i&&!a&&Vr(o)=="wrapper")var a=new Ye([],!0)}for(r=a?r:n;++r<n;){o=t[r];var l=Vr(o),c=l=="wrapper"?ru(o):s;c&&su(c[0])&&c[1]==(Le|Re|Ie|Ft)&&!c[4].length&&c[9]==1?a=a[Vr(c[0])].apply(a,c[3]):a=o.length==1&&su(o)?a[l]():a.thru(o)}return function(){var _=arguments,v=_[0];if(a&&_.length==1&&O(v))return a.plant(v).value();for(var x=0,w=n?t[x].apply(this,_):v;++x<n;)w=t[x].call(this,w);return w}})}function Zr(e,t,n,r,i,o,a,l,c,_){var v=t&Le,x=t&de,w=t&Z,C=t&(Re|ft),E=t&wn,P=w?s:fr(e);function T(){for(var B=arguments.length,D=h(B),ke=B;ke--;)D[ke]=arguments[ke];if(C)var Te=$n(T),Ge=fl(D,Te);if(r&&(D=Xo(D,r,i,C)),o&&(D=Qo(D,o,a,C)),B-=Ge,C&&B<_){var ue=Gt(D,Te);return us(e,t,Zr,T.placeholder,n,D,ue,l,c,_-B)}var it=x?n:this,Mt=w?it[e]:e;return B=D.length,l?D=xc(D,l):E&&B>1&&D.reverse(),v&&c<B&&(D.length=c),this&&this!==ge&&this instanceof T&&(Mt=P||fr(Mt)),Mt.apply(it,D)}return T}function rs(e,t){return function(n,r){return Tf(n,e,t(r),{})}}function Jr(e,t){return function(n,r){var i;if(n===s&&r===s)return t;if(n!==s&&(i=n),r!==s){if(i===s)return r;typeof n=="string"||typeof r=="string"?(n=Ne(n),r=Ne(r)):(n=ko(n),r=ko(r)),i=e(n,r)}return i}}function ji(e){return Rt(function(t){return t=ee(t,ze(A())),F(function(n){var r=this;return e(t,function(i){return De(i,r,n)})})})}function Xr(e,t){t=t===s?" ":Ne(t);var n=t.length;if(n<2)return n?Ki(t,e):t;var r=Ki(t,Br(e/Pn(t)));return Mn(t)?Zt(tt(r),0,e).join(""):r.slice(0,e)}function ec(e,t,n,r){var i=t&de,o=fr(e);function a(){for(var l=-1,c=arguments.length,_=-1,v=r.length,x=h(v+c),w=this&&this!==ge&&this instanceof a?o:e;++_<v;)x[_]=r[_];for(;c--;)x[_++]=arguments[++l];return De(w,i?n:this,x)}return a}function is(e){return function(t,n,r){return r&&typeof r!="number"&&Ee(t,n,r)&&(n=r=s),t=Ot(t),n===s?(n=t,t=0):n=Ot(n),r=r===s?t<n?1:-1:Ot(r),zf(t,n,r,e)}}function Qr(e){return function(t,n){return typeof t=="string"&&typeof n=="string"||(t=Qe(t),n=Qe(n)),e(t,n)}}function us(e,t,n,r,i,o,a,l,c,_){var v=t&Re,x=v?a:s,w=v?s:a,C=v?o:s,E=v?s:o;t|=v?Ie:yt,t&=~(v?yt:Ie),t&wt||(t&=-4);var P=[e,t,i,C,x,E,w,l,c,_],T=n.apply(s,P);return su(e)&&vs(T,P),T.placeholder=r,ms(T,e,t)}function eu(e){var t=ae[e];return function(n,r){if(n=Qe(n),r=r==null?0:be(M(r),292),r&&mo(n)){var i=(k(n)+"e").split("e"),o=t(i[0]+"e"+(+i[1]+r));return i=(k(o)+"e").split("e"),+(i[0]+"e"+(+i[1]-r))}return t(n)}}var tc=Bn&&1/Er(new Bn([,-0]))[1]==q?function(e){return new Bn(e)}:bu;function os(e){return function(t){var n=Ce(t);return n==Ue?Li(t):n==Oe?vl(t):ll(t,e(t))}}function Tt(e,t,n,r,i,o,a,l){var c=t&Z;if(!c&&typeof e!="function")throw new Ke(he);var _=r?r.length:0;if(_||(t&=-97,r=i=s),a=a===s?a:le(M(a),0),l=l===s?l:M(l),_-=i?i.length:0,t&yt){var v=r,x=i;r=i=s}var w=c?s:ru(e),C=[e,t,n,r,i,v,x,o,a,l];if(w&&_c(C,w),e=C[0],t=C[1],n=C[2],r=C[3],i=C[4],l=C[9]=C[9]===s?c?0:e.length:le(C[9]-_,0),!l&&t&(Re|ft)&&(t&=-25),!t||t==de)var E=Vf(e,t,n);else t==Re||t==ft?E=jf(e,t,l):(t==Ie||t==(de|Ie))&&!i.length?E=ec(e,t,n,r):E=Zr.apply(s,C);var P=w?No:vs;return ms(P(E,C),e,t)}function ss(e,t,n,r){return e===s||rt(e,Wn[n])&&!H.call(r,n)?t:e}function as(e,t,n,r,i,o){return te(e)&&te(t)&&(o.set(t,e),qr(e,t,s,as,o),o.delete(t)),e}function nc(e){return dr(e)?s:e}function ls(e,t,n,r,i,o){var a=n&at,l=e.length,c=t.length;if(l!=c&&!(a&&c>l))return!1;var _=o.get(e),v=o.get(t);if(_&&v)return _==t&&v==e;var x=-1,w=!0,C=n&lt?new hn:s;for(o.set(e,t),o.set(t,e);++x<l;){var E=e[x],P=t[x];if(r)var T=a?r(P,E,x,t,e,o):r(E,P,x,e,t,o);if(T!==s){if(T)continue;w=!1;break}if(C){if(!Si(t,function(B,D){if(!jn(C,D)&&(E===B||i(E,B,n,r,o)))return C.push(D)})){w=!1;break}}else if(!(E===P||i(E,P,n,r,o))){w=!1;break}}return o.delete(e),o.delete(t),w}function rc(e,t,n,r,i,o,a){switch(n){case ht:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case bt:return!(e.byteLength!=t.byteLength||!o(new Mr(e),new Mr(t)));case nn:case rn:case un:return rt(+e,+t);case Cn:return e.name==t.name&&e.message==t.message;case Ut:case Dt:return e==t+"";case Ue:var l=Li;case Oe:var c=r&at;if(l||(l=Er),e.size!=t.size&&!c)return!1;var _=a.get(e);if(_)return _==t;r|=lt,a.set(e,t);var v=ls(l(e),l(t),r,i,o,a);return a.delete(e),v;case An:if(ir)return ir.call(e)==ir.call(t)}return!1}function ic(e,t,n,r,i,o){var a=n&at,l=tu(e),c=l.length,_=tu(t),v=_.length;if(c!=v&&!a)return!1;for(var x=c;x--;){var w=l[x];if(!(a?w in t:H.call(t,w)))return!1}var C=o.get(e),E=o.get(t);if(C&&E)return C==t&&E==e;var P=!0;o.set(e,t),o.set(t,e);for(var T=a;++x<c;){w=l[x];var B=e[w],D=t[w];if(r)var ke=a?r(D,B,w,t,e,o):r(B,D,w,e,t,o);if(!(ke===s?B===D||i(B,D,n,r,o):ke)){P=!1;break}T||(T=w=="constructor")}if(P&&!T){var Te=e.constructor,Ge=t.constructor;Te!=Ge&&"constructor"in e&&"constructor"in t&&!(typeof Te=="function"&&Te instanceof Te&&typeof Ge=="function"&&Ge instanceof Ge)&&(P=!1)}return o.delete(e),o.delete(t),P}function Rt(e){return lu(gs(e,s,Ss),e+"")}function tu(e){return Io(e,fe,uu)}function nu(e){return Io(e,Fe,fs)}var ru=Dr?function(e){return Dr.get(e)}:bu;function Vr(e){for(var t=e.name+"",n=Un[t],r=H.call(Un,t)?n.length:0;r--;){var i=n[r],o=i.func;if(o==null||o==e)return i.name}return t}function $n(e){var t=H.call(u,"placeholder")?u:e;return t.placeholder}function A(){var e=u.iteratee||wu;return e=e===wu?Mo:e,arguments.length?e(arguments[0],arguments[1]):e}function jr(e,t){var n=e.__data__;return hc(t)?n[typeof t=="string"?"string":"hash"]:n.map}function iu(e){for(var t=fe(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,ds(i)]}return t}function gn(e,t){var n=pl(e,t);return Oo(n)?n:s}function uc(e){var t=H.call(e,fn),n=e[fn];try{e[fn]=s;var r=!0}catch{}var i=Lr.call(e);return r&&(t?e[fn]=n:delete e[fn]),i}var uu=Mi?function(e){return e==null?[]:(e=Y(e),$t(Mi(e),function(t){return _o.call(e,t)}))}:Cu,fs=Mi?function(e){for(var t=[];e;)kt(t,uu(e)),e=Pr(e);return t}:Cu,Ce=Ae;(Pi&&Ce(new Pi(new ArrayBuffer(1)))!=ht||tr&&Ce(new tr)!=Ue||Fi&&Ce(Fi.resolve())!=Yn||Bn&&Ce(new Bn)!=Oe||nr&&Ce(new nr)!=zt)&&(Ce=function(e){var t=Ae(e),n=t==et?e.constructor:s,r=n?_n(n):"";if(r)switch(r){case Nl:return ht;case $l:return Ue;case kl:return Yn;case Gl:return Oe;case ql:return zt}return t});function oc(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=be(t,e+a);break;case"takeRight":e=le(e,t-a);break}}return{start:e,end:t}}function sc(e){var t=e.match(ha);return t?t[1].split(da):[]}function cs(e,t,n){t=Yt(t,e);for(var r=-1,i=t.length,o=!1;++r<i;){var a=_t(t[r]);if(!(o=e!=null&&n(e,a)))break;e=e[a]}return o||++r!=i?o:(i=e==null?0:e.length,!!i&&oi(i)&&It(a,i)&&(O(e)||vn(e)))}function ac(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&H.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function hs(e){return typeof e.constructor=="function"&&!cr(e)?Dn(Pr(e)):{}}function lc(e,t,n){var r=e.constructor;switch(t){case bt:return Vi(e);case nn:case rn:return new r(+e);case ht:return Kf(e,n);case on:case Ct:case En:case Tn:case Nt:case Zn:case p:case m:case R:return Zo(e,n);case Ue:return new r;case un:case Dt:return new r(e);case Ut:return Yf(e);case Oe:return new r;case An:return Zf(e)}}function fc(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(ca,`{
/* [wrapped with `+t+`] */
`)}function cc(e){return O(e)||vn(e)||!!(vo&&e&&e[vo])}function It(e,t){var n=typeof e;return t=t??K,!!t&&(n=="number"||n!="symbol"&&ba.test(e))&&e>-1&&e%1==0&&e<t}function Ee(e,t,n){if(!te(n))return!1;var r=typeof t;return(r=="number"?Pe(n)&&It(t,n.length):r=="string"&&t in n)?rt(n[t],e):!1}function ou(e,t){if(O(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||$e(e)?!0:an.test(e)||!dt.test(e)||t!=null&&e in Y(t)}function hc(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function su(e){var t=Vr(e),n=u[t];if(typeof n!="function"||!(t in U.prototype))return!1;if(e===n)return!0;var r=ru(n);return!!r&&e===r[0]}function dc(e){return!!ho&&ho in e}var pc=Rr?Lt:Su;function cr(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Wn;return e===n}function ds(e){return e===e&&!te(e)}function ps(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==s||e in Y(n))}}function gc(e){var t=ii(e,function(r){return n.size===jt&&n.clear(),r}),n=t.cache;return t}function _c(e,t){var n=e[1],r=t[1],i=n|r,o=i<(de|Z|Le),a=r==Le&&n==Re||r==Le&&n==Ft&&e[7].length<=t[8]||r==(Le|Ft)&&t[7].length<=t[8]&&n==Re;if(!(o||a))return e;r&de&&(e[2]=t[2],i|=n&de?0:wt);var l=t[3];if(l){var c=e[3];e[3]=c?Xo(c,l,t[4]):l,e[4]=c?Gt(e[3],G):t[4]}return l=t[5],l&&(c=e[5],e[5]=c?Qo(c,l,t[6]):l,e[6]=c?Gt(e[5],G):t[6]),l=t[7],l&&(e[7]=l),r&Le&&(e[8]=e[8]==null?t[8]:be(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=i,e}function vc(e){var t=[];if(e!=null)for(var n in Y(e))t.push(n);return t}function mc(e){return Lr.call(e)}function gs(e,t,n){return t=le(t===s?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=le(r.length-t,0),a=h(o);++i<o;)a[i]=r[t+i];i=-1;for(var l=h(t+1);++i<t;)l[i]=r[i];return l[t]=n(a),De(e,this,l)}}function _s(e,t){return t.length<2?e:pn(e,Je(t,0,-1))}function xc(e,t){for(var n=e.length,r=be(t.length,n),i=Me(e);r--;){var o=t[r];e[r]=It(o,n)?i[o]:s}return e}function au(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var vs=xs(No),hr=Pl||function(e,t){return ge.setTimeout(e,t)},lu=xs(kf);function ms(e,t,n){var r=t+"";return lu(e,fc(r,wc(sc(r),n)))}function xs(e){var t=0,n=0;return function(){var r=Ul(),i=Be-(r-n);if(n=r,i>0){if(++t>=Se)return arguments[0]}else t=0;return e.apply(s,arguments)}}function ei(e,t){var n=-1,r=e.length,i=r-1;for(t=t===s?r:t;++n<t;){var o=Hi(n,i),a=e[o];e[o]=e[n],e[n]=a}return e.length=t,e}var ws=gc(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(di,function(n,r,i,o){t.push(i?o.replace(_a,"$1"):r||n)}),t});function _t(e){if(typeof e=="string"||$e(e))return e;var t=e+"";return t=="0"&&1/e==-q?"-0":t}function _n(e){if(e!=null){try{return Ir.call(e)}catch{}try{return e+""}catch{}}return""}function wc(e,t){return He(en,function(n){var r="_."+n[0];t&n[1]&&!Sr(e,r)&&e.push(r)}),e.sort()}function ys(e){if(e instanceof U)return e.clone();var t=new Ye(e.__wrapped__,e.__chain__);return t.__actions__=Me(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function yc(e,t,n){(n?Ee(e,t,n):t===s)?t=1:t=le(M(t),0);var r=e==null?0:e.length;if(!r||t<1)return[];for(var i=0,o=0,a=h(Br(r/t));i<r;)a[o++]=Je(e,i,i+=t);return a}function bc(e){for(var t=-1,n=e==null?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i}function Cc(){var e=arguments.length;if(!e)return[];for(var t=h(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return kt(O(n)?Me(n):[n],_e(t,1))}var Sc=F(function(e,t){return ie(e)?or(e,_e(t,1,ie,!0)):[]}),Ac=F(function(e,t){var n=Xe(t);return ie(n)&&(n=s),ie(e)?or(e,_e(t,1,ie,!0),A(n,2)):[]}),Ec=F(function(e,t){var n=Xe(t);return ie(n)&&(n=s),ie(e)?or(e,_e(t,1,ie,!0),s,n):[]});function Tc(e,t,n){var r=e==null?0:e.length;return r?(t=n||t===s?1:M(t),Je(e,t<0?0:t,r)):[]}function Rc(e,t,n){var r=e==null?0:e.length;return r?(t=n||t===s?1:M(t),t=r-t,Je(e,0,t<0?0:t)):[]}function Ic(e,t){return e&&e.length?Kr(e,A(t,3),!0,!0):[]}function Lc(e,t){return e&&e.length?Kr(e,A(t,3),!0):[]}function Oc(e,t,n,r){var i=e==null?0:e.length;return i?(n&&typeof n!="number"&&Ee(e,t,n)&&(n=0,r=i),Cf(e,t,n,r)):[]}function bs(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var i=n==null?0:M(n);return i<0&&(i=le(r+i,0)),Ar(e,A(t,3),i)}function Cs(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var i=r-1;return n!==s&&(i=M(n),i=n<0?le(r+i,0):be(i,r-1)),Ar(e,A(t,3),i,!0)}function Ss(e){var t=e==null?0:e.length;return t?_e(e,1):[]}function Mc(e){var t=e==null?0:e.length;return t?_e(e,q):[]}function Pc(e,t){var n=e==null?0:e.length;return n?(t=t===s?1:M(t),_e(e,t)):[]}function Fc(e){for(var t=-1,n=e==null?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r}function As(e){return e&&e.length?e[0]:s}function Wc(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var i=n==null?0:M(n);return i<0&&(i=le(r+i,0)),On(e,t,i)}function Bc(e){var t=e==null?0:e.length;return t?Je(e,0,-1):[]}var Uc=F(function(e){var t=ee(e,Xi);return t.length&&t[0]===e[0]?Ni(t):[]}),Dc=F(function(e){var t=Xe(e),n=ee(e,Xi);return t===Xe(n)?t=s:n.pop(),n.length&&n[0]===e[0]?Ni(n,A(t,2)):[]}),zc=F(function(e){var t=Xe(e),n=ee(e,Xi);return t=typeof t=="function"?t:s,t&&n.pop(),n.length&&n[0]===e[0]?Ni(n,s,t):[]});function Nc(e,t){return e==null?"":Wl.call(e,t)}function Xe(e){var t=e==null?0:e.length;return t?e[t-1]:s}function $c(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var i=r;return n!==s&&(i=M(n),i=i<0?le(r+i,0):be(i,r-1)),t===t?xl(e,t,i):Ar(e,io,i,!0)}function kc(e,t){return e&&e.length?Bo(e,M(t)):s}var Gc=F(Es);function Es(e,t){return e&&e.length&&t&&t.length?qi(e,t):e}function qc(e,t,n){return e&&e.length&&t&&t.length?qi(e,t,A(n,2)):e}function Hc(e,t,n){return e&&e.length&&t&&t.length?qi(e,t,s,n):e}var Kc=Rt(function(e,t){var n=e==null?0:e.length,r=Bi(e,t);return zo(e,ee(t,function(i){return It(i,n)?+i:i}).sort(Jo)),r});function Yc(e,t){var n=[];if(!(e&&e.length))return n;var r=-1,i=[],o=e.length;for(t=A(t,3);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}return zo(e,i),n}function fu(e){return e==null?e:zl.call(e)}function Zc(e,t,n){var r=e==null?0:e.length;return r?(n&&typeof n!="number"&&Ee(e,t,n)?(t=0,n=r):(t=t==null?0:M(t),n=n===s?r:M(n)),Je(e,t,n)):[]}function Jc(e,t){return Hr(e,t)}function Xc(e,t,n){return Yi(e,t,A(n,2))}function Qc(e,t){var n=e==null?0:e.length;if(n){var r=Hr(e,t);if(r<n&&rt(e[r],t))return r}return-1}function Vc(e,t){return Hr(e,t,!0)}function jc(e,t,n){return Yi(e,t,A(n,2),!0)}function eh(e,t){var n=e==null?0:e.length;if(n){var r=Hr(e,t,!0)-1;if(rt(e[r],t))return r}return-1}function th(e){return e&&e.length?$o(e):[]}function nh(e,t){return e&&e.length?$o(e,A(t,2)):[]}function rh(e){var t=e==null?0:e.length;return t?Je(e,1,t):[]}function ih(e,t,n){return e&&e.length?(t=n||t===s?1:M(t),Je(e,0,t<0?0:t)):[]}function uh(e,t,n){var r=e==null?0:e.length;return r?(t=n||t===s?1:M(t),t=r-t,Je(e,t<0?0:t,r)):[]}function oh(e,t){return e&&e.length?Kr(e,A(t,3),!1,!0):[]}function sh(e,t){return e&&e.length?Kr(e,A(t,3)):[]}var ah=F(function(e){return Kt(_e(e,1,ie,!0))}),lh=F(function(e){var t=Xe(e);return ie(t)&&(t=s),Kt(_e(e,1,ie,!0),A(t,2))}),fh=F(function(e){var t=Xe(e);return t=typeof t=="function"?t:s,Kt(_e(e,1,ie,!0),s,t)});function ch(e){return e&&e.length?Kt(e):[]}function hh(e,t){return e&&e.length?Kt(e,A(t,2)):[]}function dh(e,t){return t=typeof t=="function"?t:s,e&&e.length?Kt(e,s,t):[]}function cu(e){if(!(e&&e.length))return[];var t=0;return e=$t(e,function(n){if(ie(n))return t=le(n.length,t),!0}),Ri(t,function(n){return ee(e,Ai(n))})}function Ts(e,t){if(!(e&&e.length))return[];var n=cu(e);return t==null?n:ee(n,function(r){return De(t,s,r)})}var ph=F(function(e,t){return ie(e)?or(e,t):[]}),gh=F(function(e){return Ji($t(e,ie))}),_h=F(function(e){var t=Xe(e);return ie(t)&&(t=s),Ji($t(e,ie),A(t,2))}),vh=F(function(e){var t=Xe(e);return t=typeof t=="function"?t:s,Ji($t(e,ie),s,t)}),mh=F(cu);function xh(e,t){return Ho(e||[],t||[],ur)}function wh(e,t){return Ho(e||[],t||[],lr)}var yh=F(function(e){var t=e.length,n=t>1?e[t-1]:s;return n=typeof n=="function"?(e.pop(),n):s,Ts(e,n)});function Rs(e){var t=u(e);return t.__chain__=!0,t}function bh(e,t){return t(e),e}function ti(e,t){return t(e)}var Ch=Rt(function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(o){return Bi(o,e)};return t>1||this.__actions__.length||!(r instanceof U)||!It(n)?this.thru(i):(r=r.slice(n,+n+(t?1:0)),r.__actions__.push({func:ti,args:[i],thisArg:s}),new Ye(r,this.__chain__).thru(function(o){return t&&!o.length&&o.push(s),o}))});function Sh(){return Rs(this)}function Ah(){return new Ye(this.value(),this.__chain__)}function Eh(){this.__values__===s&&(this.__values__=ks(this.value()));var e=this.__index__>=this.__values__.length,t=e?s:this.__values__[this.__index__++];return{done:e,value:t}}function Th(){return this}function Rh(e){for(var t,n=this;n instanceof Nr;){var r=ys(n);r.__index__=0,r.__values__=s,t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__}return i.__wrapped__=e,t}function Ih(){var e=this.__wrapped__;if(e instanceof U){var t=e;return this.__actions__.length&&(t=new U(this)),t=t.reverse(),t.__actions__.push({func:ti,args:[fu],thisArg:s}),new Ye(t,this.__chain__)}return this.thru(fu)}function Lh(){return qo(this.__wrapped__,this.__actions__)}var Oh=Yr(function(e,t,n){H.call(e,n)?++e[n]:Et(e,n,1)});function Mh(e,t,n){var r=O(e)?no:bf;return n&&Ee(e,t,n)&&(t=s),r(e,A(t,3))}function Ph(e,t){var n=O(e)?$t:To;return n(e,A(t,3))}var Fh=ts(bs),Wh=ts(Cs);function Bh(e,t){return _e(ni(e,t),1)}function Uh(e,t){return _e(ni(e,t),q)}function Dh(e,t,n){return n=n===s?1:M(n),_e(ni(e,t),n)}function Is(e,t){var n=O(e)?He:Ht;return n(e,A(t,3))}function Ls(e,t){var n=O(e)?nl:Eo;return n(e,A(t,3))}var zh=Yr(function(e,t,n){H.call(e,n)?e[n].push(t):Et(e,n,[t])});function Nh(e,t,n,r){e=Pe(e)?e:Gn(e),n=n&&!r?M(n):0;var i=e.length;return n<0&&(n=le(i+n,0)),si(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&On(e,t,n)>-1}var $h=F(function(e,t,n){var r=-1,i=typeof t=="function",o=Pe(e)?h(e.length):[];return Ht(e,function(a){o[++r]=i?De(t,a,n):sr(a,t,n)}),o}),kh=Yr(function(e,t,n){Et(e,n,t)});function ni(e,t){var n=O(e)?ee:Po;return n(e,A(t,3))}function Gh(e,t,n,r){return e==null?[]:(O(t)||(t=t==null?[]:[t]),n=r?s:n,O(n)||(n=n==null?[]:[n]),Uo(e,t,n))}var qh=Yr(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});function Hh(e,t,n){var r=O(e)?Ci:oo,i=arguments.length<3;return r(e,A(t,4),n,i,Ht)}function Kh(e,t,n){var r=O(e)?rl:oo,i=arguments.length<3;return r(e,A(t,4),n,i,Eo)}function Yh(e,t){var n=O(e)?$t:To;return n(e,ui(A(t,3)))}function Zh(e){var t=O(e)?bo:Nf;return t(e)}function Jh(e,t,n){(n?Ee(e,t,n):t===s)?t=1:t=M(t);var r=O(e)?vf:$f;return r(e,t)}function Xh(e){var t=O(e)?mf:Gf;return t(e)}function Qh(e){if(e==null)return 0;if(Pe(e))return si(e)?Pn(e):e.length;var t=Ce(e);return t==Ue||t==Oe?e.size:ki(e).length}function Vh(e,t,n){var r=O(e)?Si:qf;return n&&Ee(e,t,n)&&(t=s),r(e,A(t,3))}var jh=F(function(e,t){if(e==null)return[];var n=t.length;return n>1&&Ee(e,t[0],t[1])?t=[]:n>2&&Ee(t[0],t[1],t[2])&&(t=[t[0]]),Uo(e,_e(t,1),[])}),ri=Ml||function(){return ge.Date.now()};function ed(e,t){if(typeof t!="function")throw new Ke(he);return e=M(e),function(){if(--e<1)return t.apply(this,arguments)}}function Os(e,t,n){return t=n?s:t,t=e&&t==null?e.length:t,Tt(e,Le,s,s,s,s,t)}function Ms(e,t){var n;if(typeof t!="function")throw new Ke(he);return e=M(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=s),n}}var hu=F(function(e,t,n){var r=de;if(n.length){var i=Gt(n,$n(hu));r|=Ie}return Tt(e,r,t,n,i)}),Ps=F(function(e,t,n){var r=de|Z;if(n.length){var i=Gt(n,$n(Ps));r|=Ie}return Tt(t,r,e,n,i)});function Fs(e,t,n){t=n?s:t;var r=Tt(e,Re,s,s,s,s,s,t);return r.placeholder=Fs.placeholder,r}function Ws(e,t,n){t=n?s:t;var r=Tt(e,ft,s,s,s,s,s,t);return r.placeholder=Ws.placeholder,r}function Bs(e,t,n){var r,i,o,a,l,c,_=0,v=!1,x=!1,w=!0;if(typeof e!="function")throw new Ke(he);t=Qe(t)||0,te(n)&&(v=!!n.leading,x="maxWait"in n,o=x?le(Qe(n.maxWait)||0,t):o,w="trailing"in n?!!n.trailing:w);function C(ue){var it=r,Mt=i;return r=i=s,_=ue,a=e.apply(Mt,it),a}function E(ue){return _=ue,l=hr(B,t),v?C(ue):a}function P(ue){var it=ue-c,Mt=ue-_,ta=t-it;return x?be(ta,o-Mt):ta}function T(ue){var it=ue-c,Mt=ue-_;return c===s||it>=t||it<0||x&&Mt>=o}function B(){var ue=ri();if(T(ue))return D(ue);l=hr(B,P(ue))}function D(ue){return l=s,w&&r?C(ue):(r=i=s,a)}function ke(){l!==s&&Ko(l),_=0,r=c=i=l=s}function Te(){return l===s?a:D(ri())}function Ge(){var ue=ri(),it=T(ue);if(r=arguments,i=this,c=ue,it){if(l===s)return E(c);if(x)return Ko(l),l=hr(B,t),C(c)}return l===s&&(l=hr(B,t)),a}return Ge.cancel=ke,Ge.flush=Te,Ge}var td=F(function(e,t){return Ao(e,1,t)}),nd=F(function(e,t,n){return Ao(e,Qe(t)||0,n)});function rd(e){return Tt(e,wn)}function ii(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new Ke(he);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(ii.Cache||At),n}ii.Cache=At;function ui(e){if(typeof e!="function")throw new Ke(he);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function id(e){return Ms(2,e)}var ud=Hf(function(e,t){t=t.length==1&&O(t[0])?ee(t[0],ze(A())):ee(_e(t,1),ze(A()));var n=t.length;return F(function(r){for(var i=-1,o=be(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return De(e,this,r)})}),du=F(function(e,t){var n=Gt(t,$n(du));return Tt(e,Ie,s,t,n)}),Us=F(function(e,t){var n=Gt(t,$n(Us));return Tt(e,yt,s,t,n)}),od=Rt(function(e,t){return Tt(e,Ft,s,s,s,t)});function sd(e,t){if(typeof e!="function")throw new Ke(he);return t=t===s?t:M(t),F(e,t)}function ad(e,t){if(typeof e!="function")throw new Ke(he);return t=t==null?0:le(M(t),0),F(function(n){var r=n[t],i=Zt(n,0,t);return r&&kt(i,r),De(e,this,i)})}function ld(e,t,n){var r=!0,i=!0;if(typeof e!="function")throw new Ke(he);return te(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Bs(e,t,{leading:r,maxWait:t,trailing:i})}function fd(e){return Os(e,1)}function cd(e,t){return du(Qi(t),e)}function hd(){if(!arguments.length)return[];var e=arguments[0];return O(e)?e:[e]}function dd(e){return Ze(e,je)}function pd(e,t){return t=typeof t=="function"?t:s,Ze(e,je,t)}function gd(e){return Ze(e,xe|je)}function _d(e,t){return t=typeof t=="function"?t:s,Ze(e,xe|je,t)}function vd(e,t){return t==null||So(e,t,fe(t))}function rt(e,t){return e===t||e!==e&&t!==t}var md=Qr(zi),xd=Qr(function(e,t){return e>=t}),vn=Lo((function(){return arguments})())?Lo:function(e){return re(e)&&H.call(e,"callee")&&!_o.call(e,"callee")},O=h.isArray,wd=Xu?ze(Xu):Rf;function Pe(e){return e!=null&&oi(e.length)&&!Lt(e)}function ie(e){return re(e)&&Pe(e)}function yd(e){return e===!0||e===!1||re(e)&&Ae(e)==nn}var Jt=Fl||Su,bd=Qu?ze(Qu):If;function Cd(e){return re(e)&&e.nodeType===1&&!dr(e)}function Sd(e){if(e==null)return!0;if(Pe(e)&&(O(e)||typeof e=="string"||typeof e.splice=="function"||Jt(e)||kn(e)||vn(e)))return!e.length;var t=Ce(e);if(t==Ue||t==Oe)return!e.size;if(cr(e))return!ki(e).length;for(var n in e)if(H.call(e,n))return!1;return!0}function Ad(e,t){return ar(e,t)}function Ed(e,t,n){n=typeof n=="function"?n:s;var r=n?n(e,t):s;return r===s?ar(e,t,s,n):!!r}function pu(e){if(!re(e))return!1;var t=Ae(e);return t==Cn||t==_r||typeof e.message=="string"&&typeof e.name=="string"&&!dr(e)}function Td(e){return typeof e=="number"&&mo(e)}function Lt(e){if(!te(e))return!1;var t=Ae(e);return t==Sn||t==Kn||t==tn||t==vr}function Ds(e){return typeof e=="number"&&e==M(e)}function oi(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=K}function te(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function re(e){return e!=null&&typeof e=="object"}var zs=Vu?ze(Vu):Of;function Rd(e,t){return e===t||$i(e,t,iu(t))}function Id(e,t,n){return n=typeof n=="function"?n:s,$i(e,t,iu(t),n)}function Ld(e){return Ns(e)&&e!=+e}function Od(e){if(pc(e))throw new L(xn);return Oo(e)}function Md(e){return e===null}function Pd(e){return e==null}function Ns(e){return typeof e=="number"||re(e)&&Ae(e)==un}function dr(e){if(!re(e)||Ae(e)!=et)return!1;var t=Pr(e);if(t===null)return!0;var n=H.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&Ir.call(n)==Rl}var gu=ju?ze(ju):Mf;function Fd(e){return Ds(e)&&e>=-K&&e<=K}var $s=eo?ze(eo):Pf;function si(e){return typeof e=="string"||!O(e)&&re(e)&&Ae(e)==Dt}function $e(e){return typeof e=="symbol"||re(e)&&Ae(e)==An}var kn=to?ze(to):Ff;function Wd(e){return e===s}function Bd(e){return re(e)&&Ce(e)==zt}function Ud(e){return re(e)&&Ae(e)==hi}var Dd=Qr(Gi),zd=Qr(function(e,t){return e<=t});function ks(e){if(!e)return[];if(Pe(e))return si(e)?tt(e):Me(e);if(er&&e[er])return _l(e[er]());var t=Ce(e),n=t==Ue?Li:t==Oe?Er:Gn;return n(e)}function Ot(e){if(!e)return e===0?e:0;if(e=Qe(e),e===q||e===-q){var t=e<0?-1:1;return t*j}return e===e?e:0}function M(e){var t=Ot(e),n=t%1;return t===t?n?t-n:t:0}function Gs(e){return e?dn(M(e),0,X):0}function Qe(e){if(typeof e=="number")return e;if($e(e))return z;if(te(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=te(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=so(e);var n=xa.test(e);return n||ya.test(e)?ja(e.slice(2),n?2:8):ma.test(e)?z:+e}function qs(e){return gt(e,Fe(e))}function Nd(e){return e?dn(M(e),-K,K):e===0?e:0}function k(e){return e==null?"":Ne(e)}var $d=zn(function(e,t){if(cr(t)||Pe(t)){gt(t,fe(t),e);return}for(var n in t)H.call(t,n)&&ur(e,n,t[n])}),Hs=zn(function(e,t){gt(t,Fe(t),e)}),ai=zn(function(e,t,n,r){gt(t,Fe(t),e,r)}),kd=zn(function(e,t,n,r){gt(t,fe(t),e,r)}),Gd=Rt(Bi);function qd(e,t){var n=Dn(e);return t==null?n:Co(n,t)}var Hd=F(function(e,t){e=Y(e);var n=-1,r=t.length,i=r>2?t[2]:s;for(i&&Ee(t[0],t[1],i)&&(r=1);++n<r;)for(var o=t[n],a=Fe(o),l=-1,c=a.length;++l<c;){var _=a[l],v=e[_];(v===s||rt(v,Wn[_])&&!H.call(e,_))&&(e[_]=o[_])}return e}),Kd=F(function(e){return e.push(s,as),De(Ks,s,e)});function Yd(e,t){return ro(e,A(t,3),pt)}function Zd(e,t){return ro(e,A(t,3),Di)}function Jd(e,t){return e==null?e:Ui(e,A(t,3),Fe)}function Xd(e,t){return e==null?e:Ro(e,A(t,3),Fe)}function Qd(e,t){return e&&pt(e,A(t,3))}function Vd(e,t){return e&&Di(e,A(t,3))}function jd(e){return e==null?[]:Gr(e,fe(e))}function ep(e){return e==null?[]:Gr(e,Fe(e))}function _u(e,t,n){var r=e==null?s:pn(e,t);return r===s?n:r}function tp(e,t){return e!=null&&cs(e,t,Sf)}function vu(e,t){return e!=null&&cs(e,t,Af)}var np=rs(function(e,t,n){t!=null&&typeof t.toString!="function"&&(t=Lr.call(t)),e[t]=n},xu(We)),rp=rs(function(e,t,n){t!=null&&typeof t.toString!="function"&&(t=Lr.call(t)),H.call(e,t)?e[t].push(n):e[t]=[n]},A),ip=F(sr);function fe(e){return Pe(e)?yo(e):ki(e)}function Fe(e){return Pe(e)?yo(e,!0):Wf(e)}function up(e,t){var n={};return t=A(t,3),pt(e,function(r,i,o){Et(n,t(r,i,o),r)}),n}function op(e,t){var n={};return t=A(t,3),pt(e,function(r,i,o){Et(n,i,t(r,i,o))}),n}var sp=zn(function(e,t,n){qr(e,t,n)}),Ks=zn(function(e,t,n,r){qr(e,t,n,r)}),ap=Rt(function(e,t){var n={};if(e==null)return n;var r=!1;t=ee(t,function(o){return o=Yt(o,e),r||(r=o.length>1),o}),gt(e,nu(e),n),r&&(n=Ze(n,xe|we|je,nc));for(var i=t.length;i--;)Zi(n,t[i]);return n});function lp(e,t){return Ys(e,ui(A(t)))}var fp=Rt(function(e,t){return e==null?{}:Uf(e,t)});function Ys(e,t){if(e==null)return{};var n=ee(nu(e),function(r){return[r]});return t=A(t),Do(e,n,function(r,i){return t(r,i[0])})}function cp(e,t,n){t=Yt(t,e);var r=-1,i=t.length;for(i||(i=1,e=s);++r<i;){var o=e==null?s:e[_t(t[r])];o===s&&(r=i,o=n),e=Lt(o)?o.call(e):o}return e}function hp(e,t,n){return e==null?e:lr(e,t,n)}function dp(e,t,n,r){return r=typeof r=="function"?r:s,e==null?e:lr(e,t,n,r)}var Zs=os(fe),Js=os(Fe);function pp(e,t,n){var r=O(e),i=r||Jt(e)||kn(e);if(t=A(t,4),n==null){var o=e&&e.constructor;i?n=r?new o:[]:te(e)?n=Lt(o)?Dn(Pr(e)):{}:n={}}return(i?He:pt)(e,function(a,l,c){return t(n,a,l,c)}),n}function gp(e,t){return e==null?!0:Zi(e,t)}function _p(e,t,n){return e==null?e:Go(e,t,Qi(n))}function vp(e,t,n,r){return r=typeof r=="function"?r:s,e==null?e:Go(e,t,Qi(n),r)}function Gn(e){return e==null?[]:Ii(e,fe(e))}function mp(e){return e==null?[]:Ii(e,Fe(e))}function xp(e,t,n){return n===s&&(n=t,t=s),n!==s&&(n=Qe(n),n=n===n?n:0),t!==s&&(t=Qe(t),t=t===t?t:0),dn(Qe(e),t,n)}function wp(e,t,n){return t=Ot(t),n===s?(n=t,t=0):n=Ot(n),e=Qe(e),Ef(e,t,n)}function yp(e,t,n){if(n&&typeof n!="boolean"&&Ee(e,t,n)&&(t=n=s),n===s&&(typeof t=="boolean"?(n=t,t=s):typeof e=="boolean"&&(n=e,e=s)),e===s&&t===s?(e=0,t=1):(e=Ot(e),t===s?(t=e,e=0):t=Ot(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var i=xo();return be(e+i*(t-e+Va("1e-"+((i+"").length-1))),t)}return Hi(e,t)}var bp=Nn(function(e,t,n){return t=t.toLowerCase(),e+(n?Xs(t):t)});function Xs(e){return mu(k(e).toLowerCase())}function Qs(e){return e=k(e),e&&e.replace(Ca,cl).replace(ka,"")}function Cp(e,t,n){e=k(e),t=Ne(t);var r=e.length;n=n===s?r:dn(M(n),0,r);var i=n;return n-=t.length,n>=0&&e.slice(n,i)==t}function Sp(e){return e=k(e),e&&wr.test(e)?e.replace(In,hl):e}function Ap(e){return e=k(e),e&&la.test(e)?e.replace(Vn,"\\$&"):e}var Ep=Nn(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),Tp=Nn(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),Rp=es("toLowerCase");function Ip(e,t,n){e=k(e),t=M(t);var r=t?Pn(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Xr(Ur(i),n)+e+Xr(Br(i),n)}function Lp(e,t,n){e=k(e),t=M(t);var r=t?Pn(e):0;return t&&r<t?e+Xr(t-r,n):e}function Op(e,t,n){e=k(e),t=M(t);var r=t?Pn(e):0;return t&&r<t?Xr(t-r,n)+e:e}function Mp(e,t,n){return n||t==null?t=0:t&&(t=+t),Dl(k(e).replace(pi,""),t||0)}function Pp(e,t,n){return(n?Ee(e,t,n):t===s)?t=1:t=M(t),Ki(k(e),t)}function Fp(){var e=arguments,t=k(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var Wp=Nn(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()});function Bp(e,t,n){return n&&typeof n!="number"&&Ee(e,t,n)&&(t=n=s),n=n===s?X:n>>>0,n?(e=k(e),e&&(typeof t=="string"||t!=null&&!gu(t))&&(t=Ne(t),!t&&Mn(e))?Zt(tt(e),0,n):e.split(t,n)):[]}var Up=Nn(function(e,t,n){return e+(n?" ":"")+mu(t)});function Dp(e,t,n){return e=k(e),n=n==null?0:dn(M(n),0,e.length),t=Ne(t),e.slice(n,n+t.length)==t}function zp(e,t,n){var r=u.templateSettings;n&&Ee(e,t,n)&&(t=s),e=k(e),t=ai({},t,r,ss);var i=ai({},t.imports,r.imports,ss),o=fe(i),a=Ii(i,o),l,c,_=0,v=t.interpolate||yr,x="__p += '",w=Oi((t.escape||yr).source+"|"+v.source+"|"+(v===sn?va:yr).source+"|"+(t.evaluate||yr).source+"|$","g"),C="//# sourceURL="+(H.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ya+"]")+`
`;e.replace(w,function(T,B,D,ke,Te,Ge){return D||(D=ke),x+=e.slice(_,Ge).replace(Sa,dl),B&&(l=!0,x+=`' +
__e(`+B+`) +
'`),Te&&(c=!0,x+=`';
`+Te+`;
__p += '`),D&&(x+=`' +
((__t = (`+D+`)) == null ? '' : __t) +
'`),_=Ge+T.length,T}),x+=`';
`;var E=H.call(t,"variable")&&t.variable;if(!E)x=`with (obj) {
`+x+`
}
`;else if(ga.test(E))throw new L(Vt);x=(c?x.replace(Rn,""):x).replace(Jn,"$1").replace(xr,"$1;"),x="function("+(E||"obj")+`) {
`+(E?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(l?", __e = _.escape":"")+(c?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+x+`return __p
}`;var P=js(function(){return $(o,C+"return "+x).apply(s,a)});if(P.source=x,pu(P))throw P;return P}function Np(e){return k(e).toLowerCase()}function $p(e){return k(e).toUpperCase()}function kp(e,t,n){if(e=k(e),e&&(n||t===s))return so(e);if(!e||!(t=Ne(t)))return e;var r=tt(e),i=tt(t),o=ao(r,i),a=lo(r,i)+1;return Zt(r,o,a).join("")}function Gp(e,t,n){if(e=k(e),e&&(n||t===s))return e.slice(0,co(e)+1);if(!e||!(t=Ne(t)))return e;var r=tt(e),i=lo(r,tt(t))+1;return Zt(r,0,i).join("")}function qp(e,t,n){if(e=k(e),e&&(n||t===s))return e.replace(pi,"");if(!e||!(t=Ne(t)))return e;var r=tt(e),i=ao(r,tt(t));return Zt(r,i).join("")}function Hp(e,t){var n=W,r=N;if(te(t)){var i="separator"in t?t.separator:i;n="length"in t?M(t.length):n,r="omission"in t?Ne(t.omission):r}e=k(e);var o=e.length;if(Mn(e)){var a=tt(e);o=a.length}if(n>=o)return e;var l=n-Pn(r);if(l<1)return r;var c=a?Zt(a,0,l).join(""):e.slice(0,l);if(i===s)return c+r;if(a&&(l+=c.length-l),gu(i)){if(e.slice(l).search(i)){var _,v=c;for(i.global||(i=Oi(i.source,k(Iu.exec(i))+"g")),i.lastIndex=0;_=i.exec(v);)var x=_.index;c=c.slice(0,x===s?l:x)}}else if(e.indexOf(Ne(i),l)!=l){var w=c.lastIndexOf(i);w>-1&&(c=c.slice(0,w))}return c+r}function Kp(e){return e=k(e),e&&Ru.test(e)?e.replace(Xn,wl):e}var Yp=Nn(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),mu=es("toUpperCase");function Vs(e,t,n){return e=k(e),t=n?s:t,t===s?gl(e)?Cl(e):ol(e):e.match(t)||[]}var js=F(function(e,t){try{return De(e,s,t)}catch(n){return pu(n)?n:new L(n)}}),Zp=Rt(function(e,t){return He(t,function(n){n=_t(n),Et(e,n,hu(e[n],e))}),e});function Jp(e){var t=e==null?0:e.length,n=A();return e=t?ee(e,function(r){if(typeof r[1]!="function")throw new Ke(he);return[n(r[0]),r[1]]}):[],F(function(r){for(var i=-1;++i<t;){var o=e[i];if(De(o[0],this,r))return De(o[1],this,r)}})}function Xp(e){return yf(Ze(e,xe))}function xu(e){return function(){return e}}function Qp(e,t){return e==null||e!==e?t:e}var Vp=ns(),jp=ns(!0);function We(e){return e}function wu(e){return Mo(typeof e=="function"?e:Ze(e,xe))}function eg(e){return Fo(Ze(e,xe))}function tg(e,t){return Wo(e,Ze(t,xe))}var ng=F(function(e,t){return function(n){return sr(n,e,t)}}),rg=F(function(e,t){return function(n){return sr(e,n,t)}});function yu(e,t,n){var r=fe(t),i=Gr(t,r);n==null&&!(te(t)&&(i.length||!r.length))&&(n=t,t=e,e=this,i=Gr(t,fe(t)));var o=!(te(n)&&"chain"in n)||!!n.chain,a=Lt(e);return He(i,function(l){var c=t[l];e[l]=c,a&&(e.prototype[l]=function(){var _=this.__chain__;if(o||_){var v=e(this.__wrapped__),x=v.__actions__=Me(this.__actions__);return x.push({func:c,args:arguments,thisArg:e}),v.__chain__=_,v}return c.apply(e,kt([this.value()],arguments))})}),e}function ig(){return ge._===this&&(ge._=Il),this}function bu(){}function ug(e){return e=M(e),F(function(t){return Bo(t,e)})}var og=ji(ee),sg=ji(no),ag=ji(Si);function ea(e){return ou(e)?Ai(_t(e)):Df(e)}function lg(e){return function(t){return e==null?s:pn(e,t)}}var fg=is(),cg=is(!0);function Cu(){return[]}function Su(){return!1}function hg(){return{}}function dg(){return""}function pg(){return!0}function gg(e,t){if(e=M(e),e<1||e>K)return[];var n=X,r=be(e,X);t=A(t),e-=X;for(var i=Ri(r,t);++n<e;)t(n);return i}function _g(e){return O(e)?ee(e,_t):$e(e)?[e]:Me(ws(k(e)))}function vg(e){var t=++Tl;return k(e)+t}var mg=Jr(function(e,t){return e+t},0),xg=eu("ceil"),wg=Jr(function(e,t){return e/t},1),yg=eu("floor");function bg(e){return e&&e.length?kr(e,We,zi):s}function Cg(e,t){return e&&e.length?kr(e,A(t,2),zi):s}function Sg(e){return uo(e,We)}function Ag(e,t){return uo(e,A(t,2))}function Eg(e){return e&&e.length?kr(e,We,Gi):s}function Tg(e,t){return e&&e.length?kr(e,A(t,2),Gi):s}var Rg=Jr(function(e,t){return e*t},1),Ig=eu("round"),Lg=Jr(function(e,t){return e-t},0);function Og(e){return e&&e.length?Ti(e,We):0}function Mg(e,t){return e&&e.length?Ti(e,A(t,2)):0}return u.after=ed,u.ary=Os,u.assign=$d,u.assignIn=Hs,u.assignInWith=ai,u.assignWith=kd,u.at=Gd,u.before=Ms,u.bind=hu,u.bindAll=Zp,u.bindKey=Ps,u.castArray=hd,u.chain=Rs,u.chunk=yc,u.compact=bc,u.concat=Cc,u.cond=Jp,u.conforms=Xp,u.constant=xu,u.countBy=Oh,u.create=qd,u.curry=Fs,u.curryRight=Ws,u.debounce=Bs,u.defaults=Hd,u.defaultsDeep=Kd,u.defer=td,u.delay=nd,u.difference=Sc,u.differenceBy=Ac,u.differenceWith=Ec,u.drop=Tc,u.dropRight=Rc,u.dropRightWhile=Ic,u.dropWhile=Lc,u.fill=Oc,u.filter=Ph,u.flatMap=Bh,u.flatMapDeep=Uh,u.flatMapDepth=Dh,u.flatten=Ss,u.flattenDeep=Mc,u.flattenDepth=Pc,u.flip=rd,u.flow=Vp,u.flowRight=jp,u.fromPairs=Fc,u.functions=jd,u.functionsIn=ep,u.groupBy=zh,u.initial=Bc,u.intersection=Uc,u.intersectionBy=Dc,u.intersectionWith=zc,u.invert=np,u.invertBy=rp,u.invokeMap=$h,u.iteratee=wu,u.keyBy=kh,u.keys=fe,u.keysIn=Fe,u.map=ni,u.mapKeys=up,u.mapValues=op,u.matches=eg,u.matchesProperty=tg,u.memoize=ii,u.merge=sp,u.mergeWith=Ks,u.method=ng,u.methodOf=rg,u.mixin=yu,u.negate=ui,u.nthArg=ug,u.omit=ap,u.omitBy=lp,u.once=id,u.orderBy=Gh,u.over=og,u.overArgs=ud,u.overEvery=sg,u.overSome=ag,u.partial=du,u.partialRight=Us,u.partition=qh,u.pick=fp,u.pickBy=Ys,u.property=ea,u.propertyOf=lg,u.pull=Gc,u.pullAll=Es,u.pullAllBy=qc,u.pullAllWith=Hc,u.pullAt=Kc,u.range=fg,u.rangeRight=cg,u.rearg=od,u.reject=Yh,u.remove=Yc,u.rest=sd,u.reverse=fu,u.sampleSize=Jh,u.set=hp,u.setWith=dp,u.shuffle=Xh,u.slice=Zc,u.sortBy=jh,u.sortedUniq=th,u.sortedUniqBy=nh,u.split=Bp,u.spread=ad,u.tail=rh,u.take=ih,u.takeRight=uh,u.takeRightWhile=oh,u.takeWhile=sh,u.tap=bh,u.throttle=ld,u.thru=ti,u.toArray=ks,u.toPairs=Zs,u.toPairsIn=Js,u.toPath=_g,u.toPlainObject=qs,u.transform=pp,u.unary=fd,u.union=ah,u.unionBy=lh,u.unionWith=fh,u.uniq=ch,u.uniqBy=hh,u.uniqWith=dh,u.unset=gp,u.unzip=cu,u.unzipWith=Ts,u.update=_p,u.updateWith=vp,u.values=Gn,u.valuesIn=mp,u.without=ph,u.words=Vs,u.wrap=cd,u.xor=gh,u.xorBy=_h,u.xorWith=vh,u.zip=mh,u.zipObject=xh,u.zipObjectDeep=wh,u.zipWith=yh,u.entries=Zs,u.entriesIn=Js,u.extend=Hs,u.extendWith=ai,yu(u,u),u.add=mg,u.attempt=js,u.camelCase=bp,u.capitalize=Xs,u.ceil=xg,u.clamp=xp,u.clone=dd,u.cloneDeep=gd,u.cloneDeepWith=_d,u.cloneWith=pd,u.conformsTo=vd,u.deburr=Qs,u.defaultTo=Qp,u.divide=wg,u.endsWith=Cp,u.eq=rt,u.escape=Sp,u.escapeRegExp=Ap,u.every=Mh,u.find=Fh,u.findIndex=bs,u.findKey=Yd,u.findLast=Wh,u.findLastIndex=Cs,u.findLastKey=Zd,u.floor=yg,u.forEach=Is,u.forEachRight=Ls,u.forIn=Jd,u.forInRight=Xd,u.forOwn=Qd,u.forOwnRight=Vd,u.get=_u,u.gt=md,u.gte=xd,u.has=tp,u.hasIn=vu,u.head=As,u.identity=We,u.includes=Nh,u.indexOf=Wc,u.inRange=wp,u.invoke=ip,u.isArguments=vn,u.isArray=O,u.isArrayBuffer=wd,u.isArrayLike=Pe,u.isArrayLikeObject=ie,u.isBoolean=yd,u.isBuffer=Jt,u.isDate=bd,u.isElement=Cd,u.isEmpty=Sd,u.isEqual=Ad,u.isEqualWith=Ed,u.isError=pu,u.isFinite=Td,u.isFunction=Lt,u.isInteger=Ds,u.isLength=oi,u.isMap=zs,u.isMatch=Rd,u.isMatchWith=Id,u.isNaN=Ld,u.isNative=Od,u.isNil=Pd,u.isNull=Md,u.isNumber=Ns,u.isObject=te,u.isObjectLike=re,u.isPlainObject=dr,u.isRegExp=gu,u.isSafeInteger=Fd,u.isSet=$s,u.isString=si,u.isSymbol=$e,u.isTypedArray=kn,u.isUndefined=Wd,u.isWeakMap=Bd,u.isWeakSet=Ud,u.join=Nc,u.kebabCase=Ep,u.last=Xe,u.lastIndexOf=$c,u.lowerCase=Tp,u.lowerFirst=Rp,u.lt=Dd,u.lte=zd,u.max=bg,u.maxBy=Cg,u.mean=Sg,u.meanBy=Ag,u.min=Eg,u.minBy=Tg,u.stubArray=Cu,u.stubFalse=Su,u.stubObject=hg,u.stubString=dg,u.stubTrue=pg,u.multiply=Rg,u.nth=kc,u.noConflict=ig,u.noop=bu,u.now=ri,u.pad=Ip,u.padEnd=Lp,u.padStart=Op,u.parseInt=Mp,u.random=yp,u.reduce=Hh,u.reduceRight=Kh,u.repeat=Pp,u.replace=Fp,u.result=cp,u.round=Ig,u.runInContext=f,u.sample=Zh,u.size=Qh,u.snakeCase=Wp,u.some=Vh,u.sortedIndex=Jc,u.sortedIndexBy=Xc,u.sortedIndexOf=Qc,u.sortedLastIndex=Vc,u.sortedLastIndexBy=jc,u.sortedLastIndexOf=eh,u.startCase=Up,u.startsWith=Dp,u.subtract=Lg,u.sum=Og,u.sumBy=Mg,u.template=zp,u.times=gg,u.toFinite=Ot,u.toInteger=M,u.toLength=Gs,u.toLower=Np,u.toNumber=Qe,u.toSafeInteger=Nd,u.toString=k,u.toUpper=$p,u.trim=kp,u.trimEnd=Gp,u.trimStart=qp,u.truncate=Hp,u.unescape=Kp,u.uniqueId=vg,u.upperCase=Yp,u.upperFirst=mu,u.each=Is,u.eachRight=Ls,u.first=As,yu(u,(function(){var e={};return pt(u,function(t,n){H.call(u.prototype,n)||(e[n]=t)}),e})(),{chain:!1}),u.VERSION=ce,He(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){u[e].placeholder=u}),He(["drop","take"],function(e,t){U.prototype[e]=function(n){n=n===s?1:le(M(n),0);var r=this.__filtered__&&!t?new U(this):this.clone();return r.__filtered__?r.__takeCount__=be(n,r.__takeCount__):r.__views__.push({size:be(n,X),type:e+(r.__dir__<0?"Right":"")}),r},U.prototype[e+"Right"]=function(n){return this.reverse()[e](n).reverse()}}),He(["filter","map","takeWhile"],function(e,t){var n=t+1,r=n==ct||n==yn;U.prototype[e]=function(i){var o=this.clone();return o.__iteratees__.push({iteratee:A(i,3),type:n}),o.__filtered__=o.__filtered__||r,o}}),He(["head","last"],function(e,t){var n="take"+(t?"Right":"");U.prototype[e]=function(){return this[n](1).value()[0]}}),He(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");U.prototype[e]=function(){return this.__filtered__?new U(this):this[n](1)}}),U.prototype.compact=function(){return this.filter(We)},U.prototype.find=function(e){return this.filter(e).head()},U.prototype.findLast=function(e){return this.reverse().find(e)},U.prototype.invokeMap=F(function(e,t){return typeof e=="function"?new U(this):this.map(function(n){return sr(n,e,t)})}),U.prototype.reject=function(e){return this.filter(ui(A(e)))},U.prototype.slice=function(e,t){e=M(e);var n=this;return n.__filtered__&&(e>0||t<0)?new U(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==s&&(t=M(t),n=t<0?n.dropRight(-t):n.take(t-e)),n)},U.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},U.prototype.toArray=function(){return this.take(X)},pt(U.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=u[r?"take"+(t=="last"?"Right":""):t],o=r||/^find/.test(t);i&&(u.prototype[t]=function(){var a=this.__wrapped__,l=r?[1]:arguments,c=a instanceof U,_=l[0],v=c||O(a),x=function(B){var D=i.apply(u,kt([B],l));return r&&w?D[0]:D};v&&n&&typeof _=="function"&&_.length!=1&&(c=v=!1);var w=this.__chain__,C=!!this.__actions__.length,E=o&&!w,P=c&&!C;if(!o&&v){a=P?a:new U(this);var T=e.apply(a,l);return T.__actions__.push({func:ti,args:[x],thisArg:s}),new Ye(T,w)}return E&&P?e.apply(this,l):(T=this.thru(x),E?r?T.value()[0]:T.value():T)})}),He(["pop","push","shift","sort","splice","unshift"],function(e){var t=Tr[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);u.prototype[e]=function(){var i=arguments;if(r&&!this.__chain__){var o=this.value();return t.apply(O(o)?o:[],i)}return this[n](function(a){return t.apply(O(a)?a:[],i)})}}),pt(U.prototype,function(e,t){var n=u[t];if(n){var r=n.name+"";H.call(Un,r)||(Un[r]=[]),Un[r].push({name:t,func:n})}}),Un[Zr(s,Z).name]=[{name:"wrapper",func:s}],U.prototype.clone=Hl,U.prototype.reverse=Kl,U.prototype.value=Yl,u.prototype.at=Ch,u.prototype.chain=Sh,u.prototype.commit=Ah,u.prototype.next=Eh,u.prototype.plant=Rh,u.prototype.reverse=Ih,u.prototype.toJSON=u.prototype.valueOf=u.prototype.value=Lh,u.prototype.first=u.prototype.head,er&&(u.prototype[er]=Th),u}),Fn=Sl();ln?((ln.exports=Fn)._=Fn,wi._=Fn):ge._=Fn}).call(p_)})(gr,gr.exports)),gr.exports}var aa=g_();function __(ot,I,s){const ce=V(null),st=V(!1),xn=V(0),he=V(""),Vt=V([]),Ve=V(new Set),jt=`progressive-guidance-charged-${ot}-${I}`,G=`progressive-guidance-${ot}-${I}`,xe=()=>{try{const W=localStorage.getItem(G);if(!W)return[];const N=JSON.parse(W);return Array.isArray(N)?N.filter(Se=>typeof Se=="string"&&Se.length>0):[]}catch{return[]}},we=W=>{try{localStorage.setItem(G,JSON.stringify(Array.from(new Set(W))))}catch{}},je=()=>{try{localStorage.removeItem(G)}catch{}},at=async()=>{const W=xe();try{await fetch(xt("projects.manual-editor.progressive-guidance.steps",{project:ot,chapter:I}),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.content||""},body:JSON.stringify({completed_step_ids:W})})}catch(N){console.error("Failed to persist completed steps:",N)}},lt=aa.debounce(at,400),de=W=>{try{const Se=new DOMParser().parseFromString(W||"","text/html");return Array.from(Se.querySelectorAll("h1,h2,h3,h4,h5,h6")).map(Wt=>(Wt.textContent||"").trim()).filter(Boolean).slice(0,20)}catch{return[]}},Z=W=>{try{const Be=(new DOMParser().parseFromString(W||"","text/html").body?.textContent||"").replace(/\s+/g," ").trim();return Be.length<=2e3?Be:Be.slice(-2e3)}catch{return(W||"").slice(-2e3)}};if(s){ce.value=s;const W=Array.isArray(s.completed_step_ids)&&s.completed_step_ids.length?s.completed_step_ids:(s.next_steps||[]).filter(N=>N.completed).map(N=>N.id);W.length&&(Vt.value=W,we(W))}const wt=async(W,N)=>{if(W.word_count===void 0||W.word_count<0)return;const Se=Date.now();if(!(Se-xn.value<3e3)){st.value=!0,xn.value=Se;try{const Be=xe(),ct=de(N),Wt=Z(N),yn=await fetch(xt("projects.manual-editor.progressive-guidance",{project:ot,chapter:I}),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.content||""},body:JSON.stringify({analysis:{...W,outline:ct,content_excerpt:Wt,completed_step_ids:Be}})});if(yn.ok){const q=await yn.json();ce.value=q,Array.isArray(q?.completed_step_ids)&&(Vt.value=q.completed_step_ids,we(Vt.value)),yt();const K=Number(q?.guidance_id);if(K){if(Ve.value.size===0)try{const j=localStorage.getItem(jt);if(j){const z=JSON.parse(j);Array.isArray(z)&&z.filter(X=>typeof X=="number"&&Number.isFinite(X)).forEach(X=>Ve.value.add(X))}}catch{}if(!Ve.value.has(K)){const j=Qt(q?.contextual_tip||"")+Qt(q?.stage_label||"")+Qt((q?.next_steps||[]).map(z=>z?.text).join(" "))+Qt((q?.writing_milestones||[]).map(z=>z?.label).join(" "));if(j>0){Ve.value.add(K);try{localStorage.setItem(jt,JSON.stringify(Array.from(Ve.value).slice(-50)))}catch{}Tu(j,"Manual editor: Progressive guidance","chapter").catch(z=>console.error("Failed to record word usage (progressive guidance):",z))}}}else{const j=JSON.stringify({stage:q?.stage,completion:q?.completion_percentage,tip:q?.contextual_tip,steps:(q?.next_steps||[]).map(z=>({t:z?.text,a:z?.action}))});if(j&&j!==he.value){he.value=j;const z=Qt(q?.contextual_tip||"")+Qt(q?.stage_label||"")+Qt((q?.next_steps||[]).map(X=>X?.text).join(" "))+Qt((q?.writing_milestones||[]).map(X=>X?.label).join(" "));z>0&&Tu(z,"Manual editor: Progressive guidance","chapter").catch(X=>console.error("Failed to record word usage (progressive guidance):",X))}}}}catch(Be){console.error("Failed to load progressive guidance:",Be)}finally{st.value=!1}}},Re=aa.debounce(wt,5e3),ft=W=>{if(!ce.value)return;const N=ce.value.next_steps.find(Se=>Se.id===W);N&&(N.completed=!N.completed,Ie(),lt())},Ie=()=>{if(!ce.value)return;const W=ce.value.next_steps.filter(N=>N.completed).map(N=>N.id);we(W)},yt=()=>{if(!ce.value)return;const W=xe();W.length&&ce.value.next_steps.forEach(N=>{W.includes(N.id)&&(N.completed=!0)})};return{guidance:ce,isLoadingGuidance:st,requestGuidance:wt,debouncedRequestGuidance:Re,toggleStep:ft,clearCompletedSteps:()=>{ce.value&&(ce.value.next_steps.forEach(W=>{W.completed=!1}),je(),lt())},getCompletionPercentage:()=>ce.value?.completion_percentage||0,getCurrentStageLabel:()=>ce.value?.stage_label||"Getting Started"}}const v_={class:"manual-editor h-screen flex flex-col bg-background dark:bg-background transition-colors duration-300"},m_={class:"md:hidden border-b h-14 px-3 flex justify-between items-center bg-background/80 backdrop-blur-md sticky top-0 z-50 transition-all duration-200"},x_={class:"flex items-center gap-2"},w_={class:"flex flex-col justify-center min-w-0 flex-1 mx-2"},y_={class:"items-center gap-2 text-xs font-medium text-muted-foreground mb-1 hidden sm:flex"},b_={class:"flex items-center gap-2 -ml-1"},C_={class:"font-bold text-base text-foreground truncate"},S_={class:"truncate"},A_={class:"flex gap-2 items-center"},E_={class:"hidden md:flex flex-col w-full z-50 sticky top-0 bg-background/80 backdrop-blur-md transition-all duration-200 border-b"},T_={class:"h-10 border-b border-border/40 flex items-center justify-center px-4 bg-background/60 relative"},R_={class:"flex items-center gap-2"},I_={class:"flex items-center gap-1 absolute right-4"},L_={class:"h-12 flex items-center justify-between px-4 bg-background/40"},O_={class:"flex items-center gap-3"},M_={class:"flex items-center gap-1"},P_={class:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-muted/30 border border-border/40"},F_={class:"flex items-center gap-1.5"},W_={class:"text-xs font-medium text-muted-foreground"},B_={key:0,class:"flex items-center gap-1.5"},U_={key:1,class:"text-xs text-muted-foreground"},D_={class:"flex items-center gap-3"},z_={class:"flex items-center gap-1 bg-muted/30 p-1 rounded-full border border-border/40"},N_={class:"text-xs font-medium"},$_={class:"w-full bg-background border-b px-3 md:px-6 py-2 flex flex-col gap-1"},k_={class:"flex justify-between items-center text-xs text-muted-foreground mb-1"},G_={class:"flex-1 flex overflow-hidden"},q_={key:0,class:"w-[320px] border-r bg-background/80 backdrop-blur-xl border-border/50 shadow-xl z-20 overflow-y-auto custom-scrollbar"},H_={class:"p-4"},K_={class:"mb-3"},Y_={class:"text-xs text-muted-foreground"},Z_={class:"flex-1 overflow-auto p-2 md:p-6 bg-background"},J_={key:0,class:"w-1/2 flex flex-col bg-background overflow-hidden"},X_={class:"flex-1 overflow-y-auto custom-scrollbar"},Q_={key:0,class:"w-[400px] border-l bg-background/80 backdrop-blur-xl border-border/50 shadow-2xl z-20 overflow-y-auto custom-scrollbar flex flex-col"},V_={class:"p-4 space-y-6"},j_={key:0,class:"space-y-2"},ev={key:1,class:"space-y-2"},tv={class:"flex items-center justify-between"},nv={class:"text-xs whitespace-pre-wrap rounded-lg border border-border/50 bg-muted/30 p-3"},rv={class:"space-y-2"},iv={class:"border-t p-2 md:p-3 flex flex-col gap-3 text-xs md:text-sm bg-muted/30"},uv={class:"flex flex-col sm:flex-row justify-between gap-3 sm:gap-2 items-start sm:items-center w-full"},ov={class:"flex gap-2 md:gap-4 flex-wrap items-center"},sv={class:"text-muted-foreground"},av={class:"text-foreground"},lv={key:0,class:"text-muted-foreground hidden sm:inline"},fv={class:"text-foreground"},cv={key:1,class:"text-muted-foreground hidden md:inline"},hv={class:"text-foreground"},dv={key:2,class:"text-muted-foreground hidden lg:inline"},pv={class:"flex gap-2 items-center w-full sm:w-auto"},gv={class:"text-xs font-medium"},_v=Pg({__name:"ManualEditor",props:{project:{},chapter:{},allChapters:{},facultyChapters:{},currentSuggestion:{},contextAnalysis:{},initialProgressGuidance:{},chatHistory:{}},setup(ot){const I=ot,s=Fg();fi(()=>s.props?.flash,p=>{p&&(p.success&&ne.success(p.success),p.error&&ne.error(p.error))},{deep:!0,immediate:!0});const{balance:ce,showPurchaseModal:st,requiredWordsForModal:xn,actionDescriptionForModal:he,checkAndPrompt:Vt,closePurchaseModal:Ve,refreshBalance:jt}=e_(),{content:G,isDirty:xe,isSaving:we,lastSaved:je,updateContent:at,manualSave:lt}=$g(I.chapter,I.project.slug),{currentSuggestion:de,currentAnalysis:Z,isAnalyzing:wt,saveSuggestion:Re,clearSuggestion:ft,applySuggestion:Ie}=kg(I.chapter,I.project.slug,I.currentSuggestion,G,{onUsageRecorded:()=>jt()}),{addToHistory:yt}=Zg(I.chapter.content||""),Le=V(!1),Ft=V(I.chapter.title||"");V(!1),V(!1),V("");const wn=()=>{Le.value=!Le.value},W=p=>{at(p),yt(p)};pr(()=>{const p=Ft.value?.trim(),m=G.value?.trim();return!!(p&&p.length>0&&m&&m.length>50)});const{guidance:N,isLoadingGuidance:Se,debouncedRequestGuidance:Be,toggleStep:ct}=__(I.project.slug,I.chapter.chapter_number,I.initialProgressGuidance||null),Wt=V(!1),yn=()=>typeof window<"u"&&window.innerWidth<1024,q=(p,m)=>{try{const R=localStorage.getItem(p);return R!==null?R==="true":m}catch{return m}},K=V(yn()),j=V(q("manualEditor_showLeftSidebar",!K.value)),z=V(q("manualEditor_showRightSidebar",!K.value)),X=V(""),bn=V(null),Bt=V(null),en=V("");V(!1),V([]),V(!1);const ye=V(!0),tn=V((()=>{try{return localStorage.getItem("citationOperationMode")==="true"}catch{return!1}})()),nn=()=>{tn.value=!0,z.value=!1;try{localStorage.setItem("citationOperationMode","true")}catch{}},rn=()=>{tn.value=!1,z.value=!0;try{localStorage.setItem("citationOperationMode","false")}catch{}},_r=V(!1),Cn=async()=>{ne.info("Fullscreen temporarily disabled")},Sn=()=>{Xt.visit(xt("projects.analysis",{project:I.project.slug}))};Au(()=>{}),na(()=>{});const{isDark:Kn,toggle:Ue}=Wg(),un=pr(()=>{const p=Z.value?.word_count??I.chapter.word_count,m=I.chapter.target_word_count||1e3;return Math.min(p/m*100,100)});pr(()=>we.value?"Saving...":je.value?`Saved ${je.value}`:"Not saved");const ci=()=>{j.value=!j.value},et=()=>{z.value=!z.value};fi(j,p=>{if(!K.value)try{localStorage.setItem("manualEditor_showLeftSidebar",String(p))}catch(m){console.error("Failed to save left sidebar state:",m)}}),fi(z,p=>{if(!K.value)try{localStorage.setItem("manualEditor_showRightSidebar",String(p))}catch(m){console.error("Failed to save right sidebar state:",m)}});const Yn=p=>{(p.ctrlKey||p.metaKey)&&p.key==="s"&&(p.preventDefault(),Nt())};Au(()=>{K.value=window.innerWidth<1024,K.value&&(j.value=!1,z.value=!1);const p=()=>{const m=K.value;K.value=window.innerWidth<1024,m!==K.value&&(K.value?(j.value=!1,z.value=!1):(j.value=q("manualEditor_showLeftSidebar",!0),z.value=q("manualEditor_showRightSidebar",!0)))};window.addEventListener("resize",p),window.addEventListener("keydown",Yn),na(()=>{window.removeEventListener("resize",p),window.removeEventListener("keydown",Yn)})}),fi(()=>Z.value,p=>{p&&Be({word_count:p.word_count,citation_count:p.citation_count,table_count:p.table_count,figure_count:p.figure_count,claim_count:p.claim_count,has_introduction:p.has_introduction,has_conclusion:p.has_conclusion,detected_issues:p.detected_issues,quality_metrics:p.quality_metrics},G.value)},{deep:!0}),Au(()=>{Wt.value||!((I.chapter.word_count||0)>50||G.value&&G.value.trim().length>200)||N.value||(Wt.value=!0,Be({word_count:I.chapter.word_count||0,citation_count:I.contextAnalysis?.citation_count||0,table_count:I.contextAnalysis?.table_count||0,figure_count:I.contextAnalysis?.figure_count||0,claim_count:I.contextAnalysis?.claim_count||0,has_introduction:I.contextAnalysis?.has_introduction||!1,has_conclusion:I.contextAnalysis?.has_conclusion||!1,detected_issues:I.contextAnalysis?.detected_issues||[],quality_metrics:I.contextAnalysis?.quality_metrics||{}},G.value||""))});const vr=p=>{W(p),ne.success("Applied improved text")},Ut=p=>{if(Bt.value?.replaceSelection(p,bn.value||void 0)??!1){ne.success("Expanded selection");return}W(`${G.value}

${p}`),ne.success("Added expanded text")},Oe=p=>{en.value=p,ye.value=!0;try{navigator.clipboard?.writeText(p)}catch{}ne.success("Citation suggestions ready")},Dt=p=>{if(Bt.value?.replaceSelection(p,bn.value||void 0)??!1){ne.success("Applied rephrased text");return}W(`${G.value}

${p}`),ne.success("Added rephrased text")},An=p=>{const m=N.value?.next_steps?.find(R=>R?.id===p);if(!(!m||!m.action||m.action==="none")){if(m.action==="open_citation_helper"){ye.value=!0,ne.success("Citation helper opened"),ct(p);return}if(m.action==="insert_text"){const R=m?.payload?.text;if(typeof R!="string"||!R.trim()){ne.error("Nothing to insert for this step");return}Bt.value?.replaceSelection(R.trim(),bn.value||void 0)??!1?ne.success("Inserted into selection"):(W(`${G.value}

${R.trim()}`),ne.success("Inserted into chapter")),ct(p)}}},mr=(p,m)=>Vt(p,m),zt=async(p,m)=>{const R=Math.max(0,Math.round(p||0));R&&(await Tu(R,m,"chapter",I.chapter.id),await jt())},hi=async()=>{if(en.value)try{await navigator.clipboard.writeText(en.value),ne.success("Copied citation suggestions")}catch{ne.error("Could not copy citation suggestions")}},bt=pr(()=>I.allChapters.find(p=>p.chapter_number===I.chapter.chapter_number-1)),ht=pr(()=>I.allChapters.find(p=>p.chapter_number===I.chapter.chapter_number+1)),on=(p,m)=>{if(m&&G.value){const Rn=m.trim(),Jn=document.createElement("div");Jn.innerHTML=G.value;const xr=Jn.textContent||Jn.innerText||"",Xn=xr.indexOf(Rn);if(Xn!==-1){const In=Xn+Rn.length,wr=xr.substring(In).match(/^[^.!?]*[.!?]/);let Qn;wr?Qn=In+wr[0].length:Qn=In;let pe=0,sn=0;const dt=G.value;for(;pe<dt.length&&sn<Qn;)if(dt[pe]==="<"){for(;pe<dt.length&&dt[pe]!==">";)pe++;pe++}else if(dt[pe]==="&"){const an=dt.indexOf(";",pe);an!==-1&&an-pe<10?(pe=an+1,sn++):(pe++,sn++)}else pe++,sn++;if(pe>0){const an=dt.substring(0,pe),di=dt.substring(pe),Vn=`${an} ${p}${di}`;W(Vn),ne.success("Citation inserted at claim location");return}}}const R=Bt.value?.getCursorPosition?.();if(typeof R=="number"&&(Bt.value?.replaceTextAt?.({from:R,to:R},` ${p} `)??!1)){ne.success("Citation inserted at cursor");return}W(`${G.value} ${p}`),ne.success("Citation appended to content")},Ct=p=>{xe.value&&!confirm("You have unsaved changes. Are you sure you want to switch chapters?")||Xt.visit(xt("projects.manual-editor.show",{project:I.project.slug,chapter:p}))},En=()=>{const p=I.chapter.chapter_number+1;I.allChapters.find(R=>R.chapter_number===p)?Ct(p):ne.info("Please create the next chapter from the dashboard first.")},Tn=p=>{confirm("Are you sure you want to delete this chapter?")&&Xt.delete(xt("chapters.destroy",{project:I.project.slug,chapter:I.allChapters.find(m=>m.id===p)?.slug}),{onSuccess:()=>ne.success("Chapter deleted")})},Nt=async()=>{try{await lt(),ne.success("Chapter saved successfully")}catch{ne.error("Failed to save chapter")}},Zn=async()=>{console.log("🔵 [MARK COMPLETE] Function called"),console.log("🔵 [MARK COMPLETE] Current word count:",Z.value?.word_count??I.chapter.word_count);try{console.log("🔵 [MARK COMPLETE] Saving chapter..."),await lt(),console.log("✅ [MARK COMPLETE] Chapter saved");const p=xt("projects.manual-editor.mark-complete",{project:I.project.slug,chapter:I.chapter.chapter_number});console.log("🔵 [MARK COMPLETE] Posting to:",p),Xt.post(p,{},{onSuccess:()=>{console.log("✅ [MARK COMPLETE] Request successful")},onError:m=>{console.error("❌ [MARK COMPLETE] Request failed:",m)}})}catch(p){console.error("❌ [MARK COMPLETE] Error:",p),ne.error("Failed to save chapter before marking complete")}};return(p,m)=>(oe(),ut(Ug,null,[S(g(Bg),{title:`${p.chapter.title} - Manual Editor`},null,8,["title"]),b("div",v_,[b("header",m_,[b("div",x_,[S(g(me),{variant:"ghost",size:"icon",class:"h-8 w-8 text-zinc-700 dark:text-zinc-300 hover:text-foreground",onClick:m[0]||(m[0]=R=>g(Xt).visit(g(xt)("projects.show",p.project.slug))),title:"Back to Project"},{default:se(()=>[S(g(ua),{class:"w-4 h-4"})]),_:1}),S(g(Pt),{orientation:"vertical",class:"h-6"}),S(g(me),{onClick:m[1]||(m[1]=R=>j.value=!0),variant:"ghost",size:"icon",class:"h-8 w-8 lg:hidden text-muted-foreground hover:text-foreground",title:"Open Chapter Navigation"},{default:se(()=>[S(g(n_),{class:"w-4 h-4"})]),_:1})]),b("div",w_,[b("div",y_,[b("span",{class:"hover:text-foreground transition-colors cursor-pointer truncate",onClick:m[2]||(m[2]=R=>g(Xt).visit(g(xt)("projects.show",p.project.slug)))},ve(p.project.title),1)]),b("div",b_,[b("div",C_,[b("span",S_,"Ch. "+ve(p.chapter.chapter_number),1)])])]),b("div",A_,[S(g(me),{variant:"ghost",size:"icon",class:"h-8 w-8",onClick:Nt,disabled:g(we),title:"Save"},{default:se(()=>[S(g(Eu),{class:"w-4 h-4"})]),_:1},8,["disabled"]),S(g(Pt),{orientation:"vertical",class:"h-6 mx-1 opacity-50"}),S(g(me),{onClick:m[3]||(m[3]=R=>z.value=!0),variant:"ghost",size:"icon",class:"h-8 w-8 text-muted-foreground hover:text-foreground",title:"Open Tools"},{default:se(()=>[S(g(oa),{class:"w-4 h-4"})]),_:1})])]),b("div",E_,[b("div",T_,[b("div",R_,[b("h1",{class:"text-sm font-bold text-foreground cursor-pointer hover:text-primary transition-colors",onClick:m[4]||(m[4]=R=>g(Xt).visit(g(xt)("projects.show",p.project.slug)))},ve(p.project.title),1),S(g(Dg),{variant:"secondary",class:"h-5 px-2 text-[10px] rounded-full"},{default:se(()=>[mn("Ch "+ve(p.chapter.chapter_number),1)]),_:1})]),b("div",I_,[bt.value?(oe(),vt(g(me),{key:0,variant:"ghost",size:"sm",class:"h-6 px-2 text-zinc-500 hover:text-foreground gap-1 rounded-full text-[10px]",onClick:m[5]||(m[5]=R=>Ct(bt.value.chapter_number)),title:`Previous: ${bt.value.title}`},{default:se(()=>[S(g(r_),{class:"w-3 h-3"}),m[17]||(m[17]=mn(" Prev ",-1))]),_:1},8,["title"])):mt("",!0),ht.value?(oe(),vt(g(me),{key:1,variant:"ghost",size:"sm",class:"h-6 px-2 text-zinc-500 hover:text-foreground gap-1 rounded-full text-[10px]",onClick:m[6]||(m[6]=R=>Ct(ht.value.chapter_number)),title:`Next: ${ht.value.title}`},{default:se(()=>[m[18]||(m[18]=mn(" Next ",-1)),S(g(i_),{class:"w-3 h-3"})]),_:1},8,["title"])):mt("",!0)])]),b("div",L_,[b("div",O_,[b("div",M_,[S(g(me),{variant:"ghost",size:"icon",class:"h-8 w-8 text-zinc-700 dark:text-zinc-300 hover:text-foreground rounded-full",onClick:m[7]||(m[7]=R=>g(Xt).visit(g(xt)("projects.show",p.project.slug))),title:"Back to Project"},{default:se(()=>[S(g(ua),{class:"w-4 h-4"})]),_:1}),m[19]||(m[19]=b("div",{class:"h-4 w-px bg-border/50 mx-1"},null,-1)),S(g(me),{onClick:ci,variant:"ghost",size:"icon",class:qn(["h-8 w-8 transition-all duration-300 rounded-full",j.value?"text-primary":"text-zinc-700 dark:text-zinc-300 hover:text-foreground"]),title:"Toggle Chapter Navigation"},{default:se(()=>[j.value?(oe(),vt(g(u_),{key:0,class:"w-4 h-4"})):(oe(),vt(g(o_),{key:1,class:"w-4 h-4"}))]),_:1},8,["class"])]),m[21]||(m[21]=b("div",{class:"h-4 w-px bg-border/50"},null,-1)),b("div",P_,[b("div",F_,[b("div",{class:qn(["w-2 h-2 rounded-full transition-colors duration-300",g(xe)?"bg-amber-500 animate-pulse":"bg-emerald-500"])},null,2),b("span",W_,ve(g(xe)?"Unsaved":"Saved"),1)]),S(g(Pt),{orientation:"vertical",class:"h-3"}),g(wt)?(oe(),ut("div",B_,[S(g(s_),{class:"w-3 h-3 animate-spin text-primary"}),m[20]||(m[20]=b("span",{class:"text-xs text-muted-foreground"},"Analyzing",-1))])):(oe(),ut("div",U_,ve(g(Z)?.word_count??p.chapter.word_count)+" words ",1))])]),m[24]||(m[24]=b("div",{class:"flex-1 px-4 min-w-0"},[b("div",{id:"manual-editor-toolbar",class:"mx-auto max-w-[950px]"})],-1)),b("div",D_,[b("div",z_,[S(g(me),{variant:"ghost",size:"icon",class:"h-7 w-7 rounded-full text-zinc-700 dark:text-zinc-300 hover:text-foreground",onClick:g(Ue),title:g(Kn)?"Switch to Light Mode":"Switch to Dark Mode"},{default:se(()=>[g(Kn)?(oe(),vt(g(a_),{key:0,class:"w-4 h-4"})):(oe(),vt(g(l_),{key:1,class:"w-4 h-4"}))]),_:1},8,["onClick","title"]),S(g(me),{variant:"ghost",size:"icon",class:"h-7 w-7 rounded-full text-zinc-700 dark:text-zinc-300 hover:text-foreground",onClick:Cn,title:_r.value?"Exit Full Screen":"Enter Full Screen"},{default:se(()=>[_r.value?(oe(),vt(g(f_),{key:0,class:"w-4 h-4"})):(oe(),vt(g(Jg),{key:1,class:"w-4 h-4"}))]),_:1},8,["title"]),S(g(me),{onClick:wn,variant:"ghost",size:"icon",class:qn(["h-7 w-7 rounded-full transition-all duration-300",Le.value?"bg-background shadow-sm text-primary":"text-zinc-700 dark:text-zinc-300 hover:text-foreground"]),title:"Toggle AI Chat Mode"},{default:se(()=>[S(g(oa),{class:"w-4 h-4"})]),_:1},8,["class"]),S(g(me),{onClick:et,variant:"ghost",size:"icon",class:qn(["h-7 w-7 rounded-full transition-all duration-300",z.value?"bg-background shadow-sm text-primary":"text-zinc-700 dark:text-zinc-300 hover:text-foreground"]),title:"Toggle Tools Sidebar"},{default:se(()=>[z.value?(oe(),vt(g(Xg),{key:0,class:"w-4 h-4"})):(oe(),vt(g(Qg),{key:1,class:"w-4 h-4"}))]),_:1},8,["class"])]),m[23]||(m[23]=b("div",{class:"w-px h-4 bg-border/50"},null,-1)),S(Vg,{project:p.project,"current-chapter":p.chapter,"all-chapters":p.allChapters,size:"sm",variant:"outline",class:"h-9","button-class":"rounded-full bg-background/50"},null,8,["project","current-chapter","all-chapters"]),S(g(me),{variant:"ghost",size:"sm",class:"h-9 gap-2 text-zinc-700 dark:text-zinc-300 hover:text-foreground rounded-full bg-background/50 border border-transparent hover:border-border/50",onClick:Sn,title:"Open bulk analysis"},{default:se(()=>[S(g(c_),{class:"w-4 h-4"}),m[22]||(m[22]=b("span",{class:"text-xs font-medium"},"Analyze",-1))]),_:1}),S(g(me),{variant:"outline",size:"sm",class:"h-9 gap-2 text-zinc-700 dark:text-zinc-300 hover:text-foreground rounded-full bg-background/50",onClick:Nt,disabled:g(we),title:"Save (Ctrl+S)"},{default:se(()=>[S(g(Eu),{class:"w-4 h-4"}),b("span",N_,ve(g(we)?"Saving...":"Save"),1)]),_:1},8,["disabled"])])])]),b("div",$_,[b("div",k_,[m[25]||(m[25]=b("span",{class:"font-medium"},"Writing Progress",-1)),b("span",null,ve(g(Z)?.word_count??p.chapter.word_count)+" / "+ve(p.chapter.target_word_count)+" words",1)]),S(g(zg),{"model-value":un.value,class:"h-1.5"},null,8,["model-value"])]),b("div",G_,[S(ra,{"enter-active-class":"transition-all duration-500 cubic-bezier(0.4, 0, 0.2, 1)","enter-from-class":"-ml-[320px] opacity-0","enter-to-class":"ml-0 opacity-100","leave-active-class":"transition-all duration-500 cubic-bezier(0.4, 0, 0.2, 1)","leave-from-class":"ml-0 opacity-100","leave-to-class":"-ml-[320px] opacity-0"},{default:se(()=>[j.value&&!K.value?(oe(),ut("aside",q_,[b("div",H_,[b("div",K_,[m[26]||(m[26]=b("h2",{class:"text-sm font-semibold text-foreground mb-1"},"Table of Contents",-1)),b("p",Y_,ve(p.allChapters.length)+" Chapters",1)]),S(Yg,{"all-chapters":p.allChapters,"current-chapter":p.chapter,project:p.project,outlines:p.project.outlines||[],"faculty-chapters":p.facultyChapters||[],"current-word-count":g(Z)?.word_count||p.chapter.word_count,"target-word-count":p.chapter.target_word_count,"writing-quality-score":0,"chapter-content-length":g(G)?.length||0,onGoToChapter:Ct,onGenerateNextChapter:En,onDeleteChapter:Tn},null,8,["all-chapters","current-chapter","project","outlines","faculty-chapters","current-word-count","target-word-count","chapter-content-length"])])])):mt("",!0)]),_:1}),b("div",{class:qn(["flex-1 flex overflow-hidden",tn.value?"flex-row":"flex-col"])},[b("div",{class:qn(["flex flex-col overflow-hidden",tn.value?"w-1/2 border-r border-border/50":"flex-1"])},[b("div",Z_,[S(Ng,{ref_key:"editorRef",ref:Bt,modelValue:g(G),"onUpdate:modelValue":W,"onUpdate:selectedText":m[8]||(m[8]=R=>X.value=R),"onUpdate:selectionRange":m[9]||(m[9]=R=>bn.value=R),"manual-mode":!0,"toolbar-teleport-target":K.value?"":"#manual-editor-toolbar",class:"min-h-full"},null,8,["modelValue","toolbar-teleport-target"])])],2),tn.value?(oe(),ut("div",J_,[b("div",X_,[S(ia,{"show-citation-helper":ye.value,"onUpdate:showCitationHelper":m[10]||(m[10]=R=>ye.value=R),"chapter-content":g(G),"chapter-id":p.chapter.id,"citation-operation-mode":!0,onInsertCitation:on,onExitOperationMode:rn},null,8,["show-citation-helper","chapter-content","chapter-id"])])])):mt("",!0)],2),S(ra,{"enter-active-class":"transition-all duration-500 cubic-bezier(0.4, 0, 0.2, 1)","enter-from-class":"-mr-[400px] opacity-0","enter-to-class":"mr-0 opacity-100","leave-active-class":"transition-all duration-500 cubic-bezier(0.4, 0, 0.2, 1)","leave-from-class":"mr-0 opacity-100","leave-to-class":"-mr-[400px] opacity-0"},{default:se(()=>[z.value&&!K.value?(oe(),ut("aside",Q_,[b("div",V_,[g(de)?(oe(),ut("div",j_,[S(Gg,{suggestion:g(de),analysis:g(Z),onSave:g(Re),onClear:g(ft),onApply:g(Ie)},null,8,["suggestion","analysis","onSave","onClear","onApply"]),S(g(Pt),{class:"bg-border/50"})])):mt("",!0),S(qg,{guidance:g(N),"is-loading":g(Se),"has-content":(g(Z)?.word_count??p.chapter.word_count)>50,onToggleStep:g(ct),onGuidanceAction:An},null,8,["guidance","is-loading","has-content","onToggleStep"]),S(g(Pt),{class:"bg-border/50"}),S(Hg,{"project-slug":p.project.slug,"chapter-number":p.chapter.chapter_number,"selected-text":X.value,"chapter-content":g(G),"is-processing":g(wt)||g(we),"ensure-balance":mr,"on-usage":zt,onTextImproved:vr,onTextExpanded:Ut,onCitationsSuggested:Oe,onTextRephrased:Dt,onOpenCitationHelper:m[11]||(m[11]=R=>ye.value=!0)},null,8,["project-slug","chapter-number","selected-text","chapter-content","is-processing"]),S(g(Pt),{class:"bg-border/50"}),en.value?(oe(),ut("div",ev,[b("div",tv,[m[28]||(m[28]=b("h3",{class:"text-sm font-semibold text-foreground"},"Citation Suggestions",-1)),S(g(me),{size:"sm",variant:"outline",onClick:hi},{default:se(()=>[...m[27]||(m[27]=[mn(" Copy ",-1)])]),_:1})]),b("pre",nv,ve(en.value),1),S(g(Pt),{class:"bg-border/50"})])):mt("",!0),b("div",rv,[S(ia,{"show-citation-helper":ye.value,"onUpdate:showCitationHelper":m[12]||(m[12]=R=>ye.value=R),"chapter-content":g(G),"chapter-id":p.chapter.id,onInsertCitation:on,onEnterOperationMode:nn},null,8,["show-citation-helper","chapter-content","chapter-id"])]),S(g(Pt),{class:"bg-border/50"}),S(g(Pt),{class:"bg-border/50"})])])):mt("",!0)]),_:1}),S(Kg,{"show-left-sidebar":j.value,"show-right-sidebar":z.value,"is-mobile":K.value,"all-chapters":p.allChapters,"current-chapter":p.chapter,project:p.project,"faculty-chapters":p.facultyChapters,"current-word-count":g(Z)?.word_count||p.chapter.word_count,"target-word-count":p.chapter.target_word_count,"chapter-content-length":g(G)?.length||0,"selected-text":X.value,"is-analyzing":g(wt),"is-saving":g(we),"current-suggestion":g(de),"current-analysis":g(Z),guidance:g(N),"is-loading-guidance":g(Se),"chapter-content":g(G),"show-citation-helper":ye.value,"ensure-balance":mr,"on-usage":zt,"onUpdate:showLeftSidebar":m[13]||(m[13]=R=>j.value=R),"onUpdate:showRightSidebar":m[14]||(m[14]=R=>z.value=R),"onUpdate:showCitationHelper":m[15]||(m[15]=R=>ye.value=R),onGoToChapter:Ct,onGenerateNextChapter:En,onDeleteChapter:Tn,onSaveSuggestion:g(Re),onClearSuggestion:g(ft),onApplySuggestion:g(Ie),onToggleStep:g(ct),onTextImproved:vr,onTextExpanded:Ut,onCitationsSuggested:Oe,onTextRephrased:Dt,onInsertCitation:on},null,8,["show-left-sidebar","show-right-sidebar","is-mobile","all-chapters","current-chapter","project","faculty-chapters","current-word-count","target-word-count","chapter-content-length","selected-text","is-analyzing","is-saving","current-suggestion","current-analysis","guidance","is-loading-guidance","chapter-content","show-citation-helper","onSaveSuggestion","onClearSuggestion","onApplySuggestion","onToggleStep"])]),b("footer",iv,[b("div",uv,[b("div",ov,[b("span",sv,[m[29]||(m[29]=b("span",{class:"hidden sm:inline"},"Words: ",-1)),b("strong",av,ve(g(Z)?.word_count??p.chapter.word_count),1),mn(" / "+ve(p.chapter.target_word_count),1)]),g(Z)?(oe(),ut("span",lv,[m[30]||(m[30]=mn(" Citations: ",-1)),b("strong",fv,ve(g(Z).citation_count),1)])):mt("",!0),g(Z)?(oe(),ut("span",cv,[m[31]||(m[31]=mn(" Tables: ",-1)),b("strong",hv,ve(g(Z).table_count),1)])):mt("",!0),g(Z)?(oe(),ut("span",dv," Quality: "+ve(g(Z).quality_metrics.reading_level),1)):mt("",!0)]),b("div",pv,[S(g(me),{variant:"outline",size:"sm",class:"h-8 md:h-9 gap-2 flex-1 sm:flex-initial",onClick:Nt,disabled:g(we),title:"Save chapter"},{default:se(()=>[S(g(Eu),{class:"w-3.5 h-3.5 md:w-4 md:h-4"}),b("span",gv,ve(g(we)?"Saving...":"Save"),1)]),_:1},8,["disabled"]),S(g(me),{variant:"default",size:"sm",class:"h-8 md:h-9 gap-2 flex-1 sm:flex-initial",onClick:Zn,disabled:g(we),title:"Save and mark chapter as complete"},{default:se(()=>[S(g(h_),{class:"w-3.5 h-3.5 md:w-4 md:h-4"}),m[32]||(m[32]=b("span",{class:"text-xs font-medium hidden sm:inline"},"Mark Complete",-1)),m[33]||(m[33]=b("span",{class:"text-xs font-medium sm:hidden"},"Complete",-1))]),_:1},8,["disabled"])])])]),S(t_,{open:g(st),"current-balance":g(ce),"required-words":g(xn),action:g(he),"onUpdate:open":m[16]||(m[16]=R=>st.value=R),onClose:g(Ve)},null,8,["open","current-balance","required-words","action","onClose"]),S(g(jg),{position:"top-center"})])],64))}}),G0=d_(_v,[["__scopeId","data-v-5b4f55c9"]]);export{G0 as default};
