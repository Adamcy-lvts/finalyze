import{bt as C,ck as N,bu as X,ci as Q,bB as F,cD as c,co as u,cr as t,cI as _,cq as i,bF as s,hN as z,ct as f,hO as U,hP as M,cT as E,di as G,cu as O,hQ as V,cj as B,cp as v,cH as $,es as W,gD as J,cs as H}from"./vendor-B5jlBrgV.js";import{_ as Y,a as Z}from"./index-DEDCgojD.js";import{_ as I}from"./index-D4mJyiz8.js";import{A as K}from"./ChapterEditor-DpRse4yL.js";import{_ as ee}from"./ChapterNavigation.vue_vue_type_script_setup_true_lang-CqXDMWzW.js";import{_ as te}from"./DefensePreparationPanel.vue_vue_type_script_setup_true_lang-CIo7O3gM.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DCGYk7ZE.js";import"./CardContent.vue_vue_type_script_setup_true_lang-CtTakpSW.js";import"./CardTitle.vue_vue_type_script_setup_true_lang-XJ5or5ZK.js";import"./ScrollArea.vue_vue_type_script_setup_true_lang-DltzEvp9.js";import"./Separator.vue_vue_type_script_setup_true_lang-BvcdIWM_.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-C5iiu9qR.js";import"./WordBalanceDisplay.vue_vue_type_script_setup_true_lang-DBc7hWuL.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-C-6bVGLf.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-2vqHzDZO.js";import"./UserInfo.vue_vue_type_script_setup_true_lang-w4YHLOMg.js";import"./Sonner.vue_vue_type_script_setup_true_lang-sxjlERgN.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-BodEwO0Z.js";import"./useAppearance-D3We0oPJ.js";import"./useWordBalance-D_NxFp97.js";import"./PWAInstallPrompt.vue_vue_type_script_setup_true_lang-D12IZ_KU.js";import"./PurchaseModal.vue_vue_type_script_setup_true_lang-DMxFPDrF.js";import"./DialogContent.vue_vue_type_script_setup_true_lang-DATQht2f.js";import"./DialogDescription.vue_vue_type_script_setup_true_lang-DsP71UmP.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-B5lGGt-M.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-Cb9j7AhV.js";import"./useChapterWordCount-BpyHk_pq.js";import"./Input.vue_vue_type_script_setup_true_lang-xMT9dCF9.js";import"./Label.vue_vue_type_script_setup_true_lang-BlhK8lFl.js";import"./RichTextEditor-CEL0MMIo.js";import"./vendor-tiptap-CeHW2ROA.js";import"./Progress.vue_vue_type_script_setup_true_lang-DwlWDfQ5.js";import"./MermaidExtension-LU-z_FW5.js";import"./vendor-mermaid-Cnq-YXE-.js";import"./RichTextViewer-DYTV8h_g.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-Bov0hrWV.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-VRoINCin.js";import"./SelectGroup.vue_vue_type_script_setup_true_lang-BZxhET4J.js";import"./useTextHistory-D0JQJQu1.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-jW0orlWc.js";import"./Switch.vue_vue_type_script_setup_true_lang-siBQm0EZ.js";function ae(){const g=C(!1),l=C(null),m=C(null),p=C(null),d=C([]),y=C({}),T=N(()=>m.value?.hasDataCollectionNeeds??!1),P=N(()=>m.value?.types??[]),x=N(()=>p.value?.hasPlaceholder?p.value.detectedType:null),R=N(()=>p.value?.hasPlaceholder?p.value.confidence??0:0);async function w(a){g.value=!0,l.value=null;try{const r=await fetch(`/api/chapters/${a}/detect`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!r.ok)throw new Error("Failed to detect data collection needs");const k=await r.json();m.value=k.detection}catch(r){l.value=r instanceof Error?r.message:"An error occurred",console.error("Error detecting data collection needs:",r)}finally{g.value=!1}}async function b(a){g.value=!0,l.value=null;try{const r=await fetch(`/api/chapters/${a}/placeholder`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!r.ok)throw new Error("Failed to generate placeholder");const k=await r.json();p.value=k.placeholder}catch(r){l.value=r instanceof Error?r.message:"An error occurred",console.error("Error generating placeholder:",r)}finally{g.value=!1}}async function D(a){g.value=!0,l.value=null;try{const r=await fetch(`/api/chapters/${a}/suggestions`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!r.ok)throw new Error("Failed to get suggestions");const k=await r.json();d.value=k.suggestions}catch(r){l.value=r instanceof Error?r.message:"An error occurred",console.error("Error getting suggestions:",r)}finally{g.value=!1}}async function j(){g.value=!0,l.value=null;try{const a=await fetch("/api/data-collection/templates",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!a.ok)throw new Error("Failed to get templates");const r=await a.json();y.value=r.templates}catch(a){l.value=a instanceof Error?a.message:"An error occurred",console.error("Error getting templates:",a)}finally{g.value=!1}}async function S(a){g.value=!0,l.value=null;try{const r=await fetch(`/api/data-collection/template?type=${encodeURIComponent(a)}`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!r.ok)throw new Error("Failed to get template");return(await r.json()).template}catch(r){return l.value=r instanceof Error?r.message:"An error occurred",console.error("Error getting template:",r),null}finally{g.value=!1}}async function L(a,r,k="append"){g.value=!0,l.value=null;try{if(!(await fetch(`/api/chapters/${a}/insert-template`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({type:r,position:k})})).ok)throw new Error("Failed to insert template");return!0}catch(q){return l.value=q instanceof Error?q.message:"An error occurred",console.error("Error inserting template:",q),!1}finally{g.value=!1}}async function A(a){await Promise.all([w(a),b(a),D(a)])}function e(a){return{survey:"Survey/Questionnaire",experiment:"Laboratory Experiment",engineering:"Engineering Design",statistical:"Statistical Analysis",construction:"Construction Project"}[a]||a.charAt(0).toUpperCase()+a.slice(1)}function n(a){return a>=50?"High":a>=25?"Medium":"Low"}function o(a){return a>=50?"text-green-600 dark:text-green-400":a>=25?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"}function h(){m.value=null,p.value=null,d.value=[],l.value=null}return{isLoading:g,error:l,detection:m,placeholder:p,suggestions:d,templates:y,hasDataCollectionNeeds:T,detectedTypes:P,primaryType:x,primaryConfidence:R,detectDataCollectionNeeds:w,generatePlaceholder:b,getSuggestions:D,getAllTemplates:j,getTemplate:S,insertTemplate:L,analyzeChapter:A,getTypeName:e,getConfidenceLevel:n,getConfidenceColor:o,clearData:h}}const re={class:"space-y-4"},oe={class:"flex items-center justify-between"},ne={class:"flex items-center gap-2"},le=["disabled"],ie={key:0,class:"text-center py-4"},de={key:1,class:"text-center py-4"},ce={key:2},ue={class:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3"},pe={class:"flex items-start gap-2"},ge={class:"min-w-0 flex-1"},he={class:"mt-2 space-y-1"},fe={class:"text-xs text-blue-700 dark:text-blue-300"},me={key:0,class:"border border-gray-200 dark:border-gray-700 rounded-lg p-3"},ye={class:"flex items-center justify-between mb-2"},ve={class:"text-xs px-2 py-1 bg-green-100 text-green-700 rounded dark:bg-green-900/20 dark:text-green-400"},be={class:"text-xs text-gray-600 dark:text-gray-400 mb-3"},xe={class:"flex gap-2"},we=["disabled"],ke={key:0,class:"mt-3 p-2 bg-gray-50 dark:bg-gray-800 rounded text-xs"},Ce={class:"whitespace-pre-wrap text-gray-700 dark:text-gray-300 overflow-auto max-h-32"},_e={key:1,class:"space-y-2"},Te={class:"text-xs font-medium text-gray-700 dark:text-gray-300 mb-2"},Se={class:"space-y-1"},Ae={class:"border border-gray-200 dark:border-gray-700 rounded-lg"},De={class:"p-3 pt-0 space-y-2"},$e={class:"text-xs font-medium text-gray-900 dark:text-gray-100"},Pe={class:"text-xs text-gray-600 dark:text-gray-400"},Re=["onClick","disabled"],je={key:3,class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3"},Le={class:"flex items-start gap-2"},qe={class:"text-xs text-red-600 dark:text-red-400 mt-1"},Ne=X({__name:"DataCollectionPanel",props:{chapterId:{},content:{}},setup(g){const l=g,m=C(!1),{isLoading:p,error:d,placeholder:y,suggestions:T,templates:P,hasDataCollectionNeeds:x,detectedTypes:R,primaryType:w,analyzeChapter:b,insertTemplate:D,getAllTemplates:j,getTypeName:S,getConfidenceColor:L}=ae();let A=null;Q(()=>l.content,(n,o)=>{!n||n===o||(A&&clearTimeout(A),A=setTimeout(()=>{n&&n.length>500&&b(l.chapterId)},3e3))},{immediate:!1});async function e(n,o,h="append"){await D(n,o,h)?(B.success("Template added successfully"),m.value=!1,setTimeout(()=>{b(n)},1e3)):B.error(d.value||"Failed to insert template")}return F(async()=>{await j(),l.content&&l.content.length>500&&await b(l.chapterId)}),(n,o)=>(u(),c("div",re,[t("div",oe,[t("div",ne,[i(s(z),{class:"h-5 w-5 text-blue-600 dark:text-blue-400"}),o[3]||(o[3]=t("h3",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"}," Data Collection Assistant ",-1))]),s(x)?_("",!0):(u(),c("button",{key:0,onClick:o[0]||(o[0]=h=>s(b)(n.chapterId)),disabled:s(p),class:"text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100 disabled:opacity-50 dark:bg-blue-900/20 dark:text-blue-400 dark:hover:bg-blue-900/30"},f(s(p)?"Analyzing...":"Scan for Data Needs"),9,le))]),s(p)&&!s(x)?(u(),c("div",ie,[...o[4]||(o[4]=[t("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"},null,-1),t("p",{class:"text-xs text-gray-500 mt-2"},"Analyzing chapter content...",-1)])])):!s(x)&&!s(p)?(u(),c("div",de,[i(s(U),{class:"h-8 w-8 text-gray-400 mx-auto mb-2"}),o[5]||(o[5]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," No data collection requirements detected in this chapter. ",-1)),o[6]||(o[6]=t("p",{class:"text-xs text-gray-400 mt-1"},' Add keywords like "survey", "experiment", or "statistical analysis" to get assistance. ',-1))])):s(x)?(u(),c("div",ce,[t("div",ue,[t("div",pe,[i(s(M),{class:"h-4 w-4 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),t("div",ge,[o[7]||(o[7]=t("p",{class:"text-sm font-medium text-blue-900 dark:text-blue-100"}," Data Collection Requirements Detected ",-1)),t("div",he,[(u(!0),c(E,null,G(s(R),h=>(u(),c("div",{key:h,class:"flex items-center justify-between"},[t("span",fe,f(s(S)(h)),1),t("span",{class:O(["text-xs font-medium",s(L)(s(y)?.allConfidence?.[h]||0)])},f(s(y)?.allConfidence?.[h]?.toFixed(1))+"% confidence ",3)]))),128))])])])]),s(w)&&s(y)?.template?(u(),c("div",me,[t("div",ye,[o[8]||(o[8]=t("h4",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"}," Recommended Template ",-1)),t("span",ve,f(s(S)(s(w))),1)]),t("p",be,f(s(y).template.title),1),t("div",xe,[t("button",{onClick:o[1]||(o[1]=h=>e(n.chapterId,s(w),"append")),disabled:s(p),class:"flex-1 text-xs px-3 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50"},f(s(p)?"Inserting...":"Add Template"),9,we),t("button",{onClick:o[2]||(o[2]=h=>m.value=!m.value),class:"text-xs px-2 py-1.5 border border-gray-200 text-gray-600 rounded hover:bg-gray-50 dark:border-gray-600 dark:text-gray-400 dark:hover:bg-gray-800"},f(m.value?"Hide":"Preview"),1)]),m.value?(u(),c("div",ke,[t("pre",Ce,f(s(y).template.content.trim()),1)])):_("",!0)])):_("",!0),s(T).length>0?(u(),c("div",_e,[o[9]||(o[9]=t("h4",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"}," Research Guidelines ",-1)),(u(!0),c(E,null,G(s(T),h=>(u(),c("div",{key:h.type,class:"border border-gray-200 dark:border-gray-700 rounded-lg p-3"},[t("h5",Te,f(h.title),1),t("ul",Se,[(u(!0),c(E,null,G(h.suggestions,(a,r)=>(u(),c("li",{key:r,class:"flex items-start gap-1.5 text-xs text-gray-600 dark:text-gray-400"},[i(s(V),{class:"h-3 w-3 text-green-500 mt-0.5 flex-shrink-0"}),t("span",null,f(a),1)]))),128))])]))),128))])):_("",!0),t("details",Ae,[o[10]||(o[10]=t("summary",{class:"p-3 cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"}," Browse All Templates ",-1)),t("div",De,[(u(!0),c(E,null,G(s(P),(h,a)=>(u(),c("div",{key:a,class:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-800 rounded"},[t("div",null,[t("span",$e,f(s(S)(a)),1),t("p",Pe,f(h.title),1)]),t("button",{onClick:r=>e(n.chapterId,a,"append"),disabled:s(p),class:"text-xs px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50"}," Add ",8,Re)]))),128))])])])):_("",!0),s(d)?(u(),c("div",je,[t("div",Le,[i(s(M),{class:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),t("div",null,[o[11]||(o[11]=t("p",{class:"text-sm font-medium text-red-800 dark:text-red-200"}," Analysis Error ",-1)),t("p",qe,f(s(d)),1)])])])):_("",!0)]))}}),Ee={key:0,class:"fixed inset-0 z-50 lg:hidden"},Ge={class:"fixed top-0 left-0 h-full w-80 overflow-y-auto border-r bg-background shadow-xl transform transition-transform"},He={class:"border-b p-3"},Me={class:"flex items-center justify-between"},Be={class:"space-y-4 p-4 mobile-enhanced"},We={key:0,class:"fixed inset-0 z-50 lg:hidden"},Ie={class:"fixed top-0 right-0 h-full w-96 overflow-y-auto border-l bg-background shadow-xl transform transition-transform"},Xe={class:"border-b p-3"},Qe={class:"flex items-center justify-between"},Fe={class:"space-y-4 p-4 mobile-enhanced"},ze=X({__name:"MobileNavOverlay",props:{showLeftSidebar:{type:Boolean},showRightSidebar:{type:Boolean},isMobile:{type:Boolean},allChapters:{},currentChapter:{},project:{},currentWordCount:{},targetWordCount:{},writingQualityScore:{},chapterContentLength:{},isGenerating:{type:Boolean},selectedText:{},isLoadingSuggestions:{type:Boolean},showCitationHelper:{type:Boolean},chapterContent:{},showDefensePrep:{type:Boolean},defenseQuestions:{},isLoadingDefenseQuestions:{type:Boolean},isGeneratingDefenseQuestions:{type:Boolean},meetsDefenseThreshold:{type:Boolean},shouldShowDefenseProgress:{type:Boolean},defenseProgressPercentage:{},defenseWordsRemaining:{},hasTriggeredGeneration:{type:Boolean},outlines:{},facultyChapters:{}},emits:["update:showLeftSidebar","update:showRightSidebar","goToChapter","generateNextChapter","startStreamingGeneration","getAISuggestions","update:showCitationHelper","checkCitations","update:showDefensePrep","generate-more","refresh","mark-helpful","hide-question"],setup(g,{emit:l}){const p=C(g.showDefensePrep??!0),d=l,y=()=>d("update:showLeftSidebar",!1),T=()=>d("update:showRightSidebar",!1),P=e=>d("goToChapter",e),x=()=>d("generateNextChapter"),R=(e,n)=>d("startStreamingGeneration",e,n),w=()=>d("getAISuggestions"),b=e=>d("update:showCitationHelper",e),D=e=>{p.value=e,d("update:showDefensePrep",e)},j=()=>d("generate-more"),S=()=>d("refresh"),L=(e,n)=>d("mark-helpful",e,n),A=e=>d("hide-question",e);return(e,n)=>(u(),c("div",null,[i($,{"enter-active-class":"duration-300 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"duration-200 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:v(()=>[e.showLeftSidebar&&e.isMobile?(u(),c("div",Ee,[i($,{"enter-active-class":"duration-300 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"duration-200 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:v(()=>[t("div",{class:"fixed inset-0 bg-black/50",onClick:y})]),_:1}),i($,{"enter-active-class":"duration-300 ease-out","enter-from-class":"-translate-x-full","enter-to-class":"translate-x-0","leave-active-class":"duration-200 ease-in","leave-from-class":"translate-x-0","leave-to-class":"-translate-x-full"},{default:v(()=>[t("div",Ge,[t("div",He,[t("div",Me,[n[0]||(n[0]=t("h2",{class:"text-base font-semibold"},"Navigation",-1)),i(s(I),{onClick:y,variant:"ghost",size:"sm",class:"h-8 w-8"},{default:v(()=>[i(s(W),{class:"h-4 w-4"})]),_:1})])]),t("div",Be,[i(ee,{"all-chapters":e.allChapters,"current-chapter":e.currentChapter,project:e.project,outlines:e.outlines||[],"faculty-chapters":e.facultyChapters||[],"current-word-count":e.currentWordCount,"target-word-count":e.targetWordCount,"writing-quality-score":e.writingQualityScore,"chapter-content-length":e.chapterContentLength,onGoToChapter:P,onGenerateNextChapter:x},null,8,["all-chapters","current-chapter","project","outlines","faculty-chapters","current-word-count","target-word-count","writing-quality-score","chapter-content-length"]),i(s(Y),{class:"border-border/50"},{default:v(()=>[i(s(J),{class:"h-4 w-4 text-muted-foreground"}),i(s(Z),{class:"text-xs text-muted-foreground"},{default:v(()=>[...n[1]||(n[1]=[t("strong",{class:"text-foreground"},"Pro Tips:",-1),t("br",null,null,-1),H(" • Press Ctrl+S to save",-1),t("br",null,null,-1),H(" • Ctrl+Z/Y for undo/redo",-1),t("br",null,null,-1),H(" • Select text for AI suggestions",-1),t("br",null,null,-1),H(" • F11 for distraction-free mode ",-1)])]),_:1})]),_:1})])])]),_:1})])):_("",!0)]),_:1}),i($,{"enter-active-class":"duration-300 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"duration-200 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:v(()=>[e.showRightSidebar&&e.isMobile?(u(),c("div",We,[i($,{"enter-active-class":"duration-300 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"duration-200 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:v(()=>[t("div",{class:"fixed inset-0 bg-black/50",onClick:T})]),_:1}),i($,{"enter-active-class":"duration-300 ease-out","enter-from-class":"translate-x-full","enter-to-class":"translate-x-0","leave-active-class":"duration-200 ease-in","leave-from-class":"translate-x-0","leave-to-class":"translate-x-full"},{default:v(()=>[t("div",Ie,[t("div",Xe,[t("div",Qe,[n[2]||(n[2]=t("h2",{class:"text-base font-semibold"},"AI Tools",-1)),i(s(I),{onClick:T,variant:"ghost",size:"sm",class:"h-8 w-8"},{default:v(()=>[i(s(W),{class:"h-4 w-4"})]),_:1})])]),t("div",Fe,[i(K,{project:e.project,chapter:e.currentChapter,"is-generating":e.isGenerating,"selected-text":e.selectedText,"is-loading-suggestions":e.isLoadingSuggestions,"show-citation-helper":e.showCitationHelper,"chapter-content":e.chapterContent,"current-word-count":e.currentWordCount,"target-word-count":e.targetWordCount,onStartStreamingGeneration:R,onGetAiSuggestions:w,"onUpdate:showCitationHelper":b},null,8,["project","chapter","is-generating","selected-text","is-loading-suggestions","show-citation-helper","chapter-content","current-word-count","target-word-count"]),i(te,{"show-defense-prep":p.value,questions:e.defenseQuestions??[],"is-loading":e.isLoadingDefenseQuestions??!1,"is-generating":e.isGeneratingDefenseQuestions??!1,"chapter-context":{chapter_number:e.currentChapter.chapter_number,chapter_title:e.currentChapter.title,word_count:e.currentWordCount},"defense-watcher":{meetsThreshold:e.meetsDefenseThreshold??!1,shouldShowProgress:e.shouldShowDefenseProgress??!1,progressPercentage:e.defenseProgressPercentage??0,wordsRemaining:e.defenseWordsRemaining??0,hasTriggeredGeneration:e.hasTriggeredGeneration??!1,threshold:500,statusMessage:e.shouldShowDefenseProgress??!1?`Write ${e.defenseWordsRemaining??0} more words to generate defense questions`:"Ready to generate defense questions"},"onUpdate:showDefensePrep":D,onGenerateMore:j,onRefresh:S,onMarkHelpful:L,onHideQuestion:A},null,8,["show-defense-prep","questions","is-loading","is-generating","chapter-context","defense-watcher"]),i(Ne,{"chapter-id":e.currentChapter.id,content:e.chapterContent},null,8,["chapter-id","content"])])])]),_:1})])):_("",!0)]),_:1})]))}}),Nt=se(ze,[["__scopeId","data-v-295f60c3"]]);export{Nt as default};
