import{d as K,E as p,g as W,h as q,a as f,o as d,F as w,k as s,u as t,w as i,e as a,s as l,t as n,n as F,z as H,N as Q,c as b,O as $,y as X,M as I}from"./app-BI3B-WKV.js";import{_ as z}from"./index-BVhQ2dbN.js";import{c as Y,_,L}from"./index-G9NCJgAI.js";import{_ as Z,a as ee}from"./CardContent.vue_vue_type_script_setup_true_lang-Crb8HVKN.js";import{_ as te,a as se}from"./CardTitle.vue_vue_type_script_setup_true_lang-DyR4agyE.js";import{_ as ae,a as oe,b as re}from"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-Dx8cI0f1.js";import{_ as ie}from"./Input.vue_vue_type_script_setup_true_lang-BHHItLpI.js";import{_ as ne}from"./useTextHistory-B0VbbFoI.js";import{_ as U}from"./Separator.vue_vue_type_script_setup_true_lang-D3LZYNkd.js";import{_ as le,a as de,b as ce,c as ue,d as me,e as pe,f as fe,g as _e}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-IvPGnnA0.js";import{B as R,t as c,P as B}from"./Sonner.vue_vue_type_script_setup_true_lang-CCODHGN7.js";import{aa as N}from"./RichTextEditor-BaUnNdYI.js";import{C as ve}from"./chevron-down-DmZrO0N0.js";import{W as he}from"./wand-sparkles-PPRn2mw8.js";import{S as xe}from"./search-D3ywZ6hb.js";import{T as ye}from"./trash-2-Ou0MLSoD.js";import{C as V}from"./copy-CaM9jdPt.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=Y("HistoryIcon",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),be={class:"flex items-center gap-2"},Ce={class:"rounded-lg bg-gradient-to-r from-amber-50 to-indigo-50 dark:from-amber-950/20 dark:to-indigo-950/20 border border-amber-200/50 dark:border-amber-800/50 p-3"},ke={class:"flex items-start gap-2"},we={class:"space-y-3"},$e={class:"space-y-2"},Se={class:"text-xs font-medium text-muted-foreground flex items-center gap-1"},Ae={class:"flex gap-1"},je={class:"rounded-lg bg-muted/30 p-2"},De={class:"text-xs font-medium text-foreground mb-1"},Ee={class:"text-xs text-muted-foreground mb-2"},Fe={class:"text-xs text-muted-foreground font-mono bg-background p-2 rounded border"},He={class:"space-y-3"},Ie={class:"text-xs font-medium text-muted-foreground flex items-center gap-1"},ze={class:"flex gap-2"},Le={key:0,class:"space-y-3"},Ue={class:"flex items-center justify-between"},Re={class:"text-xs font-medium text-muted-foreground flex items-center gap-1"},Be={class:"space-y-2 pr-2"},Ne=["onClick"],Ve={class:"flex items-start justify-between gap-2"},Je={class:"flex-1 min-w-0"},Me={class:"text-xs font-medium text-foreground truncate"},Oe={class:"text-xs text-muted-foreground mt-1"},Pe={class:"flex items-center gap-2 mt-1"},Te={class:"text-xs text-muted-foreground"},Ge={class:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity"},Ke={key:0,class:"mt-3 pt-3 border-t"},We={class:"bg-muted/30 rounded p-2"},qe={class:"text-xs font-medium text-foreground mb-1"},Qe={class:"text-xs text-muted-foreground font-mono leading-relaxed"},Xe={class:"flex gap-2 mt-3"},Ye={key:1,class:"py-8 text-center"},ht=K({__name:"CitationHelper",props:{showCitationHelper:{type:Boolean},chapterContent:{}},emits:["update:showCitationHelper","insert-citation"],setup(Ze,{emit:J}){const S=J,u=p("apa"),v=p(""),h=p(!1),C=p(!1),x=p(!1),m=p([]),y=p(null),A={apa:{name:"APA Style",description:"American Psychological Association",example:"Smith, J. (2023). Research methods. Journal of Science, 15(3), 123-145."},harvard:{name:"Harvard Style",description:"Author-date referencing system",example:'Smith, J. (2023) "Research methods", Journal of Science, 15(3), pp. 123-145.'},ieee:{name:"IEEE Style",description:"Institute of Electrical and Electronics Engineers",example:'J. Smith, "Research methods," Journal of Science, vol. 15, no. 3, pp. 123-145, 2023.'}},k=W(()=>A[u.value]),M=r=>{S("update:showCitationHelper",r)},O=r=>{y.value=y.value===r?null:r},j=async()=>{if(!v.value.trim()){c.error("Please enter a URL, DOI, or search term");return}h.value=!0;try{const r=await $.post("/api/citations/generate",{input:v.value.trim()});if(r.data.success){const e=r.data.citation,o={id:e.id.toString(),title:e.title,authors:e.authors,year:e.year,journal:e.journal,url:e.url,doi:e.doi,type:e.type,style:{apa:e.style.apa,harvard:e.style.harvard,ieee:e.style.ieee},createdAt:new Date(e.created_at)};m.value.unshift(o),v.value="",c.success("Citation generated successfully!")}else c.error("Failed to generate citation")}catch(r){console.error("Failed to search citation:",r),r.response?.status===422?c.error("Invalid input format"):c.error("Failed to generate citation")}finally{h.value=!1}},D=r=>{const e=r.style[u.value];S("insert-citation",e),c.success("Citation inserted into document")},E=r=>{const e=r.style[u.value];navigator.clipboard.writeText(e),c.success("Citation copied to clipboard")},P=()=>{if(!m.value.length){c.error("No citations to clear");return}x.value=!0},T=async()=>{C.value=!0,x.value=!1;try{(await $.delete("/api/citations/clear")).data.success?(m.value=[],y.value=null,c.success("All citations cleared successfully")):c.error("Failed to clear citations")}catch(r){console.error("Failed to clear citations:",r),c.error("Failed to clear citations")}finally{C.value=!1}},G=async()=>{try{const r=await $.get("/api/citations/recent",{params:{limit:10}});r.data.success&&(m.value=r.data.citations.map(e=>({id:e.id.toString(),title:e.title,authors:e.authors,year:e.year,journal:e.journal,url:e.url,doi:e.doi,type:e.type,style:{apa:e.style.apa,harvard:e.style.harvard,ieee:e.style.ieee},createdAt:new Date(e.created_at)})))}catch(r){console.error("Failed to load recent citations:",r)}};return q(()=>{G()}),(r,e)=>(d(),f(w,null,[s(t(Z),{class:"border border-border/60 shadow-sm dark:border-border/50 dark:shadow-none transition-all duration-300 hover:shadow-md"},{default:i(()=>[s(t(ae),{open:r.showCitationHelper,"onUpdate:open":M},{default:i(()=>[s(t(oe),{class:"w-full"},{default:i(()=>[s(t(te),{class:"pb-3 transition-colors bg-muted/40 hover:bg-muted/60 dark:bg-transparent dark:hover:bg-muted/30"},{default:i(()=>[s(t(se),{class:"flex items-center justify-between text-sm"},{default:i(()=>[a("span",be,[s(t(N),{class:"h-4 w-4 text-muted-foreground"}),e[3]||(e[3]=l(" Citation Helper ",-1)),s(t(z),{variant:"secondary",class:"ml-1 text-xs"},{default:i(()=>[l(n(u.value.toUpperCase()),1)]),_:1})]),s(t(ve),{class:F(["h-4 w-4 text-muted-foreground transition-transform",r.showCitationHelper?"rotate-180":""])},null,8,["class"])]),_:1})]),_:1})]),_:1}),s(t(re),null,{default:i(()=>[s(t(ee),{class:"space-y-4 pt-0"},{default:i(()=>[a("div",Ce,[a("div",ke,[s(t(R),{class:"h-4 w-4 text-amber-600 dark:text-amber-400 mt-0.5 flex-shrink-0"}),e[4]||(e[4]=a("div",{class:"text-xs leading-relaxed"},[a("p",{class:"font-medium text-amber-900 dark:text-amber-100 mb-1"},"Smart Citation Assistant"),a("p",{class:"text-amber-700 dark:text-amber-300"},"Automatically formats citations in your preferred academic style."),a("p",{class:"mt-1 text-amber-600 dark:text-amber-400"},"ðŸ’¡ Click citations to insert them directly into your document.")],-1))])]),a("div",we,[a("div",$e,[a("h4",Se,[s(t(R),{class:"h-3 w-3"}),e[5]||(e[5]=l(" Citation Style ",-1))]),a("div",Ae,[(d(!0),f(w,null,H(Object.keys(A),o=>(d(),b(t(_),{key:o,onClick:g=>u.value=o,variant:u.value===o?"default":"outline",size:"sm",class:"text-xs flex-1"},{default:i(()=>[l(n(o.toUpperCase()),1)]),_:2},1032,["onClick","variant"]))),128))])]),a("div",je,[a("p",De,n(k.value.name),1),a("p",Ee,n(k.value.description),1),a("p",Fe,n(k.value.example),1)])]),s(t(U)),a("div",He,[a("h4",Ie,[s(t(he),{class:"h-3 w-3"}),e[6]||(e[6]=l(" Generate Citation ",-1))]),a("div",ze,[s(t(ie),{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=o=>v.value=o),placeholder:"Enter URL, DOI, or search term...",class:"text-xs",onKeyup:Q(j,["enter"]),disabled:h.value},null,8,["modelValue","disabled"]),s(t(_),{onClick:j,size:"sm",disabled:h.value||!v.value.trim()},{default:i(()=>[h.value?(d(),b(t(L),{key:0,class:"h-3 w-3 animate-spin"})):(d(),b(t(xe),{key:1,class:"h-3 w-3"}))]),_:1},8,["disabled"])]),e[7]||(e[7]=a("p",{class:"text-xs text-muted-foreground"}," ðŸ’¡ Paste a journal URL, DOI, or search for papers by keywords ",-1))]),m.value.length?(d(),f("div",Le,[s(t(U)),a("div",Ue,[a("h4",Re,[s(t(ge),{class:"h-3 w-3"}),l(" Recent Citations ("+n(m.value.length)+") ",1)]),s(t(_),{onClick:P,disabled:C.value,variant:"ghost",size:"icon",class:"h-6 w-6 hover:bg-destructive/10 hover:text-destructive"},{default:i(()=>[C.value?(d(),b(t(L),{key:0,class:"h-3 w-3 animate-spin"})):(d(),b(t(ye),{key:1,class:"h-3 w-3"}))]),_:1},8,["disabled"])]),s(t(ne),{class:"h-[300px]"},{default:i(()=>[a("div",Be,[(d(!0),f(w,null,H(m.value,o=>(d(),f("div",{key:o.id,class:"group"},[a("div",{onClick:g=>O(o.id),class:F(["cursor-pointer rounded-lg border bg-background p-3 hover:bg-muted/30 transition-colors",y.value===o.id?"ring-2 ring-primary":""])},[a("div",Ve,[a("div",Je,[a("p",Me,n(o.title),1),a("p",Oe,n(o.authors.join(", "))+" ("+n(o.year)+") ",1),a("div",Pe,[s(t(z),{variant:"outline",class:"text-xs"},{default:i(()=>[l(n(o.type),1)]),_:2},1024),a("span",Te,n(o.createdAt.toLocaleDateString()),1)])]),a("div",Ge,[s(t(_),{onClick:I(g=>D(o),["stop"]),variant:"ghost",size:"icon",class:"h-6 w-6"},{default:i(()=>[s(t(B),{class:"h-3 w-3"})]),_:2},1032,["onClick"]),s(t(_),{onClick:I(g=>E(o),["stop"]),variant:"ghost",size:"icon",class:"h-6 w-6"},{default:i(()=>[s(t(V),{class:"h-3 w-3"})]),_:2},1032,["onClick"])])]),y.value===o.id?(d(),f("div",Ke,[a("div",We,[a("p",qe,n(u.value.toUpperCase())+" Format: ",1),a("p",Qe,n(o.style[u.value]),1)]),a("div",Xe,[s(t(_),{onClick:g=>D(o),size:"sm",class:"flex-1 text-xs"},{default:i(()=>[s(t(B),{class:"mr-1 h-3 w-3"}),e[8]||(e[8]=l(" Insert ",-1))]),_:2},1032,["onClick"]),s(t(_),{onClick:g=>E(o),size:"sm",variant:"outline",class:"flex-1 text-xs"},{default:i(()=>[s(t(V),{class:"mr-1 h-3 w-3"}),e[9]||(e[9]=l(" Copy ",-1))]),_:2},1032,["onClick"])])])):X("",!0)],10,Ne)]))),128))])]),_:1})])):(d(),f("div",Ye,[s(t(N),{class:"mx-auto h-12 w-12 text-muted-foreground/30 mb-3"}),e[10]||(e[10]=a("p",{class:"text-xs text-muted-foreground mb-1"}," No citations yet ",-1)),e[11]||(e[11]=a("p",{class:"text-xs text-muted-foreground/80"}," Generate your first citation using the search above ",-1))]))]),_:1})]),_:1})]),_:1},8,["open"])]),_:1}),s(t(le),{open:x.value,"onUpdate:open":e[2]||(e[2]=o=>x.value=o)},{default:i(()=>[s(t(de),null,{default:i(()=>[s(t(ce),null,{default:i(()=>[s(t(ue),null,{default:i(()=>[...e[12]||(e[12]=[l("Clear All Citations",-1)])]),_:1}),s(t(me),null,{default:i(()=>[l(" Are you sure you want to clear all "+n(m.value.length)+" citations? This action cannot be undone and will permanently remove all citations from your library. ",1)]),_:1})]),_:1}),s(t(pe),null,{default:i(()=>[s(t(fe),{onClick:e[1]||(e[1]=o=>x.value=!1)},{default:i(()=>[...e[13]||(e[13]=[l("Cancel",-1)])]),_:1}),s(t(_e),{onClick:T,class:"bg-destructive text-destructive-foreground hover:bg-destructive/90"},{default:i(()=>[...e[14]||(e[14]=[l(" Clear All Citations ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])],64))}});export{ht as _};
