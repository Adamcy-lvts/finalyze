import{C as L,_ as O}from"./AdminLayout.vue_vue_type_script_setup_true_lang-CnmmwA-A.js";import{_ as m,a as f}from"./CardContent.vue_vue_type_script_setup_true_lang-BU1G6cs-.js";import{_ as V}from"./CardDescription.vue_vue_type_script_setup_true_lang-BjvHfFop.js";import{_ as p,a as _}from"./CardTitle.vue_vue_type_script_setup_true_lang-B6ojriqM.js";import{_ as z,S as E,D as q,C as T,a as G,b as P}from"./ChartTooltip.vue_vue_type_script_setup_true_lang-DUngdDnj.js";import{d as U,z as h,g as u,h as H,G as K,H as W,c as X,o as w,w as s,e as a,a as C,q as J,k as e,n as M,t as r,u as t,s as c,y as Q}from"./app-CvqzSedG.js";import{D as Y}from"./dollar-sign-HOOr45pH.js";import{T as Z}from"./triangle-alert-895uXHmW.js";import{A as ee}from"./activity-Bpq16yaq.js";import"./UserInfo.vue_vue_type_script_setup_true_lang-B47enV7B.js";import"./index-B2Jp-AbD.js";import"./VisuallyHidden-DB_fmpkP.js";import"./useForwardExpose-wU1_jECe.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BISjo1U_.js";import"./users-Dkm8ECkY.js";import"./chart-column-CPWMWZ7L.js";import"./list-Ce3ZmywA.js";import"./index-BWEDi_FC.js";import"./axis-DouJwEGg.js";import"./linear-C5NI_5MW.js";import"./init-Dmth1JHB.js";import"./defaultLocale-C4B-KCzX.js";import"./band-BjYQJviF.js";import"./ordinal-B-SEvE7q.js";const te={class:"space-y-6"},se={class:"flex justify-end"},oe={key:0},ae={key:1},le={class:"flex items-center justify-between"},re={class:"text-sm text-muted-foreground"},ne={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-4"},ie={class:"text-2xl font-bold"},de={class:"text-xs text-muted-foreground mt-1"},ue={class:"text-2xl font-bold"},ce={class:"text-xs text-muted-foreground mt-1"},me={class:"text-2xl font-bold"},fe={class:"text-xs text-muted-foreground mt-1"},pe={class:"text-2xl font-bold"},_e={class:"text-xs text-muted-foreground mt-1"},ge={class:"grid gap-6 lg:grid-cols-2"},Ee=U({__name:"Index",props:{metrics:{},usageByModel:{},billingSnapshot:{}},setup(j){const k=j,S={liability_tokens:0,wallet_tokens:0,avg_daily_tokens_7:0,avg_daily_tokens_30:0,runway_days:null,status:"safe"},n=h(k.metrics??S),d=h(k.billingSnapshot??null),g=h(k.usageByModel??[]),x=u(()=>n.value?.status??"safe"),v=h(!1),$=u(()=>n.value?.liability_tokens??0),I=u(()=>n.value?.wallet_tokens??0),N=u(()=>n.value?.avg_daily_tokens_7??0),A=u(()=>!n.value||n.value.runway_days===null?"∞":`${n.value.runway_days} days`),R=u(()=>g.value?.length?g.value.map(l=>({model:l.model,input:l.input,output:l.output})):[]),b={input:{label:"Input Tokens",color:"hsl(var(--primary))"},output:{label:"Output Tokens",color:"hsl(var(--chart-2))"}},y=l=>l==null?"0":Number(l).toLocaleString();let B=null;H(()=>{B=window.Echo?.private("admin.ai"),B?.listen(".ai.provisioning.updated",l=>{l.metrics&&(n.value=l.metrics),l.snapshot&&(d.value=l.snapshot),l.usageByModel&&(g.value=l.usageByModel)})}),K(()=>{B?.stopListening(".ai.provisioning.updated")});const D=async()=>{try{v.value=!0;const o=await(await fetch(Q("admin.ai.refresh"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}})).json();o?.metrics&&(n.value=o.metrics),o?.snapshot&&(d.value=o.snapshot),o?.usageByModel&&(g.value=o.usageByModel)}catch(l){console.error("Failed to refresh AI metrics",l)}finally{v.value=!1}};return(l,o)=>{const F=W("Button");return w(),X(O,null,{title:s(()=>[...o[0]||(o[0]=[a("div",{class:"flex flex-col"},[a("h2",{class:"text-2xl font-bold tracking-tight text-foreground"},"AI Monitoring"),a("p",{class:"text-muted-foreground text-sm"},"Real-time insights into AI generation performance.")],-1)])]),default:s(()=>[a("div",te,[a("div",se,[e(F,{size:"sm",disabled:v.value,onClick:D},{default:s(()=>[v.value?(w(),C("span",oe,"Refreshing...")):(w(),C("span",ae,"Refresh now"))]),_:1},8,["disabled"])]),x.value!=="safe"?(w(),C("div",{key:0,class:M(["rounded-lg border p-4",x.value==="critical"?"border-rose-500/50 bg-rose-500/10":"border-amber-500/50 bg-amber-500/10"])},[a("div",le,[a("div",null,[a("p",{class:M(["text-sm font-semibold",x.value==="critical"?"text-rose-600":"text-amber-600"])},r(x.value==="critical"?"Critical OpenAI Balance":"Low OpenAI Balance"),3),a("p",re," Available $"+r(d.value?.available_usd?.toFixed(2)??"0.00")+" · Liability "+r(y($.value))+" tokens · Runway "+r(A.value),1)])])],2)):J("",!0),a("div",ne,[e(t(m),{class:"bg-card text-card-foreground border-border/50 shadow-sm"},{default:s(()=>[e(t(p),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[e(t(_),{class:"text-sm font-medium text-muted-foreground"},{default:s(()=>[...o[1]||(o[1]=[c("OpenAI Available",-1)])]),_:1}),e(t(Y),{class:"h-4 w-4 text-primary"})]),_:1}),e(t(f),null,{default:s(()=>[a("div",ie,"$"+r(d.value?.available_usd?.toFixed(2)??"0.00"),1),a("p",de,"Granted $"+r(d.value?.granted_usd?.toFixed(2)??"0.00"),1)]),_:1})]),_:1}),e(t(m),{class:"bg-card text-card-foreground border-border/50 shadow-sm"},{default:s(()=>[e(t(p),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[e(t(_),{class:"text-sm font-medium text-muted-foreground"},{default:s(()=>[...o[2]||(o[2]=[c("Liability (tokens)",-1)])]),_:1}),e(t(L),{class:"h-4 w-4 text-emerald-500"})]),_:1}),e(t(f),null,{default:s(()=>[a("div",ue,r(y($.value)),1),a("p",ce,"Wallet "+r(y(I.value))+" tokens",1)]),_:1})]),_:1}),e(t(m),{class:"bg-card text-card-foreground border-border/50 shadow-sm"},{default:s(()=>[e(t(p),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[e(t(_),{class:"text-sm font-medium text-muted-foreground"},{default:s(()=>[...o[3]||(o[3]=[c("Runway",-1)])]),_:1}),e(t(Z),{class:"h-4 w-4 text-amber-500"})]),_:1}),e(t(f),null,{default:s(()=>[a("div",me,r(A.value),1),a("p",fe,"Avg burn (7d): "+r(y(N.value))+" tokens/day",1)]),_:1})]),_:1}),e(t(m),{class:"bg-card text-card-foreground border-border/50 shadow-sm"},{default:s(()=>[e(t(p),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[e(t(_),{class:"text-sm font-medium text-muted-foreground"},{default:s(()=>[...o[4]||(o[4]=[c("Billing Period",-1)])]),_:1}),e(t(ee),{class:"h-4 w-4 text-rose-500"})]),_:1}),e(t(f),null,{default:s(()=>[a("div",pe," $"+r(d.value?.used_usd?.toFixed(2)??"0.00")+" used ",1),a("p",_e,r(d.value?.period_start??"—")+" → "+r(d.value?.period_end??"—"),1)]),_:1})]),_:1})]),a("div",ge,[e(t(m),{class:"bg-card text-card-foreground border-border/50 shadow-sm"},{default:s(()=>[e(t(p),null,{default:s(()=>[e(t(_),{class:"text-base font-semibold"},{default:s(()=>[...o[5]||(o[5]=[c("Token Usage",-1)])]),_:1}),e(t(V),null,{default:s(()=>[...o[6]||(o[6]=[c("Total tokens consumed per model",-1)])]),_:1})]),_:1}),e(t(f),{class:"pl-0"},{default:s(()=>[e(t(z),{config:b,class:"h-[300px] w-full"},{default:s(()=>[e(t(E),{data:R.value,height:300,margin:{top:10,right:10,bottom:0,left:10}},{default:s(()=>[e(t(q),{x:i=>i.model,y:[i=>i.input,i=>i.output],color:[b.input.color,b.output.color],"rounded-corners":4,"bar-padding":.2},null,8,["x","y","color"]),e(t(T),{type:"x",x:i=>i.model,"grid-line":!1,"domain-line":!1,color:"#888888"},null,8,["x"]),e(t(T),{type:"y","grid-line":!0,"domain-line":!1,"tick-line":!1,"tick-format":i=>i/1e3+"k",color:"#888888"},null,8,["tick-format"]),e(t(G)),e(t(P),{config:b,class:"mt-4 justify-center"})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1})])])]),_:1})}}});export{Ee as default};
