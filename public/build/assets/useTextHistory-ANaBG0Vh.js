import{c as U,_ as L}from"./index-hNHpr7NI.js";import{ay as ye,az as _e,aA as be,aB as we,aC as ke,aD as Ce,aE as $e,aF as je,aG as Pe,aH as De,aI as Le,aJ as Se,aK as Ee,aL as Fe,ax as te,aM as se}from"./RichTextEditor-WAwzvvzE.js";import{d as Q,B as E,I as ue,f as pe,y as Me,c as C,o as f,K as a,u as t,b as B,N as z,w as l,F as s,M as m,H as u,n as M,U as I,aa as Te,a as T,a7 as V,L as H,ab as O,P as J}from"./app-B7lfR3N7.js";import{_ as Ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as A}from"./index-DbACZKH5.js";import{_ as Z,a as X}from"./CardContent.vue_vue_type_script_setup_true_lang-DAfafdR8.js";import{_ as me,a as fe}from"./CardTitle.vue_vue_type_script_setup_true_lang-jCIxOk9Z.js";import{_ as he,a as ge,b as ve}from"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-B4m8NMrt.js";import{_ as Ue}from"./Input.vue_vue_type_script_setup_true_lang-B2bUrNCz.js";import{a as Y}from"./ScrollArea.vue_vue_type_script_setup_true_lang-CNqET2oE.js";import{_ as N}from"./Separator.vue_vue_type_script_setup_true_lang-CZ0GVMao.js";import{H as ze,_ as Re,a as He,b as Ie,c as We,d as Be,e as Ge,f as Oe,g as qe}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-BMYPcnK9.js";import{B as ae,t as x}from"./index-Biby0k-U.js";import{C as ee}from"./chevron-down-BPT4WFf6.js";import{L as K}from"./loader-circle-Dz2exCFl.js";import{S as Ne}from"./search-D_imah52.js";import{T as Qe}from"./trash-2-Bhfx4tyy.js";import{P as oe}from"./plus-DuYvohtx.js";import{_ as Ve,a as Je}from"./index-0f1FzGZ_.js";import{_ as Ke}from"./Progress.vue_vue_type_script_setup_true_lang-CIKUULOB.js";import{_ as Ze}from"./Switch.vue_vue_type_script_setup_true_lang-DpefNTv3.js";import{L as re}from"./lightbulb-DR6-5oN3.js";import{R as ne}from"./refresh-cw-BGOjP4Ib.js";import{D as q}from"./download-BsY-FnB_.js";import{X as Xe}from"./x-BCLiL62L.js";import{C as Ye}from"./circle-alert-CGSIlvqp.js";import{_ as et}from"./Checkbox.vue_vue_type_script_setup_true_lang-BIA06DAf.js";import{_ as tt,d as st,a as at,b as ot,c as rt}from"./DialogTitle.vue_vue_type_script_setup_true_lang-CCURHRDg.js";import{_ as nt}from"./DialogFooter.vue_vue_type_script_setup_true_lang-CQK-JmRK.js";import{e as lt,_ as it,a as dt,b as le,c as ie,d as ct}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BRhN9x2k.js";import{F as de}from"./file-text-eVYdE6sA.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=U("BookCheckIcon",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"m9 9.5 2 2 4-4",key:"1dth82"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=U("CircleHelpIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=U("FileDownIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=U("Maximize2Icon",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=U("Minimize2Icon",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=U("PanelRightCloseIcon",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=U("PanelRightOpenIcon",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m10 15-3-3 3-3",key:"1pgupc"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=U("ShieldIcon",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=U("ThumbsDownIcon",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=U("ThumbsUpIcon",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=U("WandSparklesIcon",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),ft=Q({__name:"RichTextViewer",props:{content:{},showFontControls:{type:Boolean,default:!0}},setup(R){const j=ye(Fe),y=R,i=d=>d?(d=d.replace(/```mermaid\n?([\s\S]*?)```/g,(b,c)=>{const _=c.trim();return`<div data-mermaid data-mermaid-code="${_.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}" data-view-mode="diagram"><pre><code class="language-mermaid">${_}</code></pre></div>`}),d=d.replace(/``mermaid\n?([\s\S]*?)``/g,(b,c)=>{const _=c.trim();return`<div data-mermaid data-mermaid-code="${_.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}" data-view-mode="diagram"><pre><code class="language-mermaid">${_}</code></pre></div>`}),d=d.replace(/`mermaid\n([\s\S]*?)`/g,(b,c)=>{const _=c.trim();return`<div data-mermaid data-mermaid-code="${_.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}" data-view-mode="diagram"><pre><code class="language-mermaid">${_}</code></pre></div>`}),d):"",D=d=>d?(d=d.replace(/```(\w+)\n?([\s\S]*?)```/g,(b,c,_)=>`<pre><code class="language-${c}">${_.trim()}</code></pre>`),d=d.replace(/```\n?([\s\S]*?)```/g,(b,c)=>`<pre><code>${c.trim()}</code></pre>`),d):"",P=d=>{if(!d)return"";const b=d.split(`
`);let c=[],_=0;for(;_<b.length;){const o=b[_];if(o.includes("|")){const e=S(b,_);if(e.html){c.push(e.html),_=e.nextIndex;continue}}c.push(o),_++}return c.join(`
`)},S=(d,b)=>{let c=d[b];if(!c||!c.includes("|"))return{html:null,nextIndex:b+1};const _=c.split("|").map(p=>p.trim()).filter(p=>p.length>0);if(_.length===0)return{html:null,nextIndex:b+1};const o=d[b+1];if(!o||!o.includes("|")||!o.includes("-"))return{html:null,nextIndex:b+1};let e=[],r=b+2;for(;r<d.length;){const p=d[r];if(!p||!p.includes("|"))break;const w=p.split("|").map(k=>k.trim()).filter(k=>k.length>0);w.length>0&&e.push(w),r++}let h='<div class="tableWrapper"><table>';return h+="<thead><tr>",_.forEach(p=>{h+=`<th>${p}</th>`}),h+="</tr></thead>",e.length>0&&(h+="<tbody>",e.forEach(p=>{h+="<tr>";for(let w=0;w<_.length;w++){const k=p[w]||"";h+=`<td>${k}</td>`}h+="</tr>"}),h+="</tbody>"),h+="</table></div>",{html:h,nextIndex:r}},F=d=>{if(!d)return"";if(d.includes("<p>")||d.includes("<h1>")||d.includes("<h2>")||d.includes("<div>")){let o=i(d);return o=D(o),o}let c=d;return c=i(c),c=D(c),c=c.replace(/^#### (.*$)/gim,"<h4>$1</h4>"),c=c.replace(/^### (.*$)/gim,"<h3>$1</h3>"),c=c.replace(/^## (.*$)/gim,"<h2>$1</h2>"),c=c.replace(/^# (.*$)/gim,"<h1>$1</h1>"),c=c.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),c=c.replace(new RegExp("(?<!\\*)\\*([^*\\n]+?)\\*(?!\\*)","g"),"<em>$1</em>"),c=c.replace(/`([^`]+)`/g,"<code>$1</code>"),c=P(c),c.split(/\n\s*\n/).filter(o=>o.trim()).map(o=>{const e=o.trim();if(e.startsWith("<h1>")||e.startsWith("<h2>")||e.startsWith("<h3>")||e.startsWith("<h4>"))return e;if(e.includes(`
`)){const h=e.split(`
`).map(k=>k.trim()).filter(k=>k),p=h.some(k=>k.match(/^\d+\.\s/)),w=h.some(k=>k.match(/^[-*]\s/));if(p||w){const k=h.map(v=>v.match(/^\d+\.\s/)?`<li>${v.replace(/^\d+\.\s/,"")}</li>`:v.match(/^[-*]\s/)?`<li>${v.replace(/^[-*]\s/,"")}</li>`:v);let g=[],n="";for(const v of k)v.startsWith("<li>")?(n&&g.push(n),n=v):n&&(n=n.replace("</li>",` ${v}</li>`));return n&&g.push(n),p?`<ol>${g.join("")}</ol>`:`<ul>${g.join("")}</ul>`}}return`<p>${e.replace(/\n/g,"<br>")}</p>`}).join("")},$=_e({content:F(y.content),editable:!1,extensions:[be.configure({heading:{levels:[1,2,3]},codeBlock:!1}),we.configure({lowlight:j,HTMLAttributes:{class:"code-block-highlighted"}}),ke,Ce,$e,je.configure({resizable:!0}),Pe,De,Le,Se],editorProps:{attributes:{class:"prose prose-sm dark:prose-invert max-w-none focus:outline-none"}}});return E("12"),ue(()=>{setTimeout(()=>{$.value&&$.value.chain().selectAll().setFontSize("12pt").run()},100)}),pe(()=>y.content,d=>{if($.value&&$.value.getHTML()!==d){const b=F(d);$.value.commands.setContent(b)}}),Me(()=>{$.value&&$.value.destroy()}),(d,b)=>(f(),C("div",null,[a(t(Ee),{editor:t($)},null,8,["editor"])]))}}),Ua=Ae(ft,[["__scopeId","data-v-3b560c28"]]),ht={class:"flex items-center gap-2"},gt={class:"rounded-lg bg-gradient-to-r from-amber-50 to-indigo-50 dark:from-amber-950/20 dark:to-indigo-950/20 border border-amber-200/50 dark:border-amber-800/50 p-3"},vt={class:"flex items-start gap-2"},xt={class:"space-y-3"},yt={class:"space-y-2"},_t={class:"text-xs font-medium text-muted-foreground flex items-center gap-1"},bt={class:"flex gap-1"},wt={class:"rounded-lg bg-muted/30 p-2"},kt={class:"text-xs font-medium text-foreground mb-1"},Ct={class:"text-xs text-muted-foreground mb-2"},$t={class:"text-xs text-muted-foreground font-mono bg-background p-2 rounded border"},jt={class:"space-y-3"},Pt={class:"text-xs font-medium text-muted-foreground flex items-center gap-1"},Dt={class:"flex gap-2"},Lt={key:0,class:"space-y-3"},St={class:"flex items-center justify-between"},Et={class:"text-xs font-medium text-muted-foreground flex items-center gap-1"},Ft={class:"space-y-2 pr-2"},Mt=["onClick"],Tt={class:"flex items-start justify-between gap-2"},At={class:"flex-1 min-w-0"},Ut={class:"text-xs font-medium text-foreground truncate"},zt={class:"text-xs text-muted-foreground mt-1"},Rt={class:"flex items-center gap-2 mt-1"},Ht={class:"text-xs text-muted-foreground"},It={class:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity"},Wt={key:0,class:"mt-3 pt-3 border-t"},Bt={class:"bg-muted/30 rounded p-2"},Gt={class:"text-xs font-medium text-foreground mb-1"},Ot={class:"text-xs text-muted-foreground font-mono leading-relaxed"},qt={class:"flex gap-2 mt-3"},Nt={key:1,class:"py-8 text-center"},za=Q({__name:"CitationHelper",props:{showCitationHelper:{type:Boolean},chapterContent:{}},emits:["update:showCitationHelper","insert-citation"],setup(R,{emit:j}){const y=j,i=E("apa"),D=E(""),P=E(!1),S=E(!1),F=E(!1),$=E([]),d=E(null),b={apa:{name:"APA Style",description:"American Psychological Association",example:"Smith, J. (2023). Research methods. Journal of Science, 15(3), 123-145."},harvard:{name:"Harvard Style",description:"Author-date referencing system",example:'Smith, J. (2023) "Research methods", Journal of Science, 15(3), pp. 123-145.'},ieee:{name:"IEEE Style",description:"Institute of Electrical and Electronics Engineers",example:'J. Smith, "Research methods," Journal of Science, vol. 15, no. 3, pp. 123-145, 2023.'}},c=B(()=>b[i.value]),_=g=>{y("update:showCitationHelper",g)},o=g=>{d.value=d.value===g?null:g},e=async()=>{if(!D.value.trim()){x.error("Please enter a URL, DOI, or search term");return}P.value=!0;try{const g=await V.post("/api/citations/generate",{input:D.value.trim()});if(g.data.success){const n=g.data.citation,v={id:n.id.toString(),title:n.title,authors:n.authors,year:n.year,journal:n.journal,url:n.url,doi:n.doi,type:n.type,style:{apa:n.style.apa,harvard:n.style.harvard,ieee:n.style.ieee},createdAt:new Date(n.created_at)};$.value.unshift(v),D.value="",x.success("Citation generated successfully!")}else x.error("Failed to generate citation")}catch(g){console.error("Failed to search citation:",g),g.response?.status===422?x.error("Invalid input format"):x.error("Failed to generate citation")}finally{P.value=!1}},r=g=>{const n=g.style[i.value];y("insert-citation",n),x.success("Citation inserted into document")},h=g=>{const n=g.style[i.value];navigator.clipboard.writeText(n),x.success("Citation copied to clipboard")},p=()=>{if(!$.value.length){x.error("No citations to clear");return}F.value=!0},w=async()=>{S.value=!0,F.value=!1;try{(await V.delete("/api/citations/clear")).data.success?($.value=[],d.value=null,x.success("All citations cleared successfully")):x.error("Failed to clear citations")}catch(g){console.error("Failed to clear citations:",g),x.error("Failed to clear citations")}finally{S.value=!1}},k=async()=>{try{const g=await V.get("/api/citations/recent",{params:{limit:10}});g.data.success&&($.value=g.data.citations.map(n=>({id:n.id.toString(),title:n.title,authors:n.authors,year:n.year,journal:n.journal,url:n.url,doi:n.doi,type:n.type,style:{apa:n.style.apa,harvard:n.style.harvard,ieee:n.style.ieee},createdAt:new Date(n.created_at)})))}catch(g){console.error("Failed to load recent citations:",g)}};return ue(()=>{k()}),(g,n)=>(f(),C(z,null,[a(t(Z),{class:"border border-border/60 shadow-sm dark:border-border/50 dark:shadow-none transition-all duration-300 hover:shadow-md"},{default:l(()=>[a(t(he),{open:g.showCitationHelper,"onUpdate:open":_},{default:l(()=>[a(t(ge),{class:"w-full"},{default:l(()=>[a(t(me),{class:"pb-3 transition-colors bg-muted/40 hover:bg-muted/60 dark:bg-transparent dark:hover:bg-muted/30"},{default:l(()=>[a(t(fe),{class:"flex items-center justify-between text-sm"},{default:l(()=>[s("span",ht,[a(t(te),{class:"h-4 w-4 text-muted-foreground"}),n[3]||(n[3]=m(" Citation Helper ",-1)),a(t(A),{variant:"secondary",class:"ml-1 text-xs"},{default:l(()=>[m(u(i.value.toUpperCase()),1)]),_:1})]),a(t(ee),{class:M(["h-4 w-4 text-muted-foreground transition-transform",g.showCitationHelper?"rotate-180":""])},null,8,["class"])]),_:1})]),_:1})]),_:1}),a(t(ve),null,{default:l(()=>[a(t(X),{class:"space-y-4 pt-0"},{default:l(()=>[s("div",gt,[s("div",vt,[a(t(ae),{class:"h-4 w-4 text-amber-600 dark:text-amber-400 mt-0.5 flex-shrink-0"}),n[4]||(n[4]=s("div",{class:"text-xs leading-relaxed"},[s("p",{class:"font-medium text-amber-900 dark:text-amber-100 mb-1"},"Smart Citation Assistant"),s("p",{class:"text-amber-700 dark:text-amber-300"},"Automatically formats citations in your preferred academic style."),s("p",{class:"mt-1 text-amber-600 dark:text-amber-400"},"ðŸ’¡ Click citations to insert them directly into your document.")],-1))])]),s("div",xt,[s("div",yt,[s("h4",_t,[a(t(ae),{class:"h-3 w-3"}),n[5]||(n[5]=m(" Citation Style ",-1))]),s("div",bt,[(f(!0),C(z,null,I(Object.keys(b),v=>(f(),T(t(L),{key:v,onClick:G=>i.value=v,variant:i.value===v?"default":"outline",size:"sm",class:"text-xs flex-1"},{default:l(()=>[m(u(v.toUpperCase()),1)]),_:2},1032,["onClick","variant"]))),128))])]),s("div",wt,[s("p",kt,u(c.value.name),1),s("p",Ct,u(c.value.description),1),s("p",$t,u(c.value.example),1)])]),a(t(N)),s("div",jt,[s("h4",Pt,[a(t(xe),{class:"h-3 w-3"}),n[6]||(n[6]=m(" Generate Citation ",-1))]),s("div",Dt,[a(t(Ue),{modelValue:D.value,"onUpdate:modelValue":n[0]||(n[0]=v=>D.value=v),placeholder:"Enter URL, DOI, or search term...",class:"text-xs",onKeyup:Te(e,["enter"]),disabled:P.value},null,8,["modelValue","disabled"]),a(t(L),{onClick:e,size:"sm",disabled:P.value||!D.value.trim()},{default:l(()=>[P.value?(f(),T(t(K),{key:0,class:"h-3 w-3 animate-spin"})):(f(),T(t(Ne),{key:1,class:"h-3 w-3"}))]),_:1},8,["disabled"])]),n[7]||(n[7]=s("p",{class:"text-xs text-muted-foreground"}," ðŸ’¡ Paste a journal URL, DOI, or search for papers by keywords ",-1))]),$.value.length?(f(),C("div",Lt,[a(t(N)),s("div",St,[s("h4",Et,[a(t(ze),{class:"h-3 w-3"}),m(" Recent Citations ("+u($.value.length)+") ",1)]),a(t(L),{onClick:p,disabled:S.value,variant:"ghost",size:"icon",class:"h-6 w-6 hover:bg-destructive/10 hover:text-destructive"},{default:l(()=>[S.value?(f(),T(t(K),{key:0,class:"h-3 w-3 animate-spin"})):(f(),T(t(Qe),{key:1,class:"h-3 w-3"}))]),_:1},8,["disabled"])]),a(t(Y),{class:"h-[300px]"},{default:l(()=>[s("div",Ft,[(f(!0),C(z,null,I($.value,v=>(f(),C("div",{key:v.id,class:"group"},[s("div",{onClick:G=>o(v.id),class:M(["cursor-pointer rounded-lg border bg-background p-3 hover:bg-muted/30 transition-colors",d.value===v.id?"ring-2 ring-primary":""])},[s("div",Tt,[s("div",At,[s("p",Ut,u(v.title),1),s("p",zt,u(v.authors.join(", "))+" ("+u(v.year)+") ",1),s("div",Rt,[a(t(A),{variant:"outline",class:"text-xs"},{default:l(()=>[m(u(v.type),1)]),_:2},1024),s("span",Ht,u(v.createdAt.toLocaleDateString()),1)])]),s("div",It,[a(t(L),{onClick:O(G=>r(v),["stop"]),variant:"ghost",size:"icon",class:"h-6 w-6"},{default:l(()=>[a(t(oe),{class:"h-3 w-3"})]),_:2},1032,["onClick"]),a(t(L),{onClick:O(G=>h(v),["stop"]),variant:"ghost",size:"icon",class:"h-6 w-6"},{default:l(()=>[a(t(se),{class:"h-3 w-3"})]),_:2},1032,["onClick"])])]),d.value===v.id?(f(),C("div",Wt,[s("div",Bt,[s("p",Gt,u(i.value.toUpperCase())+" Format: ",1),s("p",Ot,u(v.style[i.value]),1)]),s("div",qt,[a(t(L),{onClick:G=>r(v),size:"sm",class:"flex-1 text-xs"},{default:l(()=>[a(t(oe),{class:"mr-1 h-3 w-3"}),n[8]||(n[8]=m(" Insert ",-1))]),_:2},1032,["onClick"]),a(t(L),{onClick:G=>h(v),size:"sm",variant:"outline",class:"flex-1 text-xs"},{default:l(()=>[a(t(se),{class:"mr-1 h-3 w-3"}),n[9]||(n[9]=m(" Copy ",-1))]),_:2},1032,["onClick"])])])):H("",!0)],10,Mt)]))),128))])]),_:1})])):(f(),C("div",Nt,[a(t(te),{class:"mx-auto h-12 w-12 text-muted-foreground/30 mb-3"}),n[10]||(n[10]=s("p",{class:"text-xs text-muted-foreground mb-1"}," No citations yet ",-1)),n[11]||(n[11]=s("p",{class:"text-xs text-muted-foreground/80"}," Generate your first citation using the search above ",-1))]))]),_:1})]),_:1})]),_:1},8,["open"])]),_:1}),a(t(Re),{open:F.value,"onUpdate:open":n[2]||(n[2]=v=>F.value=v)},{default:l(()=>[a(t(He),null,{default:l(()=>[a(t(Ie),null,{default:l(()=>[a(t(We),null,{default:l(()=>[...n[12]||(n[12]=[m("Clear All Citations",-1)])]),_:1}),a(t(Be),null,{default:l(()=>[m(" Are you sure you want to clear all "+u($.value.length)+" citations? This action cannot be undone and will permanently remove all citations from your library. ",1)]),_:1})]),_:1}),a(t(Ge),null,{default:l(()=>[a(t(Oe),{onClick:n[1]||(n[1]=v=>F.value=!1)},{default:l(()=>[...n[13]||(n[13]=[m("Cancel",-1)])]),_:1}),a(t(qe),{onClick:w,class:"bg-destructive text-destructive-foreground hover:bg-destructive/90"},{default:l(()=>[...n[14]||(n[14]=[m(" Clear All Citations ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])],64))}}),Qt={class:"flex items-center gap-2"},Vt={class:"space-y-3 p-3 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg dark:from-blue-950/30 dark:to-indigo-950/30 dark:border-blue-800"},Jt={class:"flex items-center justify-center gap-2"},Kt={class:"text-center"},Zt={class:"text-xs text-blue-600 dark:text-blue-400"},Xt={class:"flex items-center justify-between rounded-md border border-dashed border-border/60 px-3 py-2 bg-muted/30"},Yt={class:"flex flex-col text-xs text-muted-foreground"},es={class:"flex items-center gap-2"},ts={class:"text-[11px] text-muted-foreground"},ss={key:0,class:"py-8"},as={class:"flex flex-col items-center justify-center space-y-2"},os={class:"text-xs text-muted-foreground text-center"},rs={class:"space-y-3"},ns={class:"space-y-2"},ls={class:"text-xs font-medium text-muted-foreground flex items-center gap-1"},is={class:"flex gap-1 flex-wrap"},ds={key:0,class:"space-y-2"},cs={class:"text-xs font-medium text-muted-foreground flex items-center gap-1"},us={class:"flex flex-wrap gap-1"},ps={class:"space-y-3 pr-3"},ms={class:"absolute top-2 left-2 opacity-60 group-hover:opacity-100 transition-opacity"},fs={class:"flex items-start justify-between gap-3"},hs={class:"flex-1 space-y-2"},gs={class:"flex items-center gap-2"},vs={class:"text-xs font-bold text-primary bg-primary/10 px-2 py-0.5 rounded-full"},xs={class:"font-medium text-foreground leading-relaxed"},ys={class:"flex items-center gap-1 opacity-70 group-hover:opacity-100 transition-opacity"},_s={key:0,class:"mt-4 space-y-4 border-t border-dashed pt-4 animate-in slide-in-from-top-2 duration-200"},bs={class:"bg-muted/30 rounded-lg p-3 space-y-2"},ws={class:"flex items-center gap-2"},ks={class:"text-sm text-muted-foreground leading-relaxed pl-6"},Cs={key:0,class:"bg-primary/5 rounded-lg p-3 space-y-2"},$s={class:"flex items-center gap-2"},js={class:"space-y-1.5 pl-6"},Ps={class:"flex items-center justify-between text-xs text-muted-foreground/70 border-t border-dashed pt-2"},Ds={class:"flex items-center gap-1"},Ls={key:2,class:"py-12 text-center"},Ss={key:0,class:"space-y-4"},Es={class:"relative"},Fs={class:"absolute inset-0 flex items-center justify-center opacity-10"},Ms={class:"relative"},Ts={class:"text-xs text-muted-foreground mb-1"},As={class:"max-w-md mx-auto space-y-2"},Us={class:"flex justify-between text-xs text-muted-foreground"},zs={class:"font-medium"},Rs={key:1,class:"relative"},Hs={class:"absolute inset-0 flex items-center justify-center opacity-10"},Is={class:"relative"},Ws={class:"grid grid-cols-2 gap-3"},Ra=Q({__name:"DefensePreparationPanel",props:{showDefensePrep:{type:Boolean,default:!0},questions:{},isLoading:{type:Boolean},isGenerating:{type:Boolean},chapterContext:{},defenseWatcher:{},autoGenerateEnabled:{type:Boolean,default:!1}},emits:["update:showDefensePrep","generate-more","refresh","mark-helpful","hide-question","toggle-auto-generate"],setup(R,{emit:j}){const y=R,i=j,D=E("all"),P=E("all"),S=E(null),F=B(()=>{let o=[...y.questions];return D.value!=="all"&&(o=o.filter(e=>e.difficulty===D.value)),P.value!=="all"&&(o=o.filter(e=>e.category===P.value)),o.slice(0,5)}),$=B(()=>{const o=new Set(y.questions.map(e=>e.category));return Array.from(o)}),d={easy:"text-green-700 bg-green-100 border-green-300 hover:bg-green-200 transition-colors",medium:"text-amber-700 bg-amber-100 border-amber-300 hover:bg-amber-200 transition-colors",hard:"text-red-700 bg-red-100 border-red-300 hover:bg-red-200 transition-colors"},b=o=>{i("update:showDefensePrep",o)},c=o=>{S.value=S.value===o?null:o},_=()=>{const o=F.value.map((p,w)=>`Q${w+1}: ${p.question}

Suggested Answer: ${p.suggested_answer}

Key Points:
${p.key_points.map(k=>`â€¢ ${k}`).join(`
`)}

---
`).join(`
`),e=new Blob([o],{type:"text/plain"}),r=URL.createObjectURL(e),h=document.createElement("a");h.href=r,h.download=`defense-questions-chapter-${y.chapterContext.chapter_number}.txt`,h.click(),URL.revokeObjectURL(r)};return pe(()=>y.questions,()=>{S.value=null}),(o,e)=>(f(),T(t(Z),{class:"border border-border/60 shadow-sm dark:border-border/50 dark:shadow-none transition-all duration-300 hover:shadow-md"},{default:l(()=>[a(t(he),{open:o.showDefensePrep,"onUpdate:open":b},{default:l(()=>[a(t(ge),{class:"w-full"},{default:l(()=>[a(t(me),{class:"pb-3 transition-colors bg-muted/40 hover:bg-muted/60 dark:bg-transparent dark:hover:bg-muted/30"},{default:l(()=>[a(t(fe),{class:"flex items-center justify-between text-sm"},{default:l(()=>[s("span",Qt,[a(t(W),{class:"h-4 w-4 text-muted-foreground"}),e[4]||(e[4]=m(" Defense Preparation ",-1)),a(t(A),{variant:"secondary",class:"ml-1 text-xs"},{default:l(()=>[m(" Ch. "+u(o.chapterContext.chapter_number),1)]),_:1}),o.questions.length?(f(),T(t(A),{key:0,variant:"outline",class:"ml-1 text-xs"},{default:l(()=>[m(u(o.questions.length)+" questions ",1)]),_:1})):H("",!0)]),a(t(ee),{class:M(["h-4 w-4 text-muted-foreground transition-transform",o.showDefensePrep?"rotate-180":""])},null,8,["class"])]),_:1})]),_:1})]),_:1}),a(t(ve),null,{default:l(()=>[a(t(X),{class:"space-y-4 pt-0"},{default:l(()=>[s("div",Vt,[s("div",Jt,[a(t(W),{class:"h-4 w-4 text-blue-600 flex-shrink-0"}),s("div",Kt,[e[5]||(e[5]=s("div",{class:"text-sm font-medium text-blue-800 dark:text-blue-300"},"AI-Powered Defense Preparation",-1)),s("div",Zt,"Generate practice questions tailored to Chapter "+u(o.chapterContext.chapter_number)+" content",1)])]),e[6]||(e[6]=s("div",{class:"text-center"},[s("p",{class:"text-xs text-blue-700 dark:text-blue-300"},'ðŸ’¡ Click "Generate Questions" below to create personalized defense questions')],-1))]),s("div",Xt,[s("div",Yt,[e[7]||(e[7]=s("span",{class:"font-semibold text-foreground"},"Generation Mode",-1)),s("span",null,u(o.autoGenerateEnabled?"Auto generate when ready":"Manual - click to generate"),1)]),s("div",es,[s("span",ts,u(o.autoGenerateEnabled?"Auto":"Manual"),1),a(t(Ze),{checked:o.autoGenerateEnabled,"onUpdate:checked":e[0]||(e[0]=r=>i("toggle-auto-generate",r))},null,8,["checked"])])]),o.isLoading&&!o.questions.length?(f(),C("div",ss,[s("div",as,[a(t(K),{class:"h-8 w-8 animate-spin text-muted-foreground"}),s("p",os,[m(" Analyzing Chapter "+u(o.chapterContext.chapter_number)+" content",1),e[8]||(e[8]=s("br",null,null,-1)),e[9]||(e[9]=m(" to generate defense questions... ",-1))])])])):o.questions.length?(f(),C(z,{key:1},[s("div",rs,[s("div",ns,[s("h4",ls,[a(t(ce),{class:"h-3 w-3"}),e[10]||(e[10]=m(" Filter by Difficulty ",-1))]),s("div",is,[(f(),C(z,null,I(["all","easy","medium","hard"],r=>a(t(A),{key:r,variant:D.value===r?"default":"secondary",onClick:h=>D.value=r,class:"cursor-pointer text-xs capitalize hover:scale-105 transition-all duration-200 hover:shadow-sm"},{default:l(()=>[m(u(r==="all"?"All Levels":r),1)]),_:2},1032,["variant","onClick"])),64))])]),$.value.length>1?(f(),C("div",ds,[s("h4",cs,[a(t(re),{class:"h-3 w-3"}),e[11]||(e[11]=m(" Filter by Topic ",-1))]),s("div",us,[a(t(A),{variant:"secondary",onClick:e[1]||(e[1]=r=>P.value="all"),class:M([P.value==="all"?"bg-primary text-primary-foreground shadow-sm":"hover:bg-muted","cursor-pointer text-xs hover:scale-105 transition-all duration-200"])},{default:l(()=>[...e[12]||(e[12]=[m(" All Topics ",-1)])]),_:1},8,["class"]),(f(!0),C(z,null,I($.value,r=>(f(),T(t(A),{key:r,variant:"secondary",onClick:h=>P.value=r,class:M([P.value===r?"bg-primary text-primary-foreground shadow-sm":"hover:bg-muted","cursor-pointer text-xs capitalize hover:scale-105 transition-all duration-200"])},{default:l(()=>[m(u(r),1)]),_:2},1032,["onClick","class"]))),128))])])):H("",!0)]),a(t(N)),a(t(Y),{class:"h-[420px]"},{default:l(()=>[s("div",ps,[(f(!0),C(z,null,I(F.value,(r,h)=>(f(),C("div",{key:r.id,class:"group relative"},[a(t(Ve),{class:M(["cursor-pointer transition-all duration-200 hover:shadow-md hover:border-primary/50",[S.value===r.id?"ring-2 ring-primary shadow-lg border-primary/50 bg-primary/5":"hover:bg-muted/30"]]),onClick:p=>c(r.id)},{default:l(()=>[s("div",ms,[a(t(ce),{class:"h-3 w-3"})]),a(t(Je),{class:"ml-5 text-sm"},{default:l(()=>[s("div",fs,[s("div",hs,[s("div",gs,[s("span",vs," Q"+u(h+1),1),a(t(A),{class:M([d[r.difficulty],"text-xs px-2 py-0.5 font-medium border cursor-pointer"])},{default:l(()=>[m(u(r.difficulty),1)]),_:2},1032,["class"]),a(t(A),{variant:"outline",class:"text-xs px-2 py-0.5 bg-muted/50"},{default:l(()=>[m(u(r.category),1)]),_:2},1024)]),s("p",xs,u(r.question),1)]),s("div",ys,[a(t(L),{onClick:O(p=>i("mark-helpful",r.id,!0),["stop"]),variant:"ghost",size:"icon",class:M(["h-7 w-7 hover:scale-110 transition-transform",r.user_marked_helpful===!0?"text-green-600 bg-green-100 hover:bg-green-200":"hover:text-green-600 hover:bg-green-50"])},{default:l(()=>[a(t(mt),{class:"h-3.5 w-3.5"})]),_:2},1032,["onClick","class"]),a(t(L),{onClick:O(p=>i("mark-helpful",r.id,!1),["stop"]),variant:"ghost",size:"icon",class:M(["h-7 w-7 hover:scale-110 transition-transform",r.user_marked_helpful===!1?"text-red-600 bg-red-100 hover:bg-red-200":"hover:text-red-600 hover:bg-red-50"])},{default:l(()=>[a(t(pt),{class:"h-3.5 w-3.5"})]),_:2},1032,["onClick","class"]),a(t(L),{onClick:O(p=>i("hide-question",r.id),["stop"]),variant:"ghost",size:"icon",class:"h-7 w-7 hover:scale-110 transition-transform hover:text-red-500 hover:bg-red-50"},{default:l(()=>[a(t(Xe),{class:"h-3.5 w-3.5"})]),_:2},1032,["onClick"])])]),S.value===r.id?(f(),C("div",_s,[s("div",bs,[s("div",ws,[a(t(re),{class:"h-4 w-4 text-amber-600"}),e[13]||(e[13]=s("strong",{class:"text-sm font-semibold text-foreground"},"Suggested Approach",-1))]),s("p",ks,u(r.suggested_answer),1)]),r.key_points.length?(f(),C("div",Cs,[s("div",$s,[a(t(Ye),{class:"h-4 w-4 text-primary"}),e[14]||(e[14]=s("strong",{class:"text-sm font-semibold text-foreground"},"Key Points to Cover",-1))]),s("ul",js,[(f(!0),C(z,null,I(r.key_points,p=>(f(),C("li",{key:p,class:"text-sm text-muted-foreground flex items-start gap-2"},[e[15]||(e[15]=s("span",{class:"text-primary font-bold text-xs mt-1"},"â€¢",-1)),s("span",null,u(p),1)]))),128))])])):H("",!0),s("div",Ps,[s("span",Ds,[a(t(ne),{class:"h-3 w-3"}),m(" Viewed "+u(r.times_viewed)+" time"+u(r.times_viewed!==1?"s":""),1)]),e[16]||(e[16]=s("span",{class:"text-xs text-primary/70"}," Click to collapse ",-1))])])):H("",!0)]),_:2},1024)]),_:2},1032,["class","onClick"])]))),128))])]),_:1})],64)):(f(),C("div",Ls,[o.defenseWatcher?.shouldShowProgress?(f(),C("div",Ss,[s("div",Es,[s("div",Fs,[a(t(W),{class:"h-24 w-24"})]),s("div",Ms,[a(t(W),{class:"mx-auto h-12 w-12 text-amber-500/60 mb-4"}),e[17]||(e[17]=s("h3",{class:"text-sm font-medium text-foreground mb-2"}," Write More to Generate Questions ",-1)),s("p",Ts," Minimum "+u(o.defenseWatcher.threshold)+" words required ",1),e[18]||(e[18]=s("p",{class:"text-xs text-muted-foreground/80 mb-4"},' Keep writing to enable the "Generate Questions" button ',-1)),s("div",As,[a(t(Ke),{value:o.defenseWatcher.progressPercentage,class:"h-2"},null,8,["value"]),s("div",Us,[s("span",null,u(o.chapterContext.word_count)+" words",1),s("span",zs,u(o.defenseWatcher.threshold)+" words needed",1)])])])])])):(f(),C("div",Rs,[s("div",Hs,[a(t(W),{class:"h-24 w-24"})]),s("div",Is,[a(t(W),{class:"mx-auto h-12 w-12 text-muted-foreground/40 mb-4"}),e[19]||(e[19]=s("h3",{class:"text-sm font-medium text-foreground mb-2"}," No Questions Yet ",-1)),e[20]||(e[20]=s("p",{class:"text-xs text-muted-foreground mb-1"},' Click the "Generate Questions" button below to create ',-1)),e[21]||(e[21]=s("p",{class:"text-xs text-muted-foreground/80"}," AI-powered defense questions based on your chapter content ",-1))])]))])),s("div",Ws,[a(t(L),{onClick:e[2]||(e[2]=r=>i("generate-more")),disabled:o.isGenerating||o.defenseWatcher&&!o.defenseWatcher.meetsThreshold,size:"sm",variant:o.questions.length?"outline":"default",class:M(["text-xs font-medium transition-all duration-200 shadow-sm",!o.questions.length&&(!o.defenseWatcher||o.defenseWatcher.meetsThreshold)?"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white shadow-md hover:shadow-lg hover:scale-105 ring-2 ring-blue-300 dark:ring-blue-800":"hover:scale-105 hover:shadow-md"])},{default:l(()=>[a(t(xe),{class:M(["mr-2 h-4 w-4",o.isGenerating?"animate-spin":""])},null,8,["class"]),m(" "+u(o.isGenerating?"Generating...":o.defenseWatcher&&!o.defenseWatcher.meetsThreshold?`Need ${o.defenseWatcher.wordsRemaining} More Words`:o.questions.length?"Generate More":"Generate Questions"),1)]),_:1},8,["disabled","variant","class"]),a(t(L),{onClick:e[3]||(e[3]=r=>i("refresh")),disabled:o.isLoading||!o.questions.length,size:"sm",variant:"outline",class:"text-xs font-medium hover:scale-105 transition-all duration-200 shadow-sm hover:shadow-md"},{default:l(()=>[a(t(ne),{class:"mr-2 h-4 w-4"}),e[22]||(e[22]=m(" Shuffle ",-1))]),_:1},8,["disabled"])]),o.questions.length?(f(),T(t(L),{key:3,onClick:_,size:"sm",variant:"ghost",class:"w-full text-xs font-medium hover:bg-primary/10 hover:text-primary transition-all duration-200"},{default:l(()=>[a(t(q),{class:"mr-2 h-4 w-4"}),e[23]||(e[23]=m(" Export Questions ",-1))]),_:1})):H("",!0)]),_:1})]),_:1})]),_:1},8,["open"])]),_:1}))}}),Bs={class:"inline-flex"},Gs={class:"space-y-4"},Os={class:"flex items-center justify-between"},qs={class:"flex items-center gap-2 text-sm text-muted-foreground"},Ns={class:"flex items-center gap-2"},Qs={class:"space-y-2"},Vs={class:"flex items-start gap-3"},Js={class:"flex-1 min-w-0"},Ks={class:"flex items-center gap-2 mb-1"},Zs={class:"font-medium truncate"},Xs={class:"flex items-center gap-4 text-sm text-muted-foreground"},Ys={key:0},Ha=Q({__name:"ExportMenu",props:{project:{},currentChapter:{},allChapters:{},triggerElement:{default:"button"},size:{default:"default"},variant:{default:"outline"},buttonClass:{default:""}},setup(R){const j=R,y=E(!1),i=E([]),D=B(()=>j.allChapters.filter(o=>o.content&&o.content.trim().length>0)),P=B(()=>i.value.length),S=B(()=>j.allChapters.filter(o=>i.value.includes(o.chapter_number)).reduce((o,e)=>o+e.word_count,0)),F=async()=>{x.loading("Generating project PDF...",{id:"export-project-pdf"});const o=J("export.project.pdf",{project:j.project.slug});try{const e=await fetch(o,{method:"GET",headers:{Accept:"application/pdf"}});if(e.ok){const r=e.headers.get("content-type");if(r&&r.includes("application/json")){const k=await e.json();x.error("Export Failed",{id:"export-project-pdf",description:k.message||"An error occurred during PDF export."});return}const h=await e.blob(),p=window.URL.createObjectURL(h),w=document.createElement("a");w.href=p,w.download=`${j.project.slug}_full_project.pdf`,document.body.appendChild(w),w.click(),document.body.removeChild(w),window.URL.revokeObjectURL(p),x.success("Project PDF exported successfully!",{id:"export-project-pdf",description:`${j.project.title} has been downloaded as PDF.`})}else try{const r=await e.json();x.error("Export Failed",{id:"export-project-pdf",description:r.message||"An error occurred during PDF export."})}catch{x.error("Export Failed",{id:"export-project-pdf",description:"Unable to export project as PDF. Please try again."})}}catch{x.error("Export Failed",{id:"export-project-pdf",description:"Network error occurred. Please check your connection and try again."})}},$=async()=>{if(i.value.length===0){x.error("No chapters selected",{description:"Please select at least one chapter to export."});return}try{x.loading(`Exporting ${i.value.length} chapters...`,{id:"export-chapters"});const o=J("export.chapters.word",{project:j.project.slug}),e=new FormData;i.value.forEach(p=>{e.append("chapters[]",p.toString())});const r=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");r&&e.append("_token",r);const h=await fetch(o,{method:"POST",body:e,headers:{Accept:"application/json"}});if(h.ok){const p=h.headers.get("content-type");if(p&&p.includes("application/json")){const n=await h.json();x.error("Export Failed",{id:"export-chapters",description:n.message||"An error occurred during export."});return}const w=await h.blob(),k=window.URL.createObjectURL(w),g=document.createElement("a");g.href=k,g.download=`${j.project.slug}-chapters-${i.value.join("-")}.docx`,document.body.appendChild(g),g.click(),document.body.removeChild(g),window.URL.revokeObjectURL(k),x.success("Selected chapters exported successfully!",{id:"export-chapters",description:`${i.value.length} chapters exported to Word.`}),i.value=[],y.value=!1}else try{const p=await h.json();x.error("Export Failed",{id:"export-chapters",description:p.message||"An error occurred during export."})}catch{x.error("Export Failed",{id:"export-chapters",description:"Unable to export selected chapters. Please try again."})}}catch{x.error("Export Failed",{id:"export-chapters",description:"Network error occurred. Please check your connection and try again."})}},d=o=>{const e=i.value.indexOf(o);e>-1?i.value.splice(e,1):i.value.push(o)},b=()=>{i.value=D.value.map(o=>o.chapter_number)},c=()=>{i.value=[]},_=async()=>{x.loading("Generating PDF...",{id:"export-chapter-pdf"});const o=J("export.chapter.pdf",{project:j.project.slug,chapterNumber:j.currentChapter.chapter_number});try{const e=await fetch(o,{method:"GET",headers:{Accept:"application/pdf"}});if(e.ok){const r=e.headers.get("content-type");if(r&&r.includes("application/json")){const k=await e.json();x.error("Export Failed",{id:"export-chapter-pdf",description:k.message||"An error occurred during PDF export."});return}const h=await e.blob(),p=window.URL.createObjectURL(h),w=document.createElement("a");w.href=p,w.download=`chapter_${j.currentChapter.chapter_number}_${j.currentChapter.title.toLowerCase().replace(/\s+/g,"_")}.pdf`,document.body.appendChild(w),w.click(),document.body.removeChild(w),window.URL.revokeObjectURL(p),x.success("PDF exported successfully!",{id:"export-chapter-pdf",description:`${j.currentChapter.title} has been downloaded as PDF.`})}else try{const r=await e.json();x.error("Export Failed",{id:"export-chapter-pdf",description:r.message||"An error occurred during PDF export."})}catch{x.error("Export Failed",{id:"export-chapter-pdf",description:"Unable to export chapter as PDF. Please try again."})}}catch{x.error("Export Failed",{id:"export-chapter-pdf",description:"Network error occurred. Please check your connection and try again."})}};return(o,e)=>(f(),C("div",Bs,[a(t(lt),null,{default:l(()=>[a(t(it),{asChild:""},{default:l(()=>[a(t(L),{variant:o.variant,size:o.size,class:M(["gap-2",o.buttonClass])},{default:l(()=>[o.triggerElement==="button"?(f(),C(z,{key:0},[a(t(q),{class:"h-4 w-4"}),e[2]||(e[2]=m(" Export ",-1)),a(t(ee),{class:"h-3 w-3"})],64)):(f(),T(t(q),{key:1,class:"h-4 w-4"}))]),_:1},8,["variant","size","class"])]),_:1}),a(t(dt),{align:"end",class:"w-64"},{default:l(()=>[a(t(le),null,{default:l(()=>[...e[3]||(e[3]=[m("Current Chapter",-1)])]),_:1}),a(t(ie),{onClick:_,class:"gap-2"},{default:l(()=>[a(t(de),{class:"h-4 w-4"}),e[4]||(e[4]=s("div",{class:"flex flex-col"},[s("span",{class:"font-medium"},"Export as PDF"),s("span",{class:"text-xs text-muted-foreground"}," Professional academic format ")],-1))]),_:1}),a(t(ct)),a(t(le),null,{default:l(()=>[...e[5]||(e[5]=[m("Full Project",-1)])]),_:1}),a(t(ie),{onClick:F,class:"gap-2"},{default:l(()=>[a(t(de),{class:"h-4 w-4"}),e[6]||(e[6]=s("div",{class:"flex flex-col"},[s("span",{class:"font-medium"},"Export as PDF"),s("span",{class:"text-xs text-muted-foreground"}," Professional academic format with cover page ")],-1))]),_:1})]),_:1})]),_:1}),a(t(tt),{open:y.value,"onUpdate:open":e[1]||(e[1]=r=>y.value=r)},{default:l(()=>[a(t(st),{class:"max-w-2xl"},{default:l(()=>[a(t(at),null,{default:l(()=>[a(t(ot),{class:"flex items-center gap-2"},{default:l(()=>[a(t(ut),{class:"h-5 w-5"}),e[7]||(e[7]=m(" Select Chapters to Export ",-1))]),_:1}),a(t(rt),null,{default:l(()=>[...e[8]||(e[8]=[m(" Choose which chapters you want to include in your Word export. Only chapters with content can be exported. ",-1)])]),_:1})]),_:1}),s("div",Gs,[s("div",Os,[s("div",qs,[s("span",null,u(P.value)+" of "+u(D.value.length)+" chapters selected",1),S.value>0?(f(),T(t(A),{key:0,variant:"outline",class:"text-xs"},{default:l(()=>[m(u(S.value.toLocaleString())+" words ",1)]),_:1})):H("",!0)]),s("div",Ns,[a(t(L),{onClick:b,variant:"ghost",size:"sm"},{default:l(()=>[...e[9]||(e[9]=[m(" Select All ",-1)])]),_:1}),a(t(L),{onClick:c,variant:"ghost",size:"sm"},{default:l(()=>[...e[10]||(e[10]=[m(" Clear ",-1)])]),_:1})])]),a(t(N)),a(t(Y),{class:"h-[300px]"},{default:l(()=>[s("div",Qs,[(f(!0),C(z,null,I(D.value,r=>(f(),T(t(Z),{key:r.id,class:M(["cursor-pointer transition-colors hover:bg-muted/50",{"ring-2 ring-primary":i.value.includes(r.chapter_number),"bg-muted/30":i.value.includes(r.chapter_number)}]),onClick:h=>d(r.chapter_number)},{default:l(()=>[a(t(X),{class:"p-4"},{default:l(()=>[s("div",Vs,[a(t(et),{checked:i.value.includes(r.chapter_number),"onUpdate:checked":h=>d(r.chapter_number),class:"mt-1"},null,8,["checked","onUpdate:checked"]),s("div",Js,[s("div",Ks,[s("h4",Zs," Chapter "+u(r.chapter_number)+": "+u(r.title),1),a(t(A),{variant:r.status==="approved"?"default":"secondary",class:"text-xs"},{default:l(()=>[m(u(r.status.replace("_"," ")),1)]),_:2},1032,["variant"])]),s("div",Xs,[s("span",null,u(r.word_count.toLocaleString())+" words",1),r.word_count>0?(f(),C("span",Ys,u(Math.ceil(r.word_count/250))+" pages approx. ",1)):H("",!0)])])])]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))])]),_:1})]),a(t(nt),null,{default:l(()=>[a(t(L),{onClick:e[0]||(e[0]=r=>y.value=!1),variant:"outline"},{default:l(()=>[...e[11]||(e[11]=[m(" Cancel ",-1)])]),_:1}),a(t(L),{onClick:$,disabled:P.value===0,class:"gap-2"},{default:l(()=>[a(t(q),{class:"h-4 w-4"}),m(" Export "+u(P.value)+" Chapter"+u(P.value===1?"":"s"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]))}});function Ia(R="",j=50){const y=E([R]),i=E(0);return{contentHistory:y,historyIndex:i,addToHistory:d=>{y.value[i.value]!==d&&(y.value=y.value.slice(0,i.value+1),y.value.push(d),y.value.length>j?y.value.shift():i.value++)},undo:()=>i.value>0?(i.value--,y.value[i.value]):null,redo:()=>i.value<y.value.length-1?(i.value++,y.value[i.value]):null,canUndo:()=>i.value>0,canRedo:()=>i.value<y.value.length-1}}export{Ea as B,ce as C,Ma as M,Ta as P,Ua as R,mt as T,xe as W,Ra as _,za as a,Ha as b,Fa as c,Aa as d,pt as e,Ia as u};
