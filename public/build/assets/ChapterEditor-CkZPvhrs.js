const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ChapterNavigation-B7HeNR_o.js","assets/ChapterNavigation.vue_vue_type_script_setup_true_lang-AdDyu9dI.js","assets/index-DP4ThCdY.js","assets/app-TT48nyjp.js","assets/app-CWxfTXSr.css","assets/ScrollArea.vue_vue_type_script_setup_true_lang-B3I_33z5.js","assets/Presence-9PI4tTID.js","assets/useForwardExpose-Dbm4xzLD.js","assets/index-oq13fV5J.js","assets/useNonce-ga19YQGq.js","assets/AlertDialogTitle.vue_vue_type_script_setup_true_lang-DbHrR7BD.js","assets/DialogTitle-KBRGtlOP.js","assets/DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-f8_GrFC-.js","assets/index-CEXqyF32.js","assets/x-Basvi7e0.js","assets/loader-circle-Dyp4s-Ms.js","assets/VisuallyHidden-bHCC2X31.js","assets/DialogTrigger-CiilS_d_.js","assets/index-9wCK-7Y_.js","assets/plus-YvI5gyOA.js","assets/chevron-right-DlLvFs6D.js","assets/circle-check-big-C93zq9Tf.js","assets/lock-Bm09Iagk.js","assets/target-BhPURjCD.js","assets/trash-2-BkyJP9YU.js","assets/MobileNavOverlay-CpWzhNS2.js","assets/index-qRxTH7D4.js","assets/DefensePreparationPanel.vue_vue_type_script_setup_true_lang-Bl9Z3FOd.js","assets/CardContent.vue_vue_type_script_setup_true_lang-BYYhQ7Wx.js","assets/CardTitle.vue_vue_type_script_setup_true_lang-CIg9mqe5.js","assets/CollapsibleTrigger.vue_vue_type_script_setup_true_lang-iSfPbvSF.js","assets/Progress.vue_vue_type_script_setup_true_lang-BNIvb6px.js","assets/nullish-CHIgUVhi.js","assets/Separator.vue_vue_type_script_setup_true_lang-BtM5sUoh.js","assets/Separator-DQbVmBVO.js","assets/Switch.vue_vue_type_script_setup_true_lang-DxVZjFVZ.js","assets/VisuallyHiddenInput-CsIxlv3l.js","assets/chevron-down-7zBjbpse.js","assets/circle-help-DKXB0Ebl.js","assets/lightbulb-CO8KcAgY.js","assets/useTextHistory-DJSy0Hom.js","assets/Input.vue_vue_type_script_setup_true_lang-oJ2QuLAR.js","assets/RichTextEditor-DclT8LFb.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/purify.es-DxJI3Wx7.js","assets/index-BWEDi_FC.js","assets/step-DrZ9DcYd.js","assets/chart-column-C0oThU4L.js","assets/calendar-CEpWtLnI.js","assets/brain-D-mPnelQ.js","assets/users-CPuaPtFt.js","assets/circle-alert-CYy7JQHT.js","assets/eye-TEuY40SI.js","assets/check-PBjlZVoN.js","assets/type-DSbbrXHT.js","assets/download-kN7fO5Qz.js","assets/DialogTitle.vue_vue_type_script_setup_true_lang-DvkFCoUv.js","assets/DialogDescription.vue_vue_type_script_setup_true_lang-90gUKkp_.js","assets/DialogFooter.vue_vue_type_script_setup_true_lang-uDeFU3gz.js","assets/Label.vue_vue_type_script_setup_true_lang-DUqfID8B.js","assets/minus-BJ-pNowi.js","assets/list-CJLJxGbG.js","assets/RichTextEditor-Bqo7AGZp.css","assets/book-open-SPJvQUXO.js","assets/search-BvIGVKq2.js","assets/sparkles-D8v5LTqf.js","assets/Checkbox.vue_vue_type_script_setup_true_lang-ClOfFpWd.js","assets/ohash.D__AXeF1-C-E83dC9.js","assets/RovingFocusItem-D-Rc3bD1.js","assets/file-text-BmZjwUxw.js","assets/refresh-cw-D2XN5D-g.js","assets/thumbs-up-CmqVxWui.js","assets/TooltipTrigger.vue_vue_type_script_setup_true_lang-Cjzyak1V.js","assets/WordBalanceDisplay.vue_vue_type_script_setup_true_lang-DsJk46nN.js","assets/coins-C5ZHbm8a.js","assets/AppLayout.vue_vue_type_script_setup_true_lang--rqdOQyb.js","assets/UserInfo.vue_vue_type_script_setup_true_lang-CZzD-Rzi.js","assets/log-out-D3ILHTsv.js","assets/AppLogo.vue_vue_type_script_setup_true_lang-DNESZNSS.js","assets/library-CxdCr05-.js","assets/sun-HDxgChSy.js","assets/useWordBalance-CSMNLoiy.js","assets/PurchaseModal.vue_vue_type_script_setup_true_lang-CFUIX1xE.js","assets/arrow-right-CjAO-a7h.js","assets/useChapterWordCount-umOwLHKX.js","assets/toNumber-Cmt6XGPC.js","assets/save-P980OPFu.js","assets/zap-FdMsQzwH.js","assets/pen-tool-Bh1MsTOW.js","assets/arrow-left-BMiq2DUd.js","assets/menu-BMFxzJ1a.js","assets/message-square-Binnmgef.js","assets/minimize-2-C5f6IScD.js","assets/MobileNavOverlay-CN-XSdXy.css","assets/ChatModeLayout-B-IRqiP2.js","assets/send-Bb0-RPtb.js","assets/loader-FgWeS3DK.js","assets/clock-BMgSyeW1.js","assets/chevron-left-Dvo-1KCL.js","assets/bot-DUmwP4-R.js","assets/user-CXjXyuW6.js","assets/square-Dk8GnTmk.js","assets/ChatModeLayout-D4JlvW0D.css","assets/CitationVerificationLayout-Ckl4lazv.js","assets/SafeHtmlText.vue_vue_type_script_setup_true_lang-DilL3Trk.js"])))=>i.map(i=>d[i]);
import{aB as Zs,af as er,S as tr,t as le,b as E,a4 as es,e as P,U as V,X as ee,q as Te,p as $e,ad as ce,d as Ue,s as sr,c as B,o as S,k as r,u as e,i as q,j as n,g as s,y as p,z as m,n as Ge,Q as Se,V as Ae,aa as De,f as X,a1 as rr,T as nr,F as Rt,aC as Ve,l as Xe,aD as or,m as Pt,I as ar,aE as Je}from"./app-TT48nyjp.js";import{_ as ke}from"./index-9wCK-7Y_.js";import{c as ct,_ as $}from"./index-DP4ThCdY.js";import{_ as ne,a as oe}from"./CardContent.vue_vue_type_script_setup_true_lang-BYYhQ7Wx.js";import{_ as ae,a as ue}from"./CardTitle.vue_vue_type_script_setup_true_lang-CIg9mqe5.js";import{a as Ft}from"./ScrollArea.vue_vue_type_script_setup_true_lang-B3I_33z5.js";import{_ as Be}from"./Separator.vue_vue_type_script_setup_true_lang-BtM5sUoh.js";import{a as te,b as se,_ as re}from"./TooltipTrigger.vue_vue_type_script_setup_true_lang-Cjzyak1V.js";import{_ as lr}from"./WordBalanceDisplay.vue_vue_type_script_setup_true_lang-DsJk46nN.js";import{a as zt,_ as Wt}from"./AppLayout.vue_vue_type_script_setup_true_lang--rqdOQyb.js";import{t as z}from"./index-CEXqyF32.js";import{_ as ir}from"./PurchaseModal.vue_vue_type_script_setup_true_lang-CFUIX1xE.js";import{r as dr,u as ur}from"./useWordBalance-CSMNLoiy.js";import{a as cr,u as pr,b as gr}from"./useChapterWordCount-umOwLHKX.js";import{t as Nt}from"./toNumber-Cmt6XGPC.js";import{_ as fr}from"./Input.vue_vue_type_script_setup_true_lang-oJ2QuLAR.js";import{_ as mr}from"./Label.vue_vue_type_script_setup_true_lang-DUqfID8B.js";import{ay as hr,az as vr,aA as br,aB as xr,aC as wr,aD as yr,aE as _r,aF as Cr,aG as kr,aH as Sr,aI as Er,aJ as Tr,aK as $r,aL as Ar,aa as ts,au as Dr,at as jr}from"./RichTextEditor-DclT8LFb.js";import{_ as pt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as ss}from"./eye-TEuY40SI.js";import{S as ut}from"./save-P980OPFu.js";import{C as Ye}from"./circle-check-big-C93zq9Tf.js";import{_ as qt,a as Ht,b as Ot}from"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-iSfPbvSF.js";import{_ as Mr}from"./Progress.vue_vue_type_script_setup_true_lang-BNIvb6px.js";import{W as Lr,b as Rr,u as Pr,M as Bt,_ as lt,a as Fr,P as zr}from"./useTextHistory-DJSy0Hom.js";import{B as Ie}from"./brain-D-mPnelQ.js";import{Z as Wr}from"./zap-FdMsQzwH.js";import{C as It}from"./chevron-down-7zBjbpse.js";import{P as Gt}from"./pen-tool-Bh1MsTOW.js";import{R as Nr}from"./refresh-cw-D2XN5D-g.js";import{C as qr}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-f8_GrFC-.js";import{S as Hr}from"./sparkles-D8v5LTqf.js";import{T as Or}from"./type-DSbbrXHT.js";import{A as it}from"./arrow-left-BMiq2DUd.js";import{M as Ut}from"./menu-BMFxzJ1a.js";import{M as Qt}from"./message-square-Binnmgef.js";import{M as Kt}from"./minimize-2-C5f6IScD.js";import{M as Vt,S as Xt}from"./sun-HDxgChSy.js";import{S as Jt}from"./search-BvIGVKq2.js";import{a as Br,P as Ir}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-DbHrR7BD.js";var dt=function(){return Zs.Date.now()},Gr="Expected a function",Ur=Math.max,Qr=Math.min;function Kr(b,x,d){var T,R,o,k,g,_,u=0,w=!1,c=!1,f=!0;if(typeof b!="function")throw new TypeError(Gr);x=Nt(x)||0,er(d)&&(w=!!d.leading,c="maxWait"in d,o=c?Ur(Nt(d.maxWait)||0,x):o,f="trailing"in d?!!d.trailing:f);function i(D){var y=T,O=R;return T=R=void 0,u=D,k=b.apply(O,y),k}function C(D){return u=D,g=setTimeout(j,x),w?i(D):k}function W(D){var y=D-_,O=D-u,I=x-y;return c?Qr(I,o-O):I}function F(D){var y=D-_,O=D-u;return _===void 0||y>=x||y<0||c&&O>=o}function j(){var D=dt();if(F(D))return h(D);g=setTimeout(j,W(D))}function h(D){return g=void 0,f&&T?i(D):(T=R=void 0,k)}function a(){g!==void 0&&clearTimeout(g),u=0,T=_=R=g=void 0}function A(){return g===void 0?k:h(dt())}function H(){var D=dt(),y=F(D);if(T=arguments,R=this,_=D,y){if(g===void 0)return C(_);if(c)return clearTimeout(g),g=setTimeout(j,x),i(_)}return g===void 0&&(g=setTimeout(j,x)),k}return H.cancel=a,H.flush=A,H}/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=ct("BookCheckIcon",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"m9 9.5 2 2 4-4",key:"1dth82"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=ct("PenIcon",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=ct("Undo2Icon",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]]);function Jr(b){const x=tr();le(()=>x.props?.flash,U=>{U&&(U.success&&z.success(U.success),U.error&&z.error(U.error))},{deep:!0,immediate:!0});const d=E(b.chapter.title||""),T=E(b.chapter.content||""),R=E(!0),{isDark:o,toggle:k}=es(),g=P(()=>o.value),_=()=>{},u=()=>{k()},w=E(!1),c=E(!1),f=E(!1),i=E("write"),C=E(""),W=E(0),F=E(!1),j=E(!1),h=E(!0),a=()=>{try{return localStorage.getItem(`chatMode_${b.project.id}_${b.chapter.chapter_number}`)==="true"}catch(U){return console.warn("Failed to load chat mode from localStorage:",U),!1}},A=U=>{try{localStorage.setItem(`chatMode_${b.project.id}_${b.chapter.chapter_number}`,String(U))}catch(ie){console.warn("Failed to save chat mode to localStorage:",ie)}},H=E(!1),D=E(!1),y=E(!1),O=E(!1),I=E(!1),J=E(!0),me=E(!0);return{chapterTitle:d,chapterContent:T,showPreview:R,isEditorDark:g,initChapterTheme:_,toggleChapterTheme:u,isNativeFullscreen:w,showAISidebar:c,showStatistics:f,activeTab:i,selectedText:C,cursorPosition:W,showChatMode:F,showCitationMode:j,showDefensePrep:h,loadChatModeFromStorage:a,saveChatModeToStorage:A,showLeftSidebar:H,showRightSidebar:D,isMobile:y,isLeftSidebarCollapsed:O,isRightSidebarCollapsed:I,showLeftSidebarInFullscreen:J,showRightSidebarInFullscreen:me}}function Yr({props:b,allChapters:x,targetWordCount:d,estimates:T,ensureBalance:R,save:o}){return{generateNextChapter:async()=>{const g=T.chapter(d.value||0);if(!R(g,"generate the next chapter with AI"))return;await o();const _=x.map(c=>c.chapter_number).sort((c,f)=>c-f),u=_.indexOf(b.chapter.chapter_number);let w;if(u===-1||u===_.length-1)w=Math.max(..._)+1;else{const c=_[u+1];c===b.chapter.chapter_number+1?w=c:w=b.chapter.chapter_number+1}try{const c=V("chapters.write",{project:b.project.slug,chapter:w}),f=new URL(c,window.location.origin);f.searchParams.set("ai_generate","true"),f.searchParams.set("generation_type","progressive"),ee.visit(f.toString())}catch(c){console.error("âŒ Error generating next chapter:",c)}}}}function Zr(b,x,d,T){const o=E(!1),k=E(0),g=E(!1),_=y=>{if(!y)return 0;const I=y.replace(/<[^>]*>/g,"").trim().replace(/\s+/g," ");if(!I)return 0;const J=I.match(/\b\w+\b/g);return J?J.length:0},u=P(()=>_(d.value)),w=P(()=>u.value>=800),c=()=>`defense_generation_triggered_${b.id}_ch_${x.chapter_number}`,f=()=>{const y=c();return localStorage.getItem(y)==="true"},i=()=>{const y=c();localStorage.setItem(y,"true"),o.value=!0},C=()=>{const y=c();localStorage.removeItem(y),o.value=!1,console.log(`ðŸ”„ DEFENSE WATCHER: Reset generation trigger for Chapter ${x.chapter_number}`)},W=Kr(async()=>{if(!g.value)return;const y=u.value;console.log(`ðŸ“Š DEFENSE WATCHER: Word count check - Chapter ${x.chapter_number}: ${y} words`),y<800*.8&&o.value&&(console.log("â¬‡ï¸ DEFENSE WATCHER: Content dropped below 80% of threshold, resetting trigger"),C()),k.value=y},2e3),F=()=>g.value?void 0:(g.value=!0,o.value=f(),k.value=u.value,console.log(`ðŸ‘€ DEFENSE WATCHER: Started watching Chapter ${x.chapter_number}`),console.log(`   Initial word count: ${k.value}`),console.log(`   Generation already triggered: ${o.value}`),console.log("   Threshold: 800 words"),le(d,(O,I)=>{O!==I&&W()},{immediate:!1})),j=()=>{g.value=!1,W.cancel(),console.log(`ðŸ›‘ DEFENSE WATCHER: Stopped watching Chapter ${x.chapter_number}`)},h=async()=>{console.log(`ðŸ” DEFENSE WATCHER: Force checking Chapter ${x.chapter_number}`),await W(),W.flush()},a=P(()=>{const y=u.value;return y>0&&y<800&&!o.value}),A=P(()=>{const y=u.value/800*100;return Math.min(y,100)}),H=P(()=>{const y=800-u.value;return Math.max(y,0)});return{isWatching:g,hasTriggeredGeneration:o,currentWordCount:u,lastWordCount:k,meetsThreshold:w,shouldShowProgressIndicator:a,progressPercentage:A,wordsRemaining:H,startWatching:F,stopWatching:j,forceCheck:h,resetGenerationTrigger:C,markGenerationTriggered:i,getStatusMessage:()=>{const y=u.value;return o.value?`Defense questions available (${y} words)`:y>=800?`Ready for defense questions (${y} words)`:y>0?`${800-y} more words needed for defense questions`:"Start writing to enable defense questions (800 words needed)"},countWords:_,DEFENSE_WORD_COUNT_THRESHOLD:800}}function en({props:b,chapterContent:x,currentWordCount:d,ensureBalance:T,estimates:R}){const o=E([]),k=E(!1),g=E(!1),_=E(null),u=E(!1),w=P(()=>b.chapter),{hasTriggeredGeneration:c,startWatching:f,stopWatching:i,forceCheck:C,getStatusMessage:W,markGenerationTriggered:F,meetsThreshold:j,shouldShowProgressIndicator:h,progressPercentage:a,wordsRemaining:A,DEFENSE_WORD_COUNT_THRESHOLD:H}=Zr(b.project,b.chapter,x),D=(M,N)=>`defense_auto_generate_${M}_ch_${N}`,y=()=>{try{return localStorage.getItem(D(b.project.id,b.chapter.chapter_number))==="true"}catch(M){return console.warn("Failed to load defense auto-generation preference:",M),!1}},O=M=>{try{localStorage.setItem(D(b.project.id,b.chapter.chapter_number),String(M))}catch(N){console.warn("Failed to save defense auto-generation preference:",N)}};u.value=y();const I=()=>{if(!o.value.length||!_.value)return!0;const M=new Date(Date.now()-360*60*1e3);return _.value<M},J=async(M=!1,N={})=>{if(k.value)return;const G=N.skipGeneration??!0;k.value=!0;try{console.log("Loading defense questions with params:",{project_id:b.project.id,chapter_number:w.value?.chapter_number,limit:5,force_refresh:M,skip_generation:G});const L=await ce.get(`/api/projects/${b.project.id}/defense/questions`,{params:{chapter_number:w.value?.chapter_number||null,limit:5,force_refresh:M?1:0,skip_generation:G?1:0},headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(console.log("Defense questions loaded:",L.data),o.value=L.data.questions||[],_.value=new Date,L.data.questions&&L.data.questions.length>0){const K=`defense_questions_${b.project.id}_chapter_${w.value?.chapter_number}`;localStorage.setItem(K,JSON.stringify({questions:L.data.questions,chapter_number:w.value?.chapter_number,loaded_at:new Date().toISOString()}))}else M||(console.log("No existing questions found for this chapter"),console.log(`Current word count: ${d.value}/${H}`),console.log('User must click "Generate Questions" button to create defense questions'))}catch(L){if(console.error("Failed to load defense questions:",L),L.response)if(console.error("Response status:",L.response.status),console.error("Response data:",L.response.data),L.response.status===422){const K=Object.values(L.response.data.errors||{})[0];K&&Array.isArray(K)?z.error(`Validation Error: ${K[0]}`):z.error("Invalid request parameters. Please refresh the page.")}else L.response.status===500?z.error("Server error. Please try again later."):z.error("Failed to load defense questions");else L.request?(console.error("No response received:",L.request),z.error("Network error. Please check your connection.")):(console.error("Error setting up request:",L.message),z.error("An unexpected error occurred"));o.value=[]}finally{k.value=!1}},me=M=>M?M.replace(/<[^>]*>/g," ").trim().split(/\s+/).filter(N=>N.length>0).length:0,U=async(M={})=>{if(g.value)return;const N=M.autoTriggered??!1,G=R.defense();if(T(G,"generate defense questions")){g.value=!0;try{const L=await ce.post(`/api/projects/${b.project.id}/defense/questions/generate`,{chapter_number:w.value.chapter_number},{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),Accept:"application/json","Content-Type":"application/json"}});if(L.data&&L.data.questions){o.value=L.data.questions,_.value=new Date;const K=L.data.questions.reduce((Re,Pe)=>{const Ze=me(Pe.question),Fe=me(Pe.suggested_answer),ze=(Pe.key_points||[]).reduce((et,Y)=>et+me(Y),0);return Re+Ze+Fe+ze},0),Le=`defense_questions_${b.project.id}_chapter_${w.value?.chapter_number}`;localStorage.setItem(Le,JSON.stringify({questions:L.data.questions,chapter_number:w.value?.chapter_number,loaded_at:new Date().toISOString()})),z.success(`Generated ${L.data.questions.length} new questions`),dr(K||R.defense(),"Defense questions","chapter",b.chapter.id).catch(Re=>console.error("Failed to record word usage (defense):",Re)),c.value=!0,F(),N&&console.log("Auto-generated defense questions after meeting threshold.")}}catch(L){console.error("Failed to generate defense questions:",L),z.error("Failed to generate defense questions")}finally{g.value=!1}}},ie=async()=>{!u.value||g.value||k.value||c.value||!j.value||o.value.length>0||await U({autoTriggered:!0})},je=M=>{u.value=M,O(M),M&&ie()},Me=async(M,N)=>{try{await ce.patch(`/api/projects/${b.project.id}/defense/questions/${M}`,{user_marked_helpful:N},{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),Accept:"application/json","Content-Type":"application/json"}});const G=o.value.find(L=>L.id===M);G&&(G.user_marked_helpful=N),z.success(N?"Question marked as helpful":"Removed helpful mark")}catch(G){console.error("Failed to mark question:",G),z.error("Failed to update question")}},Qe=async M=>{try{await ce.delete(`/api/projects/${b.project.id}/defense/questions/${M}`,{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),Accept:"application/json"}}),o.value=o.value.filter(N=>N.id!==M),localStorage.setItem(`defense_questions_${b.project.id}`,JSON.stringify({questions:o.value,loaded_at:new Date().toISOString()})),z.success("Question hidden")}catch(N){console.error("Failed to hide question:",N),z.error("Failed to hide question")}},Ee=async()=>{const M=`defense_questions_${b.project.id}_chapter_${w.value?.chapter_number}`,N=localStorage.getItem(M);let G=!0;if(N){const L=JSON.parse(N),K=new Date(L.loaded_at),Le=new Date(Date.now()-360*60*1e3);K>Le&&L.chapter_number===w.value?.chapter_number&&(o.value=L.questions,_.value=K,G=!1)}G&&await J(!1,{skipGeneration:!0})};return le(()=>b.chapter,async()=>{o.value=[],i(),f(),u.value=y(),await J(!1,{skipGeneration:!0}),await Te(()=>{C(),ie()})},{immediate:!1}),le([d,u],()=>{ie()}),$e(async()=>{await Ee(),f(),await Te(()=>{C(),ie()})}),{defenseQuestions:o,isLoadingDefenseQuestions:k,isGeneratingDefenseQuestions:g,autoGenerateDefense:u,shouldLoadDefenseQuestions:I,loadDefenseQuestions:J,generateNewDefenseQuestions:U,markQuestionHelpful:Me,hideQuestion:Qe,handleDefenseAutoToggle:je,attemptAutoGenerateDefense:ie,getDefenseStatusMessage:W,shouldShowDefenseProgress:h,defenseProgressPercentage:a,defenseWordsRemaining:A,hasTriggeredGeneration:c,meetsDefenseThreshold:j}}const tn={class:"bg-background"},sn=Ue({__name:"RichTextViewer",props:{content:{},showFontControls:{type:Boolean,default:!0}},setup(b){const x=hr(Ar),d=b,T=u=>u?(u=u.replace(/```mermaid\n?([\s\S]*?)```/g,(w,c)=>{const f=c.trim();return`<div data-mermaid data-mermaid-code="${f.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}" data-view-mode="diagram"><pre><code class="language-mermaid">${f}</code></pre></div>`}),u=u.replace(/``mermaid\n?([\s\S]*?)``/g,(w,c)=>{const f=c.trim();return`<div data-mermaid data-mermaid-code="${f.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}" data-view-mode="diagram"><pre><code class="language-mermaid">${f}</code></pre></div>`}),u=u.replace(/`mermaid\n([\s\S]*?)`/g,(w,c)=>{const f=c.trim();return`<div data-mermaid data-mermaid-code="${f.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}" data-view-mode="diagram"><pre><code class="language-mermaid">${f}</code></pre></div>`}),u):"",R=u=>u?(u=u.replace(/```(\w+)\n?([\s\S]*?)```/g,(w,c,f)=>`<pre><code class="language-${c}">${f.trim()}</code></pre>`),u=u.replace(/```\n?([\s\S]*?)```/g,(w,c)=>`<pre><code>${c.trim()}</code></pre>`),u):"",o=u=>{if(!u)return"";const w=u.split(`
`);let c=[],f=0;for(;f<w.length;){const i=w[f];if(i.includes("|")){const C=k(w,f);if(C.html){c.push(C.html),f=C.nextIndex;continue}}c.push(i),f++}return c.join(`
`)},k=(u,w)=>{let c=u[w];if(!c||!c.includes("|"))return{html:null,nextIndex:w+1};const f=c.split("|").map(j=>j.trim()).filter(j=>j.length>0);if(f.length===0)return{html:null,nextIndex:w+1};const i=u[w+1];if(!i||!i.includes("|")||!i.includes("-"))return{html:null,nextIndex:w+1};let C=[],W=w+2;for(;W<u.length;){const j=u[W];if(!j||!j.includes("|"))break;const h=j.split("|").map(a=>a.trim()).filter(a=>a.length>0);h.length>0&&C.push(h),W++}let F='<div class="tableWrapper"><table>';return F+="<thead><tr>",f.forEach(j=>{F+=`<th>${j}</th>`}),F+="</tr></thead>",C.length>0&&(F+="<tbody>",C.forEach(j=>{F+="<tr>";for(let h=0;h<f.length;h++){const a=j[h]||"";F+=`<td>${a}</td>`}F+="</tr>"}),F+="</tbody>"),F+="</table></div>",{html:F,nextIndex:W}},g=u=>{if(!u)return"";if(u.includes("<p>")||u.includes("<h1>")||u.includes("<h2>")||u.includes("<div>")){let i=T(u);return i=R(i),i}let c=u;return c=T(c),c=R(c),c=c.replace(/^#### (.*$)/gim,"<h4>$1</h4>"),c=c.replace(/^### (.*$)/gim,"<h3>$1</h3>"),c=c.replace(/^## (.*$)/gim,"<h2>$1</h2>"),c=c.replace(/^# (.*$)/gim,"<h1>$1</h1>"),c=c.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),c=c.replace(new RegExp("(?<!\\*)\\*([^*\\n]+?)\\*(?!\\*)","g"),"<em>$1</em>"),c=c.replace(/`([^`]+)`/g,"<code>$1</code>"),c=o(c),c.split(/\n\s*\n/).filter(i=>i.trim()).map(i=>{const C=i.trim();if(C.startsWith("<h1>")||C.startsWith("<h2>")||C.startsWith("<h3>")||C.startsWith("<h4>"))return C;if(C.includes(`
`)){const F=C.split(`
`).map(a=>a.trim()).filter(a=>a),j=F.some(a=>a.match(/^\d+\.\s/)),h=F.some(a=>a.match(/^[-*]\s/));if(j||h){const a=F.map(D=>D.match(/^\d+\.\s/)?`<li>${D.replace(/^\d+\.\s/,"")}</li>`:D.match(/^[-*]\s/)?`<li>${D.replace(/^[-*]\s/,"")}</li>`:D);let A=[],H="";for(const D of a)D.startsWith("<li>")?(H&&A.push(H),H=D):H&&(H=H.replace("</li>",` ${D}</li>`));return H&&A.push(H),j?`<ol>${A.join("")}</ol>`:`<ul>${A.join("")}</ul>`}}return`<p>${C.replace(/\n/g,"<br>")}</p>`}).join("")},_=vr({content:g(d.content),editable:!1,extensions:[br.configure({heading:{levels:[1,2,3]},codeBlock:!1}),xr.configure({lowlight:x,HTMLAttributes:{class:"code-block-highlighted"}}),wr,yr,_r,Cr.configure({resizable:!0}),kr,Sr,Er,Tr],editorProps:{attributes:{class:"prose prose-sm dark:prose-invert max-w-none focus:outline-none"}}});return E("12"),$e(()=>{setTimeout(()=>{_.value&&_.value.chain().selectAll().setFontSize("12pt").run()},100)}),le(()=>d.content,u=>{if(_.value&&_.value.getHTML()!==u){const w=g(u);_.value.commands.setContent(w)}}),sr(()=>{_.value&&_.value.destroy()}),(u,w)=>(S(),B("div",tn,[r(e($r),{editor:e(_)},null,8,["editor"])]))}}),ns=pt(sn,[["__scopeId","data-v-87fd46f8"]]),rn={class:"flex items-center justify-between"},nn={class:"space-y-1 w-full max-w-[520px]"},on={class:"flex items-center justify-between gap-3"},an={class:"flex flex-col"},ln={class:"flex items-center gap-2"},dn={class:"flex items-center justify-between px-6 py-2 border-b border-border/30 bg-muted/5"},un={class:"flex items-center gap-2"},cn={class:"space-y-1 relative z-10"},pn={class:"text-sm font-medium text-foreground"},gn={class:"text-[10px] text-muted-foreground line-clamp-2 leading-relaxed"},fn={class:"flex-1 relative bg-background"},mn={class:"px-12 py-10 min-h-[500px]"},hn={class:"sticky bottom-0 z-10 border-t border-border/30 bg-background/80 backdrop-blur-md p-4 flex items-center justify-between"},vn={class:"text-xs text-muted-foreground"},bn={class:"flex items-center gap-2"},Yt=Ue({__name:"ChapterEditorPaperCard",props:{context:{}},setup(b){const d=b.context,T=P(()=>{const k=d.getSectionInfo(d.nextSection);return d.aiChapterAnalysis?.section||k}),R=P(()=>T.value?.name||""),o=P(()=>T.value?.description||"");return(k,g)=>(S(),q(e(ne),{class:"w-full max-w-[850px] min-h-[calc(100vh-180px)] flex flex-col bg-background shadow-xl shadow-black/5 ring-1 ring-black/5 dark:ring-white/10 rounded-xl overflow-hidden transition-all duration-300"},{default:n(()=>[r(e(ae),{class:"flex-shrink-0 border-b border-border/30 px-8 py-6 bg-background/50 backdrop-blur-sm sticky top-0 z-10"},{default:n(()=>[s("div",rn,[s("div",nn,[s("div",on,[s("div",an,[r(e(mr),{for:"chapter-title",class:"text-xs font-medium text-zinc-500 dark:text-zinc-400 uppercase tracking-wider"},{default:n(()=>[...g[3]||(g[3]=[p("Chapter Title",-1)])]),_:1}),r(e(fr),{id:"chapter-title",modelValue:e(d).chapterTitle,"onUpdate:modelValue":g[0]||(g[0]=_=>e(d).chapterTitle=_),placeholder:"Enter chapter title...",class:"h-auto p-0 border-0 bg-transparent text-2xl font-bold placeholder:text-muted-foreground/40 focus-visible:ring-0 px-0 text-foreground"},null,8,["modelValue"])]),s("div",ln,[r(e(ke),{variant:e(d).chapter.status==="approved"?"default":"secondary",class:"rounded-full px-3"},{default:n(()=>[p(m(e(d).chapter.status.replace("_"," ")),1)]),_:1},8,["variant"]),r(e(ke),{variant:"outline",class:Ge(["rounded-full px-3 transition-colors",{"text-green-600 border-green-200 bg-green-50 dark:bg-green-900/20 dark:border-green-800":(e(d).latestAnalysis?.total_score||0)>=80,"text-yellow-600 border-yellow-200 bg-yellow-50 dark:bg-yellow-900/20 dark:border-yellow-800":(e(d).latestAnalysis?.total_score||0)>=70&&(e(d).latestAnalysis?.total_score||0)<80,"text-orange-600 border-orange-200 bg-orange-50 dark:bg-orange-900/20 dark:border-orange-800":(e(d).latestAnalysis?.total_score||0)>=60&&(e(d).latestAnalysis?.total_score||0)<70,"text-red-600 border-red-200 bg-red-50 dark:bg-red-900/20 dark:border-red-800":(e(d).latestAnalysis?.total_score||0)<60}])},{default:n(()=>[p(m(e(d).latestAnalysis?.total_score?Math.round(e(d).latestAnalysis.total_score):e(d).writingQualityScore)+"% Quality ",1)]),_:1},8,["class"])])])])])]),_:1}),r(e(oe),{class:"flex min-h-0 flex-1 flex-col p-0"},{default:n(()=>[s("div",dn,[s("div",un,[r(e($),{onClick:e(d).togglePresentationMode,variant:e(d).showPresentationMode?"default":"ghost",size:"sm",class:"h-7 text-xs rounded-full text-zinc-700 dark:text-zinc-300 hover:text-foreground"},{default:n(()=>[r(e(ss),{class:"mr-1.5 h-3.5 w-3.5"}),p(" "+m(e(d).showPresentationMode?"Edit":"Preview"),1)]),_:1},8,["onClick","variant"])]),s("div",cn,[s("div",pn,m(R.value),1),s("div",gn,m(o.value),1)])]),s("div",fn,[Se(r(ts,{modelValue:e(d).chapterContent,"onUpdate:modelValue":g[1]||(g[1]=_=>e(d).chapterContent=_),placeholder:"Start writing your chapter...","min-height":"500px",class:"min-h-[500px] px-8 py-6",ref:e(d).richTextEditor,"show-toolbar":!0,"streaming-mode":e(d).isStreamingMode,"is-generating":e(d).isGenerating,"generation-progress":e(d).generationProgress,"generation-percentage":e(d).generationPercentage,"generation-phase":e(d).generationPhase,"onUpdate:selectedText":e(d).setSelectedText},null,8,["modelValue","streaming-mode","is-generating","generation-progress","generation-percentage","generation-phase","onUpdate:selectedText"]),[[Ae,!e(d).showPresentationMode]]),Se(s("div",mn,[r(ns,{content:e(d).chapterContent,"show-font-controls":!1,class:"prose-lg mx-auto",style:{"font-family":"'Times New Roman', serif","line-height":"1.8"}},null,8,["content"])],512),[[Ae,e(d).showPresentationMode]])])]),_:1}),s("div",hn,[s("div",vn,m(e(d).isSaving?"Saving...":"All changes saved"),1),s("div",bn,[r(e($),{onClick:g[2]||(g[2]=()=>e(d).save(!1)),disabled:!e(d).isValid||e(d).isSaving,size:"sm",variant:"ghost",class:"h-8 rounded-full text-zinc-700 dark:text-zinc-300 hover:text-foreground"},{default:n(()=>[r(e(ut),{class:"mr-2 h-3.5 w-3.5"}),g[4]||(g[4]=p(" Save Draft ",-1))]),_:1},8,["disabled"]),r(e($),{onClick:e(d).goToBulkAnalysis,variant:"outline",size:"sm",class:"h-8 rounded-full"},{default:n(()=>[r(e(rs),{class:"mr-2 h-3.5 w-3.5"}),g[5]||(g[5]=p(" Run Bulk Analysis ",-1))]),_:1},8,["onClick"]),r(e($),{onClick:e(d).markAsComplete,disabled:e(d).isSaving,size:"sm",class:"h-8 rounded-full bg-gradient-to-r from-primary to-primary/90 shadow-sm hover:shadow-md transition-all"},{default:n(()=>[r(e(Ye),{class:"mr-2 h-3.5 w-3.5"}),g[6]||(g[6]=p(" Complete ",-1))]),_:1},8,["onClick","disabled"])])])]),_:1}))}}),xn={class:"flex flex-col gap-4 p-1"},wn={class:"p-1.5 rounded-lg bg-primary/10 text-primary"},yn={class:"flex items-center gap-2"},_n={class:"space-y-3"},Cn={key:0,class:"space-y-2"},kn={class:"flex items-center justify-between w-full relative z-10"},Sn={class:"flex items-center gap-2 text-primary"},En={class:"space-y-1 relative z-10"},Tn={class:"text-sm font-medium text-foreground"},$n={class:"text-[10px] text-muted-foreground line-clamp-2 leading-relaxed"},An={key:0,class:"p-4 rounded-xl bg-green-500/10 border border-green-500/20 space-y-3"},Dn={class:"flex items-center gap-2 text-green-600 dark:text-green-400"},jn={class:"space-y-2"},Mn={class:"flex justify-between text-[10px] font-medium text-muted-foreground"},Ln={class:"grid grid-cols-2 gap-2 mt-2"},Rn={class:"p-1.5 rounded-full bg-blue-500/10 text-blue-500"},Pn={class:"p-1.5 rounded-full bg-purple-500/10 text-purple-500"},Fn={class:"p-1.5 rounded-full bg-orange-500/10 text-orange-500"},zn={class:"p-1.5 rounded-full bg-emerald-500/10 text-emerald-500"},Wn={class:"p-1.5 rounded-full bg-amber-500/10 text-amber-500"},Nn={class:"flex items-center gap-2"},qn={class:"p-1 rounded-xl bg-muted/30 border border-border/50"},Hn=Ue({__name:"AISidebar",props:{project:{},chapter:{},isGenerating:{type:Boolean},selectedText:{},isLoadingSuggestions:{type:Boolean},showCitationHelper:{type:Boolean},chapterContent:{},cursorPosition:{},currentWordCount:{},targetWordCount:{},canUndo:{type:Boolean}},emits:["startStreamingGeneration","getAISuggestions","update:showCitationHelper","insert-citation","checkCitations","undoLastAction"],setup(b,{emit:x}){const d=b,T=x,R=E("Academic Formal"),o=E(null),k=E(!1),g=E({expand:!1,improve:!1,rephrase:!1,cite:!1,"generate-full":!1,"generate-section":!1,custom:!1}),_=P(()=>!!d.chapter?.id&&!!d.chapter?.chapter_number),u=P(()=>d.chapterContent&&d.chapterContent.trim().length>0);P(()=>!u.value&&_.value),P(()=>!o.value&&_.value);const w=P(()=>!d.isGenerating&&!!d.chapterContent);P(()=>!d.isLoadingSuggestions&&!!d.selectedText);const c=P(()=>o.value&&o.value.section.name!=="NONE"?o.value.section.name.toLowerCase().replace(/\s+/g,"_"):W()),f=P(()=>!d.isGenerating&&!!d.chapter?.id),i=()=>[{id:"introduction",name:"Introduction",description:"Overview and objectives of this chapter"},{id:"content",name:"Main Content",description:"Chapter main content"},{id:"conclusion",name:"Conclusion",description:"Summary and transition to next chapter"}],C=async(h,a)=>{if(Object.values(g.value).some(A=>A)){z("Please wait for the current action to complete");return}try{switch(h in g.value&&(g.value[h]=!0),h){case"expand":d.selectedText?(T("startStreamingGeneration","expand",{selectedText:d.selectedText}),z("Expanding selected text...")):z.error("Please select text to expand");break;case"improve":T("startStreamingGeneration","improve"),z("Improving chapter content...");break;case"rephrase":d.selectedText?(T("startStreamingGeneration","rephrase",{selectedText:d.selectedText,style:R.value}),z("Rephrasing selected text...")):z.error("Please select text to rephrase");break;case"cite":T("update:showCitationHelper",!0),z("Opening citation helper...");break;case"generate-full":T("startStreamingGeneration","progressive"),z("Generating complete chapter...");break;case"generate-section":const A=a?.section||c.value;T("startStreamingGeneration","section",{section:A,mode:"progressive"}),z(`Generating ${A} section...`);break;default:throw new Error(`Unknown action: ${h}`)}}catch(A){console.error(`Quick action '${h}' failed:`,A),z.error(`Failed to ${h.replace("-"," ")}. Please try again.`)}finally{setTimeout(()=>{h in g.value&&(g.value[h]=!1)},1e3)}},W=()=>{if(!u.value)return"introduction";const h=d.chapterContent.toLowerCase(),a=i();for(const A of a)if(![A.name.toLowerCase(),A.id.replace("_"," ")].some(y=>h.includes(y)))return A.id;return"conclusion"},F=h=>{const a=i();return a.find(A=>A.id===h)||a[0]},j=h=>{T("insert-citation",h)};return le(()=>d.chapter,h=>{h?.id&&(o.value=null)},{immediate:!1}),le(()=>d.chapterContent,h=>{o.value&&(!h||h.trim().length===0)&&(o.value=null)},{immediate:!1}),(h,a)=>(S(),B("div",xn,[r(e(ne),{class:"border-none shadow-none bg-transparent"},{default:n(()=>[r(e(ae),{class:"px-2 py-3"},{default:n(()=>[r(e(ue),{class:"flex items-center gap-2 text-sm font-semibold text-foreground/80"},{default:n(()=>[s("div",wn,[r(e(Ie),{class:"h-4 w-4"})]),a[9]||(a[9]=p(" AI Assistant ",-1))]),_:1})]),_:1}),r(e(oe),{class:"px-2 space-y-6"},{default:n(()=>[r(e(qt),{open:!0,class:"space-y-2"},{default:n(()=>[r(e(Ht),{class:"flex w-full items-center justify-between text-xs font-medium text-muted-foreground hover:text-foreground transition-colors group"},{default:n(()=>[s("span",yn,[r(e(Wr),{class:"h-3.5 w-3.5 text-amber-500/70 group-hover:text-amber-500 transition-colors"}),a[10]||(a[10]=p(" QUICK ACTIONS ",-1))]),r(e(It),{class:"h-3 w-3 transition-transform duration-200 group-data-[state=open]:rotate-180"})]),_:1}),r(e(Ot),{class:"space-y-3 pt-1"},{default:n(()=>[s("div",_n,[r(De,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 scale-95 translate-y-1","enter-to-class":"opacity-100 scale-100 translate-y-0"},{default:n(()=>[o.value&&o.value.show_section_button?(S(),B("div",Cn,[r(e($),{onClick:a[0]||(a[0]=A=>C("generate-section")),disabled:!f.value||k.value||h.isGenerating||g.value["generate-section"],variant:"outline",class:"w-full h-auto flex-col items-start gap-2 p-3 rounded-xl border-primary/20 bg-background/50 hover:bg-primary/5 hover:border-primary/40 transition-all duration-300 text-left group relative overflow-hidden"},{default:n(()=>[a[12]||(a[12]=s("div",{class:"absolute inset-0 bg-gradient-to-r from-primary/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"},null,-1)),s("div",kn,[s("div",Sn,[r(e(Gt),{class:"h-3.5 w-3.5"}),a[11]||(a[11]=s("span",{class:"text-xs font-semibold"},"Write Next Section",-1))]),g.value["generate-section"]?(S(),q(e(Nr),{key:0,class:"h-3 w-3 animate-spin text-primary"})):X("",!0)]),s("div",En,[s("div",Tn,m(o.value?.section.name||F(c.value).name),1),s("div",$n,m(o.value?.section.description||F(c.value).description),1)])]),_:1},8,["disabled"])])):X("",!0)]),_:1}),r(De,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 scale-95 translate-y-1","enter-to-class":"opacity-100 scale-100 translate-y-0"},{default:n(()=>[o.value&&o.value.show_full_chapter_button?(S(),q(e($),{key:0,onClick:a[1]||(a[1]=A=>C("generate-full")),disabled:h.isGenerating||k.value||g.value["generate-full"],variant:"ghost",class:"w-full h-9 justify-start gap-2 px-3 rounded-lg text-xs text-muted-foreground hover:text-primary hover:bg-primary/5"},{default:n(()=>[r(e(Lr),{class:"h-3.5 w-3.5"}),a[13]||(a[13]=s("span",null,"Generate Complete Chapter",-1))]),_:1},8,["disabled"])):X("",!0)]),_:1}),r(De,{"enter-active-class":"transition-all duration-500 ease-out","enter-from-class":"opacity-0 scale-95 translate-y-2","enter-to-class":"opacity-100 scale-100 translate-y-0"},{default:n(()=>[o.value&&o.value.status==="COMPLETE"?(S(),B("div",An,[s("div",Dn,[r(e(qr),{class:"h-4 w-4"}),a[14]||(a[14]=s("span",{class:"text-sm font-semibold"},"Chapter Complete",-1))]),s("div",jn,[s("div",Mn,[a[15]||(a[15]=s("span",null,"Progress",-1)),s("span",null,m(o.value.completion_percentage)+"%",1)]),r(e(Mr),{"model-value":o.value.completion_percentage,class:"h-1.5"},null,8,["model-value"])])])):X("",!0)]),_:1})]),s("div",Ln,[r(e($),{onClick:a[2]||(a[2]=A=>C("improve")),disabled:!w.value||h.isGenerating||g.value.improve,variant:"outline",class:"h-20 flex-col gap-2 rounded-xl border-border/50 bg-background/50 hover:bg-accent hover:border-accent transition-all duration-300"},{default:n(()=>[s("div",Rn,[r(e(Hr),{class:"h-4 w-4"})]),a[16]||(a[16]=s("span",{class:"text-xs font-medium"},"Improve",-1))]),_:1},8,["disabled"]),r(e($),{onClick:a[3]||(a[3]=A=>C("expand")),disabled:!h.selectedText||h.isGenerating||g.value.expand,variant:"outline",class:"h-20 flex-col gap-2 rounded-xl border-border/50 bg-background/50 hover:bg-accent hover:border-accent transition-all duration-300"},{default:n(()=>[s("div",Pn,[r(e(Dr),{class:"h-4 w-4"})]),a[17]||(a[17]=s("span",{class:"text-xs font-medium"},"Expand",-1))]),_:1},8,["disabled"]),r(e($),{onClick:a[4]||(a[4]=A=>C("cite")),disabled:h.isGenerating||g.value.cite,variant:"outline",class:"h-20 flex-col gap-2 rounded-xl border-border/50 bg-background/50 hover:bg-accent hover:border-accent transition-all duration-300"},{default:n(()=>[s("div",Fn,[r(e(jr),{class:"h-4 w-4"})]),a[18]||(a[18]=s("span",{class:"text-xs font-medium"},"Cite",-1))]),_:1},8,["disabled"]),r(e($),{onClick:a[5]||(a[5]=A=>C("rephrase")),disabled:!h.selectedText||h.isGenerating||g.value.rephrase,variant:"outline",class:"h-20 flex-col gap-2 rounded-xl border-border/50 bg-background/50 hover:bg-accent hover:border-accent transition-all duration-300"},{default:n(()=>[s("div",zn,[r(e(Or),{class:"h-4 w-4"})]),a[19]||(a[19]=s("span",{class:"text-xs font-medium"},"Rephrase",-1))]),_:1},8,["disabled"]),h.canUndo?(S(),q(e($),{key:0,onClick:a[6]||(a[6]=A=>T("undoLastAction")),variant:"outline",class:"h-20 flex-col gap-2 rounded-xl border-border/50 bg-background/50 hover:bg-amber-500/10 hover:border-amber-500/30 transition-all duration-300 col-span-2"},{default:n(()=>[s("div",Wn,[r(e(Xr),{class:"h-4 w-4"})]),a[20]||(a[20]=s("span",{class:"text-xs font-medium"},"Undo Last AI Change",-1))]),_:1})):X("",!0)])]),_:1})]),_:1}),r(e(Be),{class:"bg-border/50"}),r(e(qt),{open:!0,class:"space-y-2"},{default:n(()=>[r(e(Ht),{class:"flex w-full items-center justify-between text-xs font-medium text-muted-foreground hover:text-foreground transition-colors group"},{default:n(()=>[s("span",Nn,[r(e(Gt),{class:"h-3.5 w-3.5 text-indigo-500/70 group-hover:text-indigo-500 transition-colors"}),a[21]||(a[21]=p(" WRITING STYLE ",-1))]),r(e(It),{class:"h-3 w-3 transition-transform duration-200 group-data-[state=open]:rotate-180"})]),_:1}),r(e(Ot),{class:"pt-1"},{default:n(()=>[s("div",qn,[Se(s("select",{"onUpdate:modelValue":a[7]||(a[7]=A=>R.value=A),class:"w-full bg-transparent border-none text-xs font-medium focus:ring-0 cursor-pointer py-1.5 px-2"},[...a[22]||(a[22]=[s("option",{value:"Academic Formal"},"Academic Formal",-1),s("option",{value:"Academic Casual"},"Academic Casual",-1),s("option",{value:"Technical"},"Technical",-1),s("option",{value:"Analytical"},"Analytical",-1),s("option",{value:"Research-Heavy"},"Research-Heavy",-1)])],512),[[rr,R.value]])])]),_:1})]),_:1})]),_:1})]),_:1}),r(Rr,{"show-citation-helper":h.showCitationHelper,"chapter-content":h.chapterContent,"chapter-id":h.chapter?.id||0,"onUpdate:showCitationHelper":a[8]||(a[8]=A=>T("update:showCitationHelper",A)),onInsertCitation:j},null,8,["show-citation-helper","chapter-content","chapter-id"])]))}}),On=pt(Hn,[["__scopeId","data-v-8c5c841d"]]),Bn={class:"h-14 flex items-center justify-between px-4 border-b border-border/40 shrink-0"},In={class:"flex-1 overflow-y-auto custom-scrollbar"},Gn={class:"p-4 space-y-6"},Zt=Ue({__name:"ChapterEditorRightSidebar",props:{project:{},chapter:{},isGenerating:{type:Boolean},selectedText:{},isLoadingSuggestions:{type:Boolean},showCitationHelper:{type:Boolean},chapterContent:{},currentWordCount:{},targetWordCount:{},handleAIGeneration:{type:Function},getAISuggestions:{type:Function},updateCitationHelper:{type:Function},insertCitation:{type:Function},checkCitations:{type:Function},showDefensePrep:{type:Boolean},defenseQuestions:{},isLoadingDefenseQuestions:{type:Boolean},isGeneratingDefenseQuestions:{type:Boolean},chapterContext:{},defenseWatcher:{},autoGenerateDefense:{type:Boolean},handleDefensePanelToggle:{type:Function},generateNewDefenseQuestions:{type:Function},handleDefenseAutoToggle:{type:Function},refreshDefenseQuestions:{type:Function},markQuestionHelpful:{type:Function},hideQuestion:{type:Function},isCollapsed:{type:Boolean},containerClass:{}},setup(b){const x=b;return(d,T)=>Se((S(),B("aside",{class:Ge(x.containerClass)},[s("div",Bn,[T[1]||(T[1]=s("span",{class:"text-sm font-semibold tracking-tight text-foreground"},"Writing Assistant",-1)),r(e(re),null,{default:n(()=>[r(e(te),{asChild:""},{default:n(()=>[r(e($),{variant:"ghost",size:"icon",class:"h-7 w-7"},{default:n(()=>[r(e(rs),{class:"h-3.5 w-3.5"})]),_:1})]),_:1}),r(e(se),null,{default:n(()=>[...T[0]||(T[0]=[p("Manage Citations",-1)])]),_:1})]),_:1})]),s("div",In,[s("div",Gn,[r(On,{project:x.project,chapter:x.chapter,"is-generating":x.isGenerating,"selected-text":x.selectedText,"is-loading-suggestions":x.isLoadingSuggestions,"show-citation-helper":x.showCitationHelper,"chapter-content":x.chapterContent,"current-word-count":x.currentWordCount,"target-word-count":x.targetWordCount,onStartStreamingGeneration:x.handleAIGeneration,onGetAiSuggestions:x.getAISuggestions,"onUpdate:showCitationHelper":x.updateCitationHelper,onInsertCitation:x.insertCitation,onCheckCitations:x.checkCitations},null,8,["project","chapter","is-generating","selected-text","is-loading-suggestions","show-citation-helper","chapter-content","current-word-count","target-word-count","onStartStreamingGeneration","onGetAiSuggestions","onUpdate:showCitationHelper","onInsertCitation","onCheckCitations"])])])],2)),[[Ae,!x.isCollapsed]])}});function Un(b){const x=E({sentences:0,paragraphs:0,readingTime:0,avgWordLength:0,uniqueWords:0,commonWords:[]}),d=P(()=>b.value?b.value.split(/\s+/).filter(o=>o.length>0).length:0),T=()=>{if(!b.value){x.value={sentences:0,paragraphs:0,readingTime:0,avgWordLength:0,uniqueWords:0,commonWords:[]};return}const o=b.value,k=o.split(/\s+/).filter(f=>f.length>0),g=o.split(/[.!?]+/).filter(f=>f.trim().length>0),_=o.split(`

`).filter(f=>f.trim().length>0),u=new Map;k.forEach(f=>{const i=f.toLowerCase().replace(/[^a-z0-9]/g,"");i&&u.set(i,(u.get(i)||0)+1)});const w=new Set(["the","a","an","and","or","but","in","on","at","to","for","of","with","by","is","was","are","were"]),c=Array.from(u.entries()).filter(([f])=>!w.has(f)).sort((f,i)=>i[1]-f[1]).slice(0,5).map(([f])=>f);x.value={sentences:g.length,paragraphs:_.length,readingTime:Math.ceil(k.length/200),avgWordLength:k.reduce((f,i)=>f+i.length,0)/k.length,uniqueWords:u.size,commonWords:c}},R=P(()=>{if(!b.value)return 0;let o=0;const k=b.value;k.includes("##")&&(o+=20),k.length>1e3&&(o+=20),k.match(/\[.*?\]/g)&&(o+=15),(k.includes("**")||k.includes("*"))&&(o+=10);const g=k.split(/[.!?]+/).filter(u=>u.trim().length>0);if(g.length>0){const u=g.reduce((w,c)=>w+c.split(/\s+/).length,0)/g.length;u>10&&u<25&&(o+=20)}return k.split(`

`).filter(u=>u.trim().length>0).length>3&&(o+=15),Math.min(o,100)});return{writingStats:x,currentWordCount:d,writingQualityScore:R,calculateWritingStats:T}}function Qn(b){const x=E(!1),d=E(null),T=E([]),R=E(null),o=P(()=>{if(!d.value?.quality_level)return"text-muted-foreground";switch(d.value.quality_level){case"Excellent":return"text-green-600";case"Good":return"text-blue-600";case"Satisfactory":return"text-yellow-600";case"Needs Improvement":return"text-orange-600";case"Poor":return"text-red-600";default:return"text-muted-foreground"}}),k=P(()=>d.value?.scores?Object.entries(d.value.scores).sort(([,i],[,C])=>i.percentage-C.percentage).slice(0,3).map(([i,C])=>({category:i.replace(" & "," & "),percentage:Math.round(C.percentage),score:C.score,max:C.max})):[]),g=async()=>{try{x.value=!0,R.value=null,await ce.get("/sanctum/csrf-cookie");const i=await ce.post(V("api.chapters.analysis.analyze",{chapter:b}));if(i.data.success)return d.value=i.data.analysis,i.data.analysis;throw new Error(i.data.error||"Analysis failed")}catch(i){return R.value=i.response?.data?.error||i.message||"Analysis failed",console.error("Chapter analysis failed:",i),null}finally{x.value=!1}};return{isAnalyzing:x,latestAnalysis:d,analysisHistory:T,error:R,qualityLevelColor:o,topImprovementAreas:k,analyzeChapter:g,getLatestAnalysis:async()=>{try{await ce.get("/sanctum/csrf-cookie");const i=await ce.get(V("api.chapters.analysis.latest",{chapter:b}));return i.data.success?(d.value=i.data.analysis,i.data.analysis):(d.value=null,null)}catch(i){return i.response?.status!==404&&(R.value=i.response?.data?.error||i.message||"Failed to get analysis",console.error("Failed to get latest analysis:",i)),null}},getAnalysisHistory:async()=>{try{await ce.get("/sanctum/csrf-cookie");const i=await ce.get(V("api.chapters.analysis.history",{chapter:b}));if(i.data.success)return T.value=i.data.analyses,i.data.analyses;throw new Error(i.data.error||"Failed to get history")}catch(i){return R.value=i.response?.data?.error||i.message||"Failed to get analysis history",console.error("Failed to get analysis history:",i),[]}},autoAnalyze:async(i,C=500)=>{i>=C&&await g()},getScoreColor:(i,C)=>{const W=i/C*100;return W>=80?"text-green-600":W>=70?"text-blue-600":W>=60?"text-yellow-600":W>=40?"text-orange-600":"text-red-600"},getProgressVariant:i=>i>=80?"success":i>=60?"default":"destructive"}}const Kn={key:0,class:"min-h-screen bg-background text-foreground"},Vn={class:"mx-auto max-w-5xl p-6"},Xn={class:"flex items-center justify-between gap-4"},Jn={class:"flex items-center gap-3"},Yn={class:"mt-6 grid gap-4"},Zn={class:"flex flex-wrap gap-x-6 gap-y-1"},eo={class:"grid gap-1"},to={class:"grid gap-1"},so={class:"grid gap-4 md:grid-cols-3"},ro={class:"mx-auto w-full max-w-5xl p-6"},no={class:"flex items-center justify-between gap-4"},oo={class:"flex items-center gap-3"},ao={class:"mt-6 grid gap-4"},lo={class:"flex flex-wrap gap-x-6 gap-y-1"},io={class:"grid gap-1"},uo={class:"grid gap-1"},co={class:"grid gap-4 md:grid-cols-3"},po={key:0,class:"rounded-xl border border-border bg-card p-4"},go={key:2,class:"flex h-screen flex-col overflow-hidden bg-background dark:bg-background font-sans selection:bg-primary/20 transition-colors duration-300"},fo={class:"relative z-20 flex flex-shrink-0 items-center justify-between border-b border-border/40 bg-background/60 p-4 backdrop-blur-xl supports-[backdrop-filter]:bg-background/40 transition-all duration-300"},mo={class:"flex items-center gap-5"},ho={class:"flex flex-col"},vo={class:"text-lg font-bold tracking-tight text-foreground/90 font-display"},bo={class:"flex items-center gap-3 text-xs text-muted-foreground"},xo={class:"flex items-center gap-1.5"},wo={class:"flex items-center gap-4"},yo={class:"flex items-center p-1 rounded-full border border-border/40 bg-background/50 backdrop-blur-sm shadow-sm"},_o={class:"flex items-center gap-2"},Co={class:"relative z-20 h-[2px] w-full bg-border/20"},ko={key:0,class:"mx-3 my-2"},So={class:"relative overflow-hidden rounded-xl border border-blue-200 bg-gradient-to-br from-blue-50 to-purple-50 p-3 shadow-sm dark:border-blue-800 dark:from-blue-950/30 dark:to-purple-950/30"},Eo={class:"relative z-10 mb-2 flex items-center justify-between"},To={class:"flex items-center gap-2"},$o={class:"relative"},Ao={class:"flex h-6 w-6 items-center justify-center rounded-full bg-gradient-to-br from-blue-500 to-purple-600"},Do={class:"text-xs text-blue-700 dark:text-blue-300"},jo={class:"relative z-10 mb-2"},Mo={class:"mb-1 flex items-center justify-between"},Lo={class:"text-xs text-blue-600 dark:text-blue-400"},Ro={class:"relative h-2 overflow-hidden rounded-full bg-blue-100 dark:bg-blue-900/50"},Po={class:"relative z-10 flex items-center gap-2"},Fo={class:"flex-shrink-0"},zo={key:0,class:"h-2 w-2 animate-bounce rounded-full bg-blue-500"},Wo={key:1,class:"flex gap-0.5"},No={key:2,class:"h-2 w-2 animate-spin rounded-full border-2 border-blue-500 border-t-transparent"},qo={key:3,class:"h-2 w-2 rounded-full bg-green-500"},Ho={key:4,class:"h-2 w-2 rounded-full bg-red-500"},Oo={class:"flex-1 text-xs text-blue-800 dark:text-blue-200"},Bo={class:"relative z-10 flex flex-1 overflow-hidden"},Io={key:0,class:"w-[320px] flex-shrink-0 border-r border-border/50 bg-background/80 backdrop-blur-xl shadow-xl z-20"},Go={class:"h-full overflow-y-auto custom-scrollbar"},Uo={class:"p-4"},Qo={class:"mb-3"},Ko={class:"text-xs text-muted-foreground"},Vo={class:"flex min-h-0 flex-1 flex-col bg-transparent relative"},Xo={class:"flex-1 overflow-hidden relative"},Jo={class:"absolute inset-0 overflow-y-auto custom-scrollbar flex flex-col items-center py-8 px-4 sm:px-8"},Yo={class:"flex h-full w-full overflow-hidden relative"},Zo={class:"hidden lg:flex w-80 flex-col border-r border-border/40 bg-background/60 backdrop-blur-xl z-20 transition-all duration-300"},ea={class:"h-14 flex items-center justify-between px-4 border-b border-border/40 shrink-0"},ta={class:"p-4"},sa={class:"flex-1 flex flex-col relative z-10 min-w-0 bg-background/30 dark:bg-background transition-all duration-300"},ra={class:"md:hidden flex flex-wrap items-start justify-between border-b border-border/40 bg-background/60 backdrop-blur-md px-4 py-3 relative z-30 transition-all duration-300 gap-y-2"},na={class:"flex items-center gap-2 flex-shrink-0 order-1"},oa={class:"flex items-center order-2"},aa={class:"order-3 w-full flex flex-col gap-3"},la={class:"flex items-start gap-3 w-full min-w-0"},ia={class:"flex items-center gap-2 justify-between mt-1"},da={class:"flex items-center gap-2"},ua={class:"flex items-center gap-2"},ca={key:0,class:"inline"},pa={class:"hidden md:flex flex-col w-full z-30 bg-background/60 backdrop-blur-md transition-all duration-300 relative"},ga={class:"h-10 border-b border-border/40 flex items-left justify-left px-4 bg-background/40"},fa={class:"flex items-left gap-3"},ma=["innerHTML"],ha={class:"h-12 border-b border-border/40 flex items-center justify-between px-4 gap-3 bg-muted/10"},va={class:"flex items-center gap-1"},ba={class:"flex items-center gap-3"},xa={class:"flex items-center bg-background/50 rounded-full border border-border/50 p-1 backdrop-blur-sm shadow-sm"},wa={class:"hidden xl:inline"},ya={class:"hidden xl:inline"},_a={class:"flex items-center gap-2"},Ca={class:"flex items-center gap-2 pl-2 border-l border-border/50"},ka={class:"inline"},Sa={class:"flex-1 overflow-hidden relative group bg-background/20"},Ea={key:0,class:"absolute top-6 left-0 right-0 z-40 px-4 flex justify-center pointer-events-none"},Ta={class:"w-full max-w-lg pointer-events-auto"},$a={class:"relative overflow-hidden rounded-xl border border-blue-200 bg-gradient-to-br from-blue-50/95 to-purple-50/95 p-3 shadow-lg backdrop-blur-lg dark:border-blue-800 dark:from-blue-950/90 dark:to-purple-950/90"},Aa={class:"flex items-center gap-3"},Da={class:"relative flex h-8 w-8 items-center justify-center rounded-full bg-gradient-to-br from-blue-500 to-purple-600 shadow-md"},ja={class:"flex-1 min-w-0"},Ma={class:"flex items-center justify-between mb-1"},La={class:"text-xs font-mono text-muted-foreground"},Ra={class:"h-1.5 w-full bg-blue-100 dark:bg-blue-900/40 rounded-full overflow-hidden"},Pa={class:"mt-2 text-xs text-muted-foreground ml-11 truncate"},Fa={class:"mx-auto py-12 px-6 sm:px-10 min-h-full"},za={class:"min-h-[600px] pb-32"},Wa={class:"pb-32"},Na={class:"h-7 border-t border-border/30 bg-background/40 backdrop-blur-sm flex items-center justify-between px-4 text-[10px] text-muted-foreground shrink-0"},qa={class:"flex items-center gap-3"},Ha={class:"hidden sm:inline"},Oa={class:"flex items-center gap-2"},Ba={key:0,class:"text-green-500 flex items-center gap-1 ml-2"},Ia={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},Ga={class:"text-slate-600 dark:text-slate-300 mb-4"},Ua={class:"font-semibold text-amber-600 dark:text-amber-400"},Qa={class:"flex flex-col sm:flex-row gap-3"},Ka=1e3,Va=Ue({__name:"ChapterEditor",props:{project:{},chapter:{},allChapters:{},facultyChapters:{},mode:{}},setup(b){const x=Ve(()=>Je(()=>import("./ChapterNavigation-B7HeNR_o.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]))),d=Ve(()=>Je(()=>import("./MobileNavOverlay-CpWzhNS2.js"),__vite__mapDeps([25,3,4,26,2,1,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93]))),T=Ve(()=>Je(()=>import("./ChatModeLayout-B-IRqiP2.js"),__vite__mapDeps([94,3,4,18,2,8,28,31,6,7,32,5,9,42,43,44,45,46,47,48,49,50,51,52,53,54,15,55,24,12,13,14,11,16,56,57,58,41,59,60,19,61,62,95,26,96,69,64,91,97,98,20,37,88,92,40,29,30,33,34,10,63,65,66,67,36,68,38,23,87,99,21,71,100,101,86,72,73,74,75,76,77,78,79,80,81,82,83,84,85,70,89,90,102]))),R=Ve(()=>Je(()=>import("./CitationVerificationLayout-Ckl4lazv.js"),__vite__mapDeps([103,18,2,3,4,8,28,29,31,6,7,32,5,9,104,44,14,96,21,12,13,15,11,16,33,34,72,73,74,19,75,76,77,78,79,63,20,80,81,82,56,57,58,65,83,84,85,41,59,42,43,45,46,47,48,49,50,51,52,53,54,55,24,60,61,62,86,30,40,10,37,64,66,67,36,68,69,87,88,70,89,90,91,92]))),o=b,k=E(null),g=E(null),_=E(!1),u=E(!1),w=E(0);if(typeof window<"u"){const l=new URLSearchParams(window.location.search);_.value=l.has("theme_sandbox"),u.value=l.get("theme_sandbox")==="nolayout"||l.has("theme_sandbox_nolayout");const t=l.get("theme_sandbox_step"),v=t?Number.parseInt(t,10):0;w.value=Number.isFinite(v)?v:0}const{appearance:c,isDark:f}=es(),i=E({htmlHasDark:!1,background:"",foreground:"",card:"",sidebarBackground:"",bodyBg:"",insetBg:"",sampleBgBackground:"",sampleBgCard:"",sampleBgMuted:""}),C=E(null),W=E(null),F=E(null);function j(){if(typeof window>"u")return;const l=document.documentElement,t=window.getComputedStyle(l),v=document.querySelector('[data-slot="sidebar-inset"]'),Q=v?window.getComputedStyle(v).backgroundColor:"";i.value={htmlHasDark:l.classList.contains("dark"),background:t.getPropertyValue("--background").trim(),foreground:t.getPropertyValue("--foreground").trim(),card:t.getPropertyValue("--card").trim(),sidebarBackground:t.getPropertyValue("--sidebar-background").trim(),bodyBg:window.getComputedStyle(document.body).backgroundColor,insetBg:Q,sampleBgBackground:C.value?window.getComputedStyle(C.value).backgroundColor:"",sampleBgCard:W.value?window.getComputedStyle(W.value).backgroundColor:"",sampleBgMuted:F.value?window.getComputedStyle(F.value).backgroundColor:""}}const{chapterTitle:h,chapterContent:a,showPreview:A,isEditorDark:H,toggleChapterTheme:D,isNativeFullscreen:y,selectedText:O,showChatMode:I,showCitationMode:J,showDefensePrep:me,loadChatModeFromStorage:U,saveChatModeToStorage:ie,showLeftSidebar:je,showRightSidebar:Me,isMobile:Qe,isLeftSidebarCollapsed:Ee,isRightSidebarCollapsed:M,showLeftSidebarInFullscreen:N,showRightSidebarInFullscreen:G}=Jr(o),{balance:L,showPurchaseModal:K,requiredWordsForModal:Le,actionDescriptionForModal:Re,checkAndPrompt:Pe,closePurchaseModal:Ze,estimates:Fe}=ur(),ze=(l,t)=>Pe(Math.max(1,Math.round(l)),t),{hasUnsavedChanges:et,isSaving:Y,triggerAutoSave:We,save:he,clearAutoSave:os}=cr({delay:1e4,onSave:St});let gt=0;const as=()=>{const l=Date.now();l-gt>Ka&&(gt=l,z.success("Saved",{duration:2e3}))},{contentHistory:ls,historyIndex:is,addToHistory:ds,undo:us,redo:cs}=Pr(o.chapter.content||""),{writingStats:ft,writingQualityScore:ve,calculateWritingStats:tt}=Un(a),{isAnalyzing:ps,latestAnalysis:gs,getLatestAnalysis:fs}=Qn(o.chapter.id),de=P(()=>{if(o.facultyChapters&&o.facultyChapters.length>0){const t=o.facultyChapters.find(v=>v.number===o.chapter.chapter_number);if(t?.word_count)return t.word_count}if(o.project?.outlines&&o.project.outlines.length>0){const t=o.project.outlines.find(v=>v.chapter_number===o.chapter.chapter_number);if(t?.target_word_count)return t.target_word_count}const l=o.project.type==="undergraduate"?2500:3500;return o.chapter.chapter_number===1||o.chapter.chapter_number===5?Math.round(l*.8):l}),{generateNextChapter:st}=Yr({props:o,allChapters:o.allChapters,targetWordCount:de,estimates:Fe,ensureBalance:ze,save:he}),{currentWordCount:Z,progressPercentage:ms,DEFENSE_THRESHOLD:hs,countWords:vs}=pr(a,de),rt=ms,mt=P(()=>({chapter:o.chapter,chapterTitle:h,chapterContent:a,showPresentationMode:be,togglePresentationMode:Dt,isStreamingMode:xt,isGenerating:we,generationProgress:Ne,generationPercentage:ye,generationPhase:_e,aiChapterAnalysis,nextSection,getSectionInfo,writingStats:ft,latestAnalysis:gs,isAnalyzing:ps,writingQualityScore:ve,isSaving:Y,isValid:qe,save:he,goToBulkAnalysis:ot,markAsComplete:at,richTextEditor:k,richTextEditorFullscreen:g,selectedText:O,setSelectedText:l=>{O.value=l}})),bs=P(()=>({chapter_number:kt.value.chapter_number,chapter_title:kt.value.title,word_count:Z.value})),xs=P(()=>({meetsThreshold:Rs.value,shouldShowProgress:Ds.value,progressPercentage:js.value,wordsRemaining:Ms.value,hasTriggeredGeneration:Ls,threshold:hs,statusMessage:As()})),ht=P(()=>({project:pe.value,chapter:ge.value,isGenerating:we.value,selectedText:O.value,isLoadingSuggestions:bt.value,showCitationHelper:Ke.value,chapterContent:a.value,currentWordCount:Z.value,targetWordCount:de.value,handleAIGeneration:yt,getAISuggestions:_t,updateCitationHelper:l=>{Ke.value=l},insertCitation:qs,checkCitations:Ct,showDefensePrep:me.value,defenseQuestions:ws.value??[],isLoadingDefenseQuestions:ys.value,isGeneratingDefenseQuestions:_s.value,chapterContext:bs.value,defenseWatcher:xs.value,autoGenerateDefense:Cs.value,handleDefensePanelToggle:Vs,generateNewDefenseQuestions:Ss,handleDefenseAutoToggle:$s,refreshDefenseQuestions:()=>vt(!0,{skipGeneration:!0}),markQuestionHelpful:Es,hideQuestion:Ts})),{defenseQuestions:ws,isLoadingDefenseQuestions:ys,isGeneratingDefenseQuestions:_s,autoGenerateDefense:Cs,shouldLoadDefenseQuestions:ks,loadDefenseQuestions:vt,generateNewDefenseQuestions:Ss,markQuestionHelpful:Es,hideQuestion:Ts,handleDefenseAutoToggle:$s,getDefenseStatusMessage:As,shouldShowDefenseProgress:Ds,defenseProgressPercentage:js,defenseWordsRemaining:Ms,hasTriggeredGeneration:Ls,meetsDefenseThreshold:Rs}=en({props:o,chapterContent:a,currentWordCount:Z,ensureBalance:ze,estimates:Fe}),{isGenerating:we,generationProgress:Ne,generationPercentage:ye,generationPhase:_e,estimatedTotalWords:Ps,streamWordCount:Fs,streamBuffer:Ja,lastStreamUpdate:Ya,originalContentForAppend:Za,aiSuggestions:el,isLoadingSuggestions:bt,showCitationHelper:Ke,showPresentationMode:be,isStreamingMode:xt,showRecoveryDialog:zs,partialContentSaved:tl,savedWordCountOnError:Ws,isCollectingPapers:sl,paperCollectionProgress:rl,paperCollectionPhase:nl,collectedPapersCount:ol,paperCollectionPercentage:al,currentSource:ll,sourcesCompleted:il,papersPreview:dl,paperCollectionData:ul,paperCollectionInterval:cl,reconnectAttempts:pl,reconnectDelay:gl,isReconnecting:fl,currentGenerationId:ml,currentGenerationType:hl,eventSource:wt,editorScrollRef:Ns,attachScroller:vl,smoothScrollToBottom:bl,forceScrollToBottom:xl,resetScroller:wl,isAutoScrollActive:yl,isUserScrollingScroller:_l,scrollToBottom:Cl,checkConnectionQuality:kl,handleAIGeneration:yt,getAISuggestions:_t,checkCitations:Ct,insertCitation:qs,resumeGeneration:Hs,dismissRecovery:Os,checkForAutoGeneration:Bs}=gr({props:o,chapterContent:a,targetWordCount:de,estimates:Fe,ensureBalance:ze,save:he,triggerAutoSave:We,calculateWritingStats:tt,countWords:vs,selectedText:O,richTextEditor:k,richTextEditorFullscreen:g,isNativeFullscreen:y}),qe=P(()=>{const l=h.value?.trim(),t=a.value?.trim();return l&&l.length>0&&t&&t.length>50}),pe=P(()=>o.project),ge=P(()=>o.chapter),xe=P(()=>o.allChapters),kt=P(()=>o.chapter);async function St(l=!1){try{const t=await fetch(V("chapters.save",{project:o.project.id}),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({project_id:o.project.id,chapter_number:o.chapter.chapter_number,title:h.value,content:a.value,auto_save:l,statistics:ft.value,quality_score:ve.value})});console.log("Response status:",t.status,t.statusText),console.log("Response headers:",t.headers);const v=await t.text();console.log("Raw response:",v);let Q;try{Q=JSON.parse(v)}catch(fe){throw console.error("JSON parse error:",fe),console.error("Response was:",v),new Error(`Server returned non-JSON response: ${t.status} ${t.statusText}`)}t.ok}catch(t){throw l||z.error("âŒ Save Failed",{description:"Please try again or check your connection."}),t}}const Et=()=>{const l=us();l!==null&&(a.value=l,We())},Tt=()=>{const l=cs();l!==null&&(a.value=l,We())},He=l=>{et.value&&confirm("You have unsaved changes. Save before switching chapters?")&&he();const t=o.allChapters.find(fe=>fe.chapter_number===l),Q=t?.content&&t.content.trim()!==""?"chapters.edit":"chapters.write";ee.visit(V(Q,{project:o.project.slug,chapter:l}),{only:["chapter","mode","allChapters"],preserveState:!0,preserveScroll:!1})},$t=()=>document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||null,Is=async()=>{try{const l=document.documentElement;l.requestFullscreen?await l.requestFullscreen({navigationUI:"hide"}):l.webkitRequestFullscreen?await l.webkitRequestFullscreen():l.msRequestFullscreen&&await l.msRequestFullscreen()}catch(l){console.error("Error entering fullscreen:",l),z.error("Fullscreen Error",{description:"Unable to enter fullscreen mode"})}},Gs=async()=>{try{document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.msExitFullscreen&&await document.msExitFullscreen()}catch(l){console.error("Error exiting fullscreen:",l),z.error("Fullscreen Error",{description:"Unable to exit fullscreen mode"})}},nt=async()=>{if($t()){await Gs();return}await Is()},Ce=()=>{y.value=!!$t(),Te(()=>{_.value&&j()})},At=()=>{I.value=!I.value,I.value&&(J.value=!1),ie(I.value)},Us=()=>{I.value=!1,ie(!1)},Qs=()=>{J.value=!1},Dt=()=>{be.value=!be.value},ot=()=>{ee.visit(V("projects.analysis",{project:o.project.slug}))},Ks=()=>{ds(a.value),We(),tt()},jt=l=>{(l.ctrlKey||l.metaKey)&&l.key==="s"&&(l.preventDefault(),he(),as()),(l.ctrlKey||l.metaKey)&&!l.shiftKey&&l.key==="z"&&(l.preventDefault(),Et()),(l.ctrlKey||l.metaKey)&&l.shiftKey&&l.key==="z"&&(l.preventDefault(),Tt()),(l.ctrlKey||l.metaKey)&&l.shiftKey&&(l.key==="f"||l.key==="F")&&(l.preventDefault(),nt())};$e(()=>{const l=()=>{Qe.value=window.innerWidth<1024};l(),window.addEventListener("resize",l),I.value=U(),document.addEventListener("keydown",Mt),document.addEventListener("keydown",jt),document.addEventListener("fullscreenchange",Ce),document.addEventListener("webkitfullscreenchange",Ce),document.addEventListener("msfullscreenchange",Ce),Ce(),tt(),Bs()});const Mt=l=>{if((l.ctrlKey||l.metaKey)&&!["INPUT","TEXTAREA","SELECT"].includes(l.target?.tagName))switch(l.key){case"ArrowLeft":l.preventDefault();const t=o.chapter.chapter_number-1;o.allChapters.find(Oe=>Oe.chapter_number===t)&&He(t);break;case"ArrowRight":l.preventDefault();const Q=o.chapter.chapter_number+1;o.allChapters.find(Oe=>Oe.chapter_number===Q)&&He(Q);break}};$e(()=>{const l=t=>{const v=Q=>{const{scrollTop:fe,scrollHeight:Oe,clientHeight:Xs}=t,Lt=Q.deltaY,Js=fe<=0,Ys=fe+Xs>=Oe;Lt<0&&Js||Lt>0&&Ys||Q.stopPropagation()};return t.addEventListener("wheel",v,{passive:!0}),()=>t.removeEventListener("wheel",v)};Te(()=>{const t=document.querySelectorAll('[class*="overflow-y-auto"]'),v=[];t.forEach(Q=>{if(Q instanceof HTMLElement){const fe=l(Q);v.push(fe)}}),window.__scrollChainCleanup=v})}),nr(()=>{os(),wt.value&&wt.value.close(),document.removeEventListener("keydown",jt),document.removeEventListener("keydown",Mt);const l=window.__scrollChainCleanup;l&&Array.isArray(l)&&(l.forEach(t=>t()),delete window.__scrollChainCleanup),document.removeEventListener("fullscreenchange",Ce),document.removeEventListener("webkitfullscreenchange",Ce),document.removeEventListener("msfullscreenchange",Ce)}),le(()=>o.chapter,async l=>{h.value=l.title||"",a.value=l.content||""},{immediate:!1});const Vs=async l=>{me.value=l,l&&ks()&&await vt(!1,{skipGeneration:!0})};le(a,Ks),le(h,We);const at=async()=>{console.log("ðŸ”µ [MARK COMPLETE] Function called"),console.log("ðŸ”µ [MARK COMPLETE] Current word count:",Z.value);try{console.log("ðŸ”µ [MARK COMPLETE] Saving chapter..."),await he(!1),console.log("âœ… [MARK COMPLETE] Chapter saved");const l=V("chapters.mark-complete",{project:o.project.slug,chapter:o.chapter.chapter_number});console.log("ðŸ”µ [MARK COMPLETE] Posting to:",l),ee.post(l,{},{onSuccess:()=>{console.log("âœ… [MARK COMPLETE] Request successful")},onError:t=>{console.error("âŒ [MARK COMPLETE] Request failed:",t)}})}catch(l){console.error("âŒ [MARK COMPLETE] Error:",l),z.error("Failed to save chapter before marking complete")}};return $e(async()=>{await fs()}),$e(()=>{_.value&&Te(()=>j())}),le(f,()=>{_.value&&Te(()=>j())},{flush:"post"}),(l,t)=>(S(),q(e(lr),null,{default:n(()=>[_.value?(S(),B(Rt,{key:0},[u.value?(S(),B("div",Kn,[s("div",Vn,[s("div",Xn,[t[28]||(t[28]=s("div",null,[s("h1",{class:"text-lg font-semibold"},"ChapterEditor Theme Sandbox"),s("p",{class:"text-sm text-muted-foreground"},"No layout mode. Use `?theme_sandbox=nolayout`.")],-1)),s("div",Jn,[r(zt),r(e($),{variant:"outline",size:"sm",onClick:j},{default:n(()=>[...t[26]||(t[26]=[p("Refresh",-1)])]),_:1}),r(e($),{variant:"outline",size:"sm",onClick:t[0]||(t[0]=v=>e(ee).visit(l.window.location.pathname))},{default:n(()=>[...t[27]||(t[27]=[p("Exit",-1)])]),_:1})])]),s("div",Yn,[r(e(ne),{class:"bg-card text-card-foreground"},{default:n(()=>[r(e(ae),null,{default:n(()=>[r(e(ue),{class:"text-base"},{default:n(()=>[...t[29]||(t[29]=[p("Theme State",-1)])]),_:1})]),_:1}),r(e(oe),{class:"space-y-2 text-sm"},{default:n(()=>[s("div",Zn,[s("div",null,[t[30]||(t[30]=s("span",{class:"text-muted-foreground"},"appearance:",-1)),p(" "+m(e(c)),1)]),s("div",null,[t[31]||(t[31]=s("span",{class:"text-muted-foreground"},"isDark:",-1)),p(" "+m(e(f)),1)]),s("div",null,[t[32]||(t[32]=s("span",{class:"text-muted-foreground"},"html.dark:",-1)),p(" "+m(i.value.htmlHasDark),1)]),s("div",null,[t[33]||(t[33]=s("span",{class:"text-muted-foreground"},"step:",-1)),p(" "+m(w.value),1)])]),r(e(Be)),s("div",eo,[s("div",null,[t[34]||(t[34]=s("span",{class:"text-muted-foreground"},"--background:",-1)),p(" "+m(i.value.background),1)]),s("div",null,[t[35]||(t[35]=s("span",{class:"text-muted-foreground"},"--foreground:",-1)),p(" "+m(i.value.foreground),1)]),s("div",null,[t[36]||(t[36]=s("span",{class:"text-muted-foreground"},"--card:",-1)),p(" "+m(i.value.card),1)]),s("div",null,[t[37]||(t[37]=s("span",{class:"text-muted-foreground"},"--sidebar-background:",-1)),p(" "+m(i.value.sidebarBackground),1)])]),r(e(Be)),s("div",to,[s("div",null,[t[38]||(t[38]=s("span",{class:"text-muted-foreground"},"body bg:",-1)),p(" "+m(i.value.bodyBg),1)]),s("div",null,[t[39]||(t[39]=s("span",{class:"text-muted-foreground"},"inset bg:",-1)),p(" "+m(i.value.insetBg),1)]),s("div",null,[t[40]||(t[40]=s("span",{class:"text-muted-foreground"},"sample bg-background:",-1)),p(" "+m(i.value.sampleBgBackground),1)]),s("div",null,[t[41]||(t[41]=s("span",{class:"text-muted-foreground"},"sample bg-card:",-1)),p(" "+m(i.value.sampleBgCard),1)]),s("div",null,[t[42]||(t[42]=s("span",{class:"text-muted-foreground"},"sample bg-muted:",-1)),p(" "+m(i.value.sampleBgMuted),1)])])]),_:1})]),_:1}),s("div",so,[r(e(ne),{ref_key:"sampleBgBackgroundEl",ref:C,class:"bg-background"},{default:n(()=>[r(e(ae),null,{default:n(()=>[r(e(ue),{class:"text-base"},{default:n(()=>[...t[43]||(t[43]=[p("bg-background",-1)])]),_:1})]),_:1}),r(e(oe),{class:"text-sm text-muted-foreground"},{default:n(()=>[...t[44]||(t[44]=[p("Should flip with theme.",-1)])]),_:1})]),_:1},512),r(e(ne),{ref_key:"sampleBgCardEl",ref:W,class:"bg-card"},{default:n(()=>[r(e(ae),null,{default:n(()=>[r(e(ue),{class:"text-base"},{default:n(()=>[...t[45]||(t[45]=[p("bg-card",-1)])]),_:1})]),_:1}),r(e(oe),{class:"text-sm text-muted-foreground"},{default:n(()=>[...t[46]||(t[46]=[p("Card surface color.",-1)])]),_:1})]),_:1},512),r(e(ne),{ref_key:"sampleBgMutedEl",ref:F,class:"bg-muted"},{default:n(()=>[r(e(ae),null,{default:n(()=>[r(e(ue),{class:"text-base"},{default:n(()=>[...t[47]||(t[47]=[p("bg-muted",-1)])]),_:1})]),_:1}),r(e(oe),{class:"text-sm text-muted-foreground"},{default:n(()=>[...t[48]||(t[48]=[p("Muted surface color.",-1)])]),_:1})]),_:1},512)])])])])):(S(),q(Wt,{key:1,class:"h-screen overflow-hidden bg-background text-foreground"},{default:n(()=>[s("div",ro,[s("div",no,[t[51]||(t[51]=s("div",null,[s("h1",{class:"text-lg font-semibold"},"ChapterEditor Theme Sandbox"),s("p",{class:"text-sm text-muted-foreground"}," Use `?theme_sandbox=1` (with layout) or `?theme_sandbox=nolayout`. ")],-1)),s("div",oo,[r(zt),r(e($),{variant:"outline",size:"sm",onClick:j},{default:n(()=>[...t[49]||(t[49]=[p("Refresh",-1)])]),_:1}),r(e($),{variant:"outline",size:"sm",onClick:t[1]||(t[1]=v=>e(ee).visit(l.window.location.pathname))},{default:n(()=>[...t[50]||(t[50]=[p("Exit",-1)])]),_:1})])]),s("div",ao,[r(e(ne),{class:"bg-card text-card-foreground"},{default:n(()=>[r(e(ae),null,{default:n(()=>[r(e(ue),{class:"text-base"},{default:n(()=>[...t[52]||(t[52]=[p("Theme State",-1)])]),_:1})]),_:1}),r(e(oe),{class:"space-y-2 text-sm"},{default:n(()=>[s("div",lo,[s("div",null,[t[53]||(t[53]=s("span",{class:"text-muted-foreground"},"appearance:",-1)),p(" "+m(e(c)),1)]),s("div",null,[t[54]||(t[54]=s("span",{class:"text-muted-foreground"},"isDark:",-1)),p(" "+m(e(f)),1)]),s("div",null,[t[55]||(t[55]=s("span",{class:"text-muted-foreground"},"html.dark:",-1)),p(" "+m(i.value.htmlHasDark),1)]),s("div",null,[t[56]||(t[56]=s("span",{class:"text-muted-foreground"},"step:",-1)),p(" "+m(w.value),1)])]),r(e(Be)),s("div",io,[s("div",null,[t[57]||(t[57]=s("span",{class:"text-muted-foreground"},"--background:",-1)),p(" "+m(i.value.background),1)]),s("div",null,[t[58]||(t[58]=s("span",{class:"text-muted-foreground"},"--foreground:",-1)),p(" "+m(i.value.foreground),1)]),s("div",null,[t[59]||(t[59]=s("span",{class:"text-muted-foreground"},"--card:",-1)),p(" "+m(i.value.card),1)]),s("div",null,[t[60]||(t[60]=s("span",{class:"text-muted-foreground"},"--sidebar-background:",-1)),p(" "+m(i.value.sidebarBackground),1)])]),r(e(Be)),s("div",uo,[s("div",null,[t[61]||(t[61]=s("span",{class:"text-muted-foreground"},"body bg:",-1)),p(" "+m(i.value.bodyBg),1)]),s("div",null,[t[62]||(t[62]=s("span",{class:"text-muted-foreground"},"inset bg:",-1)),p(" "+m(i.value.insetBg),1)]),s("div",null,[t[63]||(t[63]=s("span",{class:"text-muted-foreground"},"sample bg-background:",-1)),p(" "+m(i.value.sampleBgBackground),1)]),s("div",null,[t[64]||(t[64]=s("span",{class:"text-muted-foreground"},"sample bg-card:",-1)),p(" "+m(i.value.sampleBgCard),1)]),s("div",null,[t[65]||(t[65]=s("span",{class:"text-muted-foreground"},"sample bg-muted:",-1)),p(" "+m(i.value.sampleBgMuted),1)])])]),_:1})]),_:1}),s("div",co,[r(e(ne),{ref_key:"sampleBgBackgroundEl",ref:C,class:"bg-background"},{default:n(()=>[r(e(ae),null,{default:n(()=>[r(e(ue),{class:"text-base"},{default:n(()=>[...t[66]||(t[66]=[p("bg-background",-1)])]),_:1})]),_:1}),r(e(oe),{class:"text-sm text-muted-foreground"},{default:n(()=>[...t[67]||(t[67]=[p("Should flip with theme.",-1)])]),_:1})]),_:1},512),r(e(ne),{ref_key:"sampleBgCardEl",ref:W,class:"bg-card"},{default:n(()=>[r(e(ae),null,{default:n(()=>[r(e(ue),{class:"text-base"},{default:n(()=>[...t[68]||(t[68]=[p("bg-card",-1)])]),_:1})]),_:1}),r(e(oe),{class:"text-sm text-muted-foreground"},{default:n(()=>[...t[69]||(t[69]=[p("Card surface color.",-1)])]),_:1})]),_:1},512),r(e(ne),{ref_key:"sampleBgMutedEl",ref:F,class:"bg-muted"},{default:n(()=>[r(e(ae),null,{default:n(()=>[r(e(ue),{class:"text-base"},{default:n(()=>[...t[70]||(t[70]=[p("bg-muted",-1)])]),_:1})]),_:1}),r(e(oe),{class:"text-sm text-muted-foreground"},{default:n(()=>[...t[71]||(t[71]=[p("Muted surface color.",-1)])]),_:1})]),_:1},512)]),w.value>=1?(S(),B("div",po,[t[72]||(t[72]=s("div",{class:"text-sm font-medium"},"Step 1: Paper Card only",-1)),t[73]||(t[73]=s("div",{class:"text-xs text-muted-foreground mb-3"},"Adds `ChapterEditorPaperCard` only.",-1)),r(Yt,{context:mt.value},null,8,["context"])])):X("",!0)])])]),_:1}))],64)):(S(),B(Rt,{key:1},[e(I)?(S(),q(e(T),{key:0,project:pe.value,chapter:ge.value,"chapter-title":e(h),"chapter-content":e(a),"current-word-count":e(Z),"target-word-count":de.value,"progress-percentage":e(rt),"writing-quality-score":e(ve),"is-valid":qe.value,"is-saving":e(Y),"show-preview":e(A),"is-generating":e(we),"generation-progress":e(Ne),"history-index":e(is),"content-history-length":e(ls).length,"selected-text":e(O),"onUpdate:chapterTitle":t[2]||(t[2]=v=>h.value=v),"onUpdate:chapterContent":t[3]||(t[3]=v=>a.value=v),"onUpdate:selectedText":t[4]||(t[4]=v=>O.value=v),"onUpdate:showPreview":t[5]||(t[5]=v=>A.value=v),onSave:t[6]||(t[6]=v=>St(v)),onUndo:Et,onRedo:Tt,onExitChatMode:Us},null,8,["project","chapter","chapter-title","chapter-content","current-word-count","target-word-count","progress-percentage","writing-quality-score","is-valid","is-saving","show-preview","is-generating","generation-progress","history-index","content-history-length","selected-text"])):e(J)?(S(),q(e(R),{key:1,project:pe.value,chapter:ge.value,"chapter-title":e(h),"chapter-content":e(a),"current-word-count":e(Z),"target-word-count":de.value,"progress-percentage":e(rt),onExitCitationMode:Qs},null,8,["project","chapter","chapter-title","chapter-content","current-word-count","target-word-count","progress-percentage"])):e(y)?(S(),B("div",go,[t[90]||(t[90]=s("div",{class:"absolute inset-0 z-0 overflow-hidden pointer-events-none"},[s("div",{class:"absolute top-[-20%] left-[-10%] w-[50%] h-[50%] rounded-full bg-blue-500/5 blur-[120px]"}),s("div",{class:"absolute bottom-[-20%] right-[-10%] w-[50%] h-[50%] rounded-full bg-purple-500/5 blur-[120px]"})],-1)),s("div",fo,[s("div",mo,[r(e(re),null,{default:n(()=>[r(e(te),{asChild:""},{default:n(()=>[r(e($),{onClick:t[7]||(t[7]=v=>e(ee).visit(e(V)("projects.show",o.project.slug))),variant:"ghost",size:"icon",class:"h-10 w-10 rounded-full hover:bg-primary/10 hover:text-primary transition-all duration-300"},{default:n(()=>[r(e(it),{class:"h-5 w-5"})]),_:1})]),_:1}),r(e(se),null,{default:n(()=>[...t[74]||(t[74]=[s("p",null,"Back to Project",-1)])]),_:1})]),_:1}),s("div",ho,[s("h1",vo,m(o.project.title),1),s("div",bo,[r(e(ke),{variant:"outline",class:"h-5 px-2 rounded-full border-primary/20 bg-primary/5 text-primary font-medium"},{default:n(()=>[p(" Chapter "+m(o.chapter.chapter_number),1)]),_:1}),s("span",xo,[t[75]||(t[75]=s("span",{class:"h-1.5 w-1.5 rounded-full bg-green-500 animate-pulse"},null,-1)),p(" "+m(e(Z))+" words ",1)])])])]),s("div",wo,[s("div",yo,[r(e($),{onClick:t[8]||(t[8]=v=>N.value=!e(N)),variant:e(N)?"secondary":"ghost",size:"sm",class:Ge(["h-8 px-4 rounded-full text-xs font-medium transition-all duration-300",e(N)?"bg-primary/10 text-primary hover:bg-primary/15":"hover:bg-muted"])},{default:n(()=>[r(e(Ut),{class:"mr-2 h-3.5 w-3.5"}),t[76]||(t[76]=p(" Outline ",-1))]),_:1},8,["variant","class"]),t[78]||(t[78]=s("div",{class:"w-px h-4 bg-border/50 mx-1"},null,-1)),r(e($),{onClick:t[9]||(t[9]=v=>G.value=!e(G)),variant:e(G)?"secondary":"ghost",size:"sm",class:Ge(["h-8 px-4 rounded-full text-xs font-medium transition-all duration-300",e(G)?"bg-primary/10 text-primary hover:bg-primary/15":"hover:bg-muted"])},{default:n(()=>[r(e(Ie),{class:"mr-2 h-3.5 w-3.5"}),t[77]||(t[77]=p(" Assistant ",-1))]),_:1},8,["variant","class"])]),s("div",_o,[r(e(re),null,{default:n(()=>[r(e(te),{asChild:""},{default:n(()=>[r(e($),{onClick:At,variant:"ghost",size:"icon",class:"h-9 w-9 rounded-full transition-all hover:bg-muted"},{default:n(()=>[r(e(Qt),{class:"h-4.5 w-4.5 text-blue-500"})]),_:1})]),_:1}),r(e(se),null,{default:n(()=>[...t[79]||(t[79]=[s("p",null,"Open AI Chat",-1)])]),_:1})]),_:1}),r(e(re),null,{default:n(()=>[r(e(te),{asChild:""},{default:n(()=>[r(e($),{onClick:nt,variant:e(y)?"secondary":"ghost",size:"icon",class:"h-9 w-9 rounded-full transition-all hover:bg-muted"},{default:n(()=>[e(y)?(S(),q(e(Kt),{key:0,class:"h-4.5 w-4.5"})):(S(),q(e(Bt),{key:1,class:"h-4.5 w-4.5"}))]),_:1},8,["variant"])]),_:1}),r(e(se),null,{default:n(()=>[s("p",null,m(e(y)?"Exit fullscreen":"Enter fullscreen"),1)]),_:1})]),_:1}),r(e(re),null,{default:n(()=>[r(e(te),{asChild:""},{default:n(()=>[r(e($),{onClick:e(D),variant:e(H)?"secondary":"ghost",size:"icon",class:"h-9 w-9 rounded-full transition-all hover:bg-muted"},{default:n(()=>[e(H)?(S(),q(e(Vt),{key:0,class:"h-4.5 w-4.5 text-foreground"})):(S(),q(e(Xt),{key:1,class:"h-4.5 w-4.5 text-muted-foreground"}))]),_:1},8,["onClick","variant"])]),_:1}),r(e(se),null,{default:n(()=>[...t[80]||(t[80]=[s("p",null,"Toggle Dark Mode",-1)])]),_:1})]),_:1}),r(lt,{project:pe.value,"current-chapter":ge.value,"all-chapters":xe.value,size:"icon",variant:"ghost",class:"h-9 w-9 rounded-full hover:bg-muted"},null,8,["project","current-chapter","all-chapters"])])])]),s("div",Co,[s("div",{class:"absolute top-0 left-0 h-full bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 transition-all duration-700 ease-out shadow-[0_0_10px_rgba(59,130,246,0.5)]",style:Xe({width:`${Math.min(e(rt),100)}%`})},null,4)]),e(we)?(S(),B("div",ko,[s("div",So,[t[86]||(t[86]=s("div",{class:"absolute inset-0 -skew-x-12 animate-pulse bg-gradient-to-r from-transparent via-white/10 to-transparent"},null,-1)),s("div",Eo,[s("div",To,[s("div",$o,[s("div",Ao,[r(e(Ie),{class:"h-3 w-3 text-white"})]),t[81]||(t[81]=s("div",{class:"absolute inset-0 h-6 w-6 animate-ping rounded-full bg-gradient-to-br from-blue-500 to-purple-600 opacity-20"},null,-1))]),s("div",null,[t[82]||(t[82]=s("h4",{class:"text-xs font-semibold text-blue-900 dark:text-blue-100"},"AI Generator",-1)),s("p",Do,m(e(_e)),1)])]),r(e(ke),{variant:"outline",class:"border-blue-300 text-xs text-blue-700 dark:border-blue-700 dark:text-blue-300"},{default:n(()=>[p(m(Math.round(e(ye)))+"% ",1)]),_:1})]),s("div",jo,[s("div",Mo,[t[83]||(t[83]=s("span",{class:"text-xs text-blue-800 dark:text-blue-200"},"Generation Progress",-1)),s("span",Lo,m(e(Fs))+" / "+m(e(Ps))+" words",1)]),s("div",Ro,[s("div",{class:"absolute top-0 left-0 h-full rounded-full bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-500 ease-out",style:Xe({width:`${e(ye)}%`})},[...t[84]||(t[84]=[s("div",{class:"absolute inset-0 animate-pulse bg-gradient-to-r from-transparent via-white/30 to-transparent"},null,-1)])],4),s("div",{class:"absolute top-0 left-0 h-full rounded-full bg-gradient-to-r from-blue-400 to-purple-400 opacity-50 blur-sm transition-all duration-500",style:Xe({width:`${e(ye)}%`})},null,4)])]),s("div",Po,[s("div",Fo,[e(_e)==="Initializing"?(S(),B("div",zo)):e(_e)==="Connecting"?(S(),B("div",Wo,[...t[85]||(t[85]=[s("div",{class:"h-2 w-0.5 animate-pulse rounded-full bg-blue-500"},null,-1),s("div",{class:"h-2 w-0.5 animate-pulse rounded-full bg-purple-500",style:{"animation-delay":"0.2s"}},null,-1),s("div",{class:"h-2 w-0.5 animate-pulse rounded-full bg-blue-500",style:{"animation-delay":"0.4s"}},null,-1)])])):e(_e)==="Generating"?(S(),B("div",No)):e(_e)==="Complete"?(S(),B("div",qo)):(S(),B("div",Ho))]),s("p",Oo,m(e(Ne)),1)])])])):X("",!0),s("div",Bo,[r(De,{"enter-active-class":"transition-all duration-300 ease-in-out","enter-from-class":"-ml-72 opacity-0","enter-to-class":"ml-0 opacity-100","leave-active-class":"transition-all duration-300 ease-in-out","leave-from-class":"ml-0 opacity-100","leave-to-class":"-ml-72 opacity-0"},{default:n(()=>[e(N)?(S(),B("div",Io,[s("div",Go,[s("div",Uo,[s("div",Qo,[t[87]||(t[87]=s("h2",{class:"text-sm font-semibold text-foreground mb-1"},"Table of Contents",-1)),s("p",Ko,m(xe.value.length)+" Chapters ",1)]),(S(),q(or,null,{fallback:n(()=>[...t[88]||(t[88]=[s("div",{class:"flex items-center justify-center p-8"},[s("div",{class:"h-6 w-6 animate-spin rounded-full border-2 border-primary border-t-transparent"})],-1)])]),default:n(()=>[r(e(x),{"all-chapters":xe.value,"current-chapter":ge.value,project:pe.value,outlines:l.project.outlines||[],"faculty-chapters":l.facultyChapters||[],"current-word-count":e(Z),"target-word-count":de.value,"writing-quality-score":e(ve),"chapter-content-length":e(a).length,onGoToChapter:He,onGenerateNextChapter:e(st)},null,8,["all-chapters","current-chapter","project","outlines","faculty-chapters","current-word-count","target-word-count","writing-quality-score","chapter-content-length","onGenerateNextChapter"])]),_:1}))])])])):X("",!0)]),_:1}),s("div",Vo,[s("div",Xo,[s("div",Jo,[r(Yt,{context:mt.value},null,8,["context"]),t[89]||(t[89]=s("div",{class:"h-12"},null,-1))])])]),r(De,{"enter-active-class":"transition-all duration-300 ease-in-out","enter-from-class":"-mr-72 opacity-0","enter-to-class":"mr-0 opacity-100","leave-active-class":"transition-all duration-300 ease-in-out","leave-from-class":"mr-0 opacity-100","leave-to-class":"-mr-72 opacity-0"},{default:n(()=>[e(G)?(S(),q(Zt,Pt({key:0,"container-class":"w-72 flex-shrink-0 border-l border-border/40 bg-background/40 backdrop-blur-md"},ht.value),null,16)):X("",!0)]),_:1})])])):(S(),q(Wt,{key:3,class:"h-screen overflow-hidden bg-background dark:bg-background transition-colors duration-300"},{default:n(()=>[s("div",Yo,[t[110]||(t[110]=s("div",{class:"absolute inset-0 z-0 overflow-hidden pointer-events-none"},[s("div",{class:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] rounded-full bg-blue-500/5 blur-[100px]"}),s("div",{class:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] rounded-full bg-purple-500/5 blur-[100px]"})],-1)),Se(s("aside",Zo,[s("div",ea,[t[91]||(t[91]=s("span",{class:"text-sm font-semibold tracking-tight text-foreground"},"Navigation",-1)),r(e(ke),{variant:"outline",class:"text-[10px] h-5 px-1.5"},{default:n(()=>[p(m(xe.value.length)+" Chapters ",1)]),_:1})]),r(e(Ft),{class:"flex-1"},{default:n(()=>[s("div",ta,[r(e(x),{"all-chapters":xe.value,"current-chapter":ge.value,project:pe.value,outlines:l.project.outlines||[],"faculty-chapters":l.facultyChapters||[],"current-word-count":e(Z),"target-word-count":de.value,"writing-quality-score":e(ve),"chapter-content-length":e(a).length,onGoToChapter:He,onGenerateNextChapter:e(st)},null,8,["all-chapters","current-chapter","project","outlines","faculty-chapters","current-word-count","target-word-count","writing-quality-score","chapter-content-length","onGenerateNextChapter"])])]),_:1})],512),[[Ae,!e(Ee)]]),s("main",sa,[s("header",ra,[s("div",na,[r(e(re),null,{default:n(()=>[r(e(te),{asChild:""},{default:n(()=>[r(e($),{variant:"ghost",size:"icon",class:"h-9 w-9 text-zinc-700 dark:text-zinc-300 hover:text-foreground hover:bg-muted/50 rounded-full",onClick:t[10]||(t[10]=v=>e(ee).visit(e(V)("projects.writing",o.project.slug)))},{default:n(()=>[r(e(it),{class:"w-4 h-4"})]),_:1})]),_:1}),r(e(se),null,{default:n(()=>[...t[92]||(t[92]=[p("Back to Writing",-1)])]),_:1})]),_:1}),t[93]||(t[93]=s("div",{class:"h-6 w-px bg-border/50 mx-1 hidden lg:block"},null,-1)),r(e($),{variant:"ghost",size:"icon",onClick:t[11]||(t[11]=v=>je.value=!0),class:"lg:hidden text-muted-foreground hover:text-foreground h-9 w-9 hover:bg-muted/50 rounded-full"},{default:n(()=>[r(e(Ut),{class:"h-4.5 w-4.5"})]),_:1})]),s("div",oa,[r(e($),{variant:"ghost",size:"icon",onClick:t[12]||(t[12]=v=>Me.value=!0),class:"text-muted-foreground hover:text-foreground h-9 w-9 hover:bg-muted/50 rounded-full"},{default:n(()=>[r(e(Ie),{class:"h-4.5 w-4.5"})]),_:1})]),s("div",aa,[s("div",la,[s("h1",{class:"text-xl font-bold tracking-tight text-foreground leading-snug cursor-pointer hover:text-primary/80 transition-colors break-words",onClick:t[13]||(t[13]=v=>e(ee).visit(e(V)("projects.show",o.project.slug)))},m(o.project.title),1),r(e(ke),{variant:"secondary",class:"shrink-0 h-5 px-2 text-[10px] font-medium rounded-full bg-secondary/50 border border-border/50 mt-1"},{default:n(()=>[p(" Ch "+m(o.chapter.chapter_number),1)]),_:1})]),s("div",ia,[s("div",da,[r(lt,{project:pe.value,"current-chapter":ge.value,"all-chapters":xe.value,size:"icon",variant:"outline","trigger-element":"icon","button-class":"h-8 w-8 rounded-full bg-background/50 backdrop-blur-sm",class:"text-zinc-700 dark:text-zinc-300"},null,8,["project","current-chapter","all-chapters"]),r(e($),{variant:"outline",size:"icon",class:"h-8 w-8 gap-2 text-zinc-700 dark:text-zinc-300 hover:text-foreground bg-background/50 backdrop-blur-sm rounded-full",onClick:ot},{default:n(()=>[r(e(Jt),{class:"w-4 h-4"})]),_:1})]),s("div",ua,[r(e($),{onClick:t[14]||(t[14]=v=>e(he)(!1)),disabled:e(Y),variant:qe.value?"default":"secondary",size:"sm",class:"h-8 px-3 text-xs shadow-sm gap-2 rounded-full min-w-[32px]"},{default:n(()=>[r(e(ut),{class:"h-3.5 w-3.5"}),e(Y)?(S(),B("span",ca,"Saving")):X("",!0)]),_:1},8,["disabled","variant"]),r(e($),{onClick:at,disabled:e(Y),size:"sm",class:"h-8 px-3 text-xs shadow-sm gap-2 rounded-full"},{default:n(()=>[r(e(Ye),{class:"h-3.5 w-3.5"}),t[94]||(t[94]=s("span",{class:"sm:hidden"},"Done",-1))]),_:1},8,["disabled"])])])])]),s("div",pa,[s("div",ga,[s("div",fa,[s("h1",{class:"text-sm font-bold text-foreground cursor-pointer hover:text-primary transition-colors flex items-center",onClick:t[15]||(t[15]=v=>e(ee).visit(e(V)("projects.show",o.project.slug)))},[s("div",{innerHTML:o.project.title,class:"inline-block"},null,8,ma)]),r(e(ke),{variant:"secondary",class:"h-5 px-2 text-[10px] font-medium rounded-full bg-secondary/50 border border-border/50"},{default:n(()=>[p(" Ch "+m(o.chapter.chapter_number),1)]),_:1})])]),s("div",ha,[s("div",va,[r(e(re),null,{default:n(()=>[r(e(te),{asChild:""},{default:n(()=>[r(e($),{variant:"ghost",size:"icon",class:"h-8 w-8 text-zinc-700 dark:text-zinc-300 hover:text-foreground rounded-full",onClick:t[16]||(t[16]=v=>e(ee).visit(e(V)("projects.writing",o.project.slug)))},{default:n(()=>[r(e(it),{class:"w-4 h-4"})]),_:1})]),_:1}),r(e(se),null,{default:n(()=>[...t[95]||(t[95]=[p("Back to Writing",-1)])]),_:1})]),_:1}),t[96]||(t[96]=s("div",{class:"h-4 w-px bg-border/50 mx-1"},null,-1)),r(e($),{variant:"ghost",size:"icon",onClick:t[17]||(t[17]=v=>Ee.value=!e(Ee)),class:"text-muted-foreground hover:text-foreground h-8 w-8 rounded-full"},{default:n(()=>[e(Ee)?(S(),q(e(Ir),{key:1,class:"h-4 w-4"})):(S(),q(e(Br),{key:0,class:"h-4 w-4"}))]),_:1})]),s("div",ba,[s("div",xa,[r(e(re),null,{default:n(()=>[r(e(te),{asChild:""},{default:n(()=>[r(e($),{onClick:Dt,variant:e(be)?"secondary":"ghost",size:"sm",class:"h-7 px-3 text-xs gap-2 text-zinc-700 dark:text-zinc-300 hover:text-foreground rounded-full"},{default:n(()=>[e(be)?(S(),q(e(Vr),{key:1,class:"h-3.5 w-3.5"})):(S(),q(e(ss),{key:0,class:"h-3.5 w-3.5"})),s("span",wa,m(e(be)?"Edit":"Preview"),1)]),_:1},8,["variant"])]),_:1}),r(e(se),null,{default:n(()=>[...t[97]||(t[97]=[p("Toggle Preview Mode",-1)])]),_:1})]),_:1}),t[101]||(t[101]=s("div",{class:"w-px h-3 bg-border/50 mx-0.5"},null,-1)),r(e(re),null,{default:n(()=>[r(e(te),{asChild:""},{default:n(()=>[r(e($),{onClick:At,variant:"ghost",size:"sm",class:"h-7 px-3 text-xs gap-2 text-muted-foreground hover:text-foreground rounded-full"},{default:n(()=>[r(e(Qt),{class:"h-3.5 w-3.5 text-blue-500"}),t[98]||(t[98]=s("span",{class:"hidden xl:inline text-foreground"},"AI Chat",-1))]),_:1})]),_:1}),r(e(se),null,{default:n(()=>[...t[99]||(t[99]=[p("Open AI Assistant",-1)])]),_:1})]),_:1}),t[102]||(t[102]=s("div",{class:"w-px h-3 bg-border/50 mx-0.5"},null,-1)),r(e(re),null,{default:n(()=>[r(e(te),{asChild:""},{default:n(()=>[r(e($),{onClick:nt,variant:"ghost",size:"sm",class:"h-7 px-3 text-xs gap-2 text-muted-foreground hover:text-foreground rounded-full"},{default:n(()=>[e(y)?(S(),q(e(Kt),{key:0,class:"h-3.5 w-3.5"})):(S(),q(e(Bt),{key:1,class:"h-3.5 w-3.5"})),s("span",ya,m(e(y)?`Exit
                                                        Fullscreen`:"Fullscreen"),1)]),_:1})]),_:1}),r(e(se),null,{default:n(()=>[s("p",null,m(e(y)?"Exit fullscreen":"Enter fullscreen"),1)]),_:1})]),_:1}),t[103]||(t[103]=s("div",{class:"w-px h-3 bg-border/50 mx-0.5"},null,-1)),r(e(re),null,{default:n(()=>[r(e(te),{asChild:""},{default:n(()=>[r(e($),{onClick:e(D),variant:"ghost",size:"sm",class:"h-7 px-3 text-xs gap-2 text-zinc-700 dark:text-zinc-300 hover:text-foreground rounded-full"},{default:n(()=>[e(H)?(S(),q(e(Vt),{key:0,class:"h-3.5 w-3.5 text-foreground"})):(S(),q(e(Xt),{key:1,class:"h-3.5 w-3.5"}))]),_:1},8,["onClick"])]),_:1}),r(e(se),null,{default:n(()=>[...t[100]||(t[100]=[p("Toggle Dark Mode",-1)])]),_:1})]),_:1})]),s("div",_a,[r(lt,{project:pe.value,"current-chapter":ge.value,"all-chapters":xe.value,size:"sm",variant:"outline","trigger-element":"button","button-class":"h-9 gap-2 px-3 rounded-full bg-background/50 backdrop-blur-sm",class:"text-zinc-700 dark:text-zinc-300"},null,8,["project","current-chapter","all-chapters"]),r(e($),{variant:"outline",size:"sm",class:"h-9 gap-2 text-zinc-700 dark:text-zinc-300 hover:text-foreground bg-background/50 backdrop-blur-sm rounded-full",onClick:ot,title:"Open bulk analysis"},{default:n(()=>[r(e(Jt),{class:"w-4 h-4"}),t[104]||(t[104]=s("span",{class:"text-xs font-medium"},"Analyze",-1))]),_:1})]),s("div",Ca,[r(e($),{onClick:t[18]||(t[18]=v=>e(he)(!1)),disabled:e(Y),variant:qe.value?"default":"secondary",size:"sm",class:"h-9 px-4 text-xs shadow-sm gap-2 rounded-full min-w-[32px]"},{default:n(()=>[r(e(ut),{class:"h-3.5 w-3.5"}),s("span",ka,m(e(Y)?"Saving":"Save"),1)]),_:1},8,["disabled","variant"]),r(e($),{onClick:at,disabled:e(Y),size:"sm",class:"h-9 px-4 text-xs shadow-sm gap-2 rounded-full"},{default:n(()=>[r(e(Ye),{class:"h-3.5 w-3.5"}),t[105]||(t[105]=s("span",null,"Mark Complete",-1))]),_:1},8,["disabled"]),t[106]||(t[106]=s("div",{class:"w-px h-4 bg-border/50 mx-1"},null,-1)),r(e($),{variant:"ghost",size:"icon",onClick:t[19]||(t[19]=v=>M.value=!e(M)),class:"hidden lg:flex text-muted-foreground hover:text-foreground h-9 w-9 hover:bg-muted/50 rounded-full"},{default:n(()=>[e(M)?(S(),q(e(zr),{key:1,class:"h-4.5 w-4.5"})):(S(),q(e(Fr),{key:0,class:"h-4.5 w-4.5"}))]),_:1})])])])]),s("div",Sa,[r(De,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 -translate-y-4","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 -translate-y-4"},{default:n(()=>[e(we)?(S(),B("div",Ea,[s("div",Ta,[s("div",$a,[s("div",Aa,[s("div",Da,[r(e(Ie),{class:"h-4 w-4 text-white animate-pulse"})]),s("div",ja,[s("div",Ma,[t[107]||(t[107]=s("h4",{class:"text-xs font-semibold text-foreground"}," Generating Content...",-1)),s("span",La,m(Math.round(e(ye)))+"%",1)]),s("div",Ra,[s("div",{class:"h-full bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-300",style:Xe({width:`${e(ye)}%`})},null,4)])])]),s("p",Pa,m(e(Ne)),1)])])])):X("",!0)]),_:1}),r(e(Ft),{ref_key:"editorScrollRef",ref:Ns,class:"h-full w-full"},{default:n(()=>[s("div",Fa,[Se(s("div",za,[r(ts,{ref_key:"richTextEditorFullscreen",ref:g,modelValue:e(a),"onUpdate:modelValue":t[20]||(t[20]=v=>ar(a)?a.value=v:null),placeholder:"Start writing your chapter...",class:"prose prose-slate dark:prose-invert prose-lg max-w-none focus:outline-none min-h-[500px]","streaming-mode":e(xt),"is-generating":e(we),"generation-progress":e(Ne),"generation-percentage":e(ye),"generation-phase":e(_e),"onUpdate:selectedText":t[21]||(t[21]=v=>O.value=v),"min-height":"500px"},null,8,["modelValue","streaming-mode","is-generating","generation-progress","generation-percentage","generation-phase"])],512),[[Ae,!e(be)]]),Se(s("div",Wa,[r(ns,{content:e(a),class:"prose prose-slate dark:prose-invert prose-lg max-w-none"},null,8,["content"])],512),[[Ae,e(be)]])])]),_:1},512)]),s("div",Na,[s("div",qa,[s("span",null,"Words: "+m(e(Z))+" / "+m(de.value),1),s("span",Ha,"Last saved: "+m(e(Y)?"Saving...":`Just
                                    now`),1)]),s("div",Oa,[s("span",null,[t[108]||(t[108]=p("Quality: ",-1)),s("span",{class:Ge(e(ve)>70?"text-green-500":"text-amber-500")},m(e(ve))+"%",3)]),qe.value?(S(),B("span",Ba,[r(e(Ye),{class:"h-3 w-3"}),t[109]||(t[109]=p(" Ready ",-1))])):X("",!0)])])]),r(Zt,Pt({"is-collapsed":e(M),"container-class":"hidden lg:flex w-96 flex-col border-l border-border/40 bg-background/60 backdrop-blur-xl z-20 transition-all duration-300"},ht.value),null,16,["is-collapsed"])]),r(e(d),{"show-left-sidebar":e(je),"show-right-sidebar":e(Me),"is-mobile":e(Qe),"all-chapters":xe.value,"current-chapter":ge.value,project:pe.value,"current-word-count":e(Z),"target-word-count":de.value,"writing-quality-score":e(ve),"chapter-content-length":e(a).length,"is-generating":e(we),"selected-text":e(O),"is-loading-suggestions":e(bt),"show-citation-helper":e(Ke),"chapter-content":e(a),"onUpdate:showLeftSidebar":t[22]||(t[22]=v=>je.value=v),"onUpdate:showRightSidebar":t[23]||(t[23]=v=>Me.value=v),onGoToChapter:He,onGenerateNextChapter:e(st),onStartStreamingGeneration:e(yt),onGetAiSuggestions:e(_t),"onUpdate:showCitationHelper":t[24]||(t[24]=v=>Ke.value=v),onCheckCitations:e(Ct)},null,8,["show-left-sidebar","show-right-sidebar","is-mobile","all-chapters","current-chapter","project","current-word-count","target-word-count","writing-quality-score","chapter-content-length","is-generating","selected-text","is-loading-suggestions","show-citation-helper","chapter-content","onGenerateNextChapter","onStartStreamingGeneration","onGetAiSuggestions","onCheckCitations"]),r(ir,{open:e(K),"current-balance":e(L),"required-words":e(Le),action:e(Re),"onUpdate:open":t[25]||(t[25]=v=>K.value=v),onClose:e(Ze)},null,8,["open","current-balance","required-words","action","onClose"]),e(zs)?(S(),B("div",Ia,[r(e(ne),{class:"w-full max-w-md mx-4 bg-white dark:bg-slate-900 border-amber-500/50 shadow-2xl"},{default:n(()=>[r(e(ae),null,{default:n(()=>[r(e(ue),{class:"flex items-center gap-2 text-amber-600 dark:text-amber-400"},{default:n(()=>[...t[111]||(t[111]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1),p(" Generation Interrupted ",-1)])]),_:1})]),_:1}),r(e(oe),null,{default:n(()=>[s("p",Ga,[t[112]||(t[112]=p(" Connection lost. ",-1)),s("span",Ua,m(e(Ws))+" words",1),t[113]||(t[113]=p(" may have been saved. ",-1))]),s("div",Qa,[r(e($),{onClick:e(Hs),class:"flex-1 bg-amber-600 hover:bg-amber-700 text-white"},{default:n(()=>[...t[114]||(t[114]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),p(" Reload & Recover ",-1)])]),_:1},8,["onClick"]),r(e($),{onClick:e(Os),variant:"outline",class:"flex-1"},{default:n(()=>[...t[115]||(t[115]=[p(" Dismiss ",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1})])):X("",!0)]),_:1}))],64))]),_:1}))}}),Xa=pt(Va,[["__scopeId","data-v-7340f5fc"]]),ci=Object.freeze(Object.defineProperty({__proto__:null,default:Xa},Symbol.toStringTag,{value:"Module"}));export{On as A,rs as B,ci as C,ns as R};
