import{bt as ve,dd as Y,de as ye,bs as j,bA as ge,ci as ee,bB as _e,dE as xe,ck as be,dl as ke,dh as we,dF as Ce,cO as he,dG as $e,bx as b,dH as Re,cn as u,co as d,cp as s,cr as n,cB as y,cS as h,df as $,bE as t,cq as r,cs as i,ct as f,dI as Te,cu as N,dJ as Ve,dK as Ne,cG as S,dL as Se,dM as Ue,dN as De,dO as Ae,dP as Ie,dQ as te,cl as se,cj as k,ce as Ee,dR as Le}from"./vendor-DTjPma1U.js";import{_ as je}from"./AdminLayout.vue_vue_type_script_setup_true_lang-F29Dh3nm.js";import{_ as U,a as D}from"./CardContent.vue_vue_type_script_setup_true_lang-I4CEGKdn.js";import{_ as z}from"./CardDescription.vue_vue_type_script_setup_true_lang-CWoegFai.js";import{_ as A,a as I}from"./CardTitle.vue_vue_type_script_setup_true_lang-CV0UXs4e.js";import{_ as re,a as ae,b as R,c as T,d as le,e as g}from"./TableHeader.vue_vue_type_script_setup_true_lang-KafZe9uV.js";import{_ as p}from"./index-mwxrBKxi.js";import{_ as G}from"./Input.vue_vue_type_script_setup_true_lang-DAeY8mMm.js";import{_ as H}from"./Label.vue_vue_type_script_setup_true_lang-D84UGLqY.js";import{_ as F}from"./index-3KGx5n4o.js";import"./Sonner.vue_vue_type_script_setup_true_lang-D0ynKKgD.js";import"./UserInfo.vue_vue_type_script_setup_true_lang-tVoAfrlY.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-DunnpUO7.js";const ze={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-8"},Fe={class:"text-2xl font-bold"},Be={class:"text-xs text-muted-foreground mt-1 flex items-center gap-1"},Me={class:"grid gap-4 lg:grid-cols-2"},Pe={class:"flex items-start justify-between gap-4"},Oe={class:"flex items-center gap-2"},Ge={class:"h-[320px] w-full"},He={class:"flex items-start justify-between gap-4"},We={class:"flex items-center gap-2"},qe={class:"h-[320px] w-full"},Je={class:"mt-8"},Ke={class:"flex items-start justify-between gap-4"},Qe={class:"grid gap-4 md:grid-cols-3"},Ze={class:"grid gap-2"},Xe={class:"grid gap-2"},Ye={class:"grid gap-2"},et={class:"flex flex-wrap items-center gap-3"},tt={key:0,class:"text-sm text-destructive"},st={class:"rounded-md border border-border"},rt={key:0},at={class:"flex justify-end gap-2"},lt={class:"mt-8"},nt={class:"flex items-center justify-between"},ot={class:"rounded-md border border-border"},kt=ve({__name:"Dashboard",props:{inviteOnlyEnabled:{type:Boolean},stats:{},recentActivity:{},invites:{},charts:{}},setup(ne){const c=ne,v=a=>Number(a??0).toLocaleString(),oe=a=>new Date(a).toLocaleString();Y.register(...ye);const _=j("30d"),x=j("30d"),B=j(null),M=j(null);let E=null,L=null;const W=a=>{const e=new Date(`${a}T00:00:00`);return Number.isNaN(e.getTime())?a:new Intl.DateTimeFormat("en",{month:"short",day:"2-digit"}).format(e)},q=a=>{const e=new Date(`${a}-01T00:00:00`);return Number.isNaN(e.getTime())?a:new Intl.DateTimeFormat("en",{month:"short",year:"2-digit"}).format(e)},J=(a,e,l,o)=>{const O={type:"line",data:{labels:e,datasets:[{label:o.label,data:l,borderColor:o.color,backgroundColor:`${o.color}22`,borderWidth:2,pointRadius:0,tension:.35,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{display:!1},tooltip:{callbacks:{title:C=>{const V=String(C?.[0]?.label??"");return o.formatTick(V)},label:C=>{const V=o.valuePrefix??"",fe=o.valueSuffix??"",pe=typeof C.parsed.y=="number"?C.parsed.y:Number(C.parsed.y??0);return`${V}${pe.toLocaleString()}${fe}`}}}},scales:{x:{ticks:{maxTicksLimit:8,callback:(C,V)=>o.formatTick(String(e[V]??""))},grid:{display:!1}},y:{beginAtZero:!0,grid:{color:"rgba(148,163,184,0.15)"},ticks:{precision:0}}}}};return new Y(a,O)},K=()=>{if(!B.value)return;E?.destroy();const a=_.value==="30d"?c.charts.revenue.daily:c.charts.revenue.monthly,e=_.value==="30d"?W:q;E=J(B.value,a.labels,a.data,{label:"Revenue",color:"#6366f1",formatTick:e,valuePrefix:"₦"})},Q=()=>{if(!M.value)return;L?.destroy();const a=x.value==="30d"?c.charts.registrations.daily:c.charts.registrations.monthly,e=x.value==="30d"?W:q;L=J(M.value,a.labels,a.data,{label:"Registrations",color:"#10b981",formatTick:e})};ge(()=>{K(),Q()}),ee(_,()=>K()),ee(x,()=>Q()),_e(()=>{E?.destroy(),L?.destroy(),E=null,L=null});const m=xe({count:1,max_uses:1,expires_in_days:7}),ie=()=>{m.post(se("admin.invites.store"),{preserveScroll:!0,onSuccess:()=>{k.success("Invite(s) created")}})},de=a=>{Ee.post(se("admin.invites.revoke",{invite:a}),void 0,{preserveScroll:!0,onSuccess:()=>{k.success("Invite revoked")}})},Z=async(a,e)=>{const l=String(a??"");if(!l){k.error("Nothing to copy");return}try{if(window.isSecureContext&&navigator.clipboard?.writeText){await navigator.clipboard.writeText(l),k.success(e);return}}catch{}try{const o=document.createElement("textarea");o.value=l,o.setAttribute("readonly","true"),o.style.position="fixed",o.style.top="-9999px",o.style.left="-9999px",document.body.appendChild(o),o.focus(),o.select();const O=document.execCommand("copy");document.body.removeChild(o),O?k.success(e):k.error("Copy failed (browser blocked)")}catch{k.error("Copy failed")}},ue=a=>a==="active"?"Active":a==="expired"?"Expired":a==="revoked"?"Revoked":a==="used_up"?"Used up":a,ce=a=>a==="active"?"default":a==="expired"||a==="used_up"?"secondary":a==="revoked"?"destructive":"secondary",me=be(()=>[{title:"Total Users",value:v(c.stats.users.total),icon:ke,trend:`+${v(c.stats.users.today)}`,trendUp:!0},{title:"Total Revenue",value:`₦${v(c.stats.revenue.total)}`,icon:we,trend:`+₦${v(c.stats.revenue.today)}`,trendUp:!0},{title:"Active Projects",value:v(c.stats.projects.total),icon:Ce,trend:`+${v(c.stats.projects.today)}`,trendUp:!0},{title:"Words Generated",value:v(c.stats.words.total),icon:he,trend:`+${v(c.stats.words.today)}`,trendUp:!0}]),w=$e(),X=[w.accessor("type",{header:"Type",cell:a=>{const e=a.getValue();return b(F,{variant:"secondary"},()=>e)}}),w.accessor("message",{header:"Activity",cell:a=>b("div",{class:"font-medium text-foreground"},a.getValue())}),w.accessor("actor",{header:"Actor",cell:a=>b("div",{class:"text-muted-foreground text-sm"},a.getValue()??"—")}),w.accessor("route",{header:"Route",cell:a=>{const e=a.getValue(),l=a.row.original,o=l.method?l.method.toUpperCase():null;return!e&&!o?b("div",{class:"text-muted-foreground text-sm"},"—"):b("div",{class:"text-muted-foreground text-xs"},`${o??""} ${e??""}`.trim())}}),w.accessor("count",{header:"Count",cell:a=>b(F,{variant:"outline",class:"font-mono text-xs"},()=>String(a.getValue()))}),w.accessor("time",{header:"Time",cell:a=>b("div",{class:"text-muted-foreground text-sm"},a.getValue())})],P=Re({get data(){return c.recentActivity},columns:X,getCoreRowModel:Le()});return(a,e)=>(d(),u(je,{title:"Dashboard",subtitle:"Overview of your system's performance."},{default:s(()=>[n("div",ze,[(d(!0),y(h,null,$(me.value,l=>(d(),u(t(U),{key:l.title,class:"bg-card text-card-foreground border-border/50 shadow-sm hover:shadow-md transition-all duration-200"},{default:s(()=>[r(t(A),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[r(t(I),{class:"text-sm font-medium text-muted-foreground"},{default:s(()=>[i(f(l.title),1)]),_:2},1024),(d(),u(Te(l.icon),{class:"h-4 w-4 text-muted-foreground"}))]),_:2},1024),r(t(D),null,{default:s(()=>[n("div",Fe,f(l.value),1),n("p",Be,[n("span",{class:N([l.trendUp?"text-emerald-500":"text-rose-500","flex items-center"])},[l.trendUp?(d(),u(t(Ve),{key:0,class:"h-3 w-3 mr-0.5"})):(d(),u(t(Ne),{key:1,class:"h-3 w-3 mr-0.5"})),i(" "+f(l.trend),1)],2),e[7]||(e[7]=n("span",{class:"opacity-70"},"from yesterday",-1))])]),_:2},1024)]),_:2},1024))),128))]),n("div",Me,[r(t(U),{class:"border-border/50 shadow-sm"},{default:s(()=>[r(t(A),null,{default:s(()=>[n("div",Pe,[n("div",null,[r(t(I),null,{default:s(()=>[...e[8]||(e[8]=[i("Revenue",-1)])]),_:1}),r(t(z),null,{default:s(()=>[...e[9]||(e[9]=[i("Track successful payments over time.",-1)])]),_:1})]),n("div",Oe,[r(t(p),{size:"sm",variant:"outline",class:N(_.value==="30d"?"border-primary/40 bg-primary/10 text-primary":""),onClick:e[0]||(e[0]=l=>_.value="30d")},{default:s(()=>[...e[10]||(e[10]=[i(" 30d ",-1)])]),_:1},8,["class"]),r(t(p),{size:"sm",variant:"outline",class:N(_.value==="monthly"?"border-primary/40 bg-primary/10 text-primary":""),onClick:e[1]||(e[1]=l=>_.value="monthly")},{default:s(()=>[...e[11]||(e[11]=[i(" Monthly ",-1)])]),_:1},8,["class"])])])]),_:1}),r(t(D),null,{default:s(()=>[n("div",Ge,[n("canvas",{ref_key:"revenueCanvas",ref:B},null,512)])]),_:1})]),_:1}),r(t(U),{class:"border-border/50 shadow-sm"},{default:s(()=>[r(t(A),null,{default:s(()=>[n("div",He,[n("div",null,[r(t(I),null,{default:s(()=>[...e[12]||(e[12]=[i("User Registrations",-1)])]),_:1}),r(t(z),null,{default:s(()=>[...e[13]||(e[13]=[i("New user signups over time.",-1)])]),_:1})]),n("div",We,[r(t(p),{size:"sm",variant:"outline",class:N(x.value==="30d"?"border-primary/40 bg-primary/10 text-primary":""),onClick:e[2]||(e[2]=l=>x.value="30d")},{default:s(()=>[...e[14]||(e[14]=[i(" 30d ",-1)])]),_:1},8,["class"]),r(t(p),{size:"sm",variant:"outline",class:N(x.value==="monthly"?"border-primary/40 bg-primary/10 text-primary":""),onClick:e[3]||(e[3]=l=>x.value="monthly")},{default:s(()=>[...e[15]||(e[15]=[i(" Monthly ",-1)])]),_:1},8,["class"])])])]),_:1}),r(t(D),null,{default:s(()=>[n("div",qe,[n("canvas",{ref_key:"registrationsCanvas",ref:M},null,512)])]),_:1})]),_:1})]),n("div",Je,[r(t(U),{class:"border-border/50 shadow-sm"},{default:s(()=>[r(t(A),null,{default:s(()=>[n("div",Ke,[n("div",null,[r(t(I),null,{default:s(()=>[...e[16]||(e[16]=[i("Registration Invites",-1)])]),_:1}),r(t(z),null,{default:s(()=>[...e[17]||(e[17]=[i(" Generate invite codes/links to control who can register while testing. ",-1)])]),_:1})]),r(t(F),{variant:a.inviteOnlyEnabled?"default":"secondary"},{default:s(()=>[i(f(a.inviteOnlyEnabled?"Invite-only enabled":"Invite-only disabled"),1)]),_:1},8,["variant"])])]),_:1}),r(t(D),{class:"space-y-6"},{default:s(()=>[n("div",Qe,[n("div",Ze,[r(t(H),{for:"count"},{default:s(()=>[...e[18]||(e[18]=[i("How many",-1)])]),_:1}),r(t(G),{id:"count",type:"number",min:"1",max:"25",modelValue:t(m).count,"onUpdate:modelValue":e[4]||(e[4]=l=>t(m).count=l)},null,8,["modelValue"])]),n("div",Xe,[r(t(H),{for:"max_uses"},{default:s(()=>[...e[19]||(e[19]=[i("Max uses",-1)])]),_:1}),r(t(G),{id:"max_uses",type:"number",min:"1",max:"1000",modelValue:t(m).max_uses,"onUpdate:modelValue":e[5]||(e[5]=l=>t(m).max_uses=l)},null,8,["modelValue"])]),n("div",Ye,[r(t(H),{for:"expires_in_days"},{default:s(()=>[...e[20]||(e[20]=[i("Expires in (days)",-1)])]),_:1}),r(t(G),{id:"expires_in_days",type:"number",min:"1",max:"365",modelValue:t(m).expires_in_days,"onUpdate:modelValue":e[6]||(e[6]=l=>t(m).expires_in_days=l)},null,8,["modelValue"])])]),n("div",et,[r(t(p),{size:"sm",class:"gap-2",disabled:t(m).processing,onClick:ie},{default:s(()=>[r(t(Se),{class:"h-4 w-4"}),i(" Generate invite"+f(Number(t(m).count)===1?"":"s"),1)]),_:1},8,["disabled"]),t(m).hasErrors?(d(),y("div",tt," Please fix the invite form errors. ")):S("",!0)]),n("div",st,[r(t(re),null,{default:s(()=>[r(t(ae),null,{default:s(()=>[r(t(R),null,{default:s(()=>[r(t(T),null,{default:s(()=>[...e[21]||(e[21]=[i("Code",-1)])]),_:1}),r(t(T),null,{default:s(()=>[...e[22]||(e[22]=[i("Status",-1)])]),_:1}),r(t(T),null,{default:s(()=>[...e[23]||(e[23]=[i("Uses",-1)])]),_:1}),r(t(T),null,{default:s(()=>[...e[24]||(e[24]=[i("Expires",-1)])]),_:1}),r(t(T),{class:"text-right"},{default:s(()=>[...e[25]||(e[25]=[i("Actions",-1)])]),_:1})]),_:1})]),_:1}),r(t(le),null,{default:s(()=>[(d(!0),y(h,null,$(a.invites,l=>(d(),u(t(R),{key:l.id},{default:s(()=>[r(t(g),{class:"font-mono text-sm"},{default:s(()=>[i(f(l.code),1)]),_:2},1024),r(t(g),null,{default:s(()=>[r(t(F),{variant:ce(l.status)},{default:s(()=>[i(f(ue(l.status)),1)]),_:2},1032,["variant"])]),_:2},1024),r(t(g),{class:"text-sm text-muted-foreground"},{default:s(()=>[i(f(l.uses),1),l.max_uses?(d(),y("span",rt," / "+f(l.max_uses),1)):S("",!0)]),_:2},1024),r(t(g),{class:"text-sm text-muted-foreground"},{default:s(()=>[i(f(l.expires_at?oe(l.expires_at):"—"),1)]),_:2},1024),r(t(g),{class:"text-right"},{default:s(()=>[n("div",at,[r(t(p),{variant:"outline",size:"sm",class:"h-8 gap-1",onClick:o=>Z(l.code,"Invite code copied")},{default:s(()=>[r(t(Ue),{class:"h-3.5 w-3.5"}),e[26]||(e[26]=n("span",{class:"hidden sm:inline"},"Copy",-1))]),_:2},1032,["onClick"]),r(t(p),{variant:"outline",size:"sm",class:"h-8 gap-1",onClick:o=>Z(l.link,"Invite link copied")},{default:s(()=>[r(t(De),{class:"h-3.5 w-3.5"}),e[27]||(e[27]=n("span",{class:"hidden sm:inline"},"Link",-1))]),_:2},1032,["onClick"]),l.status==="active"?(d(),u(t(p),{key:0,variant:"destructive",size:"sm",class:"h-8 gap-1",onClick:o=>de(l.id)},{default:s(()=>[r(t(Ae),{class:"h-3.5 w-3.5"}),e[28]||(e[28]=n("span",{class:"hidden sm:inline"},"Revoke",-1))]),_:2},1032,["onClick"])):S("",!0)])]),_:2},1024)]),_:2},1024))),128)),a.invites.length?S("",!0):(d(),u(t(R),{key:0},{default:s(()=>[r(t(g),{colspan:"5",class:"h-24 text-center text-muted-foreground"},{default:s(()=>[...e[29]||(e[29]=[i(" No invites yet. ",-1)])]),_:1})]),_:1}))]),_:1})]),_:1})])]),_:1})]),_:1})]),n("div",lt,[r(t(U),{class:"border-border/50 shadow-sm"},{default:s(()=>[r(t(A),null,{default:s(()=>[n("div",nt,[n("div",null,[r(t(I),null,{default:s(()=>[...e[30]||(e[30]=[i("Recent Activity",-1)])]),_:1}),r(t(z),null,{default:s(()=>[...e[31]||(e[31]=[i("Latest actions performed across the platform.",-1)])]),_:1})]),r(t(p),{variant:"outline",size:"sm",class:"h-8 gap-1"},{default:s(()=>[r(t(Ie),{class:"h-3.5 w-3.5"}),e[32]||(e[32]=n("span",{class:"sr-only sm:not-sr-only sm:whitespace-nowrap"},"Filter",-1))]),_:1})])]),_:1}),r(t(D),null,{default:s(()=>[n("div",ot,[r(t(re),null,{default:s(()=>[r(t(ae),null,{default:s(()=>[(d(!0),y(h,null,$(t(P).getHeaderGroups(),l=>(d(),u(t(R),{key:l.id},{default:s(()=>[(d(!0),y(h,null,$(l.headers,o=>(d(),u(t(T),{key:o.id},{default:s(()=>[o.isPlaceholder?S("",!0):(d(),u(t(te),{key:0,render:o.column.columnDef.header,props:o.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),r(t(le),null,{default:s(()=>[t(P).getRowModel().rows?.length?(d(!0),y(h,{key:0},$(t(P).getRowModel().rows,l=>(d(),u(t(R),{key:l.id,"data-state":l.getIsSelected()?"selected":void 0},{default:s(()=>[(d(!0),y(h,null,$(l.getVisibleCells(),o=>(d(),u(t(g),{key:o.id},{default:s(()=>[r(t(te),{render:o.column.columnDef.cell,props:o.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(d(),u(t(R),{key:1},{default:s(()=>[r(t(g),{colspan:X.length,class:"h-24 text-center"},{default:s(()=>[...e[33]||(e[33]=[i(" No results. ",-1)])]),_:1},8,["colspan"])]),_:1}))]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1}))}});export{kt as default};
