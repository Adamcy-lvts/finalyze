import{B as q,b as M,I as Ce,J as Se,ah as je,af as re,d as Pe,P as N,a as w,o as p,w as v,F as o,K as h,u as i,c as y,L as k,n as j,H as x,a8 as $e,M as P,N as fe,U as _e,a1 as Le,a3 as Te,ai as Fe,O as ve}from"./app-uoMyauMW.js";import{_ as Ge}from"./index-1nsIen2h.js";import{c as Ie,_ as Q}from"./index-CkIBjcAt.js";import{_ as be}from"./CardContent.vue_vue_type_script_setup_true_lang-DWW-Of9k.js";import{_ as xe,a as ye}from"./index-DT0wtR17.js";import{_ as Me}from"./AlertTitle.vue_vue_type_script_setup_true_lang-4hT7cOk5.js";import{u as ze,_ as Ee}from"./AppLayout.vue_vue_type_script_setup_true_lang-DwraDZZw.js";import{_ as Re}from"./SafeHtmlText.vue_vue_type_script_setup_true_lang-Cq_ep9cs.js";import{t as $}from"./index-ZRcbjQoz.js";import{_ as Ae}from"./PurchaseModal.vue_vue_type_script_setup_true_lang-Sp8eGavi.js";import{A as We}from"./arrow-left-BYadVodd.js";import{T as he}from"./triangle-alert-BVLUIICK.js";import{C as qe}from"./check-Cfbl9RXK.js";import{L as te}from"./loader-circle-DRxheSPr.js";import{C as Oe}from"./clock-GV-xnDzR.js";import{P as Be}from"./play-CTtLh6fm.js";import{S as Ne}from"./square-pen-BnwrIzPe.js";import{F as we}from"./file-text-DHA_pbA7.js";import{S as Ue}from"./search-C72YHf0Z.js";import{S as Ve}from"./sparkles-nL--aO2a.js";import{_ as Ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CrNUjyWn.js";import"./UserInfo.vue_vue_type_script_setup_true_lang-BoSQ2sLE.js";import"./VisuallyHidden-w02aEH7b.js";import"./Presence-CZ_Vu1k7.js";import"./useForwardExpose-B_YlLh3k.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DtVyMAhS.js";import"./x-C0T3J9QL.js";import"./coins-DKr33_Gk.js";import"./log-out-CenttQcT.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-CgMteLWP.js";import"./library-ZYngptJp.js";import"./plus-JVxXWngl.js";import"./chevron-right-CXArsnfZ.js";import"./Sonner.vue_vue_type_script_setup_true_lang-BA7jN4H3.js";import"./circle-check-BLsKHcvv.js";import"./sun-CNayuORM.js";import"./purify.es-DxJI3Wx7.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-D8V2pTFg.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-D3pOF-vf.js";import"./arrow-right-BljlOn4u.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=Ie("TerminalIcon",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);function He(U){const a=q({status:"not_started",progress:0,currentStage:"",message:"",isConnected:!1,error:null}),c=q([]),L=q([]),d=q({}),T=q(null),G=new Set;let C=null,g=null,z=null;const O=5e3;let B=null;const se=2e3,V=M(()=>["pending","processing"].includes(a.value.status)),Y=M(()=>a.value.status==="completed"),X=M(()=>a.value.status==="failed"),oe=M(()=>a.value.status==="failed"&&a.value.progress>0),ae=M(()=>{if(Y.value)return"Completed";if(X.value)return"Stopped";if(!V.value)return"Est. 15-20m";const e=d.value.chapter_timings||{},r=Object.keys(e).length,t=d.value.total_chapters||5;if(r>0){const S=Object.values(e).reduce((W,me)=>W+me,0)/r,A=(t-r)*S+60;return A<60?"< 1 min remaining":`~${Math.ceil(A/60)} min${A>=120?"s":""} remaining`}const n=100-a.value.progress,u=Math.ceil(n/100*20);return`~${u} min${u>1?"s":""} remaining`}),Z=()=>{if(C){console.warn("Already connected to WebSocket");return}try{C=new je({broadcaster:"reverb",key:"c8a608e4ba2640154b0daedb18c40f09",wsHost:"finalyze.live",wsPort:"443",wssPort:"443",forceTLS:!0,enabledTransports:["ws","wss"]}),g=C.private(`project.${U}.generation`),g.subscribed(()=>{console.log("‚úÖ Connected to generation channel"),a.value.isConnected=!0,a.value.error=null}),g.error(e=>{console.error("‚ùå Channel error:",e),a.value.error="WebSocket connection error"}),ne(),console.log("üîå Connecting to WebSocket channel...")}catch(e){console.error("Failed to initialize WebSocket:",e),a.value.error="Failed to connect to real-time updates"}},ne=()=>{g&&(g.listen(".generation.started",e=>{console.log("üì° Generation started:",e),E(e)}),g.listen(".generation.literature_mining",e=>{console.log("üìö Literature mining:",e),R(e)}),g.listen(".generation.chapter.started",e=>{console.log("üìù Chapter started:",e),ie(e)}),g.listen(".generation.chapter.progress",e=>{console.log("‚è≥ Chapter progress:",e),D(e)}),g.listen(".generation.chapter.completed",e=>{console.log("‚úÖ Chapter completed:",e),le(e)}),g.listen(".generation.completed",e=>{console.log("üéâ Generation completed:",e),ce(e)}),g.listen(".generation.failed",e=>{console.log("‚ùå Generation failed:",e),de(e)}))},E=e=>{a.value.status="processing",a.value.progress=e.progress,a.value.currentStage=e.current_stage,a.value.message=e.message,d.value={...d.value,total_chapters:e.total_chapters,is_resume:e.is_resume,estimated_duration:e.estimated_duration},ee(e.total_chapters||5),s(),I({type:e.is_resume?"info":"stage",message:e.is_resume?"üîÑ Resuming generation sequence...":"üöÄ Starting generation sequence..."})},R=e=>{a.value.progress=e.progress,a.value.currentStage="literature_mining",a.value.message=e.message;const r=c.value.find(t=>t.id==="literature_mining");r&&(r.status="active",r.progress=(e.progress-0)/20*100,r.description=e.message),I({type:"mining",message:e.message,source:e.source}),e.sub_stage==="completed"&&e.source==="complete"&&r&&(r.status="completed",r.progress=100)},ie=e=>{const r=e.chapter_number;f(),a.value.progress=e.progress,a.value.currentStage=`chapter_generation_${r}`,a.value.message=e.message,d.value={...d.value,current_chapter:r,total_chapters:e.total_chapters},ue(r,e.chapter_title,e.target_word_count),ge(r);const t=c.value.find(n=>n.id===`chapter_generation_${r}`);t&&(t.status="active",t.progress=0,t.chapterProgress=10),H(r,30),I({type:"chapter_progress",message:`üìù Starting Chapter ${r}: ${e.chapter_title}`,chapter:r})},D=e=>{const r=e.chapter_number;if(f(),a.value.progress=e.progress,a.value.message=e.stage_description||e.message,r>0){const t=c.value.find(n=>n.id===`chapter_generation_${r}`);t&&(t.chapterProgress=e.chapter_progress,t.wordCount=e.current_word_count,t.description=e.stage_description||t.description),d.value={...d.value,chapter_progress:e.chapter_progress,current_word_count:e.current_word_count},console.log(`üìä Real progress: Chapter ${r} - ${e.chapter_progress}% (${e.current_word_count} words)`)}},le=e=>{const r=e.chapter_number;f(),a.value.progress=e.progress,a.value.message=e.message;const t=c.value.find(u=>u.id===`chapter_generation_${r}`);t&&(t.status="completed",t.progress=100,t.chapterProgress=100,t.wordCount=e.word_count,t.generationTime=e.generation_time);const n=d.value.chapter_timings||{};n[r]=e.generation_time,d.value={...d.value,chapter_timings:n,chapters_completed:e.chapters_completed},I({type:"chapter_completed",message:`‚úÖ Chapter ${r} completed (${e.word_count?.toLocaleString()} words in ${e.generation_time}s)`,chapter:r,generationTime:e.generation_time})},ce=e=>{a.value.status="completed",a.value.progress=100,a.value.currentStage="completed",a.value.message="Project generation completed successfully!",_(),f();const r=c.value.find(t=>t.id==="html_conversion");r&&(r.status="completed",r.progress=100),T.value=e.download_links||null,d.value={...d.value,total_word_count:e.total_word_count,total_duration:e.total_duration,papers_collected:e.papers_collected},I({type:"success",message:`üéâ Project generation completed! (${e.total_word_count?.toLocaleString()} words in ${Math.round(e.total_duration||0)}s)`})},de=e=>{a.value.status="failed",a.value.message=e.error_message||"Generation failed",a.value.error=e.error_message||null,_(),f();const r=c.value.find(t=>t.id===e.failed_stage);r&&(r.status="error"),d.value={...d.value,can_resume:e.can_resume,last_successful_chapter:e.last_successful_chapter},I({type:"error",message:`‚ùå Generation failed: ${e.error_message}`,chapter:e.failed_chapter})},ee=e=>{const r=75/e;c.value=[{id:"literature_mining",name:"Literature Mining",description:"Collecting research papers from academic databases",status:"pending",progress:0,range:[0,20]}];for(let t=1;t<=e;t++){const n=20+(t-1)*r,u=20+t*r;c.value.push({id:`chapter_generation_${t}`,name:`Chapter ${t}`,description:`Chapter ${t}`,status:"pending",progress:0,chapterProgress:0,wordCount:0,targetWordCount:0,range:[n,u]}),G.add(t)}c.value.push({id:"html_conversion",name:"Finalizing Project",description:"Formatting content and preparing final document",status:"pending",progress:0,range:[95,100]})},ue=(e,r,t)=>{if(G.has(e)){const W=c.value.find(me=>me.id===`chapter_generation_${e}`);W&&(W.description=r,W.targetWordCount=t);return}const u=75/Math.max(G.size+1,e),F=20+(e-1)*u,S=20+e*u,K={id:`chapter_generation_${e}`,name:`Chapter ${e}`,description:r,status:"pending",progress:0,chapterProgress:0,wordCount:0,targetWordCount:t,range:[F,S]},A=c.value.findIndex(W=>W.id==="html_conversion");c.value.splice(A,0,K),G.add(e),pe()},pe=()=>{const e=c.value.filter(n=>n.id.startsWith("chapter_generation_")),t=75/e.length;e.forEach((n,u)=>{const F=20+u*t,S=20+(u+1)*t;n.range=[F,S]})},ge=e=>{const r=c.value.find(t=>t.id==="literature_mining");r&&r.status!=="completed"&&(r.status="completed",r.progress=100);for(let t=1;t<e;t++){const n=c.value.find(u=>u.id===`chapter_generation_${t}`);n&&n.status!=="completed"&&(n.status="completed",n.progress=100,n.chapterProgress=100)}},I=e=>{L.value.unshift({...e,timestamp:new Date().toISOString()}),L.value.length>100&&L.value.pop()},m=e=>{switch(e){case"success":return"success";case"error":return"error";case"chapter_completed":return"chapter_completed";case"chapter_started":case"chapter_progress":return"chapter_progress";case"mining":return"mining";case"conversion":return"conversion";case"stage":return"stage";default:return"info"}},l=e=>{a.value.status=e.status,a.value.progress=e.progress??0,a.value.currentStage=e.current_stage||"",a.value.message=e.message||"",a.value.error=e.status==="failed"?e.message:null,d.value=e.metadata||{},T.value=e.download_links||null,G.clear();const r=e.chapter_statuses?.length||d.value.total_chapters||5;if(ee(r),d.value={...d.value,total_chapters:d.value.total_chapters||r},e.chapter_statuses?.forEach(t=>{const n=c.value.find(u=>u.id===`chapter_generation_${t.chapter_number}`);n&&(n.description=t.title||n.description,n.targetWordCount=t.target_word_count??n.targetWordCount,(t.is_completed||t.status==="completed")&&(n.status="completed",n.progress=100,n.chapterProgress=100,n.wordCount=t.word_count,n.generationTime=d.value?.chapter_timings?.[t.chapter_number]))}),["processing","pending"].includes(e.status)){if(e.current_stage){const t=c.value.find(n=>n.id===e.current_stage);if(t&&(t.status="active",t.id.startsWith("chapter_generation_"))){const n=Number(e.current_stage.replace("chapter_generation_","")),u=e.metadata?.chapter_progress??d.value.chapter_progress??0,F=e.metadata?.current_word_count??d.value.current_word_count;d.value={...d.value,current_chapter:n,chapter_progress:u,current_word_count:F},t.chapterProgress=u,t.wordCount=F??t.wordCount,H(n,30)}if(e.current_stage.includes("chapter_generation")){const n=c.value.find(u=>u.id==="literature_mining");n&&(n.status="completed",n.progress=100)}if(e.current_stage==="html_conversion"){const n=c.value.find(u=>u.id==="html_conversion");n&&(n.status="active",n.progress=e.progress||n.progress)}}s()}if(e.status==="completed"&&(a.value.progress=100,c.value.forEach(t=>{t.status="completed",t.progress=100,t.chapterProgress!==void 0&&(t.chapterProgress=100)})),e.status==="failed"&&e.current_stage){const t=c.value.find(n=>n.id===e.current_stage);t&&(t.status="error")}e.details?.length&&(L.value=e.details.map(t=>({timestamp:t.timestamp,type:m(t.type),message:t.message,chapter:t.chapter,generationTime:t.generation_time,source:t.source})).reverse())},s=()=>{z||(console.log("üì° Starting polling fallback"),z=setInterval(async()=>{if(!V.value){_();return}try{const r=(await re.get(`/api/projects/${U}/bulk-generate/status`)).data;if(r.progress>a.value.progress||r.status!==a.value.status){if(console.log("üìä Polling update received:",{progress:r.progress,status:r.status,stage:r.current_stage}),a.value.progress=r.progress,a.value.status=r.status,a.value.message=r.message,a.value.currentStage=r.current_stage,r.metadata&&(d.value={...d.value,...r.metadata},r.metadata.chapter_progress!==void 0&&r.metadata.current_chapter)){const t=r.metadata.current_chapter,n=c.value.find(u=>u.id===`chapter_generation_${t}`);n&&(n.chapterProgress=r.metadata.chapter_progress,n.wordCount=r.metadata.current_word_count||0)}r.status==="completed"&&(T.value=r.download_links,_()),r.status==="failed"&&(a.value.error=r.message,_())}}catch(e){console.warn("Polling request failed:",e)}},O))},_=()=>{z&&(clearInterval(z),z=null,console.log("üì° Polling stopped"))},H=(e,r=30)=>{if(f(),!c.value.find(S=>S.id===`chapter_generation_${e}`))return;const n=1;let u=0;const F=15;console.log(`üé¨ Starting fallback animation for Chapter ${e} (will be overridden by real progress)`),B=setInterval(()=>{u++;const S=c.value.find(A=>A.id===`chapter_generation_${e}`);if(!S||S.status!=="active"){f();return}if(u>=F){console.log("‚èπÔ∏è Fallback animation stopped - waiting for real WebSocket progress"),f();return}const K=S.chapterProgress||0;K<r&&(S.chapterProgress=Math.min(K+n,r))},se)},f=()=>{B&&(clearInterval(B),B=null)},b=()=>{_(),f(),g&&(g.stopListening(".generation.started"),g.stopListening(".generation.literature_mining"),g.stopListening(".generation.chapter.started"),g.stopListening(".generation.chapter.progress"),g.stopListening(".generation.chapter.completed"),g.stopListening(".generation.completed"),g.stopListening(".generation.failed")),C&&(C.leave(`project.${U}.generation`),C=null),g=null,a.value.isConnected=!1,console.log("üîå Disconnected from generation channel")},J=()=>{a.value={status:"not_started",progress:0,currentStage:"",message:"",isConnected:a.value.isConnected,error:null},c.value=[],L.value=[],d.value={},T.value=null,G.clear()};return Ce(()=>{Z()}),Se(()=>{b()}),{state:a,stages:c,activityLog:L,metadata:d,downloadLinks:T,isGenerating:V,isCompleted:Y,hasFailed:X,canResume:oe,estimatedTimeRemaining:ae,connect:Z,disconnect:b,restoreFromApiData:l,reset:J,startPolling:s}}const Je={class:"relative min-h-screen p-4 md:p-8 lg:p-12"},Ke={class:"max-w-5xl mx-auto space-y-8"},Qe={class:"flex flex-col gap-6"},Xe={class:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4"},Ze={class:"flex items-center gap-3 px-4 py-2 rounded-full border border-border/50 bg-background/50 backdrop-blur-md shadow-sm self-end md:self-auto"},De={class:"relative flex h-3 w-3"},et={key:0,class:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"},tt={class:"space-y-2"},rt={class:"text-xl text-muted-foreground font-light tracking-wide"},st={class:"grid lg:grid-cols-12 gap-8 items-start relative"},ot={class:"lg:col-span-7 space-y-8 order-2 lg:order-1"},at={class:"space-y-6 pl-2 z-10 relative"},nt={class:"relative space-y-0"},it={class:"flex flex-col items-center"},lt={key:0,class:"w-full h-full bg-gradient-to-b from-primary to-transparent animate-pulse shadow-[0_0_10px_rgba(var(--primary),0.5)]"},ct={class:"flex items-center justify-between gap-4 p-4 rounded-xl border border-border/10 bg-card/10 backdrop-blur-md hover:border-primary/20 hover:bg-card/30 hover:shadow-[0_0_20px_rgba(var(--primary),0.1)] transition-all duration-300 group-hover:bg-card/20"},dt={class:"space-y-1 flex-1"},ut={class:"flex items-center gap-2"},pt={key:0,class:"mt-3 bg-secondary/30 rounded-lg p-3 space-y-2.5 border border-border/30 shadow-inner"},gt={class:"flex justify-between text-xs font-medium text-muted-foreground"},mt={class:"font-mono text-xs tracking-tight"},ft={class:"h-2 w-full overflow-hidden rounded-full bg-background/50 border border-white/5"},ht={key:0,class:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent skew-x-[-20deg] animate-shimmer",style:{"background-size":"200% 100%"}},_t={key:0,class:"text-primary hidden sm:block"},vt={class:"lg:col-span-5 flex flex-col gap-6 lg:sticky lg:top-24 lg:h-[calc(100vh-6rem)] order-1 lg:order-2"},bt={class:"group relative z-20"},xt={class:"space-y-6 md:space-y-8"},yt={class:"flex flex-col items-center justify-center py-6"},wt={class:"relative w-48 h-48"},kt={class:"w-full h-full -rotate-90",viewBox:"0 0 100 100"},Ct=["stroke-dasharray","stroke-dashoffset"],St={class:"absolute inset-0 flex flex-col items-center justify-center"},jt={class:"text-4xl font-bold tabular-nums tracking-tighter"},Pt={class:"text-xs font-medium uppercase tracking-widest text-muted-foreground/80 mt-1"},$t={class:"mt-6 text-center space-y-2"},Lt={class:"text-base text-muted-foreground leading-relaxed animate-pulse-slow"},Tt={class:"flex items-center justify-center gap-2 text-sm text-muted-foreground bg-secondary/30 px-3 py-1 rounded-full w-fit mx-auto"},Ft={class:"font-mono"},Gt={class:"flex flex-col gap-4 pt-4 border-t border-border/50"},It={class:"grid grid-cols-2 gap-3"},Mt={class:"hidden lg:flex flex-col flex-1 min-h-0 relative"},zt={class:"flex items-center justify-between px-1 bg-background pb-2"},Et={class:"flex items-center gap-2"},Rt={class:"flex-1 overflow-y-auto p-4 font-mono text-xs md:text-sm scrollbar-hide relative"},At={key:"empty",class:"absolute inset-0 flex flex-col items-center justify-center text-gray-700 select-none"},Wt={class:"animate-pulse flex flex-col items-center gap-2"},qt={class:"shrink-0 text-gray-600 select-none text-[10px] mt-[3px]"},Ot={key:0,class:"text-gray-500 mr-2"},Bt=Pe({__name:"BulkGeneration",props:{project:{}},setup(U){const a=U,{state:c,stages:L,activityLog:d,metadata:T,downloadLinks:G,isGenerating:C,isCompleted:g,hasFailed:z,canResume:O,estimatedTimeRemaining:B,restoreFromApiData:se,reset:V}=He(a.project.id),{showPurchaseModal:Y,requiredWordsForModal:X,actionDescriptionForModal:oe,checkAndPrompt:ae,closePurchaseModal:Z,estimates:ne}=ze(),E=q(!1),R=q(!1),ie=M(()=>c.value.isConnected?"text-green-500":c.value.error?"text-red-500":"text-yellow-500"),D=M(()=>g.value?"Project Ready!":C.value?"Generating Your Project":O.value?"Resume Generation":"Ready to Generate"),le=M(()=>{if(g.value)return"Your project has been successfully generated. You can now download it or view the chapters.";if(T.value?.current_chapter){const m=T.value.current_chapter,l=T.value.chapter_progress||0;return`Generating Chapter ${m} (${l}% complete)...`}return c.value.currentStage==="literature_mining"?"Analyzing academic databases and collecting relevant sources...":c.value.currentStage?.includes("chapter_generation")?"Writing your chapters with proper citations and formatting...":c.value.currentStage==="html_conversion"?"Finalizing formatting and preparing your document...":z.value?"Generation failed. You can resume from where it left off.":O.value?'Click "Resume Generation" to continue from the last completed step.':"Click the button below to start generating your complete project."}),ce=m=>m==="literature_mining"?Ue:m==="html_conversion"?Ve:we,de=async(m=!1)=>{if(E.value||C.value)return;const l=a.project.chapters?.filter(f=>f.status!=="completed"&&(f.word_count??0)<=0).length||a.project.chapters?.length||1,s=(()=>{const f=(a.project.chapters||[]).map(b=>b.target_word_count).filter(b=>typeof b=="number"&&b>0);return f.length>0?Math.ceil(f.reduce((b,J)=>b+J,0)/f.length):2e3})(),_=ne.chapter(s)*l;if(ae(_,m?"resume bulk generation":"bulk generate chapters")){E.value=!0,m||V();try{if((await re.post(N("api.projects.bulk-generate.start",a.project.slug),{resume:m})).data.generation_id)$.success(m?"Resuming generation...":"Generation started!");else throw new Error("No generation ID returned")}catch(f){console.error("Failed to start generation:",f),$.error(f.response?.data?.message||"Failed to start generation"),c.value.error=f.response?.data?.message||"Failed to start generation"}finally{E.value=!1}}},ee=async()=>{try{await re.post(N("api.projects.bulk-generate.cancel",a.project.slug)),$.info("Generation cancelled")}catch(m){console.error("Failed to cancel generation:",m),$.error("Failed to cancel generation")}},ue=async()=>{if(R.value)return;const m=G.value?.pdf||N("export.project.pdf",{project:a.project.slug}),l=a.project.title||a.project.topic||"Project";R.value=!0,$.loading("Generating project PDF...",{id:"download-project-pdf"});try{const s=await fetch(m,{method:"GET",headers:{Accept:"application/pdf"}});if(s.ok){const _=s.headers.get("content-type");if(_&&_.includes("application/json")){const J=await s.json();$.error("Export Failed",{id:"download-project-pdf",description:J.message||"An error occurred during PDF export."});return}const H=await s.blob(),f=window.URL.createObjectURL(H),b=document.createElement("a");b.href=f,b.download=`${a.project.slug}_full_project.pdf`,document.body.appendChild(b),b.click(),document.body.removeChild(b),window.URL.revokeObjectURL(f),$.success("Project PDF exported successfully!",{id:"download-project-pdf",description:`${l} has been downloaded as PDF.`})}else try{const _=await s.json();$.error("Export Failed",{id:"download-project-pdf",description:_.message||"An error occurred during PDF export."})}catch{$.error("Export Failed",{id:"download-project-pdf",description:"Unable to export project as PDF. Please try again."})}}catch{$.error("Export Failed",{id:"download-project-pdf",description:"Network error occurred. Please check your connection and try again."})}finally{R.value=!1}},pe=()=>{ve.visit(N("projects.show",a.project.slug))},ge=()=>{ve.visit(N("projects.writing",a.project.slug))},I=m=>new Date(m).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"});return Ce(async()=>{try{const m=await re.get(N("api.projects.bulk-generate.status",a.project.slug));m.data.status!=="not_started"&&se(m.data)}catch(m){console.error("Failed to check generation status:",m)}}),(m,l)=>(p(),w(Ee,{title:D.value},{default:v(()=>[l[19]||(l[19]=o("div",{class:"fixed inset-0 overflow-hidden pointer-events-none"},[o("div",{class:"absolute top-[-10%] right-[-5%] w-[500px] h-[500px] bg-primary/10 rounded-full blur-[100px] mix-blend-screen animate-pulse duration-3000"}),o("div",{class:"absolute bottom-[-10%] left-[-5%] w-[600px] h-[600px] bg-blue-600/5 rounded-full blur-[120px] mix-blend-screen"})],-1)),o("div",Je,[o("div",Ke,[o("div",Qe,[o("div",Xe,[h(i(Q),{variant:"outline",size:"icon",onClick:ge,class:"rounded-xl border-dashed border-gray-600/30 hover:bg-gray-100/10 hover:border-primary/50 transition-all shrink-0"},{default:v(()=>[h(i(We),{class:"h-5 w-5"})]),_:1}),o("div",Ze,[o("div",De,[i(c).isConnected?(p(),y("span",et)):k("",!0),o("span",{class:j(["relative inline-flex rounded-full h-3 w-3",i(c).isConnected?"bg-green-500":"bg-red-500"])},null,2)]),o("span",{class:j(["text-sm font-medium",ie.value])},x(i(c).isConnected?"System Online":"Connecting..."),3)])]),o("div",tt,[h(Re,{as:"h1",class:"text-2xl md:text-3xl font-bold tracking-tight bg-gradient-to-r from-foreground to-foreground/60 bg-clip-text text-transparent leading-tight",content:m.project.title||m.project.topic},null,8,["content"]),o("p",rt,x(D.value),1)])]),h($e,{"enter-active-class":"transition duration-300 ease-out","enter-from-class":"transform -translate-y-2 opacity-0","enter-to-class":"transform translate-y-0 opacity-100","leave-active-class":"transition duration-200 ease-in","leave-from-class":"transform translate-y-0 opacity-100","leave-to-class":"transform -translate-y-2 opacity-0"},{default:v(()=>[i(c).error&&!i(C)?(p(),w(i(xe),{key:0,variant:"destructive",class:"border-red-500/50 bg-red-500/10"},{default:v(()=>[h(i(he),{class:"h-4 w-4"}),h(i(Me),null,{default:v(()=>[...l[2]||(l[2]=[P("Execution Error",-1)])]),_:1}),h(i(ye),null,{default:v(()=>[P(x(i(c).error),1)]),_:1})]),_:1})):k("",!0)]),_:1}),o("div",st,[o("div",ot,[o("div",at,[l[6]||(l[6]=o("h2",{class:"text-xl font-semibold tracking-tight"},"Generation Sequence",-1)),o("div",nt,[l[5]||(l[5]=o("div",{class:"absolute left-[19px] top-6 bottom-6 w-0.5 bg-gradient-to-b from-border/50 via-border/30 to-transparent"},null,-1)),(p(!0),y(fe,null,_e(i(L),(s,_)=>(p(),y("div",{key:s.id,class:"relative flex gap-4 group"},[o("div",it,[o("div",{class:j(["relative z-10 flex h-8 w-8 items-center justify-center rounded-full border-2 shadow-sm transition-all duration-500",{"border-muted bg-card scale-95 opacity-70":s.status==="pending","border-primary bg-background ring-2 ring-primary/20 scale-110 shadow-[0_0_10px_rgba(var(--primary),0.3)]":s.status==="active","border-green-500 bg-green-500 text-white scale-100 shadow-green-500/20":s.status==="completed","border-red-500 bg-red-500/10 text-red-500":s.status==="error"}])},[s.status==="completed"?(p(),w(i(qe),{key:0,class:"h-4 w-4 stroke-[3]"})):s.status==="active"?(p(),w(i(te),{key:1,class:"h-4 w-4 animate-spin text-primary"})):s.status==="error"?(p(),w(i(he),{key:2,class:"h-4 w-4"})):(p(),w(Le(ce(s.id)),{key:3,class:"h-3.5 w-3.5 text-muted-foreground"}))],2),_<i(L).length-1?(p(),y("div",{key:0,class:j(["w-0.5 flex-1 transition-all duration-700 ease-in-out mt-[-1px] mb-[-1px]",{"bg-gradient-to-b from-green-500 to-transparent":s.status==="completed","bg-transparent":s.status!=="completed"}])},[s.status==="active"?(p(),y("div",lt)):k("",!0)],2)):k("",!0)]),o("div",{class:j(["flex-1 pb-6 min-w-0 transition-opacity duration-300",{"opacity-50 hover:opacity-100":s.status==="pending"}])},[o("div",ct,[o("div",dt,[o("div",ut,[o("h3",{class:j(["font-semibold text-base tracking-tight",{"text-foreground":s.status==="active"||s.status==="completed","text-muted-foreground":s.status==="pending","text-red-500":s.status==="error"}])},x(s.name),3),s.status==="completed"&&s.generationTime?(p(),w(i(Ge),{key:0,variant:"secondary",class:"text-[10px] h-5 px-1.5 font-mono bg-secondary/50 text-secondary-foreground/70"},{default:v(()=>[P(x(s.generationTime)+"s ",1)]),_:2},1024)):k("",!0)]),o("p",{class:j(["text-sm text-balance leading-relaxed",{"text-muted-foreground/80":s.status!=="active","text-primary/90 font-medium":s.status==="active"}])},x(s.description),3),s.id.startsWith("chapter_generation_")&&(s.status==="active"||s.status==="completed")?(p(),y("div",pt,[o("div",gt,[l[4]||(l[4]=o("span",{class:"uppercase tracking-wider text-[10px]"},"Progress",-1)),o("span",mt,[o("span",{class:j({"text-primary font-bold":s.status==="active","text-green-500 font-bold":s.status==="completed"})},x(s.wordCount?.toLocaleString()??0),3),l[3]||(l[3]=o("span",{class:"opacity-50 mx-1"},"/",-1)),P(" "+x(s.targetWordCount?.toLocaleString()??0)+" words ",1)])]),o("div",ft,[o("div",{class:j(["h-full transition-all duration-700 ease-out relative overflow-hidden",{"bg-gradient-to-r from-green-500 to-emerald-400":s.status==="completed","bg-gradient-to-r from-blue-500 to-indigo-500":s.status==="active"}]),style:Te({width:s.status==="completed"?"100%":`${s.chapterProgress}%`})},[s.status==="active"?(p(),y("div",ht)):k("",!0)],6)])])):k("",!0)]),s.status==="active"?(p(),y("div",_t,[h(i(te),{class:"h-4 w-4 animate-spin"})])):k("",!0)])],2)]))),128))])])]),o("div",vt,[o("div",bt,[l[13]||(l[13]=o("div",{class:"absolute -inset-0.5 bg-gradient-to-r from-primary/30 to-purple-500/30 rounded-2xl blur opacity-30 group-hover:opacity-50 transition duration-1000"},null,-1)),h(i(be),{class:"relative p-6 md:p-8 border-border/50 bg-card/80 backdrop-blur-xl transition-all duration-300 shadow-2xl"},{default:v(()=>[o("div",xt,[o("div",yt,[o("div",wt,[(p(),y("svg",kt,[l[7]||(l[7]=o("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"currentColor",class:"text-secondary/30","stroke-width":"8"},null,-1)),o("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"url(#progress-gradient)","stroke-width":"8","stroke-linecap":"round",class:"transition-all duration-1000 ease-out","stroke-dasharray":2*Math.PI*45,"stroke-dashoffset":2*Math.PI*45*(1-i(c).progress/100)},null,8,Ct),l[8]||(l[8]=o("defs",null,[o("linearGradient",{id:"progress-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%"},[o("stop",{offset:"0%","stop-color":"#3b82f6"}),o("stop",{offset:"50%","stop-color":"#6366f1"}),o("stop",{offset:"100%","stop-color":"#a855f7"})])],-1))])),o("div",St,[o("span",jt,x(Math.round(i(c).progress))+"%",1),o("span",Pt,x(i(g)?"Complete":"Progress"),1)])]),o("div",$t,[o("p",Lt,x(le.value),1),o("div",Tt,[h(i(Oe),{class:"h-4 w-4 text-primary"}),o("span",Ft,x(i(B)),1)])])]),o("div",Gt,[!i(C)&&!i(g)?(p(),w(i(Q),{key:0,onClick:l[0]||(l[0]=s=>de(i(O))),disabled:E.value||!i(c).isConnected,size:"lg",class:"w-full rounded-xl shadow-lg shadow-primary/20 transition-all hover:scale-[1.02] active:scale-[0.98] text-base font-semibold py-6"},{default:v(()=>[E.value?(p(),w(i(te),{key:0,class:"mr-2 h-5 w-5 animate-spin"})):(p(),w(i(Be),{key:1,class:"mr-2 h-5 w-5 fill-current"})),P(" "+x(i(O)?"Resume Operation":"Initialize Generation"),1)]),_:1},8,["disabled"])):k("",!0),i(C)?(p(),w(i(Q),{key:1,variant:"destructive",size:"lg",onClick:ee,class:"w-full rounded-xl shadow-lg shadow-destructive/20 hover:bg-destructive/90 py-6"},{default:v(()=>[...l[9]||(l[9]=[P(" Cancel Process ",-1)])]),_:1})):k("",!0),i(g)?(p(),y(fe,{key:2},[o("div",It,[h(i(Q),{onClick:pe,size:"lg",class:"rounded-xl shadow-lg shadow-primary/20 hover:scale-[1.02] transition-all text-base py-6"},{default:v(()=>[h(i(Ne),{class:"mr-2 h-5 w-5"}),l[10]||(l[10]=P(" View in Editor ",-1))]),_:1}),h(i(Q),{variant:"secondary",size:"lg",onClick:ue,disabled:R.value,class:"rounded-xl hover:bg-secondary/80 py-6"},{default:v(()=>[R.value?(p(),w(i(te),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):(p(),w(i(we),{key:1,class:"mr-2 h-4 w-4"})),l[11]||(l[11]=P(" Export PDF ",-1))]),_:1},8,["disabled"])]),h(i(xe),{variant:"default",class:"bg-yellow-500/10 border-yellow-500/20 text-yellow-500"},{default:v(()=>[h(i(he),{class:"h-4 w-4"}),h(i(ye),{class:"text-xs leading-relaxed"},{default:v(()=>[...l[12]||(l[12]=[P(" AI is not perfect and can make mistakes. Please review each chapter and make adjustments where necessary. This will also help you know the project well enough to defend it. ",-1)])]),_:1})]),_:1})],64)):k("",!0)])])]),_:1})]),o("div",Mt,[o("div",zt,[o("div",Et,[h(i(ke),{class:"h-5 w-5 text-muted-foreground"}),l[14]||(l[14]=o("h2",{class:"text-lg font-semibold tracking-tight"},"System Logs",-1))]),l[15]||(l[15]=o("div",{class:"flex gap-1.5"},[o("div",{class:"w-3 h-3 rounded-full bg-red-500/80"}),o("div",{class:"w-3 h-3 rounded-full bg-yellow-500/80"}),o("div",{class:"w-3 h-3 rounded-full bg-green-500/80"})],-1))]),h(i(be),{class:"flex-1 overflow-hidden bg-[#0c0c0c] border-gray-800 shadow-2xl rounded-xl flex flex-col"},{default:v(()=>[l[18]||(l[18]=o("div",{class:"bg-gray-900/50 border-b border-gray-800 p-2 flex justify-center shrink-0"},[o("span",{class:"text-[10px] uppercase font-mono tracking-widest text-gray-500"},"generation-task.sh")],-1)),o("div",Rt,[h(Fe,{name:"list",tag:"div",class:"space-y-2"},{default:v(()=>[i(d).length===0?(p(),y("div",At,[o("div",Wt,[h(i(ke),{class:"h-10 w-10 opacity-20"}),l[16]||(l[16]=o("p",{class:"font-sans text-sm"},"Waiting for initialization...",-1))])])):k("",!0),(p(!0),y(fe,null,_e(i(d),(s,_)=>(p(),y("div",{key:_,class:j(["flex gap-3 items-start border-l-2 pl-3 py-0.5 transition-all hover:bg-white/5",{"border-blue-500/50":s.type==="info","border-green-500/50":s.type==="success"||s.type==="chapter_completed","border-red-500/50":s.type==="error","border-purple-500/50":s.type==="stage","border-transparent":!["info","success","chapter_completed","error","stage"].includes(s.type)}])},[o("span",qt,x(I(s.timestamp)),1),o("span",{class:j(["break-words leading-tight",{"text-blue-400":s.type==="info","text-green-400 font-medium":s.type==="success"||s.type==="chapter_completed","text-red-400 font-bold bg-red-900/10 px-1 rounded":s.type==="error","text-purple-400 font-bold":s.type==="stage","text-cyan-400":s.type==="chapter_progress","text-amber-400":s.type==="mining","text-pink-400":s.type==="conversion","text-gray-300":!s.type}])},[s.type==="stage"?(p(),y("span",Ot,"$")):k("",!0),P(" "+x(s.message),1)],2)],2))),128)),l[17]||(l[17]=o("div",{key:"cursor",class:"h-4 w-2 bg-gray-500 animate-pulse mt-2 inline-block"},null,-1))]),_:1})])]),_:1})])])])])]),h(Ae,{open:i(Y),"current-balance":0,"required-words":i(X),"action-description":i(oe),"onUpdate:open":l[1]||(l[1]=s=>Y.value=s),onClose:i(Z)},null,8,["open","required-words","action-description","onClose"])]),_:1},8,["title"]))}}),Tr=Ye(Bt,[["__scopeId","data-v-97ffb228"]]);export{Tr as default};
