import{bt as C,ck as N,bu as F,ci as I,bB as Q,cB as c,co as u,cr as e,cG as _,cq as i,bF as s,hK as z,ct as m,hL as U,hM as B,cS as E,de as G,cu as O,hN as V,cj as H,cp as v,cF as $,eq as W,gA as J,cs as M}from"./vendor-BJBNFzu6.js";import{_ as K,a as Y}from"./index-BWPj8eKR.js";import{_ as X}from"./index-DKTzjY4t.js";import{A as Z}from"./ChapterEditor-DfZw0zpl.js";import{_ as ee}from"./ChapterNavigation.vue_vue_type_script_setup_true_lang-BIX9rtmO.js";import{_ as te}from"./DefensePreparationPanel.vue_vue_type_script_setup_true_lang-Cnmr5d0f.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DweHVuYF.js";import"./CardContent.vue_vue_type_script_setup_true_lang-BmpoBQtZ.js";import"./CardTitle.vue_vue_type_script_setup_true_lang-CLvp_ZLs.js";import"./ScrollArea.vue_vue_type_script_setup_true_lang-BiVOEWCH.js";import"./Separator.vue_vue_type_script_setup_true_lang-D0FejIcy.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-D5gHzBY1.js";import"./WordBalanceDisplay.vue_vue_type_script_setup_true_lang-vIKRZBkJ.js";import"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-DShD0gcS.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-DowxnUGa.js";import"./UserInfo.vue_vue_type_script_setup_true_lang-LFxEtfzj.js";import"./Sonner.vue_vue_type_script_setup_true_lang-C7Uf4kO1.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-DXhfr9d3.js";import"./useAppearance-BoUrjusV.js";import"./useWordBalance-wU2vTgqu.js";import"./PWAInstallPrompt.vue_vue_type_script_setup_true_lang-DCd0GLl4.js";import"./PurchaseModal.vue_vue_type_script_setup_true_lang-KQgPGRog.js";import"./DialogContent.vue_vue_type_script_setup_true_lang-C8SicQru.js";import"./DialogDescription.vue_vue_type_script_setup_true_lang-B95wIsmA.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-DsnnuiaB.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-vwptL7Il.js";import"./useChapterWordCount-C_DomqZz.js";import"./Input.vue_vue_type_script_setup_true_lang-CB-7LUUJ.js";import"./Label.vue_vue_type_script_setup_true_lang-YwrTvequ.js";import"./RichTextEditor-j25Fd6QF.js";import"./vendor-tiptap-DuG0yIO_.js";import"./Progress.vue_vue_type_script_setup_true_lang-BJ0VwWi9.js";import"./MermaidExtension-C8Xh9spG.js";import"./vendor-mermaid-DjbGXZoA.js";import"./RichTextViewer-D7HyL7g4.js";import"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-Cksae7nm.js";import"./useTextHistory-v5K-nwdz.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BMD0Hw_m.js";import"./Switch.vue_vue_type_script_setup_true_lang-CJ_Us863.js";function re(){const g=C(!1),l=C(null),f=C(null),p=C(null),d=C([]),y=C({}),S=N(()=>f.value?.hasDataCollectionNeeds??!1),R=N(()=>f.value?.types??[]),x=N(()=>p.value?.hasPlaceholder?p.value.detectedType:null),j=N(()=>p.value?.hasPlaceholder?p.value.confidence??0:0);async function w(r){g.value=!0,l.value=null;try{const a=await fetch(`/api/chapters/${r}/detect`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!a.ok)throw new Error("Failed to detect data collection needs");const k=await a.json();f.value=k.detection}catch(a){l.value=a instanceof Error?a.message:"An error occurred",console.error("Error detecting data collection needs:",a)}finally{g.value=!1}}async function b(r){g.value=!0,l.value=null;try{const a=await fetch(`/api/chapters/${r}/placeholder`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!a.ok)throw new Error("Failed to generate placeholder");const k=await a.json();p.value=k.placeholder}catch(a){l.value=a instanceof Error?a.message:"An error occurred",console.error("Error generating placeholder:",a)}finally{g.value=!1}}async function D(r){g.value=!0,l.value=null;try{const a=await fetch(`/api/chapters/${r}/suggestions`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!a.ok)throw new Error("Failed to get suggestions");const k=await a.json();d.value=k.suggestions}catch(a){l.value=a instanceof Error?a.message:"An error occurred",console.error("Error getting suggestions:",a)}finally{g.value=!1}}async function P(){g.value=!0,l.value=null;try{const r=await fetch("/api/data-collection/templates",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!r.ok)throw new Error("Failed to get templates");const a=await r.json();y.value=a.templates}catch(r){l.value=r instanceof Error?r.message:"An error occurred",console.error("Error getting templates:",r)}finally{g.value=!1}}async function T(r){g.value=!0,l.value=null;try{const a=await fetch(`/api/data-collection/template?type=${encodeURIComponent(r)}`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!a.ok)throw new Error("Failed to get template");return(await a.json()).template}catch(a){return l.value=a instanceof Error?a.message:"An error occurred",console.error("Error getting template:",a),null}finally{g.value=!1}}async function L(r,a,k="append"){g.value=!0,l.value=null;try{if(!(await fetch(`/api/chapters/${r}/insert-template`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({type:a,position:k})})).ok)throw new Error("Failed to insert template");return!0}catch(q){return l.value=q instanceof Error?q.message:"An error occurred",console.error("Error inserting template:",q),!1}finally{g.value=!1}}async function A(r){await Promise.all([w(r),b(r),D(r)])}function t(r){return{survey:"Survey/Questionnaire",experiment:"Laboratory Experiment",engineering:"Engineering Design",statistical:"Statistical Analysis",construction:"Construction Project"}[r]||r.charAt(0).toUpperCase()+r.slice(1)}function n(r){return r>=50?"High":r>=25?"Medium":"Low"}function o(r){return r>=50?"text-green-600 dark:text-green-400":r>=25?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"}function h(){f.value=null,p.value=null,d.value=[],l.value=null}return{isLoading:g,error:l,detection:f,placeholder:p,suggestions:d,templates:y,hasDataCollectionNeeds:S,detectedTypes:R,primaryType:x,primaryConfidence:j,detectDataCollectionNeeds:w,generatePlaceholder:b,getSuggestions:D,getAllTemplates:P,getTemplate:T,insertTemplate:L,analyzeChapter:A,getTypeName:t,getConfidenceLevel:n,getConfidenceColor:o,clearData:h}}const ae={class:"space-y-4"},oe={class:"flex items-center justify-between"},ne={class:"flex items-center gap-2"},le=["disabled"],ie={key:0,class:"text-center py-4"},de={key:1,class:"text-center py-4"},ce={key:2},ue={class:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3"},pe={class:"flex items-start gap-2"},ge={class:"min-w-0 flex-1"},he={class:"mt-2 space-y-1"},me={class:"text-xs text-blue-700 dark:text-blue-300"},fe={key:0,class:"border border-gray-200 dark:border-gray-700 rounded-lg p-3"},ye={class:"flex items-center justify-between mb-2"},ve={class:"text-xs px-2 py-1 bg-green-100 text-green-700 rounded dark:bg-green-900/20 dark:text-green-400"},be={class:"text-xs text-gray-600 dark:text-gray-400 mb-3"},xe={class:"flex gap-2"},we=["disabled"],ke={key:0,class:"mt-3 p-2 bg-gray-50 dark:bg-gray-800 rounded text-xs"},Ce={class:"whitespace-pre-wrap text-gray-700 dark:text-gray-300 overflow-auto max-h-32"},_e={key:1,class:"space-y-2"},Se={class:"text-xs font-medium text-gray-700 dark:text-gray-300 mb-2"},Te={class:"space-y-1"},Ae={class:"border border-gray-200 dark:border-gray-700 rounded-lg"},De={class:"p-3 pt-0 space-y-2"},$e={class:"text-xs font-medium text-gray-900 dark:text-gray-100"},Re={class:"text-xs text-gray-600 dark:text-gray-400"},je=["onClick","disabled"],Pe={key:3,class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3"},Le={class:"flex items-start gap-2"},qe={class:"text-xs text-red-600 dark:text-red-400 mt-1"},Ne=F({__name:"DataCollectionPanel",props:{chapterId:{},content:{}},setup(g){const l=g,f=C(!1),{isLoading:p,error:d,placeholder:y,suggestions:S,templates:R,hasDataCollectionNeeds:x,detectedTypes:j,primaryType:w,analyzeChapter:b,insertTemplate:D,getAllTemplates:P,getTypeName:T,getConfidenceColor:L}=re();let A=null;I(()=>l.content,(n,o)=>{!n||n===o||(A&&clearTimeout(A),A=setTimeout(()=>{n&&n.length>500&&b(l.chapterId)},3e3))},{immediate:!1});async function t(n,o,h="append"){await D(n,o,h)?(H.success("Template added successfully"),f.value=!1,setTimeout(()=>{b(n)},1e3)):H.error(d.value||"Failed to insert template")}return Q(async()=>{await P(),l.content&&l.content.length>500&&await b(l.chapterId)}),(n,o)=>(u(),c("div",ae,[e("div",oe,[e("div",ne,[i(s(z),{class:"h-5 w-5 text-blue-600 dark:text-blue-400"}),o[3]||(o[3]=e("h3",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"}," Data Collection Assistant ",-1))]),s(x)?_("",!0):(u(),c("button",{key:0,onClick:o[0]||(o[0]=h=>s(b)(n.chapterId)),disabled:s(p),class:"text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100 disabled:opacity-50 dark:bg-blue-900/20 dark:text-blue-400 dark:hover:bg-blue-900/30"},m(s(p)?"Analyzing...":"Scan for Data Needs"),9,le))]),s(p)&&!s(x)?(u(),c("div",ie,[...o[4]||(o[4]=[e("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"text-xs text-gray-500 mt-2"},"Analyzing chapter content...",-1)])])):!s(x)&&!s(p)?(u(),c("div",de,[i(s(U),{class:"h-8 w-8 text-gray-400 mx-auto mb-2"}),o[5]||(o[5]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," No data collection requirements detected in this chapter. ",-1)),o[6]||(o[6]=e("p",{class:"text-xs text-gray-400 mt-1"},' Add keywords like "survey", "experiment", or "statistical analysis" to get assistance. ',-1))])):s(x)?(u(),c("div",ce,[e("div",ue,[e("div",pe,[i(s(B),{class:"h-4 w-4 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),e("div",ge,[o[7]||(o[7]=e("p",{class:"text-sm font-medium text-blue-900 dark:text-blue-100"}," Data Collection Requirements Detected ",-1)),e("div",he,[(u(!0),c(E,null,G(s(j),h=>(u(),c("div",{key:h,class:"flex items-center justify-between"},[e("span",me,m(s(T)(h)),1),e("span",{class:O(["text-xs font-medium",s(L)(s(y)?.allConfidence?.[h]||0)])},m(s(y)?.allConfidence?.[h]?.toFixed(1))+"% confidence ",3)]))),128))])])])]),s(w)&&s(y)?.template?(u(),c("div",fe,[e("div",ye,[o[8]||(o[8]=e("h4",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"}," Recommended Template ",-1)),e("span",ve,m(s(T)(s(w))),1)]),e("p",be,m(s(y).template.title),1),e("div",xe,[e("button",{onClick:o[1]||(o[1]=h=>t(n.chapterId,s(w),"append")),disabled:s(p),class:"flex-1 text-xs px-3 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50"},m(s(p)?"Inserting...":"Add Template"),9,we),e("button",{onClick:o[2]||(o[2]=h=>f.value=!f.value),class:"text-xs px-2 py-1.5 border border-gray-200 text-gray-600 rounded hover:bg-gray-50 dark:border-gray-600 dark:text-gray-400 dark:hover:bg-gray-800"},m(f.value?"Hide":"Preview"),1)]),f.value?(u(),c("div",ke,[e("pre",Ce,m(s(y).template.content.trim()),1)])):_("",!0)])):_("",!0),s(S).length>0?(u(),c("div",_e,[o[9]||(o[9]=e("h4",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"}," Research Guidelines ",-1)),(u(!0),c(E,null,G(s(S),h=>(u(),c("div",{key:h.type,class:"border border-gray-200 dark:border-gray-700 rounded-lg p-3"},[e("h5",Se,m(h.title),1),e("ul",Te,[(u(!0),c(E,null,G(h.suggestions,(r,a)=>(u(),c("li",{key:a,class:"flex items-start gap-1.5 text-xs text-gray-600 dark:text-gray-400"},[i(s(V),{class:"h-3 w-3 text-green-500 mt-0.5 flex-shrink-0"}),e("span",null,m(r),1)]))),128))])]))),128))])):_("",!0),e("details",Ae,[o[10]||(o[10]=e("summary",{class:"p-3 cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"}," Browse All Templates ",-1)),e("div",De,[(u(!0),c(E,null,G(s(R),(h,r)=>(u(),c("div",{key:r,class:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-800 rounded"},[e("div",null,[e("span",$e,m(s(T)(r)),1),e("p",Re,m(h.title),1)]),e("button",{onClick:a=>t(n.chapterId,r,"append"),disabled:s(p),class:"text-xs px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50"}," Add ",8,je)]))),128))])])])):_("",!0),s(d)?(u(),c("div",Pe,[e("div",Le,[i(s(B),{class:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e("div",null,[o[11]||(o[11]=e("p",{class:"text-sm font-medium text-red-800 dark:text-red-200"}," Analysis Error ",-1)),e("p",qe,m(s(d)),1)])])])):_("",!0)]))}}),Ee={key:0,class:"fixed inset-0 z-50 lg:hidden"},Ge={class:"fixed top-0 left-0 h-full w-80 overflow-y-auto border-r bg-background shadow-xl transform transition-transform"},Me={class:"border-b p-3"},Be={class:"flex items-center justify-between"},He={class:"space-y-4 p-4 mobile-enhanced"},We={key:0,class:"fixed inset-0 z-50 lg:hidden"},Xe={class:"fixed top-0 right-0 h-full w-96 overflow-y-auto border-l bg-background shadow-xl transform transition-transform"},Fe={class:"border-b p-3"},Ie={class:"flex items-center justify-between"},Qe={class:"space-y-4 p-4 mobile-enhanced"},ze=F({__name:"MobileNavOverlay",props:{showLeftSidebar:{type:Boolean},showRightSidebar:{type:Boolean},isMobile:{type:Boolean},allChapters:{},currentChapter:{},project:{},currentWordCount:{},targetWordCount:{},writingQualityScore:{},chapterContentLength:{},isGenerating:{type:Boolean},selectedText:{},isLoadingSuggestions:{type:Boolean},showCitationHelper:{type:Boolean},chapterContent:{},showDefensePrep:{type:Boolean},defenseQuestions:{},isLoadingDefenseQuestions:{type:Boolean},isGeneratingDefenseQuestions:{type:Boolean},meetsDefenseThreshold:{type:Boolean},shouldShowDefenseProgress:{type:Boolean},defenseProgressPercentage:{},defenseWordsRemaining:{},hasTriggeredGeneration:{type:Boolean}},emits:["update:showLeftSidebar","update:showRightSidebar","goToChapter","generateNextChapter","startStreamingGeneration","getAISuggestions","update:showCitationHelper","checkCitations","update:showDefensePrep","generate-more","refresh","mark-helpful","hide-question"],setup(g,{emit:l}){const p=C(g.showDefensePrep??!0),d=l,y=()=>d("update:showLeftSidebar",!1),S=()=>d("update:showRightSidebar",!1),R=t=>d("goToChapter",t),x=()=>d("generateNextChapter"),j=(t,n)=>d("startStreamingGeneration",t,n),w=()=>d("getAISuggestions"),b=t=>d("update:showCitationHelper",t),D=t=>{p.value=t,d("update:showDefensePrep",t)},P=()=>d("generate-more"),T=()=>d("refresh"),L=(t,n)=>d("mark-helpful",t,n),A=t=>d("hide-question",t);return(t,n)=>(u(),c("div",null,[i($,{"enter-active-class":"duration-300 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"duration-200 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:v(()=>[t.showLeftSidebar&&t.isMobile?(u(),c("div",Ee,[i($,{"enter-active-class":"duration-300 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"duration-200 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:v(()=>[e("div",{class:"fixed inset-0 bg-black/50",onClick:y})]),_:1}),i($,{"enter-active-class":"duration-300 ease-out","enter-from-class":"-translate-x-full","enter-to-class":"translate-x-0","leave-active-class":"duration-200 ease-in","leave-from-class":"translate-x-0","leave-to-class":"-translate-x-full"},{default:v(()=>[e("div",Ge,[e("div",Me,[e("div",Be,[n[0]||(n[0]=e("h2",{class:"text-base font-semibold"},"Navigation",-1)),i(s(X),{onClick:y,variant:"ghost",size:"sm",class:"h-8 w-8"},{default:v(()=>[i(s(W),{class:"h-4 w-4"})]),_:1})])]),e("div",He,[i(ee,{"all-chapters":t.allChapters,"current-chapter":t.currentChapter,project:t.project,"current-word-count":t.currentWordCount,"target-word-count":t.targetWordCount,"writing-quality-score":t.writingQualityScore,"chapter-content-length":t.chapterContentLength,onGoToChapter:R,onGenerateNextChapter:x},null,8,["all-chapters","current-chapter","project","current-word-count","target-word-count","writing-quality-score","chapter-content-length"]),i(s(K),{class:"border-border/50"},{default:v(()=>[i(s(J),{class:"h-4 w-4 text-muted-foreground"}),i(s(Y),{class:"text-xs text-muted-foreground"},{default:v(()=>[...n[1]||(n[1]=[e("strong",{class:"text-foreground"},"Pro Tips:",-1),e("br",null,null,-1),M(" • Press Ctrl+S to save",-1),e("br",null,null,-1),M(" • Ctrl+Z/Y for undo/redo",-1),e("br",null,null,-1),M(" • Select text for AI suggestions",-1),e("br",null,null,-1),M(" • F11 for distraction-free mode ",-1)])]),_:1})]),_:1})])])]),_:1})])):_("",!0)]),_:1}),i($,{"enter-active-class":"duration-300 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"duration-200 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:v(()=>[t.showRightSidebar&&t.isMobile?(u(),c("div",We,[i($,{"enter-active-class":"duration-300 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"duration-200 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:v(()=>[e("div",{class:"fixed inset-0 bg-black/50",onClick:S})]),_:1}),i($,{"enter-active-class":"duration-300 ease-out","enter-from-class":"translate-x-full","enter-to-class":"translate-x-0","leave-active-class":"duration-200 ease-in","leave-from-class":"translate-x-0","leave-to-class":"translate-x-full"},{default:v(()=>[e("div",Xe,[e("div",Fe,[e("div",Ie,[n[2]||(n[2]=e("h2",{class:"text-base font-semibold"},"AI Tools",-1)),i(s(X),{onClick:S,variant:"ghost",size:"sm",class:"h-8 w-8"},{default:v(()=>[i(s(W),{class:"h-4 w-4"})]),_:1})])]),e("div",Qe,[i(Z,{project:t.project,chapter:t.currentChapter,"is-generating":t.isGenerating,"selected-text":t.selectedText,"is-loading-suggestions":t.isLoadingSuggestions,"show-citation-helper":t.showCitationHelper,"chapter-content":t.chapterContent,"current-word-count":t.currentWordCount,"target-word-count":t.targetWordCount,onStartStreamingGeneration:j,onGetAiSuggestions:w,"onUpdate:showCitationHelper":b},null,8,["project","chapter","is-generating","selected-text","is-loading-suggestions","show-citation-helper","chapter-content","current-word-count","target-word-count"]),i(te,{"show-defense-prep":p.value,questions:t.defenseQuestions??[],"is-loading":t.isLoadingDefenseQuestions??!1,"is-generating":t.isGeneratingDefenseQuestions??!1,"chapter-context":{chapter_number:t.currentChapter.chapter_number,chapter_title:t.currentChapter.title,word_count:t.currentWordCount},"defense-watcher":{meetsThreshold:t.meetsDefenseThreshold??!1,shouldShowProgress:t.shouldShowDefenseProgress??!1,progressPercentage:t.defenseProgressPercentage??0,wordsRemaining:t.defenseWordsRemaining??0,hasTriggeredGeneration:t.hasTriggeredGeneration??!1,threshold:500,statusMessage:t.shouldShowDefenseProgress??!1?`Write ${t.defenseWordsRemaining??0} more words to generate defense questions`:"Ready to generate defense questions"},"onUpdate:showDefensePrep":D,onGenerateMore:P,onRefresh:T,onMarkHelpful:L,onHideQuestion:A},null,8,["show-defense-prep","questions","is-loading","is-generating","chapter-context","defense-watcher"]),i(Ne,{"chapter-id":t.currentChapter.id,content:t.chapterContent},null,8,["chapter-id","content"])])])]),_:1})])):_("",!0)]),_:1})]))}}),Lt=se(ze,[["__scopeId","data-v-76cd8967"]]);export{Lt as default};
