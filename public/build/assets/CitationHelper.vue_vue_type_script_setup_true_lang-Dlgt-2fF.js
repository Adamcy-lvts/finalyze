import{d as K,B as p,b as Q,J as W,c as f,o as d,O as w,L as s,u as t,w as i,H as a,N as l,I as n,n as U,R as E,S as q,a as b,T as $,M as X,U as F}from"./app-Ct4JdCf2.js";import{_ as I}from"./index-DYiBwM4V.js";import{_,L as R}from"./index-B0o6wPhL.js";import{_ as Y,a as Z}from"./CardContent.vue_vue_type_script_setup_true_lang-BxnX-dqq.js";import{_ as ee,a as te}from"./CardTitle.vue_vue_type_script_setup_true_lang-5NFxzzH-.js";import{_ as se,a as ae,b as oe}from"./CollapsibleTrigger.vue_vue_type_script_setup_true_lang-ChnG4mwc.js";import{_ as re}from"./Input.vue_vue_type_script_setup_true_lang-53cFwZbi.js";import{_ as ie}from"./ScrollArea.vue_vue_type_script_setup_true_lang-svO-DDQ7.js";import{_ as z}from"./Separator.vue_vue_type_script_setup_true_lang-gOb7UsYS.js";import{_ as ne,a as le,b as de,c as ce,d as ue,e as me,f as pe,g as fe}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-Bf5MxBBh.js";import{B,t as c}from"./index-t2RagoNK.js";import{Q as L,C as J}from"./RichTextEditor-aJyPGZy6.js";import{C as _e}from"./chevron-down-IP6K18oF.js";import{W as ve}from"./wand-sparkles-D5jUrJ44.js";import{S as xe}from"./search-B2rE6yDb.js";import{H as he}from"./history-DNLY_Xcx.js";import{T as ge}from"./trash-2-CW32k0yP.js";import{P as N}from"./plus-BULjuc-R.js";const ye={class:"flex items-center gap-2"},be={class:"rounded-lg bg-gradient-to-r from-amber-50 to-indigo-50 dark:from-amber-950/20 dark:to-indigo-950/20 border border-amber-200/50 dark:border-amber-800/50 p-3"},Ce={class:"flex items-start gap-2"},ke={class:"space-y-3"},we={class:"space-y-2"},$e={class:"text-xs font-medium text-muted-foreground flex items-center gap-1"},Se={class:"flex gap-1"},Ae={class:"rounded-lg bg-muted/30 p-2"},je={class:"text-xs font-medium text-foreground mb-1"},He={class:"text-xs text-muted-foreground mb-2"},De={class:"text-xs text-muted-foreground font-mono bg-background p-2 rounded border"},Ue={class:"space-y-3"},Ee={class:"text-xs font-medium text-muted-foreground flex items-center gap-1"},Fe={class:"flex gap-2"},Ie={key:0,class:"space-y-3"},Re={class:"flex items-center justify-between"},ze={class:"text-xs font-medium text-muted-foreground flex items-center gap-1"},Be={class:"space-y-2 pr-2"},Le=["onClick"],Je={class:"flex items-start justify-between gap-2"},Ne={class:"flex-1 min-w-0"},Te={class:"text-xs font-medium text-foreground truncate"},Ve={class:"text-xs text-muted-foreground mt-1"},Oe={class:"flex items-center gap-2 mt-1"},Pe={class:"text-xs text-muted-foreground"},Me={class:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity"},Ge={key:0,class:"mt-3 pt-3 border-t"},Ke={class:"bg-muted/30 rounded p-2"},Qe={class:"text-xs font-medium text-foreground mb-1"},We={class:"text-xs text-muted-foreground font-mono leading-relaxed"},qe={class:"flex gap-2 mt-3"},Xe={key:1,class:"py-8 text-center"},xt=K({__name:"CitationHelper",props:{showCitationHelper:{type:Boolean},chapterContent:{}},emits:["update:showCitationHelper","insert-citation"],setup(Ye,{emit:T}){const S=T,u=p("apa"),v=p(""),x=p(!1),C=p(!1),h=p(!1),m=p([]),g=p(null),A={apa:{name:"APA Style",description:"American Psychological Association",example:"Smith, J. (2023). Research methods. Journal of Science, 15(3), 123-145."},harvard:{name:"Harvard Style",description:"Author-date referencing system",example:'Smith, J. (2023) "Research methods", Journal of Science, 15(3), pp. 123-145.'},ieee:{name:"IEEE Style",description:"Institute of Electrical and Electronics Engineers",example:'J. Smith, "Research methods," Journal of Science, vol. 15, no. 3, pp. 123-145, 2023.'}},k=Q(()=>A[u.value]),V=r=>{S("update:showCitationHelper",r)},O=r=>{g.value=g.value===r?null:r},j=async()=>{if(!v.value.trim()){c.error("Please enter a URL, DOI, or search term");return}x.value=!0;try{const r=await $.post("/api/citations/generate",{input:v.value.trim()});if(r.data.success){const e=r.data.citation,o={id:e.id.toString(),title:e.title,authors:e.authors,year:e.year,journal:e.journal,url:e.url,doi:e.doi,type:e.type,style:{apa:e.style.apa,harvard:e.style.harvard,ieee:e.style.ieee},createdAt:new Date(e.created_at)};m.value.unshift(o),v.value="",c.success("Citation generated successfully!")}else c.error("Failed to generate citation")}catch(r){console.error("Failed to search citation:",r),r.response?.status===422?c.error("Invalid input format"):c.error("Failed to generate citation")}finally{x.value=!1}},H=r=>{const e=r.style[u.value];S("insert-citation",e),c.success("Citation inserted into document")},D=r=>{const e=r.style[u.value];navigator.clipboard.writeText(e),c.success("Citation copied to clipboard")},P=()=>{if(!m.value.length){c.error("No citations to clear");return}h.value=!0},M=async()=>{C.value=!0,h.value=!1;try{(await $.delete("/api/citations/clear")).data.success?(m.value=[],g.value=null,c.success("All citations cleared successfully")):c.error("Failed to clear citations")}catch(r){console.error("Failed to clear citations:",r),c.error("Failed to clear citations")}finally{C.value=!1}},G=async()=>{try{const r=await $.get("/api/citations/recent",{params:{limit:10}});r.data.success&&(m.value=r.data.citations.map(e=>({id:e.id.toString(),title:e.title,authors:e.authors,year:e.year,journal:e.journal,url:e.url,doi:e.doi,type:e.type,style:{apa:e.style.apa,harvard:e.style.harvard,ieee:e.style.ieee},createdAt:new Date(e.created_at)})))}catch(r){console.error("Failed to load recent citations:",r)}};return W(()=>{G()}),(r,e)=>(d(),f(w,null,[s(t(Y),{class:"border border-border/60 shadow-sm dark:border-border/50 dark:shadow-none transition-all duration-300 hover:shadow-md"},{default:i(()=>[s(t(se),{open:r.showCitationHelper,"onUpdate:open":V},{default:i(()=>[s(t(ae),{class:"w-full"},{default:i(()=>[s(t(ee),{class:"pb-3 transition-colors bg-muted/40 hover:bg-muted/60 dark:bg-transparent dark:hover:bg-muted/30"},{default:i(()=>[s(t(te),{class:"flex items-center justify-between text-sm"},{default:i(()=>[a("span",ye,[s(t(L),{class:"h-4 w-4 text-muted-foreground"}),e[3]||(e[3]=l(" Citation Helper ",-1)),s(t(I),{variant:"secondary",class:"ml-1 text-xs"},{default:i(()=>[l(n(u.value.toUpperCase()),1)]),_:1})]),s(t(_e),{class:U(["h-4 w-4 text-muted-foreground transition-transform",r.showCitationHelper?"rotate-180":""])},null,8,["class"])]),_:1})]),_:1})]),_:1}),s(t(oe),null,{default:i(()=>[s(t(Z),{class:"space-y-4 pt-0"},{default:i(()=>[a("div",be,[a("div",Ce,[s(t(B),{class:"h-4 w-4 text-amber-600 dark:text-amber-400 mt-0.5 flex-shrink-0"}),e[4]||(e[4]=a("div",{class:"text-xs leading-relaxed"},[a("p",{class:"font-medium text-amber-900 dark:text-amber-100 mb-1"},"Smart Citation Assistant"),a("p",{class:"text-amber-700 dark:text-amber-300"},"Automatically formats citations in your preferred academic style."),a("p",{class:"mt-1 text-amber-600 dark:text-amber-400"},"ðŸ’¡ Click citations to insert them directly into your document.")],-1))])]),a("div",ke,[a("div",we,[a("h4",$e,[s(t(B),{class:"h-3 w-3"}),e[5]||(e[5]=l(" Citation Style ",-1))]),a("div",Se,[(d(!0),f(w,null,E(Object.keys(A),o=>(d(),b(t(_),{key:o,onClick:y=>u.value=o,variant:u.value===o?"default":"outline",size:"sm",class:"text-xs flex-1"},{default:i(()=>[l(n(o.toUpperCase()),1)]),_:2},1032,["onClick","variant"]))),128))])]),a("div",Ae,[a("p",je,n(k.value.name),1),a("p",He,n(k.value.description),1),a("p",De,n(k.value.example),1)])]),s(t(z)),a("div",Ue,[a("h4",Ee,[s(t(ve),{class:"h-3 w-3"}),e[6]||(e[6]=l(" Generate Citation ",-1))]),a("div",Fe,[s(t(re),{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=o=>v.value=o),placeholder:"Enter URL, DOI, or search term...",class:"text-xs",onKeyup:q(j,["enter"]),disabled:x.value},null,8,["modelValue","disabled"]),s(t(_),{onClick:j,size:"sm",disabled:x.value||!v.value.trim()},{default:i(()=>[x.value?(d(),b(t(R),{key:0,class:"h-3 w-3 animate-spin"})):(d(),b(t(xe),{key:1,class:"h-3 w-3"}))]),_:1},8,["disabled"])]),e[7]||(e[7]=a("p",{class:"text-xs text-muted-foreground"}," ðŸ’¡ Paste a journal URL, DOI, or search for papers by keywords ",-1))]),m.value.length?(d(),f("div",Ie,[s(t(z)),a("div",Re,[a("h4",ze,[s(t(he),{class:"h-3 w-3"}),l(" Recent Citations ("+n(m.value.length)+") ",1)]),s(t(_),{onClick:P,disabled:C.value,variant:"ghost",size:"icon",class:"h-6 w-6 hover:bg-destructive/10 hover:text-destructive"},{default:i(()=>[C.value?(d(),b(t(R),{key:0,class:"h-3 w-3 animate-spin"})):(d(),b(t(ge),{key:1,class:"h-3 w-3"}))]),_:1},8,["disabled"])]),s(t(ie),{class:"h-[300px]"},{default:i(()=>[a("div",Be,[(d(!0),f(w,null,E(m.value,o=>(d(),f("div",{key:o.id,class:"group"},[a("div",{onClick:y=>O(o.id),class:U(["cursor-pointer rounded-lg border bg-background p-3 hover:bg-muted/30 transition-colors",g.value===o.id?"ring-2 ring-primary":""])},[a("div",Je,[a("div",Ne,[a("p",Te,n(o.title),1),a("p",Ve,n(o.authors.join(", "))+" ("+n(o.year)+") ",1),a("div",Oe,[s(t(I),{variant:"outline",class:"text-xs"},{default:i(()=>[l(n(o.type),1)]),_:2},1024),a("span",Pe,n(o.createdAt.toLocaleDateString()),1)])]),a("div",Me,[s(t(_),{onClick:F(y=>H(o),["stop"]),variant:"ghost",size:"icon",class:"h-6 w-6"},{default:i(()=>[s(t(N),{class:"h-3 w-3"})]),_:2},1032,["onClick"]),s(t(_),{onClick:F(y=>D(o),["stop"]),variant:"ghost",size:"icon",class:"h-6 w-6"},{default:i(()=>[s(t(J),{class:"h-3 w-3"})]),_:2},1032,["onClick"])])]),g.value===o.id?(d(),f("div",Ge,[a("div",Ke,[a("p",Qe,n(u.value.toUpperCase())+" Format: ",1),a("p",We,n(o.style[u.value]),1)]),a("div",qe,[s(t(_),{onClick:y=>H(o),size:"sm",class:"flex-1 text-xs"},{default:i(()=>[s(t(N),{class:"mr-1 h-3 w-3"}),e[8]||(e[8]=l(" Insert ",-1))]),_:2},1032,["onClick"]),s(t(_),{onClick:y=>D(o),size:"sm",variant:"outline",class:"flex-1 text-xs"},{default:i(()=>[s(t(J),{class:"mr-1 h-3 w-3"}),e[9]||(e[9]=l(" Copy ",-1))]),_:2},1032,["onClick"])])])):X("",!0)],10,Le)]))),128))])]),_:1})])):(d(),f("div",Xe,[s(t(L),{class:"mx-auto h-12 w-12 text-muted-foreground/30 mb-3"}),e[10]||(e[10]=a("p",{class:"text-xs text-muted-foreground mb-1"}," No citations yet ",-1)),e[11]||(e[11]=a("p",{class:"text-xs text-muted-foreground/80"}," Generate your first citation using the search above ",-1))]))]),_:1})]),_:1})]),_:1},8,["open"])]),_:1}),s(t(ne),{open:h.value,"onUpdate:open":e[2]||(e[2]=o=>h.value=o)},{default:i(()=>[s(t(le),null,{default:i(()=>[s(t(de),null,{default:i(()=>[s(t(ce),null,{default:i(()=>[...e[12]||(e[12]=[l("Clear All Citations",-1)])]),_:1}),s(t(ue),null,{default:i(()=>[l(" Are you sure you want to clear all "+n(m.value.length)+" citations? This action cannot be undone and will permanently remove all citations from your library. ",1)]),_:1})]),_:1}),s(t(me),null,{default:i(()=>[s(t(pe),{onClick:e[1]||(e[1]=o=>h.value=!1)},{default:i(()=>[...e[13]||(e[13]=[l("Cancel",-1)])]),_:1}),s(t(fe),{onClick:M,class:"bg-destructive text-destructive-foreground hover:bg-destructive/90"},{default:i(()=>[...e[14]||(e[14]=[l(" Clear All Citations ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])],64))}});export{xt as _};
