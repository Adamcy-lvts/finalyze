import{d as M,P as X,g as S,o as m,w as l,e as t,u as e,b as d,c1 as Y,h as i,aq as Z,bo as ee,q as z,aw as x,bG as te,s as se,l as C,r as U,ax as ae,c2 as le,a as g,bN as re,t as u,bk as oe,p as de,aD as ne,c as v,F as q,f as L,a1 as ie}from"./vendor-H8yUxHVJ.js";import{s as A}from"./useAppearance-DRazjLJ1.js";import{_ as ue}from"./AdminLayout.vue_vue_type_script_setup_true_lang-CCjfYqFc.js";import{_ as me}from"./DataTable.vue_vue_type_script_setup_true_lang-CRoS6mHF.js";import{_ as G}from"./Switch.vue_vue_type_script_setup_true_lang-DCko7Dmp.js";import{_ as h}from"./index-CwD5qkLf.js";import{a as ce,b as pe,e as fe,c as T,f as _e,_ as ve}from"./Sonner.vue_vue_type_script_setup_true_lang-a4iHnNww.js";import{_ as I,a as N}from"./CardContent.vue_vue_type_script_setup_true_lang-DTkdfvuV.js";import{_ as ge}from"./CardDescription.vue_vue_type_script_setup_true_lang-BbSl0Z72.js";import{_ as B,a as O}from"./CardTitle.vue_vue_type_script_setup_true_lang-B5y-_hAe.js";import{_ as E}from"./Input.vue_vue_type_script_setup_true_lang-DRx-Lc7N.js";import{_ as b}from"./Label.vue_vue_type_script_setup_true_lang-PAGjh1rG.js";import{_ as ye}from"./Textarea.vue_vue_type_script_setup_true_lang-DS0pc_gN.js";import{_ as xe}from"./Checkbox.vue_vue_type_script_setup_true_lang-DRWhnreH.js";import{_ as be,a as $e}from"./index-DHzEmSrj.js";import{_ as ke}from"./AlertTitle.vue_vue_type_script_setup_true_lang-C9ZZR0lx.js";import{_ as we,a as Ve}from"./DialogContent.vue_vue_type_script_setup_true_lang-Dw7gJkgN.js";import{_ as Ce}from"./DialogDescription.vue_vue_type_script_setup_true_lang-nvWA5ydV.js";import{_ as Se,a as he}from"./DialogTitle.vue_vue_type_script_setup_true_lang-Biexvk_x.js";import{_ as De,a as Fe,b as Ue,c as Ee,d as Ae}from"./SelectValue.vue_vue_type_script_setup_true_lang-9plmDTMM.js";import"./UserInfo.vue_vue_type_script_setup_true_lang-B2g6QnB0.js";import"./Presence-Cn1h4MwK.js";import"./useForwardExpose-CEOuSuYA.js";import"./index-CZRrGrlM.js";import"./DialogTitle-FvR-dACM.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-ev0g6x5g.js";import"./VisuallyHidden-BvUOvbOk.js";import"./index-JqClP2ZZ.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-BhA0_Tu7.js";import"./useFormControl-BAvnyqrf.js";import"./VisuallyHiddenInput-Bdtjo0T1.js";import"./nullish-CHIgUVhi.js";import"./isValueEqualOrExist-DSClXoPv.js";import"./ohash.D__AXeF1-C-E83dC9.js";import"./RovingFocusItem-B851wM0P.js";import"./useNonce-DREsFUzM.js";const je=M({__name:"DepartmentActions",props:{department:{}},setup(n){const f=n,$=X("onEditDepartment"),y=()=>{confirm(`Delete ${f.department.name}?`)&&z.delete(A("admin.system.departments.destroy",{department:f.department.id}),{preserveScroll:!0})};return(D,p)=>(m(),S(e(ve),null,{default:l(()=>[t(e(ce),{"as-child":""},{default:l(()=>[t(e(h),{variant:"ghost",class:"h-8 w-8 p-0"},{default:l(()=>[p[1]||(p[1]=d("span",{class:"sr-only"},"Open menu",-1)),t(e(Y),{class:"h-4 w-4"})]),_:1})]),_:1}),t(e(pe),{align:"end"},{default:l(()=>[t(e(fe),null,{default:l(()=>[...p[2]||(p[2]=[i("Actions",-1)])]),_:1}),t(e(T),{onClick:p[0]||(p[0]=k=>e($)?.(f.department))},{default:l(()=>[t(e(Z),{class:"mr-2 h-4 w-4"}),p[3]||(p[3]=i(" Edit ",-1))]),_:1}),t(e(_e)),t(e(T),{onClick:y,class:"text-rose-600 focus:text-rose-600 focus:bg-rose-50"},{default:l(()=>[t(e(ee),{class:"mr-2 h-4 w-4"}),p[4]||(p[4]=i(" Delete ",-1))]),_:1})]),_:1})]),_:1}))}}),Ie=(n,f)=>{z.put(A("admin.system.departments.toggle-active",{department:n.id}),{is_active:f},{preserveScroll:!0})},Ne=[{accessorKey:"name",header:({column:n})=>x(h,{variant:"ghost",class:"-ml-2 text-xs hover:bg-muted/50",onClick:()=>n.toggleSorting(n.getIsSorted()==="asc")},()=>["Name",x(te,{class:"ml-2 h-3 w-3"})]),cell:({row:n})=>{const f=n.getValue("name"),$=n.original.slug,y=n.original.code,D=y?`${y} · ${$}`:$;return x("div",{class:"flex flex-col"},[x("span",{class:"font-medium"},f),x("span",{class:"text-xs text-muted-foreground"},D)])}},{accessorKey:"faculty_name",header:"Faculty",cell:({row:n})=>n.original.faculty_name||"—"},{accessorKey:"sort_order",header:"Order",cell:({row:n})=>n.getValue("sort_order")},{accessorKey:"is_active",header:"Active",cell:({row:n})=>x(G,{checked:n.original.is_active,"onUpdate:checked":f=>Ie(n.original,f)})},{id:"actions",cell:({row:n})=>x(je,{department:n.original})}],Be={class:"grid gap-4 md:grid-cols-2 mb-6"},Oe={class:"text-2xl font-bold"},Pe={class:"text-2xl font-bold"},Ke={class:"grid gap-4 py-4"},qe={class:"grid gap-4 md:grid-cols-2"},Le={class:"space-y-1"},Te={key:0,class:"text-xs text-rose-500"},Me={class:"space-y-1"},ze={key:0,class:"text-xs text-rose-500"},Ge={class:"grid gap-4 md:grid-cols-2"},He={class:"space-y-1"},Je={key:0,class:"text-xs text-rose-500"},Qe={class:"space-y-1"},Re={key:0,class:"text-xs text-rose-500"},We={class:"space-y-2"},Xe={class:"grid gap-2 md:grid-cols-2"},Ye={key:0,class:"text-xs text-rose-500"},Ze={class:"space-y-1"},et={key:0,class:"text-xs text-rose-500"},tt={class:"grid gap-4 md:grid-cols-2"},st={class:"space-y-1"},at={key:0,class:"text-xs text-rose-500"},lt={class:"flex items-center justify-between rounded-md border border-border/70 bg-muted/30 px-3 py-2 text-sm"},rt={class:"flex justify-end gap-2"},Tt=M({__name:"Index",props:{departments:{},faculties:{},stats:{}},setup(n){const f=n,$=se(),y=C(()=>$.props.flash),D=C(()=>f.departments??[]),p=C(()=>f.faculties??[]),k=U(null),w=U(!1),c=U([]),_=U(""),P=()=>({name:"",slug:"",code:"",description:"",faculty_ids:[],primary_faculty_id:"",sort_order:0,is_active:!0}),a=ae({...P()}),F=C(()=>k.value!==null),K=()=>{k.value=null,a.clearErrors(),Object.assign(a,P()),c.value=[],_.value=""},H=()=>{K(),w.value=!0},J=o=>{k.value=o.id,a.clearErrors(),a.name=o.name??"",a.slug=o.slug??"",a.code=o.code??"",a.description=o.description??"";const s=o.faculty_id?[o.faculty_id]:[],r=o.faculty_ids&&o.faculty_ids.length>0?o.faculty_ids:s;c.value=r.filter(Boolean).map(j=>String(j));const V=o.primary_faculty_id??o.faculty_id??r[0]??null;_.value=V?String(V):"",_.value&&!c.value.includes(_.value)&&(c.value=[...c.value,_.value]),a.sort_order=Number(o.sort_order??0),a.is_active=!!o.is_active,w.value=!0},Q=C(()=>p.value.filter(o=>c.value.includes(String(o.id)))),R=(o,s)=>{const r=String(o);if(s===!0){c.value.includes(r)||(c.value=[...c.value,r]),_.value||(_.value=r);return}c.value=c.value.filter(j=>j!==r),_.value===r&&(_.value=c.value[0]??"")},W=()=>{a.faculty_ids=[...c.value],a.primary_faculty_id=_.value;const o={preserveScroll:!0,onSuccess:()=>{w.value=!1,K()}};if(!a.primary_faculty_id&&a.faculty_ids.length>0&&(a.primary_faculty_id=a.faculty_ids[0]),F.value&&k.value!==null){a.put(A("admin.system.departments.update",{department:k.value}),o);return}a.post(A("admin.system.departments.store"),o)};return le("onEditDepartment",J),(o,s)=>(m(),S(ue,{title:"Departments",subtitle:"Manage departments available for project setup."},{default:l(()=>[d("div",Be,[t(e(I),{class:"bg-card text-card-foreground border-border/50 shadow-sm"},{default:l(()=>[t(e(B),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[t(e(O),{class:"text-sm font-medium text-muted-foreground"},{default:l(()=>[...s[9]||(s[9]=[i("Total Departments",-1)])]),_:1}),t(e(re),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(N),null,{default:l(()=>[d("div",Oe,u(o.stats.total),1)]),_:1})]),_:1}),t(e(I),{class:"bg-card text-card-foreground border-border/50 shadow-sm"},{default:l(()=>[t(e(B),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[t(e(O),{class:"text-sm font-medium text-muted-foreground"},{default:l(()=>[...s[10]||(s[10]=[i("Active",-1)])]),_:1}),t(e(oe),{class:"h-4 w-4 text-emerald-500"})]),_:1}),t(e(N),null,{default:l(()=>[d("div",Pe,u(o.stats.active),1)]),_:1})]),_:1})]),y.value?.success?(m(),S(e(be),{key:0,class:"mb-6 border border-emerald-500/40 bg-emerald-500/10"},{default:l(()=>[t(e(de),{class:"h-4 w-4 text-emerald-500"}),t(e(ke),null,{default:l(()=>[...s[11]||(s[11]=[i("Updated",-1)])]),_:1}),t(e($e),null,{default:l(()=>[i(u(y.value.success),1)]),_:1})]),_:1})):g("",!0),t(e(I),{class:"border border-border/50 bg-card shadow-sm"},{default:l(()=>[t(e(B),{class:"flex flex-row items-center justify-between pb-3"},{default:l(()=>[d("div",null,[t(e(O),{class:"text-base font-semibold text-foreground"},{default:l(()=>[...s[12]||(s[12]=[i("Departments",-1)])]),_:1}),t(e(ge),null,{default:l(()=>[...s[13]||(s[13]=[i("Assign departments to faculties for selection.",-1)])]),_:1})]),t(e(h),{size:"sm",onClick:H},{default:l(()=>[t(e(ne),{class:"mr-2 h-4 w-4"}),s[14]||(s[14]=i(" Add Department ",-1))]),_:1})]),_:1}),t(e(N),null,{default:l(()=>[t(me,{columns:e(Ne),data:D.value,"search-key":"name","search-placeholder":"Filter departments..."},null,8,["columns","data"])]),_:1})]),_:1}),t(e(we),{open:w.value,"onUpdate:open":s[8]||(s[8]=r=>w.value=r)},{default:l(()=>[t(e(Ve),{class:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto"},{default:l(()=>[t(e(Se),null,{default:l(()=>[t(e(he),null,{default:l(()=>[i(u(F.value?"Edit department":"Create department"),1)]),_:1}),t(e(Ce),null,{default:l(()=>[i(u(F.value?"Update department details.":"Add a new department to the catalog."),1)]),_:1})]),_:1}),d("div",Ke,[d("div",qe,[d("div",Le,[t(e(b),null,{default:l(()=>[...s[15]||(s[15]=[i("Name",-1)])]),_:1}),t(e(E),{modelValue:e(a).name,"onUpdate:modelValue":s[0]||(s[0]=r=>e(a).name=r),placeholder:"Computer Science"},null,8,["modelValue"]),e(a).errors.name?(m(),v("p",Te,u(e(a).errors.name),1)):g("",!0)]),d("div",Me,[t(e(b),null,{default:l(()=>[...s[16]||(s[16]=[i("Slug",-1)])]),_:1}),t(e(E),{modelValue:e(a).slug,"onUpdate:modelValue":s[1]||(s[1]=r=>e(a).slug=r),placeholder:"computer-science"},null,8,["modelValue"]),e(a).errors.slug?(m(),v("p",ze,u(e(a).errors.slug),1)):g("",!0)])]),d("div",Ge,[d("div",He,[t(e(b),null,{default:l(()=>[...s[17]||(s[17]=[i("Code",-1)])]),_:1}),t(e(E),{modelValue:e(a).code,"onUpdate:modelValue":s[2]||(s[2]=r=>e(a).code=r),placeholder:"CSC"},null,8,["modelValue"]),e(a).errors.code?(m(),v("p",Je,u(e(a).errors.code),1)):g("",!0)]),d("div",Qe,[t(e(b),null,{default:l(()=>[...s[18]||(s[18]=[i("Primary Faculty",-1)])]),_:1}),t(e(De),{modelValue:_.value,"onUpdate:modelValue":s[3]||(s[3]=r=>_.value=r)},{default:l(()=>[t(e(Fe),null,{default:l(()=>[t(e(Ue),{placeholder:"Select primary faculty"})]),_:1}),t(e(Ee),null,{default:l(()=>[(m(!0),v(q,null,L(Q.value,r=>(m(),S(e(Ae),{key:r.id,value:String(r.id)},{default:l(()=>[i(u(r.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(a).errors.primary_faculty_id?(m(),v("p",Re,u(e(a).errors.primary_faculty_id),1)):g("",!0)])]),d("div",We,[t(e(b),null,{default:l(()=>[...s[19]||(s[19]=[i("Faculties (appear in multiple lists)",-1)])]),_:1}),d("div",Xe,[(m(!0),v(q,null,L(p.value,r=>(m(),v("label",{key:r.id,class:"flex items-center gap-2 rounded-md border border-border/70 bg-muted/30 px-3 py-2 text-sm"},[t(e(xe),{"model-value":c.value.includes(String(r.id)),"onUpdate:modelValue":V=>R(r.id,V)},null,8,["model-value","onUpdate:modelValue"]),d("span",null,u(r.name),1)]))),128))]),e(a).errors.faculty_ids?(m(),v("p",Ye,u(e(a).errors.faculty_ids),1)):g("",!0)]),d("div",Ze,[t(e(b),null,{default:l(()=>[...s[20]||(s[20]=[i("Description",-1)])]),_:1}),t(e(ye),{modelValue:e(a).description,"onUpdate:modelValue":s[4]||(s[4]=r=>e(a).description=r),rows:"3",placeholder:"Optional description..."},null,8,["modelValue"]),e(a).errors.description?(m(),v("p",et,u(e(a).errors.description),1)):g("",!0)]),d("div",tt,[d("div",st,[t(e(b),null,{default:l(()=>[...s[21]||(s[21]=[i("Sort Order",-1)])]),_:1}),t(e(E),{modelValue:e(a).sort_order,"onUpdate:modelValue":s[5]||(s[5]=r=>e(a).sort_order=r),type:"number",min:"0"},null,8,["modelValue"]),e(a).errors.sort_order?(m(),v("p",at,u(e(a).errors.sort_order),1)):g("",!0)]),d("label",lt,[s[22]||(s[22]=d("span",{class:"text-foreground"},"Active",-1)),t(e(G),{checked:e(a).is_active,"onUpdate:checked":s[6]||(s[6]=r=>e(a).is_active=r)},null,8,["checked"])])])]),d("div",rt,[t(e(h),{variant:"ghost",onClick:s[7]||(s[7]=r=>w.value=!1)},{default:l(()=>[...s[23]||(s[23]=[i("Cancel",-1)])]),_:1}),t(e(h),{disabled:e(a).processing,onClick:W},{default:l(()=>[e(a).processing?(m(),S(e(ie),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):g("",!0),d("span",null,u(F.value?"Update department":"Add department"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["open"])]),_:1}))}});export{Tt as default};
