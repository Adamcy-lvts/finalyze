const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AISidebar-FWppCxCq.js","assets/app-BwSuuO8q.js","assets/app-Cgl-ZKxF.css","assets/index-DWDE3uD3.js","assets/CardContent.vue_vue_type_script_setup_true_lang-DsPBgFj-.js","assets/CardTitle.vue_vue_type_script_setup_true_lang-j1wu7leJ.js","assets/CollapsibleTrigger.vue_vue_type_script_setup_true_lang-CFvZLpcj.js","assets/VisuallyHidden-BVXBGdjB.js","assets/useForwardExpose-C6Qh1eXD.js","assets/Separator.vue_vue_type_script_setup_true_lang-Bqmb2vP6.js","assets/Separator-DFHpmVOw.js","assets/Progress.vue_vue_type_script_setup_true_lang-Ds2u6lKX.js","assets/nullish-CHIgUVhi.js","assets/Sonner.vue_vue_type_script_setup_true_lang-CkW95NHV.js","assets/DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-B0TJQ586.js","assets/triangle-alert-CQ6N0hck.js","assets/circle-check-Cm7ehRtz.js","assets/CitationHelper.vue_vue_type_script_setup_true_lang-DAmHOrd8.js","assets/index-Cxf58bkt.js","assets/Input.vue_vue_type_script_setup_true_lang-BDD34IKO.js","assets/ScrollArea.vue_vue_type_script_setup_true_lang-BMJUFCCa.js","assets/useNonce-BEc0ZK-E.js","assets/AlertDialogTitle.vue_vue_type_script_setup_true_lang-Ba2P4dIA.js","assets/RichTextEditor-BZrprvHc.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/SafeHtmlText.vue_vue_type_script_setup_true_lang-Bz9QUajs.js","assets/index-BWEDi_FC.js","assets/step-DrZ9DcYd.js","assets/DialogTitle.vue_vue_type_script_setup_true_lang-CMkhRXSU.js","assets/DialogFooter.vue_vue_type_script_setup_true_lang-BQmrY5Qj.js","assets/Label.vue_vue_type_script_setup_true_lang-uXk1mndE.js","assets/type-DSk5NDhW.js","assets/minus-C5tZ4-eT.js","assets/plus-Crxdb5Ol.js","assets/list-CnOrtbx6.js","assets/RichTextEditor-BDJ8Kfyb.css","assets/chevron-down-uQhdeyMV.js","assets/wand-sparkles-BUZ-UNGq.js","assets/search-BJjfXSMw.js","assets/history-BDABGSSF.js","assets/trash-2-Jn1EbwAK.js","assets/copy-DqdqbGDE.js","assets/brain-B8rDUplQ.js","assets/zap-D2Ss3qEM.js","assets/pen-tool-bGh6h8wV.js","assets/refresh-cw-Bt8enO53.js","assets/sparkles-DtwppNu_.js","assets/AISidebar-Ymbz_oju.css","assets/ChapterNavigation-CkNPfjuZ.js","assets/ChapterNavigation.vue_vue_type_script_setup_true_lang-CvUfJfej.js","assets/DialogTrigger-Gj05Oq5Q.js","assets/chevron-right-CUUepDUH.js","assets/circle-check-big-Wte8SNDs.js","assets/lock-Dy1cjIu9.js","assets/target-DFv7vGjK.js","assets/MobileNavOverlay-cHHg2bqi.js","assets/index-qn60maqE.js","assets/DefensePreparationPanel.vue_vue_type_script_setup_true_lang-BdU8lNdc.js","assets/Switch.vue_vue_type_script_setup_true_lang-8b3xeIcZ.js","assets/VisuallyHiddenInput-C3qlS59t.js","assets/thumbs-up-BwUhTHHO.js","assets/lightbulb-WXNvGWfA.js","assets/download-CXtKuvOg.js","assets/circle-alert-BMfqqzQB.js","assets/DataCollectionPanel.vue_vue_type_script_setup_true_lang-CPG11wUd.js","assets/MobileNavOverlay-CN-XSdXy.css","assets/ChatModeLayout-BER4HSDL.js","assets/ChatModeLayout.vue_vue_type_script_setup_true_lang-8ojiMoTj.js","assets/square-CUqPpr-1.js","assets/useTextHistory-C7XqnnfH.js","assets/Checkbox.vue_vue_type_script_setup_true_lang-D45bteIt.js","assets/ohash.D__AXeF1-C-E83dC9.js","assets/RovingFocusItem-BGVliAUw.js","assets/check-CieKL4YQ.js","assets/file-text-GkBbxBcT.js","assets/useTextHistory-BWcwai4o.css","assets/loader-BgrEtfU1.js","assets/message-square-BI0obXv9.js","assets/chevron-left-CX3KUSd6.js","assets/clock-n9MAwjIq.js","assets/rotate-ccw-BdmkXjhU.js","assets/chart-column-BHkiF3cw.js","assets/user-CS92YXhD.js","assets/eye-BYbrM7uk.js","assets/save-CeIk8Z1p.js","assets/ChatModeLayout-wjQGykpm.css","assets/CitationVerificationLayout-CiFHfYP3.js","assets/DefensePreparationPanel-WagV9_AE.js","assets/DataCollectionPanel-7jWWUpq0.js"])))=>i.map(i=>d[i]);
import{ak as Pa,ab as ja,d as Nr,g as j,c as Q,q as pe,o as _,u as t,w as l,k as n,e as r,s as M,n as ve,t as w,a as z,F as Gt,A as zt,X as Ye,z as c,Q as Ne,C as xe,y as J,h as ft,p as mt,j as qa,al as Fe,x as Qe,T as Cr,am as wt,b as Ke,f as Je,an as Le}from"./app-BwSuuO8q.js";import{_ as Te}from"./index-Cxf58bkt.js";import{_ as G}from"./index-DWDE3uD3.js";import{_ as _t,a as Ct}from"./CardContent.vue_vue_type_script_setup_true_lang-DsPBgFj-.js";import{_ as kt,a as Ht}from"./CardTitle.vue_vue_type_script_setup_true_lang-j1wu7leJ.js";import{_ as kr}from"./Input.vue_vue_type_script_setup_true_lang-BDD34IKO.js";import{_ as Nt}from"./Label.vue_vue_type_script_setup_true_lang-uXk1mndE.js";import{_ as Wr}from"./Progress.vue_vue_type_script_setup_true_lang-Ds2u6lKX.js";import{_ as Sr}from"./ScrollArea.vue_vue_type_script_setup_true_lang-BMJUFCCa.js";import{_ as ne,a as oe,b as se}from"./UserInfo.vue_vue_type_script_setup_true_lang-BD50gIik.js";import{u as Da,r as Xe,_ as Ma,a as Fa}from"./AppLayout.vue_vue_type_script_setup_true_lang-D2TNYvK1.js";import{_ as Er}from"./SafeHtmlText.vue_vue_type_script_setup_true_lang-Bz9QUajs.js";import{t as f,M as Tr,S as $r}from"./Sonner.vue_vue_type_script_setup_true_lang-CkW95NHV.js";import{_ as La}from"./PurchaseModal.vue_vue_type_script_setup_true_lang-AS6prHJw.js";import{B as it,u as Na,M as Ar,_ as Wt,R as Rr,a as Wa,P as Oa,b as Ia}from"./useTextHistory-C7XqnnfH.js";import{T as Ga}from"./trending-up-Cppe3giB.js";import{C as za}from"./circle-alert-BMfqqzQB.js";import{ao as Pr}from"./RichTextEditor-BZrprvHc.js";import{t as jr}from"./toNumber-DDtgQX9A.js";import{A as qr}from"./arrow-left-DLbhTRbg.js";import{B as bt}from"./brain-B8rDUplQ.js";import{T as Dr}from"./target-DFv7vGjK.js";import{E as Ot}from"./eye-BYbrM7uk.js";import{S as Mr}from"./save-CeIk8Z1p.js";import{C as Fr}from"./circle-check-big-Wte8SNDs.js";import{M as Ha}from"./message-square-BI0obXv9.js";import{P as Ua,a as Va}from"./panel-left-open-DJnn9LKP.js";import{P as Ba}from"./pen-tool-bGh6h8wV.js";import"./useForwardExpose-C6Qh1eXD.js";import"./VisuallyHidden-BVXBGdjB.js";import"./nullish-CHIgUVhi.js";import"./useNonce-BEc0ZK-E.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-B0TJQ586.js";import"./coins-7ZdAYMhX.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BeKVMeXI.js";import"./plus-Crxdb5Ol.js";import"./chevron-right-CUUepDUH.js";import"./triangle-alert-CQ6N0hck.js";import"./circle-check-Cm7ehRtz.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CMkhRXSU.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-BQmrY5Qj.js";import"./sparkles-DtwppNu_.js";import"./arrow-right-CbTGwkCA.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-D45bteIt.js";import"./ohash.D__AXeF1-C-E83dC9.js";import"./VisuallyHiddenInput-C3qlS59t.js";import"./RovingFocusItem-BGVliAUw.js";import"./minus-C5tZ4-eT.js";import"./check-CieKL4YQ.js";import"./Separator.vue_vue_type_script_setup_true_lang-Bqmb2vP6.js";import"./Separator-DFHpmVOw.js";import"./download-CXtKuvOg.js";import"./chevron-down-uQhdeyMV.js";import"./file-text-GkBbxBcT.js";import"./index-BWEDi_FC.js";import"./step-DrZ9DcYd.js";import"./type-DSk5NDhW.js";import"./list-CnOrtbx6.js";var It=function(){return Pa.Date.now()},Qa="Expected a function",Ka=Math.max,Ja=Math.min;function Xa(N,E,q){var W,m,p,x,v,i,C=0,b=!1,O=!1,P=!0;if(typeof N!="function")throw new TypeError(Qa);E=jr(E)||0,ja(q)&&(b=!!q.leading,O="maxWait"in q,p=O?Ka(jr(q.maxWait)||0,E):p,P="trailing"in q?!!q.trailing:P);function g(I){var T=W,K=m;return W=m=void 0,C=I,x=N.apply(K,T),x}function F(I){return C=I,v=setTimeout(Z,E),b?g(I):x}function V(I){var T=I-i,K=I-C,ee=E-T;return O?Ja(ee,p-K):ee}function X(I){var T=I-i,K=I-C;return i===void 0||T>=E||T<0||O&&K>=p}function Z(){var I=It();if(X(I))return me(I);v=setTimeout(Z,V(I))}function me(I){return v=void 0,P&&W?g(I):(W=m=void 0,x)}function _e(){v!==void 0&&clearTimeout(v),C=0,W=i=m=v=void 0}function we(){return v===void 0?x:me(It())}function he(){var I=It(),T=X(I);if(W=arguments,m=this,i=I,T){if(v===void 0)return F(i);if(O)return clearTimeout(v),v=setTimeout(Z,E),g(i)}return v===void 0&&(v=setTimeout(Z,E)),x}return he.cancel=_e,he.flush=we,he}const Ya={class:"flex items-center justify-between mb-3"},Za={class:"flex items-center gap-3"},en={class:"p-2 rounded-lg bg-blue-500/10"},tn={class:"text-right"},rn={class:"space-y-2"},an={class:"flex justify-between items-center text-xs"},nn={class:"relative"},on={key:0},sn={class:"space-y-3"},ln={class:"flex-1"},un={class:"text-sm font-medium"},cn={class:"text-xs text-muted-foreground"},dn={class:"w-20 h-2 bg-muted rounded-full overflow-hidden ml-3"},pn={key:1},vn={class:"space-y-2"},gn={class:"flex-1"},hn={class:"text-sm font-medium"},fn={class:"text-xs text-muted-foreground"},mn={key:2,class:"flex items-center justify-center gap-3 p-4 rounded-lg bg-blue-50/50 border border-blue-200/50"},wn={key:3,class:"text-center p-4 rounded-lg bg-muted/30"},Lr=Nr({__name:"WritingStatistics",props:{showStatistics:{type:Boolean},currentWordCount:{},writingStats:{},qualityAnalysis:{},isAnalyzing:{type:Boolean}},setup(N){const E=N;j(()=>{if(!E.qualityAnalysis?.quality_level)return"text-muted-foreground";switch(E.qualityAnalysis.quality_level){case"Excellent":return"text-green-600";case"Good":return"text-blue-600";case"Satisfactory":return"text-yellow-600";case"Needs Improvement":return"text-orange-600";case"Poor":return"text-red-600";default:return"text-muted-foreground"}});const q=j(()=>E.qualityAnalysis?.scores?Object.entries(E.qualityAnalysis.scores).filter(([,m])=>m.max>0).filter(([,m])=>m.percentage<75).sort(([,m],[,p])=>m.percentage-p.percentage).map(([m,p])=>({category:m.replace(" & "," & "),percentage:Math.round(p.percentage),score:p.score,max:p.max,status:p.percentage<40?"poor":p.percentage<60?"needs-work":"fair"})):[]),W=j(()=>{const m=E.qualityAnalysis?.total_score||0;return m>=80?{text:"Excellent",color:"text-green-600",bgColor:"bg-green-50"}:m>=70?{text:"Satisfactory",color:"text-yellow-600",bgColor:"bg-yellow-50"}:m>=60?{text:"Needs Work",color:"text-orange-600",bgColor:"bg-orange-50"}:{text:"Poor",color:"text-red-600",bgColor:"bg-red-50"}});return(m,p)=>m.showStatistics?(_(),Q(t(_t),{key:0,class:"border border-border/50 bg-gradient-to-br from-card/80 to-card/60 backdrop-blur-sm shadow-lg"},{default:l(()=>[m.qualityAnalysis?(_(),Q(t(kt),{key:0,class:"pb-4 border-b border-border/50"},{default:l(()=>[r("div",Ya,[r("div",Za,[r("div",en,[n(t(it),{class:"h-4 w-4 text-blue-600"})]),r("div",null,[n(t(Ht),{class:"text-sm font-semibold"},{default:l(()=>[...p[0]||(p[0]=[M("Academic Quality",-1)])]),_:1}),p[1]||(p[1]=r("p",{class:"text-xs text-muted-foreground"},"AI-powered analysis",-1))])]),r("div",tn,[r("div",{class:ve(["text-2xl font-bold",W.value.color])},[M(w(m.qualityAnalysis.total_score),1),p[2]||(p[2]=r("span",{class:"text-sm text-muted-foreground"},"/100",-1))],2),n(t(Te),{class:ve([[W.value.color,W.value.bgColor],"text-xs font-medium"]),variant:"outline"},{default:l(()=>[M(w(W.value.text),1)]),_:1},8,["class"])])]),r("div",rn,[r("div",an,[p[3]||(p[3]=r("span",{class:"text-muted-foreground"},"Overall Score",-1)),r("span",{class:ve(["font-medium",m.qualityAnalysis.meets_threshold?"text-green-600":"text-orange-600"])},w(m.qualityAnalysis.meets_threshold?"Meets threshold âœ“":"Below 80% threshold"),3)]),r("div",nn,[n(t(Wr),{"model-value":Math.round(m.qualityAnalysis.total_score||0),class:ve(["h-2",{"[&>[data-slot=progress-indicator]]:bg-green-500":(m.qualityAnalysis.total_score||0)>=80,"[&>[data-slot=progress-indicator]]:bg-yellow-500":(m.qualityAnalysis.total_score||0)>=70&&(m.qualityAnalysis.total_score||0)<80,"[&>[data-slot=progress-indicator]]:bg-orange-500":(m.qualityAnalysis.total_score||0)>=60&&(m.qualityAnalysis.total_score||0)<70,"[&>[data-slot=progress-indicator]]:bg-red-500":(m.qualityAnalysis.total_score||0)<60}])},null,8,["model-value","class"]),p[4]||(p[4]=r("div",{class:"absolute inset-0 flex items-center justify-center"},[r("div",{class:"w-0.5 h-4 bg-orange-400/60 rounded-full",style:{"margin-left":"80%"}})],-1))])])]),_:1})):pe("",!0),n(t(Ct),{class:"p-4 space-y-4"},{default:l(()=>[m.qualityAnalysis?.scores?(_(),z("div",on,[p[5]||(p[5]=r("h4",{class:"text-xs font-semibold text-muted-foreground mb-3 flex items-center gap-2"},[r("div",{class:"w-1 h-4 bg-green-500 rounded-full"}),M(" Analysis Results ")],-1)),r("div",sn,[(_(!0),z(Gt,null,zt(Object.entries(m.qualityAnalysis.scores).filter(([,x])=>x.max>0),([x,v])=>(_(),z("div",{key:x,class:"flex items-center justify-between p-3 rounded-lg bg-muted/30 hover:bg-muted/40 transition-colors"},[r("div",ln,[r("div",un,w(x),1),r("div",cn,[M(w(v.score)+"/"+w(v.max)+" points ",1),r("span",{class:ve(["ml-1",{"text-red-500":v.percentage<50,"text-orange-500":v.percentage>=50&&v.percentage<75,"text-blue-500":v.percentage>=75&&v.percentage<90,"text-green-500":v.percentage>=90}])}," ("+w(Math.round(v.percentage))+"%) ",3)])]),r("div",dn,[r("div",{class:ve(["h-full transition-all duration-500 rounded-full",{"bg-red-500":v.percentage<50,"bg-orange-500":v.percentage>=50&&v.percentage<75,"bg-blue-500":v.percentage>=75&&v.percentage<90,"bg-green-500":v.percentage>=90}]),style:Ye({width:`${v.percentage}%`})},null,6)])]))),128))])])):pe("",!0),q.value.length>0?(_(),z("div",pn,[p[6]||(p[6]=r("h4",{class:"text-xs font-semibold text-muted-foreground mb-3 flex items-center gap-2"},[r("div",{class:"w-1 h-4 bg-orange-500 rounded-full"}),M(" Focus Areas ")],-1)),r("div",vn,[(_(!0),z(Gt,null,zt(q.value,x=>(_(),z("div",{key:x.category,class:"flex items-center gap-3 p-3 rounded-lg border border-orange-200/50 bg-orange-50/30"},[n(t(za),{class:"h-4 w-4 text-orange-500 flex-shrink-0"}),r("div",gn,[r("div",hn,w(x.category),1),r("div",fn,[M(w(x.score)+"/"+w(x.max)+" points - ",1),r("span",{class:ve({"text-red-600":x.status==="poor","text-orange-600":x.status==="needs-work","text-yellow-600":x.status==="fair"})},w(x.status==="poor"?"needs significant improvement":x.status==="needs-work"?"needs improvement":"fair, could be better"),3)])])]))),128))])])):pe("",!0),m.isAnalyzing?(_(),z("div",mn,[n(t(Ga),{class:"h-4 w-4 text-blue-500 animate-pulse"}),p[7]||(p[7]=r("span",{class:"text-sm text-blue-700 font-medium"},"Analyzing academic quality with AI...",-1))])):pe("",!0),!m.qualityAnalysis&&!m.isAnalyzing?(_(),z("div",wn,[n(t(it),{class:"h-8 w-8 text-muted-foreground mx-auto mb-2"}),p[8]||(p[8]=r("p",{class:"text-sm text-muted-foreground"},'Click "Analyze" to get AI-powered quality insights',-1))])):pe("",!0)]),_:1})]),_:1})):pe("",!0)}});function bn(N){const{delay:E=1e4,onSave:q}=N,W=c(!1),m=c(!1),p=c(null),x=()=>{W.value=!0,p.value&&clearTimeout(p.value),p.value=setTimeout(()=>{v(!0)},E)},v=async(C=!1)=>{if(!m.value){m.value=!0;try{await q(C),W.value=!1,p.value&&(clearTimeout(p.value),p.value=null)}finally{m.value=!1}}};return{hasUnsavedChanges:W,isSaving:m,triggerAutoSave:x,save:v,clearAutoSave:()=>{p.value&&(clearTimeout(p.value),p.value=null)}}}function yn(N){const E=c({sentences:0,paragraphs:0,readingTime:0,avgWordLength:0,uniqueWords:0,commonWords:[]}),q=j(()=>N.value?N.value.split(/\s+/).filter(p=>p.length>0).length:0),W=()=>{if(!N.value){E.value={sentences:0,paragraphs:0,readingTime:0,avgWordLength:0,uniqueWords:0,commonWords:[]};return}const p=N.value,x=p.split(/\s+/).filter(P=>P.length>0),v=p.split(/[.!?]+/).filter(P=>P.trim().length>0),i=p.split(`

`).filter(P=>P.trim().length>0),C=new Map;x.forEach(P=>{const g=P.toLowerCase().replace(/[^a-z0-9]/g,"");g&&C.set(g,(C.get(g)||0)+1)});const b=new Set(["the","a","an","and","or","but","in","on","at","to","for","of","with","by","is","was","are","were"]),O=Array.from(C.entries()).filter(([P])=>!b.has(P)).sort((P,g)=>g[1]-P[1]).slice(0,5).map(([P])=>P);E.value={sentences:v.length,paragraphs:i.length,readingTime:Math.ceil(x.length/200),avgWordLength:x.reduce((P,g)=>P+g.length,0)/x.length,uniqueWords:C.size,commonWords:O}},m=j(()=>{if(!N.value)return 0;let p=0;const x=N.value;x.includes("##")&&(p+=20),x.length>1e3&&(p+=20),x.match(/\[.*?\]/g)&&(p+=15),(x.includes("**")||x.includes("*"))&&(p+=10);const v=x.split(/[.!?]+/).filter(C=>C.trim().length>0);if(v.length>0){const C=v.reduce((b,O)=>b+O.split(/\s+/).length,0)/v.length;C>10&&C<25&&(p+=20)}return x.split(`

`).filter(C=>C.trim().length>0).length>3&&(p+=15),Math.min(p,100)});return{writingStats:E,currentWordCount:q,writingQualityScore:m,calculateWritingStats:W}}function xn(N,E=c(3e3),q=.8){const W=d=>{if(!d)return 0;const H=d.replace(/<[^>]*>/g,"").trim().replace(/\s+/g," ");if(!H)return 0;const S=H.match(/\b\w+\b/g);return S?S.length:0},m=d=>d?d.replace(/<[^>]*>/g,"").replace(/\r\n|\r/g,`
`).trim().split(/\n\s*\n/).filter($=>$.trim().length>0).length:0,p=d=>{if(!d)return 0;const H=d.replace(/<[^>]*>/g,"").match(/[.!?]+/g);return H?H.length:0},x=d=>Math.round(d/200*10)/10,v=j(()=>W(N.value)),i=j(()=>N.value.length),C=j(()=>N.value.replace(/\s/g,"").length),b=j(()=>m(N.value)),O=j(()=>p(N.value)),P=j(()=>x(v.value)),g=j(()=>{const d=E.value;return!d||d<=0?0:Math.min(v.value/d*100,100)}),F=j(()=>v.value>=E.value*q),V=j(()=>{const d=E.value-v.value;return Math.max(d,0)}),X=j(()=>{const d=E.value*q-v.value;return Math.max(d,0)}),Z=j(()=>({wordCount:v.value,characterCount:i.value,characterCountNoSpaces:C.value,paragraphCount:b.value,sentenceCount:O.value,readingTimeMinutes:P.value})),me=j(()=>({current:v.value,target:E.value,percentage:g.value,isComplete:F.value,completionThreshold:q})),_e=d=>d>=1e3?`${Math.round(d/100)/10}k`:d.toString(),we=(d=0)=>`${Math.round(g.value*Math.pow(10,d))/Math.pow(10,d)}%`,he=()=>`${v.value} / ${E.value} words (${we()}%)`,I=()=>{if(F.value)return`âœ… Complete (${_e(v.value)} words)`;const d=X.value;return`${_e(d)} more words to complete`},T=()=>{const d=v.value,y=E.value;return d===0?"empty":d<y*.25?"started":d<y*.75?"progressing":d<y*q?"near_complete":d<y?"complete":"exceeded"},K=()=>{const d=T();return{empty:"text-gray-500",started:"text-blue-500",progressing:"text-yellow-500",near_complete:"text-orange-500",complete:"text-green-500",exceeded:"text-emerald-600"}[d]},ee=()=>{const d=T();return{empty:"bg-gray-200",started:"bg-blue-200",progressing:"bg-yellow-200",near_complete:"bg-orange-200",complete:"bg-green-200",exceeded:"bg-emerald-200"}[d]},ie=800,$e=j(()=>v.value>=ie),D=j(()=>Math.max(ie-v.value,0)),k=j(()=>Math.min(v.value/ie*100,100));return{currentWordCount:v,characterCount:i,characterCountNoSpaces:C,paragraphCount:b,sentenceCount:O,readingTimeMinutes:P,progressPercentage:g,isComplete:F,wordsRemaining:V,wordsToComplete:X,wordCountStats:Z,wordCountProgress:me,meetsDefenseThreshold:$e,defenseWordsRemaining:D,defenseProgressPercentage:k,DEFENSE_THRESHOLD:ie,formatWordCount:_e,formatProgress:we,getProgressDisplay:he,getCompletionDisplay:I,getWordCountStatus:T,getStatusColor:K,getProgressBarColor:ee,countWords:W}}function _n(N,E,q,W){const p=c(!1),x=c(0),v=c(!1),i=T=>{if(!T)return 0;const ee=T.replace(/<[^>]*>/g,"").trim().replace(/\s+/g," ");if(!ee)return 0;const ie=ee.match(/\b\w+\b/g);return ie?ie.length:0},C=j(()=>i(q.value)),b=j(()=>C.value>=800),O=()=>`defense_generation_triggered_${N.id}_ch_${E.chapter_number}`,P=()=>{const T=O();return localStorage.getItem(T)==="true"},g=()=>{const T=O();localStorage.setItem(T,"true"),p.value=!0},F=()=>{const T=O();localStorage.removeItem(T),p.value=!1,console.log(`ðŸ”„ DEFENSE WATCHER: Reset generation trigger for Chapter ${E.chapter_number}`)},V=Xa(async()=>{if(!v.value)return;const T=C.value;console.log(`ðŸ“Š DEFENSE WATCHER: Word count check - Chapter ${E.chapter_number}: ${T} words`),T<800*.8&&p.value&&(console.log("â¬‡ï¸ DEFENSE WATCHER: Content dropped below 80% of threshold, resetting trigger"),F()),x.value=T},2e3),X=()=>v.value?void 0:(v.value=!0,p.value=P(),x.value=C.value,console.log(`ðŸ‘€ DEFENSE WATCHER: Started watching Chapter ${E.chapter_number}`),console.log(`   Initial word count: ${x.value}`),console.log(`   Generation already triggered: ${p.value}`),console.log("   Threshold: 800 words"),Ne(q,(K,ee)=>{K!==ee&&V()},{immediate:!1})),Z=()=>{v.value=!1,V.cancel(),console.log(`ðŸ›‘ DEFENSE WATCHER: Stopped watching Chapter ${E.chapter_number}`)},me=async()=>{console.log(`ðŸ” DEFENSE WATCHER: Force checking Chapter ${E.chapter_number}`),await V(),V.flush()},_e=j(()=>{const T=C.value;return T>0&&T<800&&!p.value}),we=j(()=>{const T=C.value/800*100;return Math.min(T,100)}),he=j(()=>{const T=800-C.value;return Math.max(T,0)});return{isWatching:v,hasTriggeredGeneration:p,currentWordCount:C,lastWordCount:x,meetsThreshold:b,shouldShowProgressIndicator:_e,progressPercentage:we,wordsRemaining:he,startWatching:X,stopWatching:Z,forceCheck:me,resetGenerationTrigger:F,markGenerationTriggered:g,getStatusMessage:()=>{const T=C.value;return p.value?`Defense questions available (${T} words)`:T>=800?`Ready for defense questions (${T} words)`:T>0?`${800-T} more words needed for defense questions`:"Start writing to enable defense questions (800 words needed)"},countWords:i,DEFENSE_WORD_COUNT_THRESHOLD:800}}function Cn(N){const E=c(!1),q=c(null),W=c([]),m=c(null),p=j(()=>{if(!q.value?.quality_level)return"text-muted-foreground";switch(q.value.quality_level){case"Excellent":return"text-green-600";case"Good":return"text-blue-600";case"Satisfactory":return"text-yellow-600";case"Needs Improvement":return"text-orange-600";case"Poor":return"text-red-600";default:return"text-muted-foreground"}}),x=j(()=>q.value?.scores?Object.entries(q.value.scores).sort(([,g],[,F])=>g.percentage-F.percentage).slice(0,3).map(([g,F])=>({category:g.replace(" & "," & "),percentage:Math.round(F.percentage),score:F.score,max:F.max})):[]),v=async()=>{try{E.value=!0,m.value=null,await xe.get("/sanctum/csrf-cookie");const g=await xe.post(J("api.chapters.analysis.analyze",{chapter:N}));if(g.data.success)return q.value=g.data.analysis,g.data.analysis;throw new Error(g.data.error||"Analysis failed")}catch(g){return m.value=g.response?.data?.error||g.message||"Analysis failed",console.error("Chapter analysis failed:",g),null}finally{E.value=!1}};return{isAnalyzing:E,latestAnalysis:q,analysisHistory:W,error:m,qualityLevelColor:p,topImprovementAreas:x,analyzeChapter:v,getLatestAnalysis:async()=>{try{await xe.get("/sanctum/csrf-cookie");const g=await xe.get(J("api.chapters.analysis.latest",{chapter:N}));return g.data.success?(q.value=g.data.analysis,g.data.analysis):(q.value=null,null)}catch(g){return g.response?.status!==404&&(m.value=g.response?.data?.error||g.message||"Failed to get analysis",console.error("Failed to get latest analysis:",g)),null}},getAnalysisHistory:async()=>{try{await xe.get("/sanctum/csrf-cookie");const g=await xe.get(J("api.chapters.analysis.history",{chapter:N}));if(g.data.success)return W.value=g.data.analyses,g.data.analyses;throw new Error(g.data.error||"Failed to get history")}catch(g){return m.value=g.response?.data?.error||g.message||"Failed to get analysis history",console.error("Failed to get analysis history:",g),[]}},autoAnalyze:async(g,F=500)=>{g>=F&&await v()},getScoreColor:(g,F)=>{const V=g/F*100;return V>=80?"text-green-600":V>=70?"text-blue-600":V>=60?"text-yellow-600":V>=40?"text-orange-600":"text-red-600"},getProgressVariant:g=>g>=80?"success":g>=60?"default":"destructive"}}const kn={key:2,class:"flex h-screen flex-col overflow-hidden bg-zinc-50 dark:bg-zinc-950 font-sans selection:bg-primary/20"},Sn={class:"relative z-20 flex flex-shrink-0 items-center justify-between border-b border-border/40 bg-background/60 p-4 backdrop-blur-xl supports-[backdrop-filter]:bg-background/40 transition-all duration-300"},En={class:"flex items-center gap-5"},Tn={class:"flex flex-col"},$n={class:"flex items-center gap-3 text-xs text-muted-foreground"},An={class:"flex items-center gap-1.5"},Rn={class:"flex items-center gap-4"},Pn={class:"flex items-center p-1 rounded-full border border-border/40 bg-background/50 backdrop-blur-sm shadow-sm"},jn={class:"flex items-center gap-2"},qn={class:"relative z-20 h-[2px] w-full bg-border/20"},Dn={key:0,class:"mx-3 my-2"},Mn={class:"relative overflow-hidden rounded-xl border border-blue-200 bg-gradient-to-br from-blue-50 to-purple-50 p-3 shadow-sm dark:border-blue-800 dark:from-blue-950/30 dark:to-purple-950/30"},Fn={class:"relative z-10 mb-2 flex items-center justify-between"},Ln={class:"flex items-center gap-2"},Nn={class:"relative"},Wn={class:"flex h-6 w-6 items-center justify-center rounded-full bg-gradient-to-br from-blue-500 to-purple-600"},On={class:"text-xs text-blue-700 dark:text-blue-300"},In={class:"relative z-10 mb-2"},Gn={class:"mb-1 flex items-center justify-between"},zn={class:"text-xs text-blue-600 dark:text-blue-400"},Hn={class:"relative h-2 overflow-hidden rounded-full bg-blue-100 dark:bg-blue-900/50"},Un={class:"relative z-10 flex items-center gap-2"},Vn={class:"flex-shrink-0"},Bn={key:0,class:"h-2 w-2 animate-bounce rounded-full bg-blue-500"},Qn={key:1,class:"flex gap-0.5"},Kn={key:2,class:"h-2 w-2 animate-spin rounded-full border-2 border-blue-500 border-t-transparent"},Jn={key:3,class:"h-2 w-2 rounded-full bg-green-500"},Xn={key:4,class:"h-2 w-2 rounded-full bg-red-500"},Yn={class:"flex-1 text-xs text-blue-800 dark:text-blue-200"},Zn={class:"relative z-10 flex flex-1 overflow-hidden"},eo={key:0,class:"w-[320px] flex-shrink-0 border-r border-border/50 bg-background/80 backdrop-blur-xl shadow-xl z-20"},to={class:"h-full overflow-y-auto custom-scrollbar"},ro={class:"p-4"},ao={class:"mb-3"},no={class:"text-xs text-muted-foreground"},oo={class:"flex min-h-0 flex-1 flex-col bg-transparent relative"},so={class:"flex-1 overflow-hidden relative"},lo={class:"absolute inset-0 overflow-y-auto custom-scrollbar flex flex-col items-center py-8 px-4 sm:px-8"},io={class:"flex items-center justify-between"},uo={class:"space-y-1"},co={class:"flex items-center gap-2"},po={class:"flex items-center justify-between px-6 py-2 border-b border-border/30 bg-muted/5"},vo={class:"flex items-center gap-2"},go={class:"space-y-1 relative z-10"},ho={class:"text-sm font-medium text-foreground"},fo={class:"text-[10px] text-muted-foreground line-clamp-2 leading-relaxed"},mo={class:"flex-1 relative bg-background"},wo={class:"px-12 py-10 min-h-[500px]"},bo={class:"sticky bottom-0 z-10 border-t border-border/30 bg-background/80 backdrop-blur-md p-4 flex items-center justify-between"},yo={class:"text-xs text-muted-foreground"},xo={class:"flex items-center gap-2"},_o={key:0,class:"w-72 flex-shrink-0 border-l border-border/40 bg-background/40 backdrop-blur-md"},Co={class:"h-full overflow-y-auto custom-scrollbar"},ko={class:"space-y-6 p-4"},So={class:"min-h-screen bg-gradient-to-br from-background via-background to-muted/20"},Eo={class:"w-full px-4 py-6 transition-all duration-300"},To={class:"mb-6 flex items-center justify-between"},$o={class:"flex items-center gap-4"},Ao={class:"text-sm text-muted-foreground"},Ro={class:"flex items-center gap-2"},Po={class:"hidden items-center gap-2 lg:flex"},jo={class:"mb-6"},qo={class:"mb-2 flex items-center justify-between"},Do={class:"text-sm text-muted-foreground"},Mo={key:0,class:"mb-6"},Fo={class:"relative overflow-hidden rounded-xl border border-blue-200 bg-gradient-to-br from-blue-50 to-purple-50 p-4 shadow-sm dark:border-blue-800 dark:from-blue-950/30 dark:to-purple-950/30"},Lo={class:"relative z-10 mb-3 flex items-center justify-between"},No={class:"flex items-center gap-2"},Wo={class:"relative"},Oo={class:"flex h-8 w-8 items-center justify-center rounded-full bg-gradient-to-br from-blue-500 to-purple-600"},Io={class:"text-xs text-blue-700 dark:text-blue-300"},Go={class:"relative z-10 mb-3"},zo={class:"mb-1 flex items-center justify-between"},Ho={class:"text-xs text-blue-600 dark:text-blue-400"},Uo={class:"relative h-2 overflow-hidden rounded-full bg-blue-100 dark:bg-blue-900/50"},Vo={class:"relative z-10 flex items-center gap-2"},Bo={class:"flex-shrink-0"},Qo={key:0,class:"h-3 w-3 animate-bounce rounded-full bg-blue-500"},Ko={key:1,class:"flex gap-1"},Jo={key:2,class:"h-3 w-3 animate-spin rounded-full border-2 border-blue-500 border-t-transparent"},Xo={key:3,class:"h-3 w-3 rounded-full bg-green-500"},Yo={key:4,class:"h-3 w-3 rounded-full bg-red-500"},Zo={class:"flex-1 text-xs text-blue-800 dark:text-blue-200"},es={key:0,class:"relative z-10 mt-3 border-t border-blue-200 pt-3 dark:border-blue-800"},ts={class:"flex items-center justify-between text-xs"},rs={class:"flex items-center gap-1"},as={class:"flex gap-0.5"},ns={class:"ml-1 text-blue-600 dark:text-blue-400"},os={class:"grid grid-cols-1 gap-6 lg:grid-cols-12 transition-all duration-300"},ss={class:"hidden lg:block lg:col-span-2 transition-all duration-300"},ls={class:"h-[calc(100vh-320px)] overflow-y-auto space-y-6 custom-scrollbar pr-1"},is={class:"flex items-center justify-between"},us={class:"flex items-center gap-2"},cs={class:"flex items-center gap-2"},ds={class:"space-y-2"},ps={class:"space-y-2"},vs={class:"flex items-center justify-between"},gs={class:"flex items-center gap-2"},hs={class:"flex flex-col gap-2 pt-4 sm:flex-row"},fs={class:"hidden sm:inline"},ms={class:"sm:hidden"},ws={class:"hidden sm:inline"},bs={class:"sm:hidden"},ys={class:"hidden lg:block lg:col-span-3 transition-all duration-300"},xs={class:"h-[calc(100vh-40px)] overflow-y-auto space-y-4 custom-scrollbar px-1"},_s={key:1,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},Cs={class:"text-slate-600 dark:text-slate-300 mb-4"},ks={class:"font-semibold text-amber-600 dark:text-amber-400"},Ss={class:"flex flex-col sm:flex-row gap-3"},yt=3,lt=3,xt=3e3,Es=1e3,ql=Nr({__name:"ChapterEditor",props:{project:{},chapter:{},allChapters:{},facultyChapters:{},mode:{}},setup(N){const E=Fe(()=>Le(()=>import("./AISidebar-FWppCxCq.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47]))),q=Fe(()=>Le(()=>import("./ChapterNavigation-CkNPfjuZ.js"),__vite__mapDeps([48,49,3,1,2,20,7,8,21,22,14,50,18,13,15,16,33,51,52,53,54,40]))),W=Fe(()=>Le(()=>import("./MobileNavOverlay-cHHg2bqi.js"),__vite__mapDeps([55,1,2,56,3,0,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,49,50,51,52,53,54,57,58,59,60,61,62,63,64,65]))),m=Fe(()=>Le(()=>import("./ChatModeLayout-BER4HSDL.js"),__vite__mapDeps([66,67,1,2,18,3,8,4,11,7,12,20,21,23,24,25,26,27,14,28,29,19,30,31,32,33,34,35,68,69,70,71,59,72,73,9,10,13,15,16,62,36,74,75,56,76,63,40,38,77,78,51,79,80,44,81,60,54,43,42,46,41,52,82,83,84,85]))),p=Fe(()=>Le(()=>import("./CitationVerificationLayout-CiFHfYP3.js"),__vite__mapDeps([86,18,3,1,2,8,4,5,11,7,12,20,21,25,69,23,24,26,27,14,28,29,19,30,31,32,33,34,35,70,71,59,72,73,9,10,13,15,16,62,36,74,75,76,52]))),x=Fe(()=>Le(()=>import("./DefensePreparationPanel-WagV9_AE.js"),__vite__mapDeps([87,57,1,2,56,3,18,8,4,5,6,7,11,12,20,21,9,10,58,59,36,60,61,37,45,62,14,63]))),v=Fe(()=>Le(()=>import("./DataCollectionPanel-7jWWUpq0.js"),__vite__mapDeps([88,64,1,2,13,3,14,8,7,15,16]))),i=N,C=c(i.chapter.title||""),b=c(i.chapter.content||""),O=c(!0),P=c(!1),g=c(!1);c(!1);const F=c(!1);c("write");const V=c("");c(0);const X=c(!1),Z=c(!1),me=c(!0),_e=()=>{try{return localStorage.getItem(`chatMode_${i.project.id}_${i.chapter.chapter_number}`)==="true"}catch(a){return console.warn("Failed to load chat mode from localStorage:",a),!1}},we=a=>{try{localStorage.setItem(`chatMode_${i.project.id}_${i.chapter.chapter_number}`,String(a))}catch(e){console.warn("Failed to save chat mode to localStorage:",e)}},he=c(!1),I=c(!1),T=c(!1),K=c(!1),ee=c(!1),ie=c(!0),$e=c(!0),D=c(!1),k=c(""),d=c(0),y=c(""),H=c(0),S=c(0),$=c(null),L=c(""),We=c(0),St=c(""),Ut=c([]),Ze=c(!1),Ae=c(!1),ge=c(0),Et=c(2e3),Oe=c(!1),ut=c(null);c("progressive");const Ie=c(!1),ct=c(!1),dt=c(0),Tt=c(!1),Re=c(0),Or=async()=>{for(Tt.value=!0,Re.value=0;Re.value<lt;){if(Re.value++,!navigator.onLine){f.warning("No Internet Connection",{description:`Waiting for connection... (${Re.value}/${lt})`,duration:3e3}),await new Promise(o=>setTimeout(o,xt));continue}const e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;if(e){const o=e.effectiveType,s=e.downlink;if(console.log("ðŸ“¶ Connection info:",{effectiveType:o,downlink:s,rtt:e.rtt}),o==="slow-2g"||o==="2g"){f.warning("Slow Connection Detected",{description:`Your connection (${o}) may cause issues. Waiting... (${Re.value}/${lt})`,duration:3e3}),await new Promise(u=>setTimeout(u,xt));continue}}try{const o=performance.now(),s=await fetch(J("api.ping"),{method:"HEAD",cache:"no-cache"}).catch(()=>null),u=performance.now()-o;if(console.log("ðŸ“¡ Server latency:",u.toFixed(0),"ms"),u>2e3){f.warning("High Latency Detected",{description:`Response time is ${Math.round(u)}ms. Waiting for better connection... (${Re.value}/${lt})`,duration:3e3}),await new Promise(h=>setTimeout(h,xt));continue}return u>1e3&&f.info("Connection is slow but usable",{description:`Response time: ${Math.round(u)}ms. Content will be auto-saved during generation.`,duration:3e3}),Tt.value=!1,!0}catch(o){console.warn("Connection check failed:",o),f.warning("Connection Check Failed",{description:`Retrying... (${Re.value}/${lt})`,duration:3e3}),await new Promise(s=>setTimeout(s,xt));continue}}return Tt.value=!1,confirm(`Your connection appears unstable. Content will be auto-saved during generation to prevent data loss.

Do you want to proceed anyway?`)},{balance:Ir,showPurchaseModal:Vt,requiredWordsForModal:Gr,actionDescriptionForModal:zr,checkAndPrompt:Hr,closePurchaseModal:Ur,estimates:Se}=Da(),Ge=(a,e)=>Hr(Math.max(1,Math.round(a)),e),et=c(!1),ze=c(""),He=c(""),Vr=c(0),Pe=c(null),Br=c(0),Qr=c(null),Kr=c([]),Jr=c([]),Xr=c(null);c(null),c(null);const Yr=c(),Bt=c(),Zr=c(),Qt=c();c(null),c(null);const re=c(!1),{hasUnsavedChanges:ea,isSaving:Ee,triggerAutoSave:je,save:Ce,clearAutoSave:ta}=bn({delay:1e4,onSave:Yt});let Kt=0;const ra=()=>{const a=Date.now();a-Kt>Es&&(Kt=a,f.success("Saved",{duration:2e3}))},{contentHistory:aa,historyIndex:na,addToHistory:oa,undo:sa,redo:la}=Na(i.chapter.content||""),{writingStats:$t,writingQualityScore:ke,calculateWritingStats:pt}=yn(b),{isAnalyzing:Jt,latestAnalysis:Y,getLatestAnalysis:ia}=Cn(i.chapter.id),ue=j(()=>{if(i.facultyChapters&&i.facultyChapters.length>0){const e=i.facultyChapters.find(o=>o.number===i.chapter.chapter_number);if(e?.word_count)return e.word_count}if(i.project?.outlines&&i.project.outlines.length>0){const e=i.project.outlines.find(o=>o.chapter_number===i.chapter.chapter_number);if(e?.target_word_count)return e.target_word_count}const a=i.project.type==="undergraduate"?2500:3500;return i.chapter.chapter_number===1||i.chapter.chapter_number===5?Math.round(a*.8):a}),{currentWordCount:te,progressPercentage:ua,meetsDefenseThreshold:ca,defenseWordsRemaining:da,defenseProgressPercentage:pa,DEFENSE_THRESHOLD:vt,countWords:Xt}=xn(b,ue),tt=ua,At=j(()=>{const a=C.value?.trim(),e=b.value?.trim();return a&&a.length>0&&e&&e.length>50}),be=j(()=>i.project),ye=j(()=>i.chapter),qe=j(()=>i.allChapters);async function Yt(a=!1){try{const e=await fetch(J("chapters.save",{project:i.project.id}),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({project_id:i.project.id,chapter_number:i.chapter.chapter_number,title:C.value,content:b.value,auto_save:a,statistics:$t.value,quality_score:ke.value})});console.log("Response status:",e.status,e.statusText),console.log("Response headers:",e.headers);const o=await e.text();console.log("Raw response:",o);let s;try{s=JSON.parse(o)}catch(u){throw console.error("JSON parse error:",u),console.error("Response was:",o),new Error(`Server returned non-JSON response: ${e.status} ${e.statusText}`)}e.ok}catch(e){throw a||f.error("âŒ Save Failed",{description:"Please try again or check your connection."}),e}}const Zt=()=>{const a=sa();a!==null&&(b.value=a,je())},er=()=>{const a=la();a!==null&&(b.value=a,je())},rt=a=>{ea.value&&confirm("You have unsaved changes. Save before switching chapters?")&&Ce();const e=i.allChapters.find(u=>u.chapter_number===a),s=e?.content&&e.content.trim()!==""?"chapters.edit":"chapters.write";Qe.visit(J(s,{project:i.project.slug,chapter:a}),{only:["chapter","mode","allChapters"],preserveState:!0,preserveScroll:!1})},Rt=async()=>{const a=Se.chapter(ue.value||0);if(!Ge(a,"generate the next chapter with AI"))return;await Ce();const e=i.allChapters.map(u=>u.chapter_number).sort((u,h)=>u-h),o=e.indexOf(i.chapter.chapter_number);let s;if(o===-1||o===e.length-1)s=Math.max(...e)+1;else{const u=e[o+1];u===i.chapter.chapter_number+1?s=u:s=i.chapter.chapter_number+1}console.log("ðŸ“ Generating next chapter:",{currentChapter:i.chapter.chapter_number,existingChapters:e,nextChapterNumber:s});try{const u=J("chapters.write",{project:i.project.slug,chapter:s});console.log("ðŸ”— Generated URL for next chapter:",u);const h=new URL(u,window.location.origin);h.searchParams.set("ai_generate","true"),h.searchParams.set("generation_type","progressive"),console.log("ðŸš€ Navigating to:",h.toString()),Qe.visit(h.toString())}catch(u){console.error("âŒ Error generating next chapter:",u),f.error("Navigation Error",{description:"Failed to navigate to next chapter. Please try again."})}},Pt=(a,e)=>{a==="section"&&e?.section?va(e.section):a==="rephrase"&&e?.selectedText?ga(e.selectedText,e.style||"Academic Formal"):a==="expand"&&e?.selectedText?ha(e.selectedText):jt(a)},va=async a=>{D.value=!0,L.value="",S.value=0,d.value=5,y.value="Papers",k.value="Checking for verified sources...",H.value=600,St.value=b.value||i.chapter.content||"",re.value=!0;try{d.value=50,y.value="Papers",k.value="Using existing verified sources...",await new Promise(o=>setTimeout(o,500)),y.value="Section",k.value=`Generating ${a} section with verified sources...`,d.value=51;const e=J("chapters.stream",{project:i.project.slug,chapter:i.chapter.chapter_number});$.value=new EventSource(`${e}?generation_type=section&section_type=${a}`),$.value.onmessage=o=>{const s=JSON.parse(o.data);switch(s.type){case"start":y.value="Generating Section",d.value=52,k.value=`Starting ${a} section generation...`;break;case"content":L.value+=s.content,S.value=s.word_count||Xt(L.value);const u=Date.now();if(u-We.value>150){const R=L.value;b.value=St.value+`

`+R,We.value=u;const A=Math.min(S.value/H.value*43,43);d.value=Math.max(52,52+A),k.value=`Generating ${a} section... (${S.value} / ${H.value} words)`,pt(),Mt()}break;case"complete":d.value=100,y.value="Complete",k.value=`âœ“ Generated ${a} section (${S.value} words)`;const h=L.value;b.value=St.value+`

`+h,Ce(!0),f.success("âœ… Section Generated Successfully",{description:`Added ${a} section with ${S.value} words and verified citations.`,duration:5e3}),D.value=!1,$.value?.close();break;case"error":throw new Error(s.message||"Section generation failed");case"heartbeat":d.value<95&&(d.value+=.5);break}},$.value.onerror=()=>{D.value=!1,y.value="Error",k.value="âŒ Section generation failed",f.error("âŒ Generation Failed",{description:"Unable to generate section. Please check your connection and try again."}),$.value?.close()}}catch(e){console.error("Section generation failed:",e),D.value=!1,y.value="Error",k.value="âŒ Section generation error",f.error("âŒ Generation Failed",{description:"Section generation encountered an error."})}},ga=async(a,e)=>{const o=a.split(/\s+/).length,s=Math.max(o,Se.rephrase());if(!Ge(s,`rephrase about ${o} words`))return;console.log("ðŸš€ ChapterEditor - Starting rephrase generation:",{selectedTextLength:a.length,selectedTextPreview:a.substring(0,100)+(a.length>100?"...":""),style:e,timestamp:new Date().toISOString()}),D.value=!0,L.value="",S.value=0,d.value=10,y.value="Rephrasing",k.value="Preparing to rephrase selected text...",H.value=Math.max(o,50);const u=at.value||gt.value,h=u?.getSelectionRange();console.log("ðŸ“ ChapterEditor - Editor and selection info:",{hasActiveEditor:!!u,selectionRange:h,selectedWordCount:o,estimatedWords:H.value});const R={originalText:a,range:h,wordCount:o,style:e,startTime:Date.now()};console.log("ðŸ’¾ ChapterEditor - Stored rephrase context:",R),re.value=!0;try{d.value=20,k.value=`Rephrasing ${o} words in ${e} style...`;const ae=`${J("chapters.stream",{project:i.project.slug,chapter:i.chapter.chapter_number})}?generation_type=rephrase&selected_text=${encodeURIComponent(a)}&style=${encodeURIComponent(e)}`;console.log("ðŸŒ ChapterEditor - Creating EventSource:",{url:ae,encodedTextLength:encodeURIComponent(a).length}),$.value=new EventSource(ae),$.value.onmessage=B=>{const U=JSON.parse(B.data);switch(console.log("ðŸ“¨ ChapterEditor - EventSource message received:",{type:U.type,hasContent:!!U.content,contentLength:U.content?.length||0,wordCount:U.word_count}),U.type){case"start":console.log("â–¶ï¸ ChapterEditor - Rephrase generation started"),y.value="Rephrasing Text",d.value=30,k.value=`Rephrasing text in ${e} style...`;break;case"content":L.value+=U.content,S.value=U.word_count||Xt(L.value),console.log("ðŸ“ ChapterEditor - Content chunk received:",{chunkLength:U.content?.length||0,totalBufferLength:L.value.length,totalWords:S.value});const de=Math.min(S.value/H.value*60,60);d.value=Math.max(30,30+de),k.value=`Rephrasing... (${S.value} words)`;break;case"complete":if(console.log("ðŸ ChapterEditor - Rephrase generation complete"),d.value=100,y.value="Complete",k.value=`âœ“ Text rephrased successfully (${S.value} words)`,console.log("ðŸ”„ ChapterEditor - Starting text replacement:",{hasRange:!!R.range,hasContent:!!L.value.trim(),range:R.range,newContentLength:L.value.trim().length,newContentPreview:L.value.trim().substring(0,100)+"..."}),R.range&&L.value.trim()){console.log("ðŸŽ¯ ChapterEditor - Attempting text replacement with activeEditor:",{editorType:u===at.value?"fullscreen":"normal",hasActiveEditor:!!u});const fe=u?.replaceSelection(L.value.trim(),R.range);console.log("ðŸ“Š ChapterEditor - Text replacement result:",{success:fe}),fe?(console.log("âœ… ChapterEditor - Text replacement successful, updating chapter content"),setTimeout(()=>{const Me=u?.getHTML()||b.value;console.log("ðŸ“„ ChapterEditor - Updated chapter content length:",Me.length),b.value=Me},100)):(console.warn("âŒ ChapterEditor - Failed to replace selected text, falling back to manual update"),f.warning("Please manually replace the selected text",{description:"The rephrased text is ready but couldn't be automatically replaced."}))}else console.error("âŒ ChapterEditor - Cannot replace text:",{missingRange:!R.range,missingContent:!L.value.trim()});Ce(!0),f.success("âœ… Text Rephrased Successfully",{description:`Rephrased ${o} words in ${e} style.`,duration:5e3}),Xe(S.value||o,`Rephrase (${e})`,"chapter",i.chapter.id).catch(fe=>console.error("Failed to record word usage (rephrase):",fe)),D.value=!1,$.value?.close();break;case"error":throw new Error(U.message||"Text rephrasing failed");case"heartbeat":d.value<95&&(d.value+=.5);break}},$.value.onerror=()=>{D.value=!1,y.value="Error",k.value="âŒ Text rephrasing failed",f.error("âŒ Rephrasing Failed",{description:"Unable to rephrase text. Please check your connection and try again."}),$.value?.close()}}catch(A){console.error("Text rephrasing failed:",A),D.value=!1,y.value="Error",k.value="âŒ Rephrasing error",f.error("âŒ Rephrasing Failed",{description:"Text rephrasing encountered an error."})}},ha=async a=>{const e=a.split(/\s+/).length,o=Math.max(e*2,Se.expand());if(!Ge(o,`expand about ${e} words`))return;console.log("ðŸ“ˆ ChapterEditor - Starting expand generation:",{selectedTextLength:a.length,selectedTextPreview:a.substring(0,100)+(a.length>100?"...":""),timestamp:new Date().toISOString()}),D.value=!0,L.value="",S.value=0,d.value=10,y.value="Expanding",k.value="Preparing to expand selected text...",H.value=Math.max(e*2,100);const s=at.value||gt.value,u=s?.getSelectionRange();console.log("ðŸ“ ChapterEditor - Editor and selection info for expand:",{hasActiveEditor:!!s,selectionRange:u,selectedWordCount:e,estimatedWords:H.value});const h={originalText:a,range:u,wordCount:e,startTime:Date.now()};console.log("ðŸ’¾ ChapterEditor - Stored expand context:",h);try{const A=`${J("chapters.stream",{project:i.project.slug,chapter:i.chapter.chapter_number})}?generation_type=expand&selected_text=${encodeURIComponent(a)}`;console.log("ðŸŒ ChapterEditor - Creating EventSource for expand:",{url:A,encodedTextLength:encodeURIComponent(a).length}),$.value=new EventSource(A),$.value.onmessage=ae=>{const B=JSON.parse(ae.data);switch(console.log("ðŸ“¨ ChapterEditor - EventSource message received:",{type:B.type,hasContent:!!B.content,contentLength:B.content?.length||0,wordCount:B.word_count}),B.type){case"start":console.log("â–¶ï¸ ChapterEditor - Expand generation started"),y.value="Expanding Text",d.value=20,k.value="Starting text expansion...";break;case"content":L.value+=B.content,S.value=B.word_count||L.value.split(/\s+/).filter(de=>de.length>0).length;const U=Math.min(S.value/H.value*90,90);d.value=Math.max(U,25),k.value=`Expanding text... ${S.value}/${H.value} words`,console.log("ðŸ“ ChapterEditor - Expand content received:",{chunkLength:B.content?.length||0,totalWords:S.value,progress:d.value});break;case"complete":if(console.log("âœ… ChapterEditor - Expand generation complete"),y.value="Complete",k.value="âœ… Text expansion completed",d.value=100,h.range&&L.value.trim()){console.log("ðŸŽ¯ ChapterEditor - Attempting text replacement for expand");const de=s?.replaceSelection(L.value.trim(),h.range);console.log("ðŸ“Š ChapterEditor - Expand text replacement result:",{success:de}),de?(console.log("âœ… ChapterEditor - Expand text replacement successful"),setTimeout(()=>{const fe=s?.getHTML()||b.value;console.log("ðŸ“„ ChapterEditor - Updated chapter content length after expand:",fe.length),b.value=fe},100)):(console.warn("âŒ ChapterEditor - Failed to replace expanded text"),f.warning("Please manually replace the selected text",{description:"The expanded text is ready but couldn't be automatically replaced."}))}else console.error("âŒ ChapterEditor - Cannot replace expanded text:",{missingRange:!h.range,missingContent:!L.value.trim()});Ce(!0),f.success("âœ… Text Expanded Successfully",{description:`Expanded ${h.wordCount} words into ${S.value} words`}),Xe(S.value||h.wordCount*2,"Expand text","chapter",i.chapter.id).catch(de=>console.error("Failed to record word usage (expand):",de)),D.value=!1,$.value?.close();break;case"error":console.error("âŒ ChapterEditor - Expand generation error:",B.message),D.value=!1,y.value="Error",k.value="âŒ Text expansion failed",f.error("âŒ Expansion Failed",{description:B.message||"Text expansion encountered an error."}),$.value?.close();break}},$.value.onerror=()=>{console.error("âŒ ChapterEditor - Expand stream error occurred"),D.value=!1,y.value="Error",k.value="âŒ Text expansion failed",f.error("âŒ Expansion Failed",{description:"Unable to expand text. Please check your connection and try again."}),$.value?.close()}}catch(R){console.error("Text expansion failed:",R),D.value=!1,y.value="Error",k.value="âŒ Expansion error",f.error("âŒ Expansion Failed",{description:"Text expansion encountered an error."})}},fa=async()=>{et.value=!0,He.value="Starting",ze.value="Initializing source collection...",d.value=5;try{const a=document.querySelector('meta[name="csrf-token"]')?.content;if(!a)throw new Error("CSRF token not found - please refresh the page");const e=await fetch(J("api.projects.paper-collection.start",{project:i.project.slug}),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":a,"X-Requested-With":"XMLHttpRequest"},credentials:"include"});if(!e.ok){const o=await e.text();if(console.error("API Error:",e.status,o),e.status===409)try{const s=JSON.parse(o);throw new Error(s.message||"Source collection is already in progress")}catch{throw new Error("Source collection is already in progress for this project")}throw new Error(`Failed to start source collection: ${e.status}`)}return await ma()}catch(a){return console.error("Paper collection failed:",a),He.value="Error",ze.value="âŒ Source collection failed",et.value=!1,!1}},ma=async()=>new Promise(a=>{let e=0;const o=120,s=async()=>{try{const h=await(await fetch(J("api.projects.paper-collection.status",{project:i.project.slug}))).json();if(h.success&&h.data){Xr.value=h.data;const R=h.data.status,A=h.data.papers_count||h.data.count||0,ae=h.data.message,B=h.data.percentage||0,U=h.data.current_source,de=h.data.sources_completed||[],fe=h.data.papers_preview||[];if(Vr.value=A,Br.value=B,Qr.value=U,Kr.value=de,Jr.value=fe,R==="completed"){He.value="Complete",ze.value=`âœ“ Collected ${A} verified sources from ${de.length} databases`,d.value=50,et.value=!1,Pe.value&&clearInterval(Pe.value),a(!0);return}else if(R==="collecting_papers"||R==="initializing"||R==="processing"||R==="storing"){let Me="";U&&(Me={semantic_scholar:"Semantic Scholar",openalex:"OpenAlex",crossref:"CrossRef",pubmed:"PubMed"}[U]||U),He.value=Me||"Collecting Sources",ze.value=ae||"Collecting sources from academic databases...",d.value=Math.min(5+B*.4,45)}else if(R==="collection_failed"){He.value="Error",ze.value=ae||"âŒ Source collection failed",et.value=!1,Pe.value&&clearInterval(Pe.value),a(!1);return}}e++,e>=o&&(He.value="Timeout",ze.value="â±ï¸ Source collection timed out",et.value=!1,Pe.value&&clearInterval(Pe.value),a(!1))}catch(u){console.error("Error checking paper collection status:",u),e++}};s(),Pe.value=setInterval(s,5e3)}),jt=async a=>{const e=Se.chapter(ue.value||0);if(!Ge(e,"generate this chapter with AI")||!await Or())return;if(D.value=!0,L.value="",S.value=0,d.value=5,y.value="Papers",k.value="Checking for verified sources...",H.value=ue.value,re.value=!0,!await fa()){f.error("Paper Collection Failed",{description:"Unable to collect verified papers. Please try again."}),D.value=!1,re.value=!1;return}y.value="Initializing",k.value="Starting AI generation with verified sources...",d.value=51;const u=setInterval(()=>{d.value<52&&D.value?d.value+=.2:clearInterval(u)},100),h=J("chapters.stream",{project:i.project.slug,chapter:i.chapter.chapter_number});$.value=new EventSource(`${h}?generation_type=${a}`),$.value.onmessage=R=>{const A=JSON.parse(R.data);switch(A.type){case"start":y.value="Connecting",d.value=52,k.value="Connecting to AI service...";break;case"content":y.value="Generating",L.value+=A.content,S.value=A.word_count||L.value.split(/\s+/).filter(U=>U.length>0).length;const ae=Date.now();if(ae-We.value>150){b.value=L.value,We.value=ae;const U=Math.min(S.value/H.value*43,43);d.value=Math.max(52,52+U),k.value=`Generating chapter content... (${S.value} / ${H.value} words)`,pt(),Mt()}break;case"heartbeat":d.value<95&&(d.value+=.5);break;case"complete":y.value="Complete",d.value=100,D.value=!1,b.value=L.value;const B=A.final_word_count||S.value;k.value=`âœ“ Generated ${B} words successfully`,Xe(B,`Chapter generation (${i.chapter.chapter_number})`,"chapter",i.chapter.id).catch(U=>console.error("Failed to record word usage (chapter generation):",U)),setTimeout(()=>{je()},500),$.value?.close(),$.value=null;break;case"error":y.value="Error",d.value=50,A.partial_saved&&(ct.value=!0,dt.value=A.saved_word_count||0),A.code==="OFFLINE_MODE"?(k.value="ðŸ“¡ AI services offline",D.value=!1,f.error("AI Services Offline",{description:"Please check your internet connection and try again."})):A.can_resume?(k.value=`âš ï¸ Generation interrupted (${A.saved_word_count} words saved)`,D.value=!1,Ie.value=!0,f.warning("Generation Interrupted",{description:`${A.saved_word_count} words were saved. You can resume generation.`,duration:8e3})):(k.value="âŒ Generation failed",D.value=!1,f.error("Generation Error",{description:A.message||"Please try again."})),$.value?.close(),$.value=null;break;case"autosave":A.word_count&&(console.log(`ðŸ’¾ Auto-saved: ${A.word_count} words`),A.generation_id&&(ut.value=A.generation_id));break}},$.value.onerror=()=>{if(ge.value<yt){ge.value++,Oe.value=!0,y.value="Reconnecting",k.value=`ðŸ”„ Connection lost. Reconnecting... (${ge.value}/${yt})`,$.value?.close(),$.value=null;const R=Et.value*Math.pow(2,ge.value-1);console.log(`ðŸ”Œ Attempting reconnection in ${R}ms (attempt ${ge.value})`),setTimeout(()=>{tr(a)},R)}else y.value="Error",d.value=50,D.value=!1,Oe.value=!1,k.value="âŒ Connection failed after multiple attempts",S.value>100?(ct.value=!0,dt.value=S.value,Ie.value=!0,f.warning("Connection Lost",{description:`${S.value} words may have been saved. Check and resume if needed.`,duration:8e3})):f.error("Connection Error",{description:"Please check your internet connection and try again."}),$.value?.close(),$.value=null,ge.value=0,Et.value=2e3}},tr=a=>{const e=J("chapters.stream",{project:i.project.slug,chapter:i.chapter.chapter_number}),o=new URLSearchParams({generation_type:a,resume_from:S.value.toString()});ut.value&&o.set("generation_id",ut.value),console.log(`ðŸ”Œ Reconnecting to stream from ${S.value} words...`),$.value=new EventSource(`${e}?${o}`),$.value.onmessage=s=>{const u=JSON.parse(s.data);switch((u.type==="content"||u.type==="start")&&(Oe.value=!1,ge.value=0,y.value="Generating"),u.type){case"start":k.value="âœ… Reconnected! Continuing generation...",f.success("Reconnected",{description:"Generation resumed successfully.",duration:3e3});break;case"content":y.value="Generating",L.value+=u.content,S.value=u.word_count||L.value.split(/\s+/).filter(A=>A.length>0).length;const h=Date.now();if(h-We.value>150){b.value=L.value,We.value=h;const A=Math.min(S.value/H.value*43,43);d.value=Math.max(52,52+A),k.value=`Generating chapter content... (${S.value} / ${H.value} words)`,Mt()}break;case"complete":y.value="Complete",d.value=100,D.value=!1,Oe.value=!1,b.value=L.value;const R=u.final_word_count||S.value;k.value=`âœ“ Generated ${R} words successfully`,Xe(R,`Chapter generation (${i.chapter.chapter_number})`,"chapter",i.chapter.id).catch(A=>console.error("Failed to record word usage:",A)),setTimeout(()=>{je()},500),$.value?.close(),$.value=null;break;case"error":y.value="Error",D.value=!1,Oe.value=!1,k.value="âŒ Generation failed",f.error("Generation Error",{description:u.message||"Please try again."}),$.value?.close(),$.value=null;break;case"autosave":u.generation_id&&(ut.value=u.generation_id);break}},$.value.onerror=()=>{if(ge.value<yt){ge.value++;const s=Et.value*Math.pow(2,ge.value-1);k.value=`ðŸ”„ Reconnecting... (${ge.value}/${yt})`,$.value?.close(),setTimeout(()=>{tr(a)},s)}else y.value="Error",D.value=!1,Oe.value=!1,k.value="âŒ Connection failed",S.value>100?(Ie.value=!0,f.warning("Connection Lost",{description:`${S.value} words may be saved. Refresh to recover.`})):f.error("Connection Error",{description:"Please check your connection and try again."}),$.value?.close(),$.value=null,ge.value=0}},wa=()=>{Ie.value=!1,ct.value=!1,window.location.reload()},ba=()=>{Ie.value=!1,ct.value=!1,dt.value=0},qt=async()=>{if(!V.value)return;const a=Se.suggestion();if(Ge(a,"get AI suggestions")){Ze.value=!0;try{const o=await(await fetch(J("chapters.suggestions",{project:i.project.slug,chapter:i.chapter.chapter_number}),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({selected_text:V.value,context:b.value})})).json();Ut.value=o.suggestions||[],Ut.value.length&&Xe(Se.suggestion(),"AI suggestions","chapter",i.chapter.id).catch(s=>console.error("Failed to record word usage (suggestions):",s))}catch{f.error("Error getting suggestions",{description:"Please try again."})}finally{Ze.value=!1}}},Dt=()=>{Ae.value=!0,f.success("Citation Manager opened!",{description:"Review and verify your citations in the panel below."})},rr=a=>{try{const e=at.value?.editor||gt.value?.editor;if(!e){f.error("Editor not found");return}const{from:o}=e.state.selection;e.chain().focus().insertContentAt(o,` ${a} `).run(),f.success("Citation inserted successfully")}catch(e){console.error("Failed to insert citation:",e),f.error("Failed to insert citation")}},gt=c(null),at=c(null),ya=async()=>{try{const a=document.documentElement;a.requestFullscreen?await a.requestFullscreen():a.webkitRequestFullscreen?await a.webkitRequestFullscreen():a.msRequestFullscreen&&await a.msRequestFullscreen()}catch(a){console.error("Error entering fullscreen:",a),f.error("Fullscreen Error",{description:"Unable to enter fullscreen mode"})}},xa=async()=>{try{document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.msExitFullscreen&&await document.msExitFullscreen()}catch(a){console.error("Error exiting fullscreen:",a),f.error("Fullscreen Error",{description:"Unable to exit fullscreen mode"})}},ar=async()=>{g.value?await xa():await ya()},Ue=()=>{const a=document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement;g.value=!!a},nr=()=>{P.value=!P.value,document.documentElement.classList.toggle("dark",P.value),localStorage.setItem("darkMode",P.value.toString())},_a=()=>{X.value=!X.value,X.value&&(Z.value=!1),we(X.value)},Ca=()=>{X.value=!1,we(!1)},ka=()=>{Z.value=!Z.value,Z.value&&(X.value=!1,we(!1))},Sa=()=>{Z.value=!1},or=()=>{re.value=!re.value},sr=()=>{Qe.visit(J("projects.analysis",{project:i.project.slug}))},lr=async()=>{try{await Ce(!1),Qe.post(J("chapters.mark-complete",{project:i.project.slug,chapter:i.chapter.chapter_number}),{},{onSuccess:()=>{f.success("Chapter marked as complete")},onError:a=>{console.error("Mark complete failed:",a),f.error("Failed to mark chapter as complete")}})}catch(a){console.error("Error marking chapter complete:",a),f.error("Failed to save chapter before marking complete")}},ir=()=>{oa(b.value),je(),pt()},ur=a=>{(a.ctrlKey||a.metaKey)&&a.key==="s"&&(a.preventDefault(),Ce(),ra()),(a.ctrlKey||a.metaKey)&&!a.shiftKey&&a.key==="z"&&(a.preventDefault(),Zt()),(a.ctrlKey||a.metaKey)&&a.shiftKey&&a.key==="z"&&(a.preventDefault(),er()),a.key==="F11"&&(a.preventDefault(),ar())};ft(()=>{const a=()=>{T.value=window.innerWidth<1024};a(),window.addEventListener("resize",a);const e=localStorage.getItem("darkMode")==="true";P.value=e,document.documentElement.classList.toggle("dark",e),X.value=_e(),document.addEventListener("keydown",cr),document.addEventListener("keydown",ur),document.addEventListener("fullscreenchange",Ue),document.addEventListener("webkitfullscreenchange",Ue),document.addEventListener("msfullscreenchange",Ue),pt(),Ea()});const Mt=()=>{mt(()=>{if(D.value){const a=re.value?g.value?Qt.value:Zr.value:g.value?Bt.value:Yr.value;if(a)try{const e=a;if(!e)return;const o=e.$el||e;if(!o)return;let s=o.querySelector("[data-radix-scroll-area-viewport]");if(s||(s=o.querySelector("[data-viewport]")),s||(s=o.querySelector('[role="region"]')),s||(s=o.querySelector('div[style*="overflow"]')),s||(s=o.querySelector("[data-scrollable]")),!s){const u=o.querySelectorAll("div");for(const h of u){const R=window.getComputedStyle(h);if(R.overflow==="auto"||R.overflow==="scroll"||R.overflowY==="auto"||R.overflowY==="scroll"||h.scrollHeight>h.clientHeight){s=h;break}}}if(!s){const u=o.querySelector('.ProseMirror, [contenteditable="true"]');u&&(s=u.closest('div[style*="overflow"]')||u.closest("[data-radix-scroll-area-viewport]")||u.parentElement)}if(s){const u=s.scrollHeight-s.clientHeight;s.scrollTop=u,requestAnimationFrame(()=>{s.scrollTop=s.scrollHeight,s.scrollTo&&s.scrollTo({top:s.scrollHeight,behavior:"instant"})})}else console.warn("Could not find scrollable viewport in ScrollArea",{scrollAreaEl:o,children:o.children,mode:re.value?"preview":"editor",fullscreen:g.value})}catch(e){console.warn("Auto-scroll failed:",e)}else{const e=document.querySelector(".ProseMirror");e&&e.scrollIntoView({behavior:"instant",block:"end"})}}})},Ea=()=>{const a=new URLSearchParams(window.location.search),e=a.get("ai_generate")==="true",o=a.get("generation_type");e&&o&&setTimeout(()=>{if(o==="progressive"){jt("progressive");const s=new URL(window.location.href);s.searchParams.delete("ai_generate"),s.searchParams.delete("generation_type"),window.history.replaceState({},"",s.toString()),f.success("ðŸš€ AI Generation Started",{description:`Generating ${i.chapter.title} with AI assistance...`})}else if(o==="single"){jt("progressive");const s=new URL(window.location.href);s.searchParams.delete("ai_generate"),s.searchParams.delete("generation_type"),window.history.replaceState({},"",s.toString()),f.success("ðŸš€ AI Generation Started",{description:`Generating ${i.chapter.title} with AI assistance...`})}},1e3)},cr=a=>{if((a.ctrlKey||a.metaKey)&&!["INPUT","TEXTAREA","SELECT"].includes(a.target?.tagName))switch(a.key){case"ArrowLeft":a.preventDefault();const e=i.chapter.chapter_number-1;i.allChapters.find(h=>h.chapter_number===e)&&rt(e);break;case"ArrowRight":a.preventDefault();const s=i.chapter.chapter_number+1;i.allChapters.find(h=>h.chapter_number===s)&&rt(s);break}};ft(()=>{const a=e=>{const o=s=>{const{scrollTop:u,scrollHeight:h,clientHeight:R}=e,A=s.deltaY,ae=u<=0,B=u+R>=h;A<0&&ae||A>0&&B||s.stopPropagation()};return e.addEventListener("wheel",o,{passive:!0}),()=>e.removeEventListener("wheel",o)};mt(()=>{const e=document.querySelectorAll('[class*="overflow-y-auto"]'),o=[];e.forEach(s=>{if(s instanceof HTMLElement){const u=a(s);o.push(u)}}),window.__scrollChainCleanup=o})}),qa(()=>{ta(),$.value&&$.value.close(),document.removeEventListener("keydown",ur),document.removeEventListener("keydown",cr);const a=window.__scrollChainCleanup;a&&Array.isArray(a)&&(a.forEach(e=>e()),delete window.__scrollChainCleanup),document.removeEventListener("fullscreenchange",Ue),document.removeEventListener("webkitfullscreenchange",Ue),document.removeEventListener("msfullscreenchange",Ue)}),Ne(()=>i.chapter,async a=>{C.value=a.title||"",b.value=a.content||"",ce.value=[],Aa(),hr(),De.value=pr(),await ot(!1,{skipGeneration:!0}),await mt(()=>{fr(),ht()})},{immediate:!1});const ce=c([]),Ve=c(!1),Be=c(!1),nt=c(null),De=c(!1),dr=(a,e)=>`defense_auto_generate_${a}_ch_${e}`,pr=()=>{try{return localStorage.getItem(dr(i.project.id,i.chapter.chapter_number))==="true"}catch(a){return console.warn("Failed to load defense auto-generation preference:",a),!1}},Ta=a=>{try{localStorage.setItem(dr(i.project.id,i.chapter.chapter_number),String(a))}catch(e){console.warn("Failed to save defense auto-generation preference:",e)}};De.value=pr(),Ne(b,ir),Ne(C,je);const le=j(()=>i.chapter),vr=async a=>{me.value=a,a&&$a()&&await ot(!1,{skipGeneration:!0})},$a=()=>{if(!ce.value.length||!nt.value)return!0;const a=new Date(Date.now()-360*60*1e3);return nt.value<a},ot=async(a=!1,e={})=>{if(Ve.value)return;const o=e.skipGeneration??!0;Ve.value=!0;try{console.log("Loading defense questions with params:",{project_id:i.project.id,chapter_number:le.value?.chapter_number,limit:5,force_refresh:a,skip_generation:o});const s=await xe.get(`/api/projects/${i.project.id}/defense/questions`,{params:{chapter_number:le.value?.chapter_number||null,limit:5,force_refresh:a?1:0,skip_generation:o?1:0},headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(console.log("Defense questions loaded:",s.data),console.log("Questions array:",s.data.questions),console.log("Questions count:",s.data.questions?s.data.questions.length:0),ce.value=s.data.questions||[],nt.value=new Date,s.data.questions&&s.data.questions.length>0){const u=`defense_questions_${i.project.id}_chapter_${le.value?.chapter_number}`;localStorage.setItem(u,JSON.stringify({questions:s.data.questions,chapter_number:le.value?.chapter_number,loaded_at:new Date().toISOString()}))}else a||(console.log("No existing questions found for this chapter"),console.log(`Current word count: ${te.value}/${vt}`),console.log('User must click "Generate Questions" button to create defense questions'))}catch(s){if(console.error("Failed to load defense questions:",s),s.response)if(console.error("Response status:",s.response.status),console.error("Response data:",s.response.data),s.response.status===422){console.error("Validation errors:",s.response.data.errors);const u=Object.values(s.response.data.errors||{})[0];u&&Array.isArray(u)?f.error(`Validation Error: ${u[0]}`):f.error("Invalid request parameters. Please refresh the page.")}else s.response.status===500?f.error("Server error. Please try again later."):f.error("Failed to load defense questions");else s.request?(console.error("No response received:",s.request),f.error("Network error. Please check your connection.")):(console.error("Error setting up request:",s.message),f.error("An unexpected error occurred"));ce.value=[]}finally{Ve.value=!1}},ht=async()=>{!De.value||Be.value||Ve.value||st.value||!Lt.value||ce.value.length>0||await Ft({autoTriggered:!0})},gr=a=>{De.value=a,Ta(a),a&&ht()};Ne(b,ir),Ne(C,je),Ne([te,De],()=>{ht()});const Ft=async(a={})=>{if(Be.value)return;const e=a.autoTriggered??!1,o=Se.defense();if(Ge(o,"generate defense questions")){Be.value=!0;try{const s=h=>h?h.replace(/<[^>]*>/g," ").trim().split(/\s+/).filter(R=>R.length>0).length:0,u=await xe.post(`/api/projects/${i.project.id}/defense/questions/generate`,{chapter_number:le.value.chapter_number},{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),Accept:"application/json","Content-Type":"application/json"}});if(u.data&&u.data.questions){ce.value=u.data.questions,nt.value=new Date;const h=u.data.questions.reduce((A,ae)=>{const B=s(ae.question),U=s(ae.suggested_answer),de=(ae.key_points||[]).reduce((fe,Me)=>fe+s(Me),0);return A+B+U+de},0),R=`defense_questions_${i.project.id}_chapter_${le.value?.chapter_number}`;localStorage.setItem(R,JSON.stringify({questions:u.data.questions,chapter_number:le.value?.chapter_number,loaded_at:new Date().toISOString()})),f.success(`Generated ${u.data.questions.length} new questions`),Xe(h||Se.defense(),"Defense questions","chapter",i.chapter.id).catch(A=>console.error("Failed to record word usage (defense):",A)),st.value=!0,Ra(),e&&console.log("Auto-generated defense questions after meeting threshold.")}}catch(s){console.error("Failed to generate defense questions:",s),f.error("Failed to generate defense questions")}finally{Be.value=!1}}},{hasTriggeredGeneration:st,startWatching:hr,stopWatching:Aa,forceCheck:fr,getStatusMessage:mr,markGenerationTriggered:Ra}=_n(i.project,i.chapter,b),Lt=ca,wr=j(()=>{const a=te.value;return a>0&&a<vt&&!st.value}),br=pa,yr=da,xr=async(a,e)=>{try{await xe.patch(`/api/projects/${i.project.id}/defense/questions/${a}`,{user_marked_helpful:e},{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),Accept:"application/json","Content-Type":"application/json"}});const o=ce.value.find(s=>s.id===a);o&&(o.user_marked_helpful=e),f.success(e?"Question marked as helpful":"Removed helpful mark")}catch(o){console.error("Failed to mark question:",o),f.error("Failed to update question")}},_r=async a=>{try{await xe.delete(`/api/projects/${i.project.id}/defense/questions/${a}`,{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),Accept:"application/json"}}),ce.value=ce.value.filter(e=>e.id!==a),localStorage.setItem(`defense_questions_${i.project.id}`,JSON.stringify({questions:ce.value,loaded_at:new Date().toISOString()})),f.success("Question hidden")}catch(e){console.error("Failed to hide question:",e),f.error("Failed to hide question")}};return ft(async()=>{const a=`defense_questions_${i.project.id}_chapter_${le.value?.chapter_number}`,e=localStorage.getItem(a);let o=!0;if(e){const s=JSON.parse(e),u=new Date(s.loaded_at),h=new Date(Date.now()-360*60*1e3);u>h&&s.chapter_number===le.value?.chapter_number&&(ce.value=s.questions,nt.value=u,o=!1)}o&&await ot(!1,{skipGeneration:!0}),hr(),await mt(()=>{fr(),ht()})}),ft(async()=>{await ia()}),(a,e)=>(_(),Q(t(Fa),null,{default:l(()=>[X.value?(_(),Q(t(m),{key:0,project:be.value,chapter:ye.value,"chapter-title":C.value,"chapter-content":b.value,"current-word-count":t(te),"target-word-count":ue.value,"progress-percentage":t(tt),"writing-quality-score":t(ke),"is-valid":At.value,"is-saving":t(Ee),"show-preview":O.value,"is-generating":D.value,"generation-progress":k.value,"history-index":t(na),"content-history-length":t(aa).length,"selected-text":V.value,"onUpdate:chapterTitle":e[0]||(e[0]=o=>C.value=o),"onUpdate:chapterContent":e[1]||(e[1]=o=>b.value=o),"onUpdate:selectedText":e[2]||(e[2]=o=>V.value=o),"onUpdate:showPreview":e[3]||(e[3]=o=>O.value=o),onSave:e[4]||(e[4]=o=>Yt(o)),onUndo:Zt,onRedo:er,onExitChatMode:Ca},null,8,["project","chapter","chapter-title","chapter-content","current-word-count","target-word-count","progress-percentage","writing-quality-score","is-valid","is-saving","show-preview","is-generating","generation-progress","history-index","content-history-length","selected-text"])):Z.value?(_(),Q(t(p),{key:1,project:be.value,chapter:ye.value,"chapter-title":C.value,"chapter-content":b.value,"current-word-count":t(te),"target-word-count":ue.value,"progress-percentage":t(tt),onExitCitationMode:Sa},null,8,["project","chapter","chapter-title","chapter-content","current-word-count","target-word-count","progress-percentage"])):g.value?(_(),z("div",kn,[e[54]||(e[54]=r("div",{class:"absolute inset-0 z-0 overflow-hidden pointer-events-none"},[r("div",{class:"absolute top-[-20%] left-[-10%] w-[50%] h-[50%] rounded-full bg-blue-500/5 blur-[120px]"}),r("div",{class:"absolute bottom-[-20%] right-[-10%] w-[50%] h-[50%] rounded-full bg-purple-500/5 blur-[120px]"})],-1)),r("div",Sn,[r("div",En,[n(t(ne),null,{default:l(()=>[n(t(oe),{asChild:""},{default:l(()=>[n(t(G),{onClick:e[5]||(e[5]=o=>t(Qe).visit(t(J)("projects.show",i.project.slug))),variant:"ghost",size:"icon",class:"h-10 w-10 rounded-full hover:bg-primary/10 hover:text-primary transition-all duration-300"},{default:l(()=>[n(t(qr),{class:"h-5 w-5"})]),_:1})]),_:1}),n(t(se),null,{default:l(()=>[...e[32]||(e[32]=[r("p",null,"Back to Project",-1)])]),_:1})]),_:1}),r("div",Tn,[n(Er,{as:"h1",class:"text-lg font-bold tracking-tight text-foreground/90 font-display",content:i.project.title},null,8,["content"]),r("div",$n,[n(t(Te),{variant:"outline",class:"h-5 px-2 rounded-full border-primary/20 bg-primary/5 text-primary font-medium"},{default:l(()=>[M(" Chapter "+w(i.chapter.chapter_number),1)]),_:1}),r("span",An,[e[33]||(e[33]=r("span",{class:"h-1.5 w-1.5 rounded-full bg-green-500 animate-pulse"},null,-1)),M(" "+w(t(te))+" words ",1)])])])]),r("div",Rn,[r("div",Pn,[n(t(G),{onClick:e[6]||(e[6]=o=>ie.value=!ie.value),variant:ie.value?"secondary":"ghost",size:"sm",class:ve(["h-8 px-4 rounded-full text-xs font-medium transition-all duration-300",ie.value?"bg-primary/10 text-primary hover:bg-primary/15":"hover:bg-muted"])},{default:l(()=>[n(t(Ar),{class:"mr-2 h-3.5 w-3.5"}),e[34]||(e[34]=M(" Outline ",-1))]),_:1},8,["variant","class"]),e[36]||(e[36]=r("div",{class:"w-px h-4 bg-border/50 mx-1"},null,-1)),n(t(G),{onClick:e[7]||(e[7]=o=>$e.value=!$e.value),variant:$e.value?"secondary":"ghost",size:"sm",class:ve(["h-8 px-4 rounded-full text-xs font-medium transition-all duration-300",$e.value?"bg-primary/10 text-primary hover:bg-primary/15":"hover:bg-muted"])},{default:l(()=>[n(t(bt),{class:"mr-2 h-3.5 w-3.5"}),e[35]||(e[35]=M(" Assistant ",-1))]),_:1},8,["variant","class"])]),r("div",jn,[n(t(ne),null,{default:l(()=>[n(t(oe),{asChild:""},{default:l(()=>[n(t(G),{onClick:e[8]||(e[8]=o=>F.value=!F.value),variant:F.value?"secondary":"ghost",size:"icon",class:"h-9 w-9 rounded-full transition-all hover:bg-muted"},{default:l(()=>[n(t(Dr),{class:"h-4.5 w-4.5 text-muted-foreground"})]),_:1},8,["variant"])]),_:1}),n(t(se),null,{default:l(()=>[r("p",null,w(F.value?"Hide":"Show")+" Statistics",1)]),_:1})]),_:1}),n(t(ne),null,{default:l(()=>[n(t(oe),{asChild:""},{default:l(()=>[n(t(G),{onClick:nr,variant:"ghost",size:"icon",class:"h-9 w-9 rounded-full transition-all hover:bg-muted"},{default:l(()=>[P.value?(_(),Q(t($r),{key:1,class:"h-4.5 w-4.5 text-muted-foreground"})):(_(),Q(t(Tr),{key:0,class:"h-4.5 w-4.5 text-muted-foreground"}))]),_:1})]),_:1}),n(t(se),null,{default:l(()=>[...e[37]||(e[37]=[r("p",null,"Toggle Theme",-1)])]),_:1})]),_:1}),n(Wt,{project:be.value,"current-chapter":ye.value,"all-chapters":qe.value,size:"icon",variant:"ghost",class:"h-9 w-9 rounded-full hover:bg-muted"},null,8,["project","current-chapter","all-chapters"])])])]),r("div",qn,[r("div",{class:"absolute top-0 left-0 h-full bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 transition-all duration-700 ease-out shadow-[0_0_10px_rgba(59,130,246,0.5)]",style:Ye({width:`${Math.min(t(tt),100)}%`})},null,4)]),D.value?(_(),z("div",Dn,[r("div",Mn,[e[43]||(e[43]=r("div",{class:"absolute inset-0 -skew-x-12 animate-pulse bg-gradient-to-r from-transparent via-white/10 to-transparent"},null,-1)),r("div",Fn,[r("div",Ln,[r("div",Nn,[r("div",Wn,[n(t(bt),{class:"h-3 w-3 text-white"})]),e[38]||(e[38]=r("div",{class:"absolute inset-0 h-6 w-6 animate-ping rounded-full bg-gradient-to-br from-blue-500 to-purple-600 opacity-20"},null,-1))]),r("div",null,[e[39]||(e[39]=r("h4",{class:"text-xs font-semibold text-blue-900 dark:text-blue-100"},"AI Generator",-1)),r("p",On,w(y.value),1)])]),n(t(Te),{variant:"outline",class:"border-blue-300 text-xs text-blue-700 dark:border-blue-700 dark:text-blue-300"},{default:l(()=>[M(w(Math.round(d.value))+"% ",1)]),_:1})]),r("div",In,[r("div",Gn,[e[40]||(e[40]=r("span",{class:"text-xs text-blue-800 dark:text-blue-200"},"Generation Progress",-1)),r("span",zn,w(S.value)+" / "+w(H.value)+" words",1)]),r("div",Hn,[r("div",{class:"absolute top-0 left-0 h-full rounded-full bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-500 ease-out",style:Ye({width:`${d.value}%`})},[...e[41]||(e[41]=[r("div",{class:"absolute inset-0 animate-pulse bg-gradient-to-r from-transparent via-white/30 to-transparent"},null,-1)])],4),r("div",{class:"absolute top-0 left-0 h-full rounded-full bg-gradient-to-r from-blue-400 to-purple-400 opacity-50 blur-sm transition-all duration-500",style:Ye({width:`${d.value}%`})},null,4)])]),r("div",Un,[r("div",Vn,[y.value==="Initializing"?(_(),z("div",Bn)):y.value==="Connecting"?(_(),z("div",Qn,[...e[42]||(e[42]=[r("div",{class:"h-2 w-0.5 animate-pulse rounded-full bg-blue-500"},null,-1),r("div",{class:"h-2 w-0.5 animate-pulse rounded-full bg-purple-500",style:{"animation-delay":"0.2s"}},null,-1),r("div",{class:"h-2 w-0.5 animate-pulse rounded-full bg-blue-500",style:{"animation-delay":"0.4s"}},null,-1)])])):y.value==="Generating"?(_(),z("div",Kn)):y.value==="Complete"?(_(),z("div",Jn)):(_(),z("div",Xn))]),r("p",Yn,w(k.value),1)])])])):pe("",!0),F.value?(_(),Q(Lr,{key:1,"show-statistics":F.value,"current-word-count":t(te),"writing-stats":t($t),"quality-analysis":t(Y),"is-analyzing":t(Jt),class:"relative z-20 mx-4 mt-2 rounded-lg border border-border/40 bg-background/60 backdrop-blur-md"},null,8,["show-statistics","current-word-count","writing-stats","quality-analysis","is-analyzing"])):pe("",!0),r("div",Zn,[n(Cr,{"enter-active-class":"transition-all duration-300 ease-in-out","enter-from-class":"-ml-72 opacity-0","enter-to-class":"ml-0 opacity-100","leave-active-class":"transition-all duration-300 ease-in-out","leave-from-class":"ml-0 opacity-100","leave-to-class":"-ml-72 opacity-0"},{default:l(()=>[ie.value?(_(),z("div",eo,[r("div",to,[r("div",ro,[r("div",ao,[e[44]||(e[44]=r("h2",{class:"text-sm font-semibold text-foreground mb-1"},"Table of Contents",-1)),r("p",no,w(qe.value.length)+" Chapters ",1)]),(_(),Q(wt,null,{fallback:l(()=>[...e[45]||(e[45]=[r("div",{class:"flex items-center justify-center p-8"},[r("div",{class:"h-6 w-6 animate-spin rounded-full border-2 border-primary border-t-transparent"})],-1)])]),default:l(()=>[n(t(q),{"all-chapters":qe.value,"current-chapter":ye.value,project:be.value,outlines:a.project.outlines||[],"faculty-chapters":a.facultyChapters||[],"current-word-count":t(te),"target-word-count":ue.value,"writing-quality-score":t(ke),"chapter-content-length":b.value.length,onGoToChapter:rt,onGenerateNextChapter:Rt},null,8,["all-chapters","current-chapter","project","outlines","faculty-chapters","current-word-count","target-word-count","writing-quality-score","chapter-content-length"])]),_:1}))])])])):pe("",!0)]),_:1}),r("div",oo,[r("div",so,[r("div",lo,[n(t(_t),{class:"w-full max-w-[850px] min-h-[calc(100vh-180px)] flex flex-col bg-background shadow-xl shadow-black/5 ring-1 ring-black/5 dark:ring-white/10 rounded-xl overflow-hidden transition-all duration-300"},{default:l(()=>[n(t(kt),{class:"flex-shrink-0 border-b border-border/30 px-8 py-6 bg-background/50 backdrop-blur-sm sticky top-0 z-10"},{default:l(()=>[r("div",io,[r("div",uo,[n(t(Nt),{for:"chapter-title-fs",class:"text-xs font-medium text-muted-foreground uppercase tracking-wider"},{default:l(()=>[...e[46]||(e[46]=[M("Chapter Title",-1)])]),_:1}),n(t(kr),{id:"chapter-title-fs",modelValue:C.value,"onUpdate:modelValue":e[9]||(e[9]=o=>C.value=o),placeholder:"Enter chapter title...",class:"h-auto p-0 border-0 bg-transparent text-2xl font-bold placeholder:text-muted-foreground/40 focus-visible:ring-0 px-0"},null,8,["modelValue"])]),r("div",co,[n(t(Te),{variant:a.chapter.status==="approved"?"default":"secondary",class:"rounded-full px-3"},{default:l(()=>[M(w(a.chapter.status.replace("_"," ")),1)]),_:1},8,["variant"]),n(t(Te),{variant:"outline",class:ve(["rounded-full px-3 transition-colors",{"text-green-600 border-green-200 bg-green-50 dark:bg-green-900/20 dark:border-green-800":(t(Y)?.total_score||0)>=80,"text-yellow-600 border-yellow-200 bg-yellow-50 dark:bg-yellow-900/20 dark:border-yellow-800":(t(Y)?.total_score||0)>=70&&(t(Y)?.total_score||0)<80,"text-orange-600 border-orange-200 bg-orange-50 dark:bg-orange-900/20 dark:border-orange-800":(t(Y)?.total_score||0)>=60&&(t(Y)?.total_score||0)<70,"text-red-600 border-red-200 bg-red-50 dark:bg-red-900/20 dark:border-red-800":(t(Y)?.total_score||0)<60}])},{default:l(()=>[M(w(t(Y)?.total_score?Math.round(t(Y).total_score):t(ke))+"% Quality ",1)]),_:1},8,["class"])])])]),_:1}),n(t(Ct),{class:"flex min-h-0 flex-1 flex-col p-0"},{default:l(()=>[r("div",po,[r("div",vo,[n(t(G),{onClick:or,variant:re.value?"default":"ghost",size:"sm",class:"h-7 text-xs rounded-full"},{default:l(()=>[n(t(Ot),{class:"mr-1.5 h-3.5 w-3.5"}),M(" "+w(re.value?"Edit":"Preview"),1)]),_:1},8,["variant"])]),r("div",go,[r("div",ho,w(a.aiChapterAnalysis?.section.name||a.getSectionInfo(a.nextSection).name),1),r("div",fo,w(a.aiChapterAnalysis?.section.description||a.getSectionInfo(a.nextSection).description),1)])]),r("div",mo,[Ke(n(Pr,{modelValue:b.value,"onUpdate:modelValue":e[10]||(e[10]=o=>b.value=o),placeholder:"Start writing your chapter...","min-height":"500px",class:"min-h-[500px] px-8 py-6",ref_key:"richTextEditor",ref:gt,"show-toolbar":!0,"onUpdate:selectedText":e[11]||(e[11]=o=>{V.value=o})},null,8,["modelValue"]),[[Je,!re.value]]),Ke(r("div",wo,[n(Rr,{content:b.value,"show-font-controls":!1,class:"prose-lg mx-auto",style:{"font-family":"'Times New Roman', serif","line-height":"1.8"}},null,8,["content"])],512),[[Je,re.value]])])]),_:1}),r("div",bo,[r("div",yo,w(t(Ee)?"Saving...":"All changes saved"),1),r("div",xo,[n(t(G),{onClick:e[12]||(e[12]=o=>t(Ce)(!1)),disabled:!At.value||t(Ee),size:"sm",variant:"ghost",class:"h-8 rounded-full"},{default:l(()=>[n(t(Mr),{class:"mr-2 h-3.5 w-3.5"}),e[47]||(e[47]=M(" Save Draft ",-1))]),_:1},8,["disabled"]),n(t(G),{onClick:sr,variant:"outline",size:"sm",class:"h-8 rounded-full"},{default:l(()=>[n(t(it),{class:"mr-2 h-3.5 w-3.5"}),e[48]||(e[48]=M(" Run Bulk Analysis ",-1))]),_:1}),n(t(G),{onClick:lr,disabled:t(Ee),size:"sm",class:"h-8 rounded-full bg-gradient-to-r from-primary to-primary/90 shadow-sm hover:shadow-md transition-all"},{default:l(()=>[n(t(Fr),{class:"mr-2 h-3.5 w-3.5"}),e[49]||(e[49]=M(" Complete ",-1))]),_:1},8,["disabled"])])])]),_:1}),e[50]||(e[50]=r("div",{class:"h-12"},null,-1))])])]),n(Cr,{"enter-active-class":"transition-all duration-300 ease-in-out","enter-from-class":"-mr-72 opacity-0","enter-to-class":"mr-0 opacity-100","leave-active-class":"transition-all duration-300 ease-in-out","leave-from-class":"mr-0 opacity-100","leave-to-class":"-mr-72 opacity-0"},{default:l(()=>[$e.value?(_(),z("div",_o,[r("div",Co,[r("div",ko,[(_(),Q(wt,null,{fallback:l(()=>[...e[51]||(e[51]=[r("div",{class:"flex items-center justify-center p-8"},[r("div",{class:"h-6 w-6 animate-spin rounded-full border-2 border-primary border-t-transparent"})],-1)])]),default:l(()=>[n(t(E),{project:be.value,chapter:ye.value,"is-generating":D.value,"selected-text":V.value,"is-loading-suggestions":Ze.value,"show-citation-helper":Ae.value,"chapter-content":b.value,"current-word-count":t(te),"target-word-count":ue.value,onStartStreamingGeneration:Pt,onGetAiSuggestions:qt,"onUpdate:showCitationHelper":e[13]||(e[13]=o=>Ae.value=o),onInsertCitation:rr,onCheckCitations:Dt},null,8,["project","chapter","is-generating","selected-text","is-loading-suggestions","show-citation-helper","chapter-content","current-word-count","target-word-count"])]),_:1})),(_(),Q(wt,null,{fallback:l(()=>[...e[52]||(e[52]=[r("div",{class:"flex items-center justify-center p-4"},[r("div",{class:"h-4 w-4 animate-spin rounded-full border-2 border-muted border-t-transparent"})],-1)])]),default:l(()=>[n(t(x),{"show-defense-prep":me.value,questions:ce.value,"is-loading":Ve.value,"is-generating":Be.value,"chapter-context":{chapter_number:le.value.chapter_number,chapter_title:le.value.title,word_count:t(te)},"defense-watcher":{meetsThreshold:t(Lt),shouldShowProgress:wr.value,progressPercentage:t(br),wordsRemaining:t(yr),hasTriggeredGeneration:t(st),threshold:t(vt),statusMessage:t(mr)()},"auto-generate-enabled":De.value,"onUpdate:showDefensePrep":vr,onGenerateMore:Ft,onToggleAutoGenerate:gr,onRefresh:e[14]||(e[14]=()=>ot(!0,{skipGeneration:!0})),onMarkHelpful:xr,onHideQuestion:_r},null,8,["show-defense-prep","questions","is-loading","is-generating","chapter-context","defense-watcher","auto-generate-enabled"])]),_:1})),(_(),Q(wt,null,{fallback:l(()=>[...e[53]||(e[53]=[r("div",{class:"flex items-center justify-center p-4"},[r("div",{class:"h-4 w-4 animate-spin rounded-full border-2 border-muted border-t-transparent"})],-1)])]),default:l(()=>[n(t(v),{"chapter-id":le.value.id,content:b.value},null,8,["chapter-id","content"])]),_:1}))])])])):pe("",!0)]),_:1})])])):(_(),Q(Ma,{key:3,class:"h-screen overflow-hidden"},{default:l(()=>[r("div",So,[r("div",Eo,[r("div",To,[r("div",$o,[n(t(ne),null,{default:l(()=>[n(t(oe),{asChild:""},{default:l(()=>[n(t(G),{onClick:e[15]||(e[15]=o=>t(Qe).visit(t(J)("projects.show",i.project.slug))),variant:"ghost",size:"icon",class:"hidden sm:flex"},{default:l(()=>[n(t(qr),{class:"h-4 w-4"})]),_:1})]),_:1}),n(t(se),null,{default:l(()=>[...e[55]||(e[55]=[r("p",null,"Back to Project",-1)])]),_:1})]),_:1}),r("div",null,[n(Er,{as:"h1",class:"text-xl font-bold sm:text-2xl",content:i.project.title},null,8,["content"]),r("p",Ao," Chapter "+w(i.chapter.chapter_number)+" â€¢ "+w(t(te))+" / "+w(ue.value)+" words ",1)])]),r("div",Ro,[n(t(ne),null,{default:l(()=>[n(t(oe),{asChild:""},{default:l(()=>[n(t(G),{onClick:e[16]||(e[16]=o=>he.value=!0),variant:"outline",size:"icon",class:"lg:hidden"},{default:l(()=>[n(t(Ar),{class:"h-4 w-4"})]),_:1})]),_:1}),n(t(se),null,{default:l(()=>[...e[56]||(e[56]=[r("p",null,"Chapter Navigation",-1)])]),_:1})]),_:1}),n(t(ne),null,{default:l(()=>[n(t(oe),{asChild:""},{default:l(()=>[n(t(G),{onClick:e[17]||(e[17]=o=>I.value=!0),variant:"outline",size:"icon",class:"lg:hidden"},{default:l(()=>[n(t(bt),{class:"h-4 w-4"})]),_:1})]),_:1}),n(t(se),null,{default:l(()=>[...e[57]||(e[57]=[r("p",null,"AI Tools & Defense Prep",-1)])]),_:1})]),_:1}),r("div",Po,[n(t(ne),null,{default:l(()=>[n(t(oe),{asChild:""},{default:l(()=>[n(t(G),{onClick:_a,variant:X.value?"default":"outline",size:"sm"},{default:l(()=>[n(t(Ha),{class:"h-4 w-4"})]),_:1},8,["variant"])]),_:1}),n(t(se),null,{default:l(()=>[r("p",null,w(X.value?"Exit":"Open")+" AI Chat Assistant",1)]),_:1})]),_:1}),n(t(ne),null,{default:l(()=>[n(t(oe),{asChild:""},{default:l(()=>[n(t(G),{onClick:ka,variant:Z.value?"default":"outline",size:"sm"},{default:l(()=>[n(t(it),{class:"h-4 w-4"})]),_:1},8,["variant"])]),_:1}),n(t(se),null,{default:l(()=>[r("p",null,w(Z.value?"Exit":"Open")+" Citation Verification",1)]),_:1})]),_:1}),n(t(ne),null,{default:l(()=>[n(t(oe),{asChild:""},{default:l(()=>[n(t(G),{onClick:e[18]||(e[18]=o=>F.value=!F.value),variant:F.value?"default":"outline",size:"sm"},{default:l(()=>[n(t(Dr),{class:"h-4 w-4"})]),_:1},8,["variant"])]),_:1}),n(t(se),null,{default:l(()=>[r("p",null,w(F.value?"Hide":"Show")+" Writing Statistics",1)]),_:1})]),_:1}),n(t(ne),null,{default:l(()=>[n(t(oe),{asChild:""},{default:l(()=>[n(t(G),{onClick:nr,variant:"outline",size:"sm"},{default:l(()=>[P.value?(_(),Q(t($r),{key:1,class:"h-4 w-4"})):(_(),Q(t(Tr),{key:0,class:"h-4 w-4"}))]),_:1})]),_:1}),n(t(se),null,{default:l(()=>[r("p",null,"Switch to "+w(P.value?"Light":"Dark")+" Mode",1)]),_:1})]),_:1}),n(t(ne),null,{default:l(()=>[n(t(oe),{asChild:""},{default:l(()=>[n(t(G),{onClick:ar,variant:g.value?"default":"outline",size:"sm"},{default:l(()=>[n(t(Wa),{class:"h-4 w-4"})]),_:1},8,["variant"])]),_:1}),n(t(se),null,{default:l(()=>[r("p",null,w(g.value?"Exit":"Enter")+" Fullscreen Mode (F11)",1)]),_:1})]),_:1}),n(Wt,{project:be.value,"current-chapter":ye.value,"all-chapters":qe.value,size:"sm"},null,8,["project","current-chapter","all-chapters"])])])]),r("div",jo,[r("div",qo,[e[58]||(e[58]=r("span",{class:"text-sm font-medium"},"Writing Progress",-1)),r("span",Do,w(t(te))+" / "+w(ue.value)+" words ("+w(Math.round(t(tt)))+"%)",1)]),n(t(Wr),{"model-value":Number(t(tt)),class:"h-2"},null,8,["model-value"])]),D.value?(_(),z("div",Mo,[r("div",Fo,[e[65]||(e[65]=r("div",{class:"absolute inset-0 -skew-x-12 animate-pulse bg-gradient-to-r from-transparent via-white/10 to-transparent"},null,-1)),r("div",Lo,[r("div",No,[r("div",Wo,[r("div",Oo,[n(t(bt),{class:"h-4 w-4 text-white"})]),e[59]||(e[59]=r("div",{class:"absolute inset-0 h-8 w-8 animate-ping rounded-full bg-gradient-to-br from-blue-500 to-purple-600 opacity-20"},null,-1))]),r("div",null,[e[60]||(e[60]=r("h4",{class:"text-sm font-semibold text-blue-900 dark:text-blue-100"},"AI Chapter Generator ",-1)),r("p",Io,w(y.value),1)])]),n(t(Te),{variant:"outline",class:"border-blue-300 text-xs text-blue-700 dark:border-blue-700 dark:text-blue-300"},{default:l(()=>[M(w(Math.round(d.value))+"% ",1)]),_:1})]),r("div",Go,[r("div",zo,[e[61]||(e[61]=r("span",{class:"text-xs text-blue-800 dark:text-blue-200"},"Generation Progress",-1)),r("span",Ho,w(S.value)+" / "+w(H.value)+" words",1)]),r("div",Uo,[r("div",{class:"absolute top-0 left-0 h-full rounded-full bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-500 ease-out",style:Ye({width:`${d.value}%`})},[...e[62]||(e[62]=[r("div",{class:"absolute inset-0 animate-pulse bg-gradient-to-r from-transparent via-white/30 to-transparent"},null,-1)])],4),r("div",{class:"absolute top-0 left-0 h-full rounded-full bg-gradient-to-r from-blue-400 to-purple-400 opacity-50 blur-sm transition-all duration-500",style:Ye({width:`${d.value}%`})},null,4)])]),r("div",Vo,[r("div",Bo,[y.value==="Initializing"?(_(),z("div",Qo)):y.value==="Connecting"?(_(),z("div",Ko,[...e[63]||(e[63]=[r("div",{class:"h-3 w-1 animate-pulse rounded-full bg-blue-500"},null,-1),r("div",{class:"h-3 w-1 animate-pulse rounded-full bg-purple-500",style:{"animation-delay":"0.2s"}},null,-1),r("div",{class:"h-3 w-1 animate-pulse rounded-full bg-blue-500",style:{"animation-delay":"0.4s"}},null,-1)])])):y.value==="Generating"?(_(),z("div",Jo)):y.value==="Complete"?(_(),z("div",Xo)):(_(),z("div",Yo))]),r("p",Zo,w(k.value),1)]),y.value==="Generating"&&S.value>50?(_(),z("div",es,[r("div",ts,[e[64]||(e[64]=r("span",{class:"text-blue-700 dark:text-blue-300"},"Writing Quality",-1)),r("div",rs,[r("div",as,[(_(),z(Gt,null,zt(5,o=>r("div",{key:o,class:ve(["h-2 w-2 rounded-full",o<=Math.ceil(t(ke)/20)?"bg-yellow-400":"bg-blue-200 dark:bg-blue-800"])},null,2)),64))]),r("span",ns,w(t(ke))+"%",1)])])])):pe("",!0)])])):pe("",!0),n(Lr,{"show-statistics":F.value,"current-word-count":t(te),"writing-stats":t($t),"quality-analysis":t(Y),"is-analyzing":t(Jt)},null,8,["show-statistics","current-word-count","writing-stats","quality-analysis","is-analyzing"]),r("div",os,[Ke(r("div",ss,[r("div",ls,[n(t(q),{"all-chapters":qe.value,"current-chapter":ye.value,project:be.value,outlines:a.project.outlines||[],"faculty-chapters":a.facultyChapters||[],"current-word-count":t(te),"target-word-count":ue.value,"writing-quality-score":t(ke),"chapter-content-length":b.value.length,onGoToChapter:rt,onGenerateNextChapter:Rt},null,8,["all-chapters","current-chapter","project","outlines","faculty-chapters","current-word-count","target-word-count","writing-quality-score","chapter-content-length"])])],512),[[Je,!K.value]]),r("div",{class:ve(["transition-all duration-300",K.value&&ee.value?"lg:col-span-12":K.value?"lg:col-span-9":ee.value?"lg:col-span-10":"lg:col-span-7"])},[n(t(_t),{class:"border-[0.5px] border-border/50 transition-all duration-300"},{default:l(()=>[n(t(kt),{class:"pb-4"},{default:l(()=>[r("div",is,[r("div",us,[n(t(G),{variant:"ghost",size:"icon",class:"h-6 w-6 hidden lg:flex mr-1 text-muted-foreground hover:text-foreground",onClick:e[19]||(e[19]=o=>K.value=!K.value),title:K.value?"Expand Sidebar":"Collapse Sidebar"},{default:l(()=>[K.value?(_(),Q(t(Va),{key:1,class:"h-4 w-4"})):(_(),Q(t(Ua),{key:0,class:"h-4 w-4"}))]),_:1},8,["title"]),n(t(Ht),{class:"text-lg"},{default:l(()=>[M("Chapter "+w(a.chapter.chapter_number),1)]),_:1})]),r("div",cs,[n(t(Te),{variant:a.chapter.status==="approved"?"default":"secondary"},{default:l(()=>[M(w(a.chapter.status.replace("_"," ")),1)]),_:1},8,["variant"]),n(t(Te),{variant:"outline",class:ve(["text-xs",{"text-green-600 border-green-200 bg-green-50":(t(Y)?.total_score||0)>=80,"text-yellow-600 border-yellow-200 bg-yellow-50":(t(Y)?.total_score||0)>=70&&(t(Y)?.total_score||0)<80,"text-orange-600 border-orange-200 bg-orange-50":(t(Y)?.total_score||0)>=60&&(t(Y)?.total_score||0)<70,"text-red-600 border-red-200 bg-red-50":(t(Y)?.total_score||0)<60}])},{default:l(()=>[M(w(t(Y)?.total_score?Math.round(t(Y).total_score):t(ke))+"% Quality ",1)]),_:1},8,["class"]),n(t(G),{variant:"ghost",size:"icon",class:"h-6 w-6 hidden lg:flex ml-1 text-muted-foreground hover:text-foreground",onClick:e[20]||(e[20]=o=>ee.value=!ee.value),title:ee.value?"Expand Tools":"Collapse Tools"},{default:l(()=>[ee.value?(_(),Q(t(Ia),{key:1,class:"h-4 w-4"})):(_(),Q(t(Oa),{key:0,class:"h-4 w-4"}))]),_:1},8,["title"])])])]),_:1}),n(t(Ct),{class:"space-y-4"},{default:l(()=>[r("div",ds,[n(t(Nt),{for:"chapter-title"},{default:l(()=>[...e[66]||(e[66]=[M("Chapter Title",-1)])]),_:1}),n(t(kr),{id:"chapter-title",modelValue:C.value,"onUpdate:modelValue":e[21]||(e[21]=o=>C.value=o),placeholder:"Enter chapter title...",class:"text-lg font-medium"},null,8,["modelValue"])]),r("div",ps,[r("div",vs,[n(t(Nt),{for:"chapter-content"},{default:l(()=>[...e[67]||(e[67]=[M("Content",-1)])]),_:1}),r("div",gs,[n(t(G),{onClick:or,variant:re.value?"default":"outline",size:"sm"},{default:l(()=>[n(t(Ot),{class:"mr-1 h-4 w-4"}),M(" "+w(re.value?"Edit Mode":"Preview Mode"),1)]),_:1},8,["variant"])])]),Ke(n(t(Sr),{ref_key:"editorFullscreenScrollRef",ref:Bt,class:"h-[calc(100vh-320px)] w-full"},{default:l(()=>[n(Pr,{modelValue:b.value,"onUpdate:modelValue":e[22]||(e[22]=o=>b.value=o),placeholder:"Start writing your chapter...","min-height":"600px",class:"text-base leading-relaxed",ref_key:"richTextEditorFullscreen",ref:at,"onUpdate:selectedText":e[23]||(e[23]=o=>{V.value=o,console.log("ðŸ“‹ ChapterEditor Fullscreen - Selected text updated:",{length:o.length,preview:o.substring(0,50)+(o.length>50?"...":"")})})},null,8,["modelValue"])]),_:1},512),[[Je,!re.value]]),Ke(n(t(Sr),{ref_key:"previewFullscreenScrollRef",ref:Qt,class:"h-[calc(100vh-320px)] w-full"},{default:l(()=>[n(Rr,{content:b.value,"show-font-controls":!1,class:"min-h-[600px] rounded-md border border-border/50 bg-background p-6",style:{"font-family":"'Times New Roman', serif","line-height":"1.8"}},null,8,["content"])]),_:1},512),[[Je,re.value]])]),r("div",hs,[n(t(ne),null,{default:l(()=>[n(t(oe),{asChild:""},{default:l(()=>[n(t(G),{onClick:e[24]||(e[24]=o=>t(Ce)(!1)),disabled:!At.value||t(Ee),size:"sm",class:"flex-1 sm:flex-none"},{default:l(()=>[n(t(Mr),{class:"mr-1 h-3 w-3 sm:mr-2 sm:h-4 sm:w-4"}),r("span",fs,w(t(Ee)?"Saving...":`Save
                                                        Draft`),1),r("span",ms,w(t(Ee)?"Saving...":"Save"),1)]),_:1},8,["disabled"])]),_:1}),n(t(se),null,{default:l(()=>[...e[68]||(e[68]=[r("p",null,"Save chapter as draft (Ctrl+S)",-1)])]),_:1})]),_:1}),n(t(ne),null,{default:l(()=>[n(t(oe),{asChild:""},{default:l(()=>[n(t(G),{onClick:sr,variant:"outline",size:"sm",class:"flex-1 sm:flex-none"},{default:l(()=>[n(t(it),{class:"mr-1 h-3 w-3 sm:mr-2 sm:h-4 sm:w-4"}),e[69]||(e[69]=r("span",{class:"hidden sm:inline"},"Bulk Analysis",-1)),e[70]||(e[70]=r("span",{class:"sm:hidden"},"Analyze",-1))]),_:1})]),_:1}),n(t(se),null,{default:l(()=>[...e[71]||(e[71]=[r("p",null,"Open bulk chapter analysis to score this project.",-1)])]),_:1})]),_:1}),n(t(ne),null,{default:l(()=>[n(t(oe),{asChild:""},{default:l(()=>[n(t(G),{onClick:e[25]||(e[25]=o=>O.value=!O.value),variant:"outline",size:"sm",class:"flex-1 sm:flex-none"},{default:l(()=>[O.value?(_(),Q(t(Ba),{key:1,class:"mr-1 h-3 w-3 sm:mr-2 sm:h-4 sm:w-4"})):(_(),Q(t(Ot),{key:0,class:"mr-1 h-3 w-3 sm:mr-2 sm:h-4 sm:w-4"})),r("span",ws,w(O.value?"Edit":"Preview"),1),r("span",bs,w(O.value?"Edit":"Preview"),1)]),_:1})]),_:1}),n(t(se),null,{default:l(()=>[r("p",null,w(O.value?"Switch to edit mode":"Switch to preview mode"),1)]),_:1})]),_:1}),n(t(ne),null,{default:l(()=>[n(t(oe),{asChild:""},{default:l(()=>[n(t(G),{onClick:lr,disabled:t(Ee),size:"sm",class:"flex-1 sm:flex-none"},{default:l(()=>[n(t(Fr),{class:"mr-1 h-3 w-3 sm:mr-2 sm:h-4 sm:w-4"}),e[72]||(e[72]=r("span",{class:"hidden sm:inline"},"Save & Mark Complete",-1)),e[73]||(e[73]=r("span",{class:"sm:hidden"},"Complete",-1))]),_:1},8,["disabled"])]),_:1}),n(t(se),null,{default:l(()=>[...e[74]||(e[74]=[r("p",null,"Mark chapter as complete (requires 80% of target word count)",-1)])]),_:1})]),_:1}),n(Wt,{project:be.value,"current-chapter":ye.value,"all-chapters":qe.value,size:"sm",variant:"outline",class:"flex-1 sm:flex-none"},null,8,["project","current-chapter","all-chapters"])])]),_:1})]),_:1})],2),Ke(r("div",ys,[r("div",xs,[n(t(E),{project:be.value,chapter:ye.value,"is-generating":D.value,"selected-text":V.value,"is-loading-suggestions":Ze.value,"show-citation-helper":Ae.value,"chapter-content":b.value,"current-word-count":t(te),"target-word-count":ue.value,onStartStreamingGeneration:Pt,onGetAiSuggestions:qt,"onUpdate:showCitationHelper":e[26]||(e[26]=o=>Ae.value=o),onInsertCitation:rr,onCheckCitations:Dt},null,8,["project","chapter","is-generating","selected-text","is-loading-suggestions","show-citation-helper","chapter-content","current-word-count","target-word-count"]),n(t(x),{"show-defense-prep":me.value,questions:ce.value,"is-loading":Ve.value,"is-generating":Be.value,"chapter-context":{chapter_number:le.value.chapter_number,chapter_title:le.value.title,word_count:t(te)},"defense-watcher":{meetsThreshold:t(Lt),shouldShowProgress:wr.value,progressPercentage:t(br),wordsRemaining:t(yr),hasTriggeredGeneration:t(st),threshold:t(vt),statusMessage:t(mr)()},"auto-generate-enabled":De.value,"onUpdate:showDefensePrep":vr,onGenerateMore:Ft,onToggleAutoGenerate:gr,onRefresh:e[27]||(e[27]=()=>ot(!0,{skipGeneration:!0})),onMarkHelpful:xr,onHideQuestion:_r},null,8,["show-defense-prep","questions","is-loading","is-generating","chapter-context","defense-watcher","auto-generate-enabled"])])],512),[[Je,!ee.value]])]),n(t(W),{"show-left-sidebar":he.value,"show-right-sidebar":I.value,"is-mobile":T.value,"all-chapters":qe.value,"current-chapter":ye.value,project:be.value,"current-word-count":t(te),"target-word-count":ue.value,"writing-quality-score":t(ke),"chapter-content-length":b.value.length,"is-generating":D.value,"selected-text":V.value,"is-loading-suggestions":Ze.value,"show-citation-helper":Ae.value,"chapter-content":b.value,"onUpdate:showLeftSidebar":e[28]||(e[28]=o=>he.value=o),"onUpdate:showRightSidebar":e[29]||(e[29]=o=>I.value=o),onGoToChapter:rt,onGenerateNextChapter:Rt,onStartStreamingGeneration:Pt,onGetAiSuggestions:qt,"onUpdate:showCitationHelper":e[30]||(e[30]=o=>Ae.value=o),onCheckCitations:Dt},null,8,["show-left-sidebar","show-right-sidebar","is-mobile","all-chapters","current-chapter","project","current-word-count","target-word-count","writing-quality-score","chapter-content-length","is-generating","selected-text","is-loading-suggestions","show-citation-helper","chapter-content"]),n(La,{open:t(Vt),"current-balance":t(Ir),"required-words":t(Gr),action:t(zr),"onUpdate:open":e[31]||(e[31]=o=>Vt.value=o),onClose:t(Ur)},null,8,["open","current-balance","required-words","action","onClose"]),Ie.value?(_(),z("div",_s,[n(t(_t),{class:"w-full max-w-md mx-4 bg-white dark:bg-slate-900 border-amber-500/50"},{default:l(()=>[n(t(kt),null,{default:l(()=>[n(t(Ht),{class:"flex items-center gap-2 text-amber-600 dark:text-amber-400"},{default:l(()=>[...e[75]||(e[75]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1),M(" Generation Interrupted ",-1)])]),_:1})]),_:1}),n(t(Ct),null,{default:l(()=>[r("p",Cs,[e[76]||(e[76]=M(" The connection was lost during generation, but ",-1)),r("span",ks,w(dt.value)+" words",1),e[77]||(e[77]=M(" may have been saved to the server. ",-1))]),e[80]||(e[80]=r("p",{class:"text-sm text-slate-500 dark:text-slate-400 mb-6"}," Reload the page to recover your content, or dismiss this dialog to continue with what's currently displayed. ",-1)),r("div",Ss,[n(t(G),{onClick:wa,class:"flex-1 bg-amber-600 hover:bg-amber-700 text-white"},{default:l(()=>[...e[78]||(e[78]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),M(" Reload & Recover ",-1)])]),_:1}),n(t(G),{onClick:ba,variant:"outline",class:"flex-1"},{default:l(()=>[...e[79]||(e[79]=[M(" Dismiss ",-1)])]),_:1})])]),_:1})]),_:1})])):pe("",!0)])])]),_:1}))]),_:1}))}});export{ql as default};
