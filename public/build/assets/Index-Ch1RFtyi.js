import{bt as Y,dS as S,cn as V,co as g,cp as a,cq as s,bE as e,cr as p,dT as le,cs as l,gx as ne,dY as de,gy as ue,dO as ie,cA as me,dU as fe,ce as H,cl as P,bx as f,dV as ce,ck as X,bs as C,dE as N,bu as D,dl as pe,ct as _,gz as _e,gA as ve,cB as W,cG as k,du as T,dg as ge}from"./vendor-DTjPma1U.js";import{_ as we}from"./AdminLayout.vue_vue_type_script_setup_true_lang-F29Dh3nm.js";import{_ as K,a as R}from"./CardContent.vue_vue_type_script_setup_true_lang-I4CEGKdn.js";import{_ as be}from"./CardDescription.vue_vue_type_script_setup_true_lang-CWoegFai.js";import{_ as j,a as B}from"./CardTitle.vue_vue_type_script_setup_true_lang-CV0UXs4e.js";import{_ as xe}from"./DataTable.vue_vue_type_script_setup_true_lang-BXCtcsa1.js";import{_ as x}from"./index-mwxrBKxi.js";import{_ as F}from"./index-3KGx5n4o.js";import{_ as ye,a as $e,b as ke,c as U,d as Ve,e as Ce}from"./Sonner.vue_vue_type_script_setup_true_lang-D0ynKKgD.js";import{_ as I,a as M}from"./DialogContent.vue_vue_type_script_setup_true_lang-3pmUscSv.js";import{_ as q}from"./DialogDescription.vue_vue_type_script_setup_true_lang-krf9iH0t.js";import{_ as z}from"./DialogFooter.vue_vue_type_script_setup_true_lang-Djbi9e8D.js";import{_ as G,a as J}from"./DialogTitle.vue_vue_type_script_setup_true_lang-DT1UgW8j.js";import{_ as E}from"./Input.vue_vue_type_script_setup_true_lang-DAeY8mMm.js";import{_ as A}from"./Label.vue_vue_type_script_setup_true_lang-D84UGLqY.js";import{_ as Ue}from"./Textarea.vue_vue_type_script_setup_true_lang-B2qCjWbq.js";import{_ as Se,a as De,b as Ae,c as Pe,d as We,e as Ke,f as Re,g as je}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-DLCPkSzL.js";import"./UserInfo.vue_vue_type_script_setup_true_lang-tVoAfrlY.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-DunnpUO7.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-KafZe9uV.js";const Be=Y({__name:"UserActions",props:{user:{}},setup(o){const u=o,L=S("onResetPassword"),O=S("onAddWords"),n=S("onDeductWords"),y=S("onSuspend"),b=S("onDelete"),$=()=>{confirm(`Unsuspend ${u.user.name}?`)&&H.post(P("admin.users.unban",{user:u.user.id}),{},{preserveScroll:!0})};return(v,r)=>(g(),V(e(Ce),null,{default:a(()=>[s(e(ye),{"as-child":""},{default:a(()=>[s(e(x),{variant:"ghost",class:"h-8 w-8 p-0"},{default:a(()=>[r[5]||(r[5]=p("span",{class:"sr-only"},"Open menu",-1)),s(e(le),{class:"h-4 w-4"})]),_:1})]),_:1}),s(e($e),{align:"end"},{default:a(()=>[s(e(ke),null,{default:a(()=>[...r[6]||(r[6]=[l("Actions",-1)])]),_:1}),s(e(U),{onClick:r[0]||(r[0]=c=>e(L)?.(v.user))},{default:a(()=>[s(e(ne),{class:"mr-2 h-4 w-4"}),r[7]||(r[7]=l(" Reset Password ",-1))]),_:1}),s(e(U),{onClick:r[1]||(r[1]=c=>e(O)?.(v.user))},{default:a(()=>[s(e(de),{class:"mr-2 h-4 w-4"}),r[8]||(r[8]=l(" Add Words ",-1))]),_:1}),s(e(U),{onClick:r[2]||(r[2]=c=>e(n)?.(v.user))},{default:a(()=>[s(e(ue),{class:"mr-2 h-4 w-4"}),r[9]||(r[9]=l(" Deduct Words ",-1))]),_:1}),s(e(Ve)),v.user.is_banned?(g(),V(e(U),{key:1,onClick:$,class:"text-emerald-600 focus:text-emerald-600 focus:bg-emerald-50"},{default:a(()=>[s(e(me),{class:"mr-2 h-4 w-4"}),r[11]||(r[11]=l(" Unsuspend ",-1))]),_:1})):(g(),V(e(U),{key:0,onClick:r[3]||(r[3]=c=>e(y)?.(v.user)),class:"text-amber-600 focus:text-amber-600 focus:bg-amber-50"},{default:a(()=>[s(e(ie),{class:"mr-2 h-4 w-4"}),r[10]||(r[10]=l(" Suspend ",-1))]),_:1})),s(e(U),{onClick:r[4]||(r[4]=c=>e(b)?.(v.user)),class:"text-rose-600 focus:text-rose-600 focus:bg-rose-50"},{default:a(()=>[s(e(fe),{class:"mr-2 h-4 w-4"}),r[12]||(r[12]=l(" Delete ",-1))]),_:1})]),_:1})]),_:1}))}}),Ee=[{accessorKey:"id",header:"ID",cell:({row:o})=>f("div",{class:"text-muted-foreground font-mono text-xs"},`#${o.getValue("id")}`)},{accessorKey:"name",header:"Name",cell:({row:o})=>f("div",{class:"font-medium text-foreground"},o.getValue("name"))},{accessorKey:"email",header:({column:o})=>f(x,{variant:"ghost",class:"-ml-2 text-xs hover:bg-muted/50",onClick:()=>o.toggleSorting(o.getIsSorted()==="asc")},()=>["Email",f(ce,{class:"ml-2 h-3 w-3"})]),cell:({row:o})=>f("div",{class:"text-muted-foreground"},o.getValue("email"))},{accessorKey:"package",header:"Package",cell:({row:o})=>f(F,{variant:"outline",class:"font-normal"},()=>o.getValue("package"))},{accessorKey:"word_balance",header:"Balance",cell:({row:o})=>f("div",{class:"font-mono text-xs"},o.getValue("word_balance").toLocaleString())},{accessorKey:"total_words_purchased",header:"Purchased",cell:({row:o})=>f("div",{class:"text-muted-foreground text-xs"},o.getValue("total_words_purchased").toLocaleString())},{accessorKey:"projects_count",header:()=>f("div",{class:"text-center"},"Projects"),cell:({row:o})=>f("div",{class:"text-center font-medium"},o.getValue("projects_count"))},{accessorKey:"payments_count",header:()=>f("div",{class:"text-center"},"Payments"),cell:({row:o})=>f("div",{class:"text-center font-medium"},o.getValue("payments_count"))},{accessorKey:"is_banned",header:"Status",cell:({row:o})=>{const u=o.getValue("is_banned");return f(F,{variant:u?"destructive":"secondary",class:u?"":"bg-emerald-500/15 text-emerald-600 hover:bg-emerald-500/25 border-emerald-500/20"},()=>u?"Banned":"Active")}},{accessorKey:"is_online",header:"Online",cell:({row:o})=>{const u=o.getValue("is_online");return f(F,{variant:u?"secondary":"outline",class:u?"bg-emerald-500/15 text-emerald-600 border-emerald-500/20":"text-muted-foreground"},()=>u?"Online":"Offline")}},{accessorKey:"last_active_at",header:"Last Active",cell:({row:o})=>{const u=o.getValue("last_active_at");return f("div",{class:"text-muted-foreground text-xs"},u?new Date(u).toLocaleString():"—")}},{accessorKey:"last_login_at",header:"Last Login",cell:({row:o})=>{const u=o.getValue("last_login_at");return f("div",{class:"text-muted-foreground text-xs"},u?new Date(u).toLocaleString():"—")}},{accessorKey:"created_at",header:"Joined",cell:({row:o})=>f("div",{class:"text-muted-foreground text-sm"},new Date(o.getValue("created_at")).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}))},{id:"actions",cell:({row:o})=>f(Be,{user:o.original})}],Le={class:"grid gap-4 md:grid-cols-3 mb-8"},Oe={class:"text-2xl font-bold"},Ne={class:"text-2xl font-bold"},Te={class:"text-2xl font-bold"},Fe={class:"grid gap-4 py-4"},Ie={class:"space-y-2"},Me={key:0,class:"text-sm text-destructive"},qe={class:"space-y-2"},ze={class:"grid gap-4 py-4"},Ge={class:"space-y-2"},Je={key:0,class:"text-sm text-destructive"},Xe={class:"space-y-2"},Ye={key:0,class:"text-sm text-destructive"},He={class:"grid gap-4 py-4"},Qe={class:"space-y-2"},Ze={key:0,class:"text-sm text-destructive"},he={class:"font-semibold text-foreground"},xs=Y({__name:"Index",props:{users:{}},setup(o){const u=o,L=X(()=>u.users.data.filter(i=>!i.is_banned).length),O=X(()=>u.users.data.filter(i=>i.is_banned).length),n=C(null),y=C(!1),b=C(!1),$=C(!1),v=C(!1),r=C(!1),c=N({password:"",password_confirmation:""}),m=N({words:void 0,reason:""}),w=N({reason:""}),Q=i=>{n.value=i,c.reset(),c.clearErrors(),y.value=!0},Z=i=>{n.value=i,r.value=!1,m.reset(),m.clearErrors(),b.value=!0},h=i=>{n.value=i,r.value=!0,m.reset(),m.clearErrors(),b.value=!0},ee=i=>{n.value=i,w.reset(),w.clearErrors(),$.value=!0},se=i=>{n.value=i,v.value=!0};D("onResetPassword",Q),D("onAddWords",Z),D("onDeductWords",h),D("onSuspend",ee),D("onDelete",se);const te=()=>{n.value&&c.post(P("admin.users.reset-password",n.value.id),{onSuccess:()=>{y.value=!1,c.reset()}})},ae=()=>{if(!n.value)return;const i=Math.abs(Number(m.words));m.words=r.value?-i:i,m.post(P("admin.users.adjust-balance",n.value.id),{onSuccess:()=>{b.value=!1,m.reset()}})},oe=()=>{n.value&&w.post(P("admin.users.ban",n.value.id),{onSuccess:()=>{$.value=!1,w.reset()}})},re=()=>{n.value&&H.delete(P("admin.users.force-destroy",n.value.id),{onSuccess:()=>{v.value=!1,n.value=null}})};return(i,t)=>(g(),V(we,{title:"Users",subtitle:"Manage your platform's user base."},{default:a(()=>[p("div",Le,[s(e(K),{class:"bg-card text-card-foreground border-border/50 shadow-sm"},{default:a(()=>[s(e(j),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[s(e(B),{class:"text-sm font-medium text-muted-foreground"},{default:a(()=>[...t[12]||(t[12]=[l("Total Users",-1)])]),_:1}),s(e(pe),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),s(e(R),null,{default:a(()=>[p("div",Oe,_(i.users.data.length),1)]),_:1})]),_:1}),s(e(K),{class:"bg-card text-card-foreground border-border/50 shadow-sm"},{default:a(()=>[s(e(j),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[s(e(B),{class:"text-sm font-medium text-muted-foreground"},{default:a(()=>[...t[13]||(t[13]=[l("Active Users",-1)])]),_:1}),s(e(_e),{class:"h-4 w-4 text-emerald-500"})]),_:1}),s(e(R),null,{default:a(()=>[p("div",Ne,_(L.value),1)]),_:1})]),_:1}),s(e(K),{class:"bg-card text-card-foreground border-border/50 shadow-sm"},{default:a(()=>[s(e(j),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[s(e(B),{class:"text-sm font-medium text-muted-foreground"},{default:a(()=>[...t[14]||(t[14]=[l("Banned Users",-1)])]),_:1}),s(e(ve),{class:"h-4 w-4 text-rose-500"})]),_:1}),s(e(R),null,{default:a(()=>[p("div",Te,_(O.value),1)]),_:1})]),_:1})]),s(e(K),{class:"border border-border/50 bg-card shadow-sm"},{default:a(()=>[s(e(j),{class:"flex flex-row items-center justify-between pb-3"},{default:a(()=>[p("div",null,[s(e(B),{class:"text-base font-semibold text-foreground"},{default:a(()=>[...t[15]||(t[15]=[l("All Users",-1)])]),_:1}),s(e(be),null,{default:a(()=>[...t[16]||(t[16]=[l("A list of all registered users including their name, email, and status.",-1)])]),_:1})])]),_:1}),s(e(R),null,{default:a(()=>[s(xe,{columns:e(Ee),data:i.users.data,"search-key":"email","search-placeholder":"Filter by email..."},null,8,["columns","data"])]),_:1})]),_:1}),s(e(I),{open:y.value,"onUpdate:open":t[3]||(t[3]=d=>y.value=d)},{default:a(()=>[s(e(M),{class:"sm:max-w-[425px]"},{default:a(()=>[s(e(G),null,{default:a(()=>[s(e(J),null,{default:a(()=>[...t[17]||(t[17]=[l("Reset Password",-1)])]),_:1}),s(e(q),null,{default:a(()=>[l(" Set a new password for "+_(n.value?.name)+". ",1)]),_:1})]),_:1}),p("div",Fe,[p("div",Ie,[s(e(A),{for:"password"},{default:a(()=>[...t[18]||(t[18]=[l("New Password",-1)])]),_:1}),s(e(E),{id:"password",type:"password",modelValue:e(c).password,"onUpdate:modelValue":t[0]||(t[0]=d=>e(c).password=d)},null,8,["modelValue"]),e(c).errors.password?(g(),W("p",Me,_(e(c).errors.password),1)):k("",!0)]),p("div",qe,[s(e(A),{for:"password_confirmation"},{default:a(()=>[...t[19]||(t[19]=[l("Confirm Password",-1)])]),_:1}),s(e(E),{id:"password_confirmation",type:"password",modelValue:e(c).password_confirmation,"onUpdate:modelValue":t[1]||(t[1]=d=>e(c).password_confirmation=d)},null,8,["modelValue"])])]),s(e(z),null,{default:a(()=>[s(e(x),{variant:"outline",onClick:t[2]||(t[2]=d=>y.value=!1)},{default:a(()=>[...t[20]||(t[20]=[l("Cancel",-1)])]),_:1}),s(e(x),{onClick:te,disabled:e(c).processing},{default:a(()=>[e(c).processing?(g(),V(e(T),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):k("",!0),t[21]||(t[21]=l(" Reset Password ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),s(e(I),{open:b.value,"onUpdate:open":t[7]||(t[7]=d=>b.value=d)},{default:a(()=>[s(e(M),{class:"sm:max-w-[425px]"},{default:a(()=>[s(e(G),null,{default:a(()=>[s(e(J),null,{default:a(()=>[l(_(r.value?"Deduct Words":"Add Words"),1)]),_:1}),s(e(q),null,{default:a(()=>[l(_(r.value?"Remove words from":"Add words to")+" "+_(n.value?.name)+"'s balance. ",1)]),_:1})]),_:1}),p("div",ze,[p("div",Ge,[s(e(A),{for:"words"},{default:a(()=>[...t[22]||(t[22]=[l("Amount of Words",-1)])]),_:1}),s(e(E),{id:"words",type:"number",min:"0",modelValue:e(m).words,"onUpdate:modelValue":t[4]||(t[4]=d=>e(m).words=d),placeholder:"e.g. 5000"},null,8,["modelValue"]),e(m).errors.words?(g(),W("p",Je,_(e(m).errors.words),1)):k("",!0)]),p("div",Xe,[s(e(A),{for:"reason"},{default:a(()=>[...t[23]||(t[23]=[l("Reason",-1)])]),_:1}),s(e(E),{id:"reason",modelValue:e(m).reason,"onUpdate:modelValue":t[5]||(t[5]=d=>e(m).reason=d),placeholder:"e.g. Bonus, Refund, Adjustment"},null,8,["modelValue"]),e(m).errors.reason?(g(),W("p",Ye,_(e(m).errors.reason),1)):k("",!0)])]),s(e(z),null,{default:a(()=>[s(e(x),{variant:"outline",onClick:t[6]||(t[6]=d=>b.value=!1)},{default:a(()=>[...t[24]||(t[24]=[l("Cancel",-1)])]),_:1}),s(e(x),{onClick:ae,disabled:e(m).processing,variant:r.value?"destructive":"default"},{default:a(()=>[e(m).processing?(g(),V(e(T),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):k("",!0),l(" "+_(r.value?"Deduct Words":"Add Words"),1)]),_:1},8,["disabled","variant"])]),_:1})]),_:1})]),_:1},8,["open"]),s(e(I),{open:$.value,"onUpdate:open":t[10]||(t[10]=d=>$.value=d)},{default:a(()=>[s(e(M),{class:"sm:max-w-[425px]"},{default:a(()=>[s(e(G),null,{default:a(()=>[s(e(J),null,{default:a(()=>[...t[25]||(t[25]=[l("Suspend User",-1)])]),_:1}),s(e(q),null,{default:a(()=>[l(" Ban "+_(n.value?.name)+" from accessing the platform. ",1)]),_:1})]),_:1}),p("div",He,[p("div",Qe,[s(e(A),{for:"ban_reason"},{default:a(()=>[...t[26]||(t[26]=[l("Reason for Suspension",-1)])]),_:1}),s(e(Ue),{id:"ban_reason",modelValue:e(w).reason,"onUpdate:modelValue":t[8]||(t[8]=d=>e(w).reason=d),placeholder:"e.g. Violation of terms..."},null,8,["modelValue"]),e(w).errors.reason?(g(),W("p",Ze,_(e(w).errors.reason),1)):k("",!0)])]),s(e(z),null,{default:a(()=>[s(e(x),{variant:"outline",onClick:t[9]||(t[9]=d=>$.value=!1)},{default:a(()=>[...t[27]||(t[27]=[l("Cancel",-1)])]),_:1}),s(e(x),{variant:"destructive",onClick:oe,disabled:e(w).processing},{default:a(()=>[e(w).processing?(g(),V(e(T),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):k("",!0),t[28]||(t[28]=l(" Suspend User ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),s(e(Se),{open:v.value,"onUpdate:open":t[11]||(t[11]=d=>v.value=d)},{default:a(()=>[s(e(De),null,{default:a(()=>[s(e(Ae),null,{default:a(()=>[s(e(Pe),{class:"text-destructive flex items-center gap-2"},{default:a(()=>[s(e(ge),{class:"h-5 w-5"}),t[29]||(t[29]=l(" Delete User Permanently? ",-1))]),_:1}),s(e(We),null,{default:a(()=>[t[30]||(t[30]=l(" This action cannot be undone. This will permanently delete ",-1)),p("span",he,_(n.value?.name),1),t[31]||(t[31]=l(" and remove all of their data, including projects, payments, and generated content. ",-1))]),_:1})]),_:1}),s(e(Ke),null,{default:a(()=>[s(e(Re),null,{default:a(()=>[...t[32]||(t[32]=[l("Cancel",-1)])]),_:1}),s(e(je),{onClick:re,class:"bg-destructive text-destructive-foreground hover:bg-destructive/90"},{default:a(()=>[...t[33]||(t[33]=[l(" Delete Permanently ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]),_:1}))}});export{xs as default};
