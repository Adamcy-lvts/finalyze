const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AISidebar-DoiIBopp.js","assets/app-Ny7D0hgf.js","assets/app-CHashLQN.css","assets/index-Bupl7fKY.js","assets/CardContent.vue_vue_type_script_setup_true_lang-DbElbaMI.js","assets/CardTitle.vue_vue_type_script_setup_true_lang-Dq8BmzX9.js","assets/CollapsibleTrigger.vue_vue_type_script_setup_true_lang-D9POI0Eo.js","assets/VisuallyHidden-DoBBZ7JS.js","assets/useForwardExpose-CZ3cENpG.js","assets/Separator.vue_vue_type_script_setup_true_lang-BpuKr2xG.js","assets/Separator-CrS0wYfY.js","assets/Progress.vue_vue_type_script_setup_true_lang-DnSd_kT2.js","assets/nullish-CHIgUVhi.js","assets/Sonner.vue_vue_type_script_setup_true_lang-DGsYSM7L.js","assets/DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-D3hJer-Q.js","assets/triangle-alert-VCE7VMiD.js","assets/circle-check-iPFL9NKt.js","assets/CitationHelper.vue_vue_type_script_setup_true_lang-C1EmNhjk.js","assets/index-Bz77OLxf.js","assets/Input.vue_vue_type_script_setup_true_lang-C1_Jxp-n.js","assets/ScrollArea.vue_vue_type_script_setup_true_lang-B0S9Ql21.js","assets/useNonce-DCn1xFIR.js","assets/AlertDialogTitle.vue_vue_type_script_setup_true_lang-C3mPq8vj.js","assets/RichTextEditor-DnPpxxFI.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/SafeHtmlText.vue_vue_type_script_setup_true_lang-BcLinGeQ.js","assets/index-BWEDi_FC.js","assets/step-DrZ9DcYd.js","assets/chart-column-jsfDJ3Ir.js","assets/calendar-Q9Fhzl6j.js","assets/brain-CClOm80q.js","assets/users-B7MB2cMl.js","assets/circle-alert-CX1ml_fa.js","assets/eye-BefDly4g.js","assets/check-TX6CFziN.js","assets/download-DnJOy4aC.js","assets/trash-2-Br1_2cOY.js","assets/DialogTitle.vue_vue_type_script_setup_true_lang-C80_BKsw.js","assets/DialogFooter.vue_vue_type_script_setup_true_lang-DdeSjYSa.js","assets/Label.vue_vue_type_script_setup_true_lang-w_yioNE1.js","assets/type-C2rQKPJU.js","assets/minus-C8djUSp8.js","assets/plus-CKqzs8ZG.js","assets/list-IvZ8VgNU.js","assets/RichTextEditor-DrYiwMFR.css","assets/chevron-down-DV2jaFc6.js","assets/wand-sparkles-BzBttf7m.js","assets/search-CSTRLq5p.js","assets/history-BZzoJ8NM.js","assets/zap-iWHWWpPm.js","assets/pen-tool-BY4zH7L2.js","assets/refresh-cw-wHunTBP4.js","assets/sparkles-BGkMBtaD.js","assets/AISidebar-Ymbz_oju.css","assets/ChapterNavigation-3lcG9VdX.js","assets/ChapterNavigation.vue_vue_type_script_setup_true_lang-YI3FDv7l.js","assets/DialogTrigger-BWnXhzZa.js","assets/chevron-right-RfvrqRkJ.js","assets/circle-check-big-CgE0szfF.js","assets/lock-soEsRdAR.js","assets/target-tRmqFzHb.js","assets/MobileNavOverlay-Bbhh7BGD.js","assets/index-ChAhZtzN.js","assets/DefensePreparationPanel.vue_vue_type_script_setup_true_lang-C4jEYxg0.js","assets/Switch.vue_vue_type_script_setup_true_lang-DHG-t4gK.js","assets/VisuallyHiddenInput-BsVdE9bx.js","assets/thumbs-up-DK68nk2t.js","assets/lightbulb-WBYGnoBC.js","assets/DataCollectionPanel.vue_vue_type_script_setup_true_lang-DbizK7ZG.js","assets/MobileNavOverlay-CN-XSdXy.css","assets/ChatModeLayout-DdxySux0.js","assets/ChatModeLayout.vue_vue_type_script_setup_true_lang-vZuK81d5.js","assets/square-Dn5l2_ng.js","assets/useTextHistory-BPPz7YuU.js","assets/Checkbox.vue_vue_type_script_setup_true_lang-DATP6oSV.js","assets/ohash.D__AXeF1-C-E83dC9.js","assets/RovingFocusItem-BoRi_45M.js","assets/file-text-DywEfGwH.js","assets/useTextHistory-BLZ3MaDD.css","assets/loader-jgpMyosF.js","assets/message-square-D6z6q-d2.js","assets/chevron-left-CMJScE2j.js","assets/clock-CQ0z0-AC.js","assets/user-DjD8DuHu.js","assets/save-DaGqZnXS.js","assets/ChatModeLayout-wjQGykpm.css","assets/CitationVerificationLayout-C22wT6ku.js","assets/DefensePreparationPanel-Df2zOvQG.js","assets/DataCollectionPanel-CROOQC1N.js"])))=>i.map(i=>d[i]);
import{ak as Aa,ab as $a,d as Mr,g as j,c as H,q as ie,o as _,u as r,w as i,k as n,f as a,s as $,n as ne,t as D,a as K,F as wr,A as br,X as ct,z as c,Q as Ee,C as be,y as V,j as qr,U as Ra,ad as Pa,h as bt,p as xt,al as Fe,x as Je,T as yt,am as _t,b as Xe,e as Ye,an as Le}from"./app-Ny7D0hgf.js";import{_ as Oe}from"./index-Bz77OLxf.js";import{c as Da,_ as G}from"./index-Bupl7fKY.js";import{_ as zt,a as It}from"./CardContent.vue_vue_type_script_setup_true_lang-DbElbaMI.js";import{_ as Wt,a as jr}from"./CardTitle.vue_vue_type_script_setup_true_lang-Dq8BmzX9.js";import{_ as Ma}from"./Input.vue_vue_type_script_setup_true_lang-C1_Jxp-n.js";import{_ as qa}from"./Label.vue_vue_type_script_setup_true_lang-w_yioNE1.js";import{_ as xr}from"./ScrollArea.vue_vue_type_script_setup_true_lang-B0S9Ql21.js";import{_ as Ce,a as ke,b as Se}from"./UserInfo.vue_vue_type_script_setup_true_lang-D9vmFaY8.js";import{u as ja,r as Ze,_ as Fa,a as La}from"./AppLayout.vue_vue_type_script_setup_true_lang-icyN3qHz.js";import{_ as yr}from"./SafeHtmlText.vue_vue_type_script_setup_true_lang-BcLinGeQ.js";import{t as m,M as _r,S as Cr}from"./Sonner.vue_vue_type_script_setup_true_lang-DGsYSM7L.js";import{_ as Oa}from"./PurchaseModal.vue_vue_type_script_setup_true_lang-NlXCK8Gb.js";import{_ as za}from"./Progress.vue_vue_type_script_setup_true_lang-DnSd_kT2.js";import{B as kt,u as Ia,M as kr,_ as Sr,R as Er,a as Wa,b as Na,P as Ua,c as Ga}from"./useTextHistory-BPPz7YuU.js";import{T as Ha}from"./trending-up-DHB6s68f.js";import{C as Ba}from"./circle-alert-CX1ml_fa.js";import{ap as Tr}from"./RichTextEditor-DnPpxxFI.js";import{t as Ar}from"./toNumber-DXe35ahk.js";import{A as Ka}from"./arrow-left-CVkqCFbo.js";import{B as it}from"./brain-CClOm80q.js";import{T as $r}from"./target-tRmqFzHb.js";import{E as Rr}from"./eye-BefDly4g.js";import{S as Pr}from"./save-DaGqZnXS.js";import{C as Lt}from"./circle-check-big-CgE0szfF.js";import{P as Va,a as Qa}from"./panel-left-open-uqq5oXIl.js";import{M as Ja}from"./message-square-D6z6q-d2.js";import{_ as Xa}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useForwardExpose-CZ3cENpG.js";import"./VisuallyHidden-DoBBZ7JS.js";import"./useNonce-DCn1xFIR.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-D3hJer-Q.js";import"./coins-Bhpph8wy.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Bi6T1S47.js";import"./plus-CKqzs8ZG.js";import"./chevron-right-RfvrqRkJ.js";import"./triangle-alert-VCE7VMiD.js";import"./circle-check-iPFL9NKt.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-C80_BKsw.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-DdeSjYSa.js";import"./sparkles-BGkMBtaD.js";import"./arrow-right-Cp7XKu1P.js";import"./nullish-CHIgUVhi.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-DATP6oSV.js";import"./ohash.D__AXeF1-C-E83dC9.js";import"./VisuallyHiddenInput-BsVdE9bx.js";import"./RovingFocusItem-BoRi_45M.js";import"./minus-C8djUSp8.js";import"./check-TX6CFziN.js";import"./Separator.vue_vue_type_script_setup_true_lang-BpuKr2xG.js";import"./Separator-CrS0wYfY.js";import"./download-DnJOy4aC.js";import"./chevron-down-DV2jaFc6.js";import"./file-text-DywEfGwH.js";import"./index-BWEDi_FC.js";import"./step-DrZ9DcYd.js";import"./chart-column-jsfDJ3Ir.js";import"./calendar-Q9Fhzl6j.js";import"./users-B7MB2cMl.js";import"./trash-2-Br1_2cOY.js";import"./type-C2rQKPJU.js";import"./list-IvZ8VgNU.js";var Ot=function(){return Aa.Date.now()},Ya="Expected a function",Za=Math.max,eo=Math.min;function to(O,g,S){var F,f,u,w,p,s,q=0,N=!1,v=!1,z=!0;if(typeof O!="function")throw new TypeError(Ya);g=Ar(g)||0,$a(S)&&(N=!!S.leading,v="maxWait"in S,u=v?Za(Ar(S.maxWait)||0,g):u,z="trailing"in S?!!S.trailing:z);function h(W){var k=F,re=f;return F=f=void 0,q=W,w=O.apply(re,k),w}function R(W){return q=W,p=setTimeout(te,g),N?h(W):w}function Q(W){var k=W-s,re=W-q,ce=g-k;return v?eo(ce,u-re):ce}function me(W){var k=W-s,re=W-q;return s===void 0||k>=g||k<0||v&&re>=u}function te(){var W=Ot();if(me(W))return J(W);p=setTimeout(te,Q(W))}function J(W){return p=void 0,z&&F?h(W):(F=f=void 0,w)}function X(){p!==void 0&&clearTimeout(p),q=0,F=s=f=p=void 0}function se(){return p===void 0?w:J(Ot())}function ve(){var W=Ot(),k=me(W);if(F=arguments,f=this,s=W,k){if(p===void 0)return R(s);if(v)return clearTimeout(p),p=setTimeout(te,g),h(s)}return p===void 0&&(p=setTimeout(te,g)),w}return ve.cancel=X,ve.flush=se,ve}/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=Da("PenIcon",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),ao={class:"flex items-center justify-between mb-3"},oo={class:"flex items-center gap-3"},no={class:"p-2 rounded-lg bg-blue-500/10"},so={class:"text-right"},lo={class:"space-y-2"},io={class:"flex justify-between items-center text-xs"},co={class:"relative"},uo={key:0},po={class:"space-y-3"},go={class:"flex-1"},vo={class:"text-sm font-medium"},ho={class:"text-xs text-muted-foreground"},fo={class:"w-20 h-2 bg-muted rounded-full overflow-hidden ml-3"},mo={key:1},wo={class:"space-y-2"},bo={class:"flex-1"},xo={class:"text-sm font-medium"},yo={class:"text-xs text-muted-foreground"},_o={key:2,class:"flex items-center justify-center gap-3 p-4 rounded-lg bg-blue-50/50 border border-blue-200/50"},Co={key:3,class:"text-center p-4 rounded-lg bg-muted/30"},Dr=Mr({__name:"WritingStatistics",props:{showStatistics:{type:Boolean},currentWordCount:{},writingStats:{},qualityAnalysis:{},isAnalyzing:{type:Boolean}},setup(O){const g=O;j(()=>{if(!g.qualityAnalysis?.quality_level)return"text-muted-foreground";switch(g.qualityAnalysis.quality_level){case"Excellent":return"text-green-600";case"Good":return"text-blue-600";case"Satisfactory":return"text-yellow-600";case"Needs Improvement":return"text-orange-600";case"Poor":return"text-red-600";default:return"text-muted-foreground"}});const S=j(()=>g.qualityAnalysis?.scores?Object.entries(g.qualityAnalysis.scores).filter(([,f])=>f.max>0).filter(([,f])=>f.percentage<75).sort(([,f],[,u])=>f.percentage-u.percentage).map(([f,u])=>({category:f.replace(" & "," & "),percentage:Math.round(u.percentage),score:u.score,max:u.max,status:u.percentage<40?"poor":u.percentage<60?"needs-work":"fair"})):[]),F=j(()=>{const f=g.qualityAnalysis?.total_score||0;return f>=80?{text:"Excellent",color:"text-green-600",bgColor:"bg-green-50"}:f>=70?{text:"Satisfactory",color:"text-yellow-600",bgColor:"bg-yellow-50"}:f>=60?{text:"Needs Work",color:"text-orange-600",bgColor:"bg-orange-50"}:{text:"Poor",color:"text-red-600",bgColor:"bg-red-50"}});return(f,u)=>f.showStatistics?(_(),H(r(zt),{key:0,class:"border border-border/50 bg-gradient-to-br from-card/80 to-card/60 backdrop-blur-sm shadow-lg"},{default:i(()=>[f.qualityAnalysis?(_(),H(r(Wt),{key:0,class:"pb-4 border-b border-border/50"},{default:i(()=>[a("div",ao,[a("div",oo,[a("div",no,[n(r(kt),{class:"h-4 w-4 text-blue-600"})]),a("div",null,[n(r(jr),{class:"text-sm font-semibold"},{default:i(()=>[...u[0]||(u[0]=[$("Academic Quality",-1)])]),_:1}),u[1]||(u[1]=a("p",{class:"text-xs text-muted-foreground"},"AI-powered analysis",-1))])]),a("div",so,[a("div",{class:ne(["text-2xl font-bold",F.value.color])},[$(D(f.qualityAnalysis.total_score),1),u[2]||(u[2]=a("span",{class:"text-sm text-muted-foreground"},"/100",-1))],2),n(r(Oe),{class:ne([[F.value.color,F.value.bgColor],"text-xs font-medium"]),variant:"outline"},{default:i(()=>[$(D(F.value.text),1)]),_:1},8,["class"])])]),a("div",lo,[a("div",io,[u[3]||(u[3]=a("span",{class:"text-muted-foreground"},"Overall Score",-1)),a("span",{class:ne(["font-medium",f.qualityAnalysis.meets_threshold?"text-green-600":"text-orange-600"])},D(f.qualityAnalysis.meets_threshold?"Meets threshold âœ“":"Below 80% threshold"),3)]),a("div",co,[n(r(za),{"model-value":Math.round(f.qualityAnalysis.total_score||0),class:ne(["h-2",{"[&>[data-slot=progress-indicator]]:bg-green-500":(f.qualityAnalysis.total_score||0)>=80,"[&>[data-slot=progress-indicator]]:bg-yellow-500":(f.qualityAnalysis.total_score||0)>=70&&(f.qualityAnalysis.total_score||0)<80,"[&>[data-slot=progress-indicator]]:bg-orange-500":(f.qualityAnalysis.total_score||0)>=60&&(f.qualityAnalysis.total_score||0)<70,"[&>[data-slot=progress-indicator]]:bg-red-500":(f.qualityAnalysis.total_score||0)<60}])},null,8,["model-value","class"]),u[4]||(u[4]=a("div",{class:"absolute inset-0 flex items-center justify-center"},[a("div",{class:"w-0.5 h-4 bg-orange-400/60 rounded-full",style:{"margin-left":"80%"}})],-1))])])]),_:1})):ie("",!0),n(r(It),{class:"p-4 space-y-4"},{default:i(()=>[f.qualityAnalysis?.scores?(_(),K("div",uo,[u[5]||(u[5]=a("h4",{class:"text-xs font-semibold text-muted-foreground mb-3 flex items-center gap-2"},[a("div",{class:"w-1 h-4 bg-green-500 rounded-full"}),$(" Analysis Results ")],-1)),a("div",po,[(_(!0),K(wr,null,br(Object.entries(f.qualityAnalysis.scores).filter(([,w])=>w.max>0),([w,p])=>(_(),K("div",{key:w,class:"flex items-center justify-between p-3 rounded-lg bg-muted/30 hover:bg-muted/40 transition-colors"},[a("div",go,[a("div",vo,D(w),1),a("div",ho,[$(D(p.score)+"/"+D(p.max)+" points ",1),a("span",{class:ne(["ml-1",{"text-red-500":p.percentage<50,"text-orange-500":p.percentage>=50&&p.percentage<75,"text-blue-500":p.percentage>=75&&p.percentage<90,"text-green-500":p.percentage>=90}])}," ("+D(Math.round(p.percentage))+"%) ",3)])]),a("div",fo,[a("div",{class:ne(["h-full transition-all duration-500 rounded-full",{"bg-red-500":p.percentage<50,"bg-orange-500":p.percentage>=50&&p.percentage<75,"bg-blue-500":p.percentage>=75&&p.percentage<90,"bg-green-500":p.percentage>=90}]),style:ct({width:`${p.percentage}%`})},null,6)])]))),128))])])):ie("",!0),S.value.length>0?(_(),K("div",mo,[u[6]||(u[6]=a("h4",{class:"text-xs font-semibold text-muted-foreground mb-3 flex items-center gap-2"},[a("div",{class:"w-1 h-4 bg-orange-500 rounded-full"}),$(" Focus Areas ")],-1)),a("div",wo,[(_(!0),K(wr,null,br(S.value,w=>(_(),K("div",{key:w.category,class:"flex items-center gap-3 p-3 rounded-lg border border-orange-200/50 bg-orange-50/30"},[n(r(Ba),{class:"h-4 w-4 text-orange-500 flex-shrink-0"}),a("div",bo,[a("div",xo,D(w.category),1),a("div",yo,[$(D(w.score)+"/"+D(w.max)+" points - ",1),a("span",{class:ne({"text-red-600":w.status==="poor","text-orange-600":w.status==="needs-work","text-yellow-600":w.status==="fair"})},D(w.status==="poor"?"needs significant improvement":w.status==="needs-work"?"needs improvement":"fair, could be better"),3)])])]))),128))])])):ie("",!0),f.isAnalyzing?(_(),K("div",_o,[n(r(Ha),{class:"h-4 w-4 text-blue-500 animate-pulse"}),u[7]||(u[7]=a("span",{class:"text-sm text-blue-700 font-medium"},"Analyzing academic quality with AI...",-1))])):ie("",!0),!f.qualityAnalysis&&!f.isAnalyzing?(_(),K("div",Co,[n(r(kt),{class:"h-8 w-8 text-muted-foreground mx-auto mb-2"}),u[8]||(u[8]=a("p",{class:"text-sm text-muted-foreground"},'Click "Analyze" to get AI-powered quality insights',-1))])):ie("",!0)]),_:1})]),_:1})):ie("",!0)}});function ko(O){const{delay:g=1e4,onSave:S}=O,F=c(!1),f=c(!1),u=c(null),w=()=>{F.value=!0,u.value&&clearTimeout(u.value),u.value=setTimeout(()=>{p(!0)},g)},p=async(q=!1)=>{if(!f.value){f.value=!0;try{await S(q),F.value=!1,u.value&&(clearTimeout(u.value),u.value=null)}finally{f.value=!1}}};return{hasUnsavedChanges:F,isSaving:f,triggerAutoSave:w,save:p,clearAutoSave:()=>{u.value&&(clearTimeout(u.value),u.value=null)}}}function So(O){const g=c({sentences:0,paragraphs:0,readingTime:0,avgWordLength:0,uniqueWords:0,commonWords:[]}),S=j(()=>O.value?O.value.split(/\s+/).filter(u=>u.length>0).length:0),F=()=>{if(!O.value){g.value={sentences:0,paragraphs:0,readingTime:0,avgWordLength:0,uniqueWords:0,commonWords:[]};return}const u=O.value,w=u.split(/\s+/).filter(z=>z.length>0),p=u.split(/[.!?]+/).filter(z=>z.trim().length>0),s=u.split(`

`).filter(z=>z.trim().length>0),q=new Map;w.forEach(z=>{const h=z.toLowerCase().replace(/[^a-z0-9]/g,"");h&&q.set(h,(q.get(h)||0)+1)});const N=new Set(["the","a","an","and","or","but","in","on","at","to","for","of","with","by","is","was","are","were"]),v=Array.from(q.entries()).filter(([z])=>!N.has(z)).sort((z,h)=>h[1]-z[1]).slice(0,5).map(([z])=>z);g.value={sentences:p.length,paragraphs:s.length,readingTime:Math.ceil(w.length/200),avgWordLength:w.reduce((z,h)=>z+h.length,0)/w.length,uniqueWords:q.size,commonWords:v}},f=j(()=>{if(!O.value)return 0;let u=0;const w=O.value;w.includes("##")&&(u+=20),w.length>1e3&&(u+=20),w.match(/\[.*?\]/g)&&(u+=15),(w.includes("**")||w.includes("*"))&&(u+=10);const p=w.split(/[.!?]+/).filter(q=>q.trim().length>0);if(p.length>0){const q=p.reduce((N,v)=>N+v.split(/\s+/).length,0)/p.length;q>10&&q<25&&(u+=20)}return w.split(`

`).filter(q=>q.trim().length>0).length>3&&(u+=15),Math.min(u,100)});return{writingStats:g,currentWordCount:S,writingQualityScore:f,calculateWritingStats:F}}function Eo(O,g=c(3e3),S=.8){const F=C=>{if(!C)return 0;const E=C.replace(/<[^>]*>/g,"").trim().replace(/\s+/g," ");if(!E)return 0;const x=E.match(/\b\w+\b/g);return x?x.length:0},f=C=>C?C.replace(/<[^>]*>/g,"").replace(/\r\n|\r/g,`
`).trim().split(/\n\s*\n/).filter(y=>y.trim().length>0).length:0,u=C=>{if(!C)return 0;const E=C.replace(/<[^>]*>/g,"").match(/[.!?]+/g);return E?E.length:0},w=C=>Math.round(C/200*10)/10,p=j(()=>F(O.value)),s=j(()=>O.value.length),q=j(()=>O.value.replace(/\s/g,"").length),N=j(()=>f(O.value)),v=j(()=>u(O.value)),z=j(()=>w(p.value)),h=j(()=>{const C=g.value;return!C||C<=0?0:Math.min(p.value/C*100,100)}),R=j(()=>p.value>=g.value*S),Q=j(()=>{const C=g.value-p.value;return Math.max(C,0)}),me=j(()=>{const C=g.value*S-p.value;return Math.max(C,0)}),te=j(()=>({wordCount:p.value,characterCount:s.value,characterCountNoSpaces:q.value,paragraphCount:N.value,sentenceCount:v.value,readingTimeMinutes:z.value})),J=j(()=>({current:p.value,target:g.value,percentage:h.value,isComplete:R.value,completionThreshold:S})),X=C=>C>=1e3?`${Math.round(C/100)/10}k`:C.toString(),se=(C=0)=>`${Math.round(h.value*Math.pow(10,C))/Math.pow(10,C)}%`,ve=()=>`${p.value} / ${g.value} words (${se()}%)`,W=()=>{if(R.value)return`âœ… Complete (${X(p.value)} words)`;const C=me.value;return`${X(C)} more words to complete`},k=()=>{const C=p.value,ae=g.value;return C===0?"empty":C<ae*.25?"started":C<ae*.75?"progressing":C<ae*S?"near_complete":C<ae?"complete":"exceeded"},re=()=>{const C=k();return{empty:"text-gray-500",started:"text-blue-500",progressing:"text-yellow-500",near_complete:"text-orange-500",complete:"text-green-500",exceeded:"text-emerald-600"}[C]},ce=()=>{const C=k();return{empty:"bg-gray-200",started:"bg-blue-200",progressing:"bg-yellow-200",near_complete:"bg-orange-200",complete:"bg-green-200",exceeded:"bg-emerald-200"}[C]},he=800,ut=j(()=>p.value>=he),ze=j(()=>Math.max(he-p.value,0)),Ie=j(()=>Math.min(p.value/he*100,100));return{currentWordCount:p,characterCount:s,characterCountNoSpaces:q,paragraphCount:N,sentenceCount:v,readingTimeMinutes:z,progressPercentage:h,isComplete:R,wordsRemaining:Q,wordsToComplete:me,wordCountStats:te,wordCountProgress:J,meetsDefenseThreshold:ut,defenseWordsRemaining:ze,defenseProgressPercentage:Ie,DEFENSE_THRESHOLD:he,formatWordCount:X,formatProgress:se,getProgressDisplay:ve,getCompletionDisplay:W,getWordCountStatus:k,getStatusColor:re,getProgressBarColor:ce,countWords:F}}function To(O,g,S,F){const u=c(!1),w=c(0),p=c(!1),s=k=>{if(!k)return 0;const ce=k.replace(/<[^>]*>/g,"").trim().replace(/\s+/g," ");if(!ce)return 0;const he=ce.match(/\b\w+\b/g);return he?he.length:0},q=j(()=>s(S.value)),N=j(()=>q.value>=800),v=()=>`defense_generation_triggered_${O.id}_ch_${g.chapter_number}`,z=()=>{const k=v();return localStorage.getItem(k)==="true"},h=()=>{const k=v();localStorage.setItem(k,"true"),u.value=!0},R=()=>{const k=v();localStorage.removeItem(k),u.value=!1,console.log(`ðŸ”„ DEFENSE WATCHER: Reset generation trigger for Chapter ${g.chapter_number}`)},Q=to(async()=>{if(!p.value)return;const k=q.value;console.log(`ðŸ“Š DEFENSE WATCHER: Word count check - Chapter ${g.chapter_number}: ${k} words`),k<800*.8&&u.value&&(console.log("â¬‡ï¸ DEFENSE WATCHER: Content dropped below 80% of threshold, resetting trigger"),R()),w.value=k},2e3),me=()=>p.value?void 0:(p.value=!0,u.value=z(),w.value=q.value,console.log(`ðŸ‘€ DEFENSE WATCHER: Started watching Chapter ${g.chapter_number}`),console.log(`   Initial word count: ${w.value}`),console.log(`   Generation already triggered: ${u.value}`),console.log("   Threshold: 800 words"),Ee(S,(re,ce)=>{re!==ce&&Q()},{immediate:!1})),te=()=>{p.value=!1,Q.cancel(),console.log(`ðŸ›‘ DEFENSE WATCHER: Stopped watching Chapter ${g.chapter_number}`)},J=async()=>{console.log(`ðŸ” DEFENSE WATCHER: Force checking Chapter ${g.chapter_number}`),await Q(),Q.flush()},X=j(()=>{const k=q.value;return k>0&&k<800&&!u.value}),se=j(()=>{const k=q.value/800*100;return Math.min(k,100)}),ve=j(()=>{const k=800-q.value;return Math.max(k,0)});return{isWatching:p,hasTriggeredGeneration:u,currentWordCount:q,lastWordCount:w,meetsThreshold:N,shouldShowProgressIndicator:X,progressPercentage:se,wordsRemaining:ve,startWatching:me,stopWatching:te,forceCheck:J,resetGenerationTrigger:R,markGenerationTriggered:h,getStatusMessage:()=>{const k=q.value;return u.value?`Defense questions available (${k} words)`:k>=800?`Ready for defense questions (${k} words)`:k>0?`${800-k} more words needed for defense questions`:"Start writing to enable defense questions (800 words needed)"},countWords:s,DEFENSE_WORD_COUNT_THRESHOLD:800}}function Ao(O){const g=c(!1),S=c(null),F=c([]),f=c(null),u=j(()=>{if(!S.value?.quality_level)return"text-muted-foreground";switch(S.value.quality_level){case"Excellent":return"text-green-600";case"Good":return"text-blue-600";case"Satisfactory":return"text-yellow-600";case"Needs Improvement":return"text-orange-600";case"Poor":return"text-red-600";default:return"text-muted-foreground"}}),w=j(()=>S.value?.scores?Object.entries(S.value.scores).sort(([,h],[,R])=>h.percentage-R.percentage).slice(0,3).map(([h,R])=>({category:h.replace(" & "," & "),percentage:Math.round(R.percentage),score:R.score,max:R.max})):[]),p=async()=>{try{g.value=!0,f.value=null,await be.get("/sanctum/csrf-cookie");const h=await be.post(V("api.chapters.analysis.analyze",{chapter:O}));if(h.data.success)return S.value=h.data.analysis,h.data.analysis;throw new Error(h.data.error||"Analysis failed")}catch(h){return f.value=h.response?.data?.error||h.message||"Analysis failed",console.error("Chapter analysis failed:",h),null}finally{g.value=!1}};return{isAnalyzing:g,latestAnalysis:S,analysisHistory:F,error:f,qualityLevelColor:u,topImprovementAreas:w,analyzeChapter:p,getLatestAnalysis:async()=>{try{await be.get("/sanctum/csrf-cookie");const h=await be.get(V("api.chapters.analysis.latest",{chapter:O}));return h.data.success?(S.value=h.data.analysis,h.data.analysis):(S.value=null,null)}catch(h){return h.response?.status!==404&&(f.value=h.response?.data?.error||h.message||"Failed to get analysis",console.error("Failed to get latest analysis:",h)),null}},getAnalysisHistory:async()=>{try{await be.get("/sanctum/csrf-cookie");const h=await be.get(V("api.chapters.analysis.history",{chapter:O}));if(h.data.success)return F.value=h.data.analyses,h.data.analyses;throw new Error(h.data.error||"Failed to get history")}catch(h){return f.value=h.response?.data?.error||h.message||"Failed to get analysis history",console.error("Failed to get analysis history:",h),[]}},autoAnalyze:async(h,R=500)=>{h>=R&&await p()},getScoreColor:(h,R)=>{const Q=h/R*100;return Q>=80?"text-green-600":Q>=70?"text-blue-600":Q>=60?"text-yellow-600":Q>=40?"text-orange-600":"text-red-600"},getProgressVariant:h=>h>=80?"success":h>=60?"default":"destructive"}}const $o={userScrollTimeout:2e3,scrollBehavior:"smooth",bottomThreshold:100};class Ro{scrollContainer=null;isUserScrolling=!1;userScrollTimeout=null;isEnabled=!0;isDestroyed=!1;config;wasAtBottom=!0;rafId=null;handleWheel;handleTouchStart;handleTouchMove;handleScroll;handleKeydown;constructor(g={}){this.config={...$o,...g},this.handleWheel=this.onUserScroll.bind(this),this.handleTouchStart=this.onUserScroll.bind(this),this.handleTouchMove=this.onUserScroll.bind(this),this.handleScroll=this.onScroll.bind(this),this.handleKeydown=this.onKeydown.bind(this)}attach(g){this.isDestroyed||(this.detach(),this.scrollContainer=g,this.setupEventListeners(),this.wasAtBottom=this.isAtBottom())}detach(){this.scrollContainer&&(this.scrollContainer.removeEventListener("wheel",this.handleWheel),this.scrollContainer.removeEventListener("touchstart",this.handleTouchStart),this.scrollContainer.removeEventListener("touchmove",this.handleTouchMove),this.scrollContainer.removeEventListener("scroll",this.handleScroll),this.scrollContainer.removeEventListener("keydown",this.handleKeydown)),this.userScrollTimeout&&(clearTimeout(this.userScrollTimeout),this.userScrollTimeout=null),this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=null),this.scrollContainer=null}setupEventListeners(){this.scrollContainer&&(this.scrollContainer.addEventListener("wheel",this.handleWheel,{passive:!0}),this.scrollContainer.addEventListener("touchstart",this.handleTouchStart,{passive:!0}),this.scrollContainer.addEventListener("touchmove",this.handleTouchMove,{passive:!0}),this.scrollContainer.addEventListener("scroll",this.handleScroll,{passive:!0}),this.scrollContainer.addEventListener("keydown",this.handleKeydown))}onUserScroll(){this.isEnabled&&(this.isUserScrolling=!0,this.userScrollTimeout&&clearTimeout(this.userScrollTimeout),this.userScrollTimeout=setTimeout(()=>{this.isUserScrolling=!1,this.isAtBottom()&&(this.wasAtBottom=!0)},this.config.userScrollTimeout))}onScroll(){this.wasAtBottom=this.isAtBottom()}onKeydown(g){["ArrowUp","ArrowDown","PageUp","PageDown","Home","End"].includes(g.key)&&this.onUserScroll()}isAtBottom(){if(!this.scrollContainer)return!0;const{scrollTop:g,scrollHeight:S,clientHeight:F}=this.scrollContainer;return S-g-F<=this.config.bottomThreshold}scrollToBottom(){!this.scrollContainer||!this.isEnabled||this.isDestroyed||this.isUserScrolling||!this.wasAtBottom||(this.rafId&&cancelAnimationFrame(this.rafId),this.rafId=requestAnimationFrame(()=>{if(this.rafId=null,!this.scrollContainer||this.isDestroyed)return;const g=this.scrollContainer.scrollHeight-this.scrollContainer.clientHeight;this.config.scrollBehavior==="instant"?this.scrollContainer.scrollTop=g:this.scrollContainer.scrollTo({top:g,behavior:"smooth"}),this.wasAtBottom=!0}))}forceScrollToBottom(){!this.scrollContainer||this.isDestroyed||(this.isUserScrolling=!1,this.wasAtBottom=!0,this.userScrollTimeout&&(clearTimeout(this.userScrollTimeout),this.userScrollTimeout=null),this.scrollToBottom())}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}isAutoScrollActive(){return this.isEnabled&&!this.isUserScrolling&&this.wasAtBottom}isUserScrollingNow(){return this.isUserScrolling}reset(){this.isUserScrolling=!1,this.wasAtBottom=!0,this.userScrollTimeout&&(clearTimeout(this.userScrollTimeout),this.userScrollTimeout=null)}destroy(){this.isDestroyed=!0,this.detach()}}function Po(O={}){const g=new Ro(O),S=c(!0),F=c(!1);let f=null;function u(R){R?(g.attach(R),p()):(g.detach(),s())}function w(R){Ee(R,Q=>{u(Q)},{immediate:!0})}function p(){s(),f=setInterval(()=>{S.value=g.isAutoScrollActive(),F.value=g.isUserScrollingNow()},100)}function s(){f&&(clearInterval(f),f=null)}function q(){g.scrollToBottom()}function N(){g.forceScrollToBottom()}function v(){g.enable()}function z(){g.disable()}function h(){g.reset(),S.value=!0,F.value=!1}return qr(()=>{s(),g.destroy()}),{attach:u,attachRef:w,scrollToBottom:q,forceScrollToBottom:N,enable:v,disable:z,reset:h,isAutoScrollActive:S,isUserScrolling:F}}const Do={class:"relative z-20 flex flex-shrink-0 items-center justify-between border-b border-border/40 bg-background/60 p-4 backdrop-blur-xl supports-[backdrop-filter]:bg-background/40 transition-all duration-300"},Mo={class:"flex items-center gap-5"},qo={class:"flex flex-col"},jo={class:"flex items-center gap-3 text-xs text-muted-foreground"},Fo={class:"flex items-center gap-1.5"},Lo={class:"flex items-center gap-4"},Oo={class:"flex items-center p-1 rounded-full border border-border/40 bg-background/50 backdrop-blur-sm shadow-sm"},zo={class:"flex items-center gap-2"},Io={class:"relative z-20 h-[2px] w-full bg-border/20"},Wo={key:0,class:"mx-3 my-2"},No={class:"relative overflow-hidden rounded-xl border border-blue-200 bg-gradient-to-br from-blue-50 to-purple-50 p-3 shadow-sm dark:border-blue-800 dark:from-blue-950/30 dark:to-purple-950/30"},Uo={class:"relative z-10 mb-2 flex items-center justify-between"},Go={class:"flex items-center gap-2"},Ho={class:"relative"},Bo={class:"flex h-6 w-6 items-center justify-center rounded-full bg-gradient-to-br from-blue-500 to-purple-600"},Ko={class:"text-xs text-blue-700 dark:text-blue-300"},Vo={class:"relative z-10 mb-2"},Qo={class:"mb-1 flex items-center justify-between"},Jo={class:"text-xs text-blue-600 dark:text-blue-400"},Xo={class:"relative h-2 overflow-hidden rounded-full bg-blue-100 dark:bg-blue-900/50"},Yo={class:"relative z-10 flex items-center gap-2"},Zo={class:"flex-shrink-0"},en={key:0,class:"h-2 w-2 animate-bounce rounded-full bg-blue-500"},tn={key:1,class:"flex gap-0.5"},rn={key:2,class:"h-2 w-2 animate-spin rounded-full border-2 border-blue-500 border-t-transparent"},an={key:3,class:"h-2 w-2 rounded-full bg-green-500"},on={key:4,class:"h-2 w-2 rounded-full bg-red-500"},nn={class:"flex-1 text-xs text-blue-800 dark:text-blue-200"},sn={class:"relative z-10 flex flex-1 overflow-hidden"},ln={key:0,class:"w-[320px] flex-shrink-0 border-r border-border/50 bg-background/80 backdrop-blur-xl shadow-xl z-20"},cn={class:"h-full overflow-y-auto custom-scrollbar"},un={class:"p-4"},dn={class:"mb-3"},pn={class:"text-xs text-muted-foreground"},gn={class:"flex min-h-0 flex-1 flex-col bg-transparent relative"},vn={class:"flex-1 overflow-hidden relative"},hn={class:"absolute inset-0 overflow-y-auto custom-scrollbar flex flex-col items-center py-8 px-4 sm:px-8"},fn={class:"flex items-center justify-between"},mn={class:"space-y-1"},wn={class:"flex items-center gap-2"},bn={class:"flex items-center justify-between px-6 py-2 border-b border-border/30 bg-muted/5"},xn={class:"flex items-center gap-2"},yn={class:"space-y-1 relative z-10"},_n={class:"text-sm font-medium text-foreground"},Cn={class:"text-[10px] text-muted-foreground line-clamp-2 leading-relaxed"},kn={class:"flex-1 relative bg-background"},Sn={class:"px-12 py-10 min-h-[500px]"},En={class:"sticky bottom-0 z-10 border-t border-border/30 bg-background/80 backdrop-blur-md p-4 flex items-center justify-between"},Tn={class:"text-xs text-muted-foreground"},An={class:"flex items-center gap-2"},$n={key:0,class:"w-72 flex-shrink-0 border-l border-border/40 bg-background/40 backdrop-blur-md"},Rn={class:"h-full overflow-y-auto custom-scrollbar"},Pn={class:"space-y-6 p-4"},Dn={class:"flex h-full w-full overflow-hidden relative"},Mn={class:"hidden lg:flex w-80 flex-col border-r border-border/40 bg-background/60 backdrop-blur-xl z-20 transition-all duration-300"},qn={class:"h-14 flex items-center justify-between px-4 border-b border-border/40 shrink-0"},jn={class:"p-4"},Fn={class:"flex-1 flex flex-col relative z-10 min-w-0 bg-background/30 dark:bg-background transition-all duration-300"},Ln={class:"min-h-[5.5rem] flex flex-shrink-0 items-center justify-between border-b border-border/40 bg-background/60 backdrop-blur-md px-4 py-2 relative z-30 transition-all duration-300"},On={class:"flex items-center gap-4 flex-1"},zn={class:"flex items-center gap-2 flex-shrink-0 h-full self-start mt-1"},In={class:"flex flex-col gap-1.5 flex-1 min-w-0"},Wn={class:"flex items-start gap-3 w-full"},Nn={class:"flex items-center gap-2 flex-wrap"},Un={class:"flex items-center bg-background/50 rounded-md border border-border/50 p-0.5 mr-2 backdrop-blur-sm hidden sm:flex"},Gn={class:"flex items-center self-start mt-1 ml-2"},Hn={class:"flex-1 overflow-hidden relative group bg-background/20"},Bn={key:0,class:"absolute top-6 left-0 right-0 z-40 px-4 flex justify-center pointer-events-none"},Kn={class:"w-full max-w-lg pointer-events-auto"},Vn={class:"relative overflow-hidden rounded-xl border border-blue-200 bg-gradient-to-br from-blue-50/95 to-purple-50/95 p-3 shadow-lg backdrop-blur-lg dark:border-blue-800 dark:from-blue-950/90 dark:to-purple-950/90"},Qn={class:"flex items-center gap-3"},Jn={class:"relative flex h-8 w-8 items-center justify-center rounded-full bg-gradient-to-br from-blue-500 to-purple-600 shadow-md"},Xn={class:"flex-1 min-w-0"},Yn={class:"flex items-center justify-between mb-1"},Zn={class:"text-xs font-mono text-muted-foreground"},es={class:"h-1.5 w-full bg-blue-100 dark:bg-blue-900/40 rounded-full overflow-hidden"},ts={class:"mt-2 text-xs text-muted-foreground ml-11 truncate"},rs={class:"max-w-[850px] mx-auto py-12 px-6 sm:px-10 min-h-full"},as={class:"min-h-[600px] pb-32"},os={class:"pb-32"},ns={class:"h-7 border-t border-border/30 bg-background/40 backdrop-blur-sm flex items-center justify-between px-4 text-[10px] text-muted-foreground shrink-0"},ss={class:"flex items-center gap-3"},ls={class:"hidden sm:inline"},is={class:"flex items-center gap-2"},cs={key:0,class:"text-green-500 flex items-center gap-1 ml-2"},us={class:"hidden lg:flex w-96 flex-col border-l border-border/40 bg-background/60 backdrop-blur-xl z-20 transition-all duration-300"},ds={class:"h-14 flex items-center justify-between px-4 border-b border-border/40 shrink-0"},ps={class:"flex-1 overflow-y-auto custom-scrollbar"},gs={class:"p-4 space-y-6"},vs={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},hs={class:"text-slate-600 dark:text-slate-300 mb-4"},fs={class:"font-semibold text-amber-600 dark:text-amber-400"},ms={class:"flex flex-col sm:flex-row gap-3"},Ct=3,ws=1e3,bs=Mr({__name:"ChapterEditor",props:{project:{},chapter:{},allChapters:{},facultyChapters:{},mode:{}},setup(O){const g=Fe(()=>Le(()=>import("./AISidebar-DoiIBopp.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53]))),S=Fe(()=>Le(()=>import("./ChapterNavigation-3lcG9VdX.js"),__vite__mapDeps([54,55,3,1,2,20,7,8,21,22,14,56,18,13,15,16,42,57,58,59,60,36]))),F=Fe(()=>Le(()=>import("./MobileNavOverlay-Bbhh7BGD.js"),__vite__mapDeps([61,1,2,62,3,0,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,55,56,57,58,59,60,63,64,65,66,67,68,69]))),f=Fe(()=>Le(()=>import("./ChatModeLayout-DdxySux0.js"),__vite__mapDeps([70,71,1,2,18,3,8,4,11,7,12,20,21,23,24,25,26,27,28,29,30,31,32,33,34,35,36,14,37,38,19,39,40,41,42,43,44,72,73,74,75,65,76,9,10,13,15,16,45,77,78,62,79,47,80,81,57,82,50,66,60,49,52,58,83,84,85]))),u=Fe(()=>Le(()=>import("./CitationVerificationLayout-C22wT6ku.js"),__vite__mapDeps([86,18,3,1,2,8,4,5,11,7,12,20,21,25,73,23,24,26,27,28,29,30,31,32,33,34,35,36,14,37,38,19,39,40,41,42,43,44,74,75,65,76,9,10,13,15,16,45,77,78,79,58]))),w=Fe(()=>Le(()=>import("./DefensePreparationPanel-Df2zOvQG.js"),__vite__mapDeps([87,63,1,2,62,3,18,8,4,5,6,7,11,12,20,21,9,10,64,65,45,66,67,46,51,35,14,32]))),p=Fe(()=>Le(()=>import("./DataCollectionPanel-CROOQC1N.js"),__vite__mapDeps([88,68,1,2,13,3,14,8,7,15,16]))),s=O,q=Ra();Ee(()=>q.props?.flash,t=>{t&&(t.success&&m.success(t.success),t.error&&m.error(t.error))},{deep:!0,immediate:!0});const N=c(s.chapter.title||""),v=c(s.chapter.content||""),z=c(!0),{isDark:h}=Pa(),R=c(!1),Q=()=>{const t=localStorage.getItem(`chapter_theme_${s.project.id}`);t?R.value=t==="dark":R.value=h.value},me=()=>{R.value=!R.value;const t=R.value?"dark":"light";localStorage.setItem(`chapter_theme_${s.project.id}`,t),m.success(`Switched to ${R.value?"Dark":"Light"} Mode`)},te=c(!1);c(!1);const J=c(!1);c("write");const X=c("");c(0);const se=c(!1),ve=c(!1),W=c(!0),k=()=>{try{return localStorage.getItem(`chatMode_${s.project.id}_${s.chapter.chapter_number}`)==="true"}catch(t){return console.warn("Failed to load chat mode from localStorage:",t),!1}},re=t=>{try{localStorage.setItem(`chatMode_${s.project.id}_${s.chapter.chapter_number}`,String(t))}catch(e){console.warn("Failed to save chat mode to localStorage:",e)}},ce=c(!1),he=c(!1),ut=c(!1),ze=c(!1),Ie=c(!1),C=c(!0),ae=c(!0),E=c(!1),x=c(""),y=c(0),P=c(""),Z=c(0),M=c(0),T=c(null),I=c(""),We=c(0),St=c(""),Nt=c([]),et=c(!1),Re=c(!1),pe=c(0),Et=c(2e3),Ne=c(!1),dt=c(null);c("progressive");const Ue=c(!1),pt=c(!1),gt=c(0);c(!1),c(0);const Fr=async()=>{if(!navigator.onLine)return m.error("No Internet Connection",{description:"Please check your internet connection and try again."}),!1;const t=navigator.connection||navigator.mozConnection||navigator.webkitConnection;if(t){const e=t.effectiveType;(e==="slow-2g"||e==="2g")&&m.warning("Slow Connection Detected",{description:"Your connection is slow. Content will be auto-saved during generation.",duration:4e3})}try{const e=new AbortController,o=setTimeout(()=>e.abort(),5e3),l=performance.now();await fetch(V("api.ping"),{method:"HEAD",cache:"no-cache",signal:e.signal}),clearTimeout(o);const d=performance.now()-l;console.log("ðŸ“¡ Server latency:",d.toFixed(0),"ms"),d>2e3&&m.info("Connection is slow",{description:"Content will be auto-saved during generation to prevent data loss.",duration:3e3})}catch(e){console.warn("Connection check ping failed:",e),m.info("Connection check skipped",{description:"Content will be auto-saved during generation.",duration:2e3})}return!0},{balance:Lr,showPurchaseModal:Ut,requiredWordsForModal:Or,actionDescriptionForModal:zr,checkAndPrompt:Ir,closePurchaseModal:Wr,estimates:Te}=ja(),Ge=(t,e)=>Ir(Math.max(1,Math.round(t)),e),tt=c(!1),He=c(""),Be=c(""),Nr=c(0),Pe=c(null),Ur=c(0),Gr=c(null),Hr=c([]),Br=c([]),Kr=c(null);c(null),c(null);const Gt=c(),oe=c(!1),{attach:Vr,scrollToBottom:Qr,reset:Jr,isUserScrolling:Xr}=Po({userScrollTimeout:2e3,scrollBehavior:"smooth",bottomThreshold:100}),rt=c(!1),{hasUnsavedChanges:Yr,isSaving:Ae,triggerAutoSave:De,save:xe,clearAutoSave:Zr}=ko({delay:1e4,onSave:Vt});let Ht=0;const ea=()=>{const t=Date.now();t-Ht>ws&&(Ht=t,m.success("Saved",{duration:2e3}))},{contentHistory:ta,historyIndex:ra,addToHistory:aa,undo:oa,redo:na}=Ia(s.chapter.content||""),{writingStats:Tt,writingQualityScore:$e,calculateWritingStats:vt}=So(v),{isAnalyzing:Bt,latestAnalysis:we,getLatestAnalysis:sa}=Ao(s.chapter.id),ge=j(()=>{if(s.facultyChapters&&s.facultyChapters.length>0){const e=s.facultyChapters.find(o=>o.number===s.chapter.chapter_number);if(e?.word_count)return e.word_count}if(s.project?.outlines&&s.project.outlines.length>0){const e=s.project.outlines.find(o=>o.chapter_number===s.chapter.chapter_number);if(e?.target_word_count)return e.target_word_count}const t=s.project.type==="undergraduate"?2500:3500;return s.chapter.chapter_number===1||s.chapter.chapter_number===5?Math.round(t*.8):t}),{currentWordCount:Y,progressPercentage:la,meetsDefenseThreshold:ia,defenseWordsRemaining:ca,defenseProgressPercentage:ua,DEFENSE_THRESHOLD:ht,countWords:Kt}=Eo(v,ge),At=la,ft=j(()=>{const t=N.value?.trim(),e=v.value?.trim();return t&&t.length>0&&e&&e.length>50}),ye=j(()=>s.project),_e=j(()=>s.chapter),Me=j(()=>s.allChapters);async function Vt(t=!1){try{const e=await fetch(V("chapters.save",{project:s.project.id}),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({project_id:s.project.id,chapter_number:s.chapter.chapter_number,title:N.value,content:v.value,auto_save:t,statistics:Tt.value,quality_score:$e.value})});console.log("Response status:",e.status,e.statusText),console.log("Response headers:",e.headers);const o=await e.text();console.log("Raw response:",o);let l;try{l=JSON.parse(o)}catch(d){throw console.error("JSON parse error:",d),console.error("Response was:",o),new Error(`Server returned non-JSON response: ${e.status} ${e.statusText}`)}e.ok}catch(e){throw t||m.error("âŒ Save Failed",{description:"Please try again or check your connection."}),e}}const Qt=()=>{const t=oa();t!==null&&(v.value=t,De())},Jt=()=>{const t=na();t!==null&&(v.value=t,De())},at=t=>{Yr.value&&confirm("You have unsaved changes. Save before switching chapters?")&&xe();const e=s.allChapters.find(d=>d.chapter_number===t),l=e?.content&&e.content.trim()!==""?"chapters.edit":"chapters.write";Je.visit(V(l,{project:s.project.slug,chapter:t}),{only:["chapter","mode","allChapters"],preserveState:!0,preserveScroll:!1})},$t=async()=>{const t=Te.chapter(ge.value||0);if(!Ge(t,"generate the next chapter with AI"))return;await xe();const e=s.allChapters.map(d=>d.chapter_number).sort((d,b)=>d-b),o=e.indexOf(s.chapter.chapter_number);let l;if(o===-1||o===e.length-1)l=Math.max(...e)+1;else{const d=e[o+1];d===s.chapter.chapter_number+1?l=d:l=s.chapter.chapter_number+1}console.log("ðŸ“ Generating next chapter:",{currentChapter:s.chapter.chapter_number,existingChapters:e,nextChapterNumber:l});try{const d=V("chapters.write",{project:s.project.slug,chapter:l});console.log("ðŸ”— Generated URL for next chapter:",d);const b=new URL(d,window.location.origin);b.searchParams.set("ai_generate","true"),b.searchParams.set("generation_type","progressive"),console.log("ðŸš€ Navigating to:",b.toString()),Je.visit(b.toString())}catch(d){console.error("âŒ Error generating next chapter:",d),m.error("Navigation Error",{description:"Failed to navigate to next chapter. Please try again."})}},Rt=(t,e)=>{t==="section"&&e?.section?da(e.section):t==="rephrase"&&e?.selectedText?pa(e.selectedText,e.style||"Academic Formal"):t==="expand"&&e?.selectedText?ga(e.selectedText):Pt(t)},da=async t=>{E.value=!0,I.value="",M.value=0,y.value=5,P.value="Papers",x.value="Checking for verified sources...",Z.value=600,St.value=v.value||s.chapter.content||"",oe.value=!0;try{y.value=50,P.value="Papers",x.value="Using existing verified sources...",await new Promise(o=>setTimeout(o,500)),P.value="Section",x.value=`Generating ${t} section with verified sources...`,y.value=51;const e=V("chapters.stream",{project:s.project.slug,chapter:s.chapter.chapter_number});T.value=new EventSource(`${e}?generation_type=section&section_type=${t}`),T.value.onmessage=o=>{const l=JSON.parse(o.data);switch(l.type){case"start":P.value="Generating Section",y.value=52,x.value=`Starting ${t} section generation...`;break;case"content":I.value+=l.content,M.value=l.word_count||Kt(I.value);const d=Date.now();if(d-We.value>150){const L=I.value;v.value=St.value+`

`+L,We.value=d;const A=Math.min(M.value/Z.value*43,43);y.value=Math.max(52,52+A),x.value=`Generating ${t} section... (${M.value} / ${Z.value} words)`,vt(),qt()}break;case"complete":y.value=100,P.value="Complete",x.value=`âœ“ Generated ${t} section (${M.value} words)`;const b=I.value;v.value=St.value+`

`+b,xe(!0),m.success("âœ… Section Generated Successfully",{description:`Added ${t} section with ${M.value} words and verified citations.`,duration:5e3}),E.value=!1,T.value?.close();break;case"error":throw new Error(l.message||"Section generation failed");case"heartbeat":y.value<95&&(y.value+=.5);break}},T.value.onerror=()=>{E.value=!1,P.value="Error",x.value="âŒ Section generation failed",m.error("âŒ Generation Failed",{description:"Unable to generate section. Please check your connection and try again."}),T.value?.close()}}catch(e){console.error("Section generation failed:",e),E.value=!1,P.value="Error",x.value="âŒ Section generation error",m.error("âŒ Generation Failed",{description:"Section generation encountered an error."})}},pa=async(t,e)=>{const o=t.split(/\s+/).length,l=Math.max(o,Te.rephrase());if(!Ge(l,`rephrase about ${o} words`))return;console.log("ðŸš€ ChapterEditor - Starting rephrase generation:",{selectedTextLength:t.length,selectedTextPreview:t.substring(0,100)+(t.length>100?"...":""),style:e,timestamp:new Date().toISOString()}),E.value=!0,I.value="",M.value=0,y.value=10,P.value="Rephrasing",x.value="Preparing to rephrase selected text...",Z.value=Math.max(o,50);const d=ot.value||mt.value,b=d?.getSelectionRange();console.log("ðŸ“ ChapterEditor - Editor and selection info:",{hasActiveEditor:!!d,selectionRange:b,selectedWordCount:o,estimatedWords:Z.value});const L={originalText:t,range:b,wordCount:o,style:e,startTime:Date.now()};console.log("ðŸ’¾ ChapterEditor - Stored rephrase context:",L),oe.value=!0;try{y.value=20,x.value=`Rephrasing ${o} words in ${e} style...`;const ee=`${V("chapters.stream",{project:s.project.slug,chapter:s.chapter.chapter_number})}?generation_type=rephrase&selected_text=${encodeURIComponent(t)}&style=${encodeURIComponent(e)}`;console.log("ðŸŒ ChapterEditor - Creating EventSource:",{url:ee,encodedTextLength:encodeURIComponent(t).length}),T.value=new EventSource(ee),T.value.onmessage=B=>{const U=JSON.parse(B.data);switch(console.log("ðŸ“¨ ChapterEditor - EventSource message received:",{type:U.type,hasContent:!!U.content,contentLength:U.content?.length||0,wordCount:U.word_count}),U.type){case"start":console.log("â–¶ï¸ ChapterEditor - Rephrase generation started"),P.value="Rephrasing Text",y.value=30,x.value=`Rephrasing text in ${e} style...`;break;case"content":I.value+=U.content,M.value=U.word_count||Kt(I.value),console.log("ðŸ“ ChapterEditor - Content chunk received:",{chunkLength:U.content?.length||0,totalBufferLength:I.value.length,totalWords:M.value});const de=Math.min(M.value/Z.value*60,60);y.value=Math.max(30,30+de),x.value=`Rephrasing... (${M.value} words)`;break;case"complete":if(console.log("ðŸ ChapterEditor - Rephrase generation complete"),y.value=100,P.value="Complete",x.value=`âœ“ Text rephrased successfully (${M.value} words)`,console.log("ðŸ”„ ChapterEditor - Starting text replacement:",{hasRange:!!L.range,hasContent:!!I.value.trim(),range:L.range,newContentLength:I.value.trim().length,newContentPreview:I.value.trim().substring(0,100)+"..."}),L.range&&I.value.trim()){console.log("ðŸŽ¯ ChapterEditor - Attempting text replacement with activeEditor:",{editorType:d===ot.value?"fullscreen":"normal",hasActiveEditor:!!d});const fe=d?.replaceSelection(I.value.trim(),L.range);console.log("ðŸ“Š ChapterEditor - Text replacement result:",{success:fe}),fe?(console.log("âœ… ChapterEditor - Text replacement successful, updating chapter content"),setTimeout(()=>{const je=d?.getHTML()||v.value;console.log("ðŸ“„ ChapterEditor - Updated chapter content length:",je.length),v.value=je},100)):(console.warn("âŒ ChapterEditor - Failed to replace selected text, falling back to manual update"),m.warning("Please manually replace the selected text",{description:"The rephrased text is ready but couldn't be automatically replaced."}))}else console.error("âŒ ChapterEditor - Cannot replace text:",{missingRange:!L.range,missingContent:!I.value.trim()});xe(!0),m.success("âœ… Text Rephrased Successfully",{description:`Rephrased ${o} words in ${e} style.`,duration:5e3}),Ze(M.value||o,`Rephrase (${e})`,"chapter",s.chapter.id).catch(fe=>console.error("Failed to record word usage (rephrase):",fe)),E.value=!1,T.value?.close();break;case"error":throw new Error(U.message||"Text rephrasing failed");case"heartbeat":y.value<95&&(y.value+=.5);break}},T.value.onerror=()=>{E.value=!1,P.value="Error",x.value="âŒ Text rephrasing failed",m.error("âŒ Rephrasing Failed",{description:"Unable to rephrase text. Please check your connection and try again."}),T.value?.close()}}catch(A){console.error("Text rephrasing failed:",A),E.value=!1,P.value="Error",x.value="âŒ Rephrasing error",m.error("âŒ Rephrasing Failed",{description:"Text rephrasing encountered an error."})}},ga=async t=>{const e=t.split(/\s+/).length,o=Math.max(e*2,Te.expand());if(!Ge(o,`expand about ${e} words`))return;console.log("ðŸ“ˆ ChapterEditor - Starting expand generation:",{selectedTextLength:t.length,selectedTextPreview:t.substring(0,100)+(t.length>100?"...":""),timestamp:new Date().toISOString()}),E.value=!0,I.value="",M.value=0,y.value=10,P.value="Expanding",x.value="Preparing to expand selected text...",Z.value=Math.max(e*2,100);const l=ot.value||mt.value,d=l?.getSelectionRange();console.log("ðŸ“ ChapterEditor - Editor and selection info for expand:",{hasActiveEditor:!!l,selectionRange:d,selectedWordCount:e,estimatedWords:Z.value});const b={originalText:t,range:d,wordCount:e,startTime:Date.now()};console.log("ðŸ’¾ ChapterEditor - Stored expand context:",b);try{const A=`${V("chapters.stream",{project:s.project.slug,chapter:s.chapter.chapter_number})}?generation_type=expand&selected_text=${encodeURIComponent(t)}`;console.log("ðŸŒ ChapterEditor - Creating EventSource for expand:",{url:A,encodedTextLength:encodeURIComponent(t).length}),T.value=new EventSource(A),T.value.onmessage=ee=>{const B=JSON.parse(ee.data);switch(console.log("ðŸ“¨ ChapterEditor - EventSource message received:",{type:B.type,hasContent:!!B.content,contentLength:B.content?.length||0,wordCount:B.word_count}),B.type){case"start":console.log("â–¶ï¸ ChapterEditor - Expand generation started"),P.value="Expanding Text",y.value=20,x.value="Starting text expansion...";break;case"content":I.value+=B.content,M.value=B.word_count||I.value.split(/\s+/).filter(de=>de.length>0).length;const U=Math.min(M.value/Z.value*90,90);y.value=Math.max(U,25),x.value=`Expanding text... ${M.value}/${Z.value} words`,console.log("ðŸ“ ChapterEditor - Expand content received:",{chunkLength:B.content?.length||0,totalWords:M.value,progress:y.value});break;case"complete":if(console.log("âœ… ChapterEditor - Expand generation complete"),P.value="Complete",x.value="âœ… Text expansion completed",y.value=100,b.range&&I.value.trim()){console.log("ðŸŽ¯ ChapterEditor - Attempting text replacement for expand");const de=l?.replaceSelection(I.value.trim(),b.range);console.log("ðŸ“Š ChapterEditor - Expand text replacement result:",{success:de}),de?(console.log("âœ… ChapterEditor - Expand text replacement successful"),setTimeout(()=>{const fe=l?.getHTML()||v.value;console.log("ðŸ“„ ChapterEditor - Updated chapter content length after expand:",fe.length),v.value=fe},100)):(console.warn("âŒ ChapterEditor - Failed to replace expanded text"),m.warning("Please manually replace the selected text",{description:"The expanded text is ready but couldn't be automatically replaced."}))}else console.error("âŒ ChapterEditor - Cannot replace expanded text:",{missingRange:!b.range,missingContent:!I.value.trim()});xe(!0),m.success("âœ… Text Expanded Successfully",{description:`Expanded ${b.wordCount} words into ${M.value} words`}),Ze(M.value||b.wordCount*2,"Expand text","chapter",s.chapter.id).catch(de=>console.error("Failed to record word usage (expand):",de)),E.value=!1,T.value?.close();break;case"error":console.error("âŒ ChapterEditor - Expand generation error:",B.message),E.value=!1,P.value="Error",x.value="âŒ Text expansion failed",m.error("âŒ Expansion Failed",{description:B.message||"Text expansion encountered an error."}),T.value?.close();break}},T.value.onerror=()=>{console.error("âŒ ChapterEditor - Expand stream error occurred"),E.value=!1,P.value="Error",x.value="âŒ Text expansion failed",m.error("âŒ Expansion Failed",{description:"Unable to expand text. Please check your connection and try again."}),T.value?.close()}}catch(L){console.error("Text expansion failed:",L),E.value=!1,P.value="Error",x.value="âŒ Expansion error",m.error("âŒ Expansion Failed",{description:"Text expansion encountered an error."})}},va=async()=>{tt.value=!0,Be.value="Starting",He.value="Initializing source collection...",y.value=5;try{const t=document.querySelector('meta[name="csrf-token"]')?.content;if(!t)throw new Error("CSRF token not found - please refresh the page");const e=await fetch(V("api.projects.paper-collection.start",{project:s.project.slug}),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest"},credentials:"include"});if(!e.ok){const o=await e.text();if(console.error("API Error:",e.status,o),e.status===409)try{const l=JSON.parse(o);throw new Error(l.message||"Source collection is already in progress")}catch{throw new Error("Source collection is already in progress for this project")}throw new Error(`Failed to start source collection: ${e.status}`)}return await ha()}catch(t){return console.error("Paper collection failed:",t),Be.value="Error",He.value="âŒ Source collection failed",tt.value=!1,!1}},ha=async()=>new Promise(t=>{let e=0;const o=120,l=async()=>{try{const b=await(await fetch(V("api.projects.paper-collection.status",{project:s.project.slug}))).json();if(b.success&&b.data){Kr.value=b.data;const L=b.data.status,A=b.data.papers_count||b.data.count||0,ee=b.data.message,B=b.data.percentage||0,U=b.data.current_source,de=b.data.sources_completed||[],fe=b.data.papers_preview||[];if(Nr.value=A,Ur.value=B,Gr.value=U,Hr.value=de,Br.value=fe,L==="completed"){Be.value="Complete",He.value=`âœ“ Collected ${A} verified sources from ${de.length} databases`,y.value=50,tt.value=!1,Pe.value&&clearInterval(Pe.value),t(!0);return}else if(L==="collecting_papers"||L==="initializing"||L==="processing"||L==="storing"){let je="";U&&(je={semantic_scholar:"Semantic Scholar",openalex:"OpenAlex",crossref:"CrossRef",pubmed:"PubMed"}[U]||U),Be.value=je||"Collecting Sources",He.value=ee||"Collecting sources from academic databases...",y.value=Math.min(5+B*.4,45)}else if(L==="collection_failed"){Be.value="Error",He.value=ee||"âŒ Source collection failed",tt.value=!1,Pe.value&&clearInterval(Pe.value),t(!1);return}}e++,e>=o&&(Be.value="Timeout",He.value="â±ï¸ Source collection timed out",tt.value=!1,Pe.value&&clearInterval(Pe.value),t(!1))}catch(d){console.error("Error checking paper collection status:",d),e++}};l(),Pe.value=setInterval(l,5e3)}),Pt=async t=>{const e=Te.chapter(ge.value||0);if(!Ge(e,"generate this chapter with AI")||!await Fr())return;if(E.value=!0,I.value="",M.value=0,y.value=5,P.value="Papers",x.value="Checking for verified sources...",rt.value=!0,Jr(),Z.value=ge.value,oe.value=!0,!await va()){m.error("Paper Collection Failed",{description:"Unable to collect verified papers. Please try again."}),E.value=!1,oe.value=!1;return}P.value="Initializing",x.value="Starting AI generation with verified sources...",y.value=51;const d=setInterval(()=>{y.value<52&&E.value?y.value+=.2:clearInterval(d)},100),b=V("chapters.stream",{project:s.project.slug,chapter:s.chapter.chapter_number});T.value=new EventSource(`${b}?generation_type=${t}`),T.value.onmessage=L=>{const A=JSON.parse(L.data);switch(A.type){case"start":P.value="Connecting",y.value=52,x.value="Connecting to AI service...";break;case"content":P.value="Generating",I.value+=A.content,M.value=A.word_count||I.value.split(/\s+/).filter(U=>U.length>0).length;const ee=Date.now();if(ee-We.value>200){v.value=I.value,We.value=ee;const U=Math.min(M.value/Z.value*43,43);y.value=Math.max(52,52+U),x.value=`Generating chapter content... (${M.value} / ${Z.value} words)`,qt()}break;case"heartbeat":y.value<95&&(y.value+=.5);break;case"complete":P.value="Complete",y.value=100,E.value=!1,rt.value=!1,v.value=I.value;const B=A.final_word_count||M.value;x.value=`âœ“ Generated ${B} words successfully`,vt(),Ze(B,`Chapter generation (${s.chapter.chapter_number})`,"chapter",s.chapter.id).catch(U=>console.error("Failed to record word usage (chapter generation):",U)),setTimeout(()=>{De()},500),T.value?.close(),T.value=null;break;case"error":P.value="Error",y.value=50,rt.value=!1,A.partial_saved&&(pt.value=!0,gt.value=A.saved_word_count||0),A.code==="OFFLINE_MODE"?(x.value="ðŸ“¡ AI services offline",E.value=!1,m.error("AI Services Offline",{description:"Please check your internet connection and try again."})):A.can_resume?(x.value=`âš ï¸ Generation interrupted (${A.saved_word_count} words saved)`,E.value=!1,Ue.value=!0,m.warning("Generation Interrupted",{description:`${A.saved_word_count} words were saved. You can resume generation.`,duration:8e3})):(x.value="âŒ Generation failed",E.value=!1,m.error("Generation Error",{description:A.message||"Please try again."})),T.value?.close(),T.value=null;break;case"autosave":A.word_count&&(console.log(`ðŸ’¾ Auto-saved: ${A.word_count} words`),A.generation_id&&(dt.value=A.generation_id));break}},T.value.onerror=()=>{if(pe.value<Ct){pe.value++,Ne.value=!0,P.value="Reconnecting",x.value=`ðŸ”„ Connection lost. Reconnecting... (${pe.value}/${Ct})`,T.value?.close(),T.value=null;const L=Et.value*Math.pow(2,pe.value-1);console.log(`ðŸ”Œ Attempting reconnection in ${L}ms (attempt ${pe.value})`),setTimeout(()=>{Xt(t)},L)}else P.value="Error",y.value=50,E.value=!1,Ne.value=!1,x.value="âŒ Connection failed after multiple attempts",M.value>100?(pt.value=!0,gt.value=M.value,Ue.value=!0,m.warning("Connection Lost",{description:`${M.value} words may have been saved. Check and resume if needed.`,duration:8e3})):m.error("Connection Error",{description:"Please check your internet connection and try again."}),T.value?.close(),T.value=null,pe.value=0,Et.value=2e3}},Xt=t=>{const e=V("chapters.stream",{project:s.project.slug,chapter:s.chapter.chapter_number}),o=new URLSearchParams({generation_type:t,resume_from:M.value.toString()});dt.value&&o.set("generation_id",dt.value),console.log(`ðŸ”Œ Reconnecting to stream from ${M.value} words...`),T.value=new EventSource(`${e}?${o}`),T.value.onmessage=l=>{const d=JSON.parse(l.data);switch((d.type==="content"||d.type==="start")&&(Ne.value=!1,pe.value=0,P.value="Generating"),d.type){case"start":x.value="âœ… Reconnected! Continuing generation...",m.success("Reconnected",{description:"Generation resumed successfully.",duration:3e3});break;case"content":P.value="Generating",I.value+=d.content,M.value=d.word_count||I.value.split(/\s+/).filter(A=>A.length>0).length;const b=Date.now();if(b-We.value>150){v.value=I.value,We.value=b;const A=Math.min(M.value/Z.value*43,43);y.value=Math.max(52,52+A),x.value=`Generating chapter content... (${M.value} / ${Z.value} words)`,qt()}break;case"complete":P.value="Complete",y.value=100,E.value=!1,Ne.value=!1,v.value=I.value;const L=d.final_word_count||M.value;x.value=`âœ“ Generated ${L} words successfully`,Ze(L,`Chapter generation (${s.chapter.chapter_number})`,"chapter",s.chapter.id).catch(A=>console.error("Failed to record word usage:",A)),setTimeout(()=>{De()},500),T.value?.close(),T.value=null;break;case"error":P.value="Error",E.value=!1,Ne.value=!1,x.value="âŒ Generation failed",m.error("Generation Error",{description:d.message||"Please try again."}),T.value?.close(),T.value=null;break;case"autosave":d.generation_id&&(dt.value=d.generation_id);break}},T.value.onerror=()=>{if(pe.value<Ct){pe.value++;const l=Et.value*Math.pow(2,pe.value-1);x.value=`ðŸ”„ Reconnecting... (${pe.value}/${Ct})`,T.value?.close(),setTimeout(()=>{Xt(t)},l)}else P.value="Error",E.value=!1,Ne.value=!1,x.value="âŒ Connection failed",M.value>100?(Ue.value=!0,m.warning("Connection Lost",{description:`${M.value} words may be saved. Refresh to recover.`})):m.error("Connection Error",{description:"Please check your connection and try again."}),T.value?.close(),T.value=null,pe.value=0}},fa=()=>{Ue.value=!1,pt.value=!1,window.location.reload()},ma=()=>{Ue.value=!1,pt.value=!1,gt.value=0},Dt=async()=>{if(!X.value)return;const t=Te.suggestion();if(Ge(t,"get AI suggestions")){et.value=!0;try{const o=await(await fetch(V("chapters.suggestions",{project:s.project.slug,chapter:s.chapter.chapter_number}),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({selected_text:X.value,context:v.value})})).json();Nt.value=o.suggestions||[],Nt.value.length&&Ze(Te.suggestion(),"AI suggestions","chapter",s.chapter.id).catch(l=>console.error("Failed to record word usage (suggestions):",l))}catch{m.error("Error getting suggestions",{description:"Please try again."})}finally{et.value=!1}}},Mt=()=>{Re.value=!0,m.success("Citation Manager opened!",{description:"Review and verify your citations in the panel below."})},Yt=t=>{try{const e=ot.value?.editor||mt.value?.editor;if(!e){m.error("Editor not found");return}const{from:o}=e.state.selection;e.chain().focus().insertContentAt(o,` ${t} `).run(),m.success("Citation inserted successfully")}catch(e){console.error("Failed to insert citation:",e),m.error("Failed to insert citation")}},mt=c(null),ot=c(null),wa=async()=>{try{const t=document.documentElement;t.requestFullscreen?await t.requestFullscreen():t.webkitRequestFullscreen?await t.webkitRequestFullscreen():t.msRequestFullscreen&&await t.msRequestFullscreen()}catch(t){console.error("Error entering fullscreen:",t),m.error("Fullscreen Error",{description:"Unable to enter fullscreen mode"})}},ba=async()=>{try{document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.msExitFullscreen&&await document.msExitFullscreen()}catch(t){console.error("Error exiting fullscreen:",t),m.error("Fullscreen Error",{description:"Unable to exit fullscreen mode"})}},Zt=async()=>{te.value?await ba():await wa()},Ke=()=>{const t=document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement;te.value=!!t},xa=()=>{se.value=!se.value,se.value&&(ve.value=!1),re(se.value)},ya=()=>{se.value=!1,re(!1)},_a=()=>{ve.value=!1},er=()=>{oe.value=!oe.value},tr=()=>{Je.visit(V("projects.analysis",{project:s.project.slug}))},rr=()=>{aa(v.value),De(),vt()},ar=t=>{(t.ctrlKey||t.metaKey)&&t.key==="s"&&(t.preventDefault(),xe(),ea()),(t.ctrlKey||t.metaKey)&&!t.shiftKey&&t.key==="z"&&(t.preventDefault(),Qt()),(t.ctrlKey||t.metaKey)&&t.shiftKey&&t.key==="z"&&(t.preventDefault(),Jt()),t.key==="F11"&&(t.preventDefault(),Zt())};bt(()=>{const t=()=>{ut.value=window.innerWidth<1024};t(),window.addEventListener("resize",t),se.value=k(),document.addEventListener("keydown",or),document.addEventListener("keydown",ar),document.addEventListener("fullscreenchange",Ke),document.addEventListener("webkitfullscreenchange",Ke),document.addEventListener("msfullscreenchange",Ke),vt(),Ca(),Q()});const qt=()=>{E.value&&xt(()=>{let t=null;if(te.value){const e=Gt.value;if(e){const o=e.$el||e;t=o?.querySelector("[data-radix-scroll-area-viewport]")||o?.querySelector("[data-viewport]")||o?.querySelector('[role="region"]')}}else t=document.querySelector(".overflow-y-auto.custom-scrollbar");if(!t){const e=document.querySelector("main");if(e){const o=e.querySelectorAll("div");for(const l of o)if(l.scrollHeight>l.clientHeight&&l.classList.contains("overflow-y-auto")){t=l;break}}}t&&(Vr(t),Qr(),requestAnimationFrame(()=>{!Xr.value&&t&&t.scrollTo({top:t.scrollHeight,behavior:"smooth"})}))})},Ca=()=>{const t=new URLSearchParams(window.location.search),e=t.get("ai_generate")==="true",o=t.get("generation_type");e&&o&&setTimeout(()=>{if(o==="progressive"){Pt("progressive");const l=new URL(window.location.href);l.searchParams.delete("ai_generate"),l.searchParams.delete("generation_type"),window.history.replaceState({},"",l.toString()),m.success("ðŸš€ AI Generation Started",{description:`Generating ${s.chapter.title} with AI assistance...`})}else if(o==="single"){Pt("progressive");const l=new URL(window.location.href);l.searchParams.delete("ai_generate"),l.searchParams.delete("generation_type"),window.history.replaceState({},"",l.toString()),m.success("ðŸš€ AI Generation Started",{description:`Generating ${s.chapter.title} with AI assistance...`})}},1e3)},or=t=>{if((t.ctrlKey||t.metaKey)&&!["INPUT","TEXTAREA","SELECT"].includes(t.target?.tagName))switch(t.key){case"ArrowLeft":t.preventDefault();const e=s.chapter.chapter_number-1;s.allChapters.find(b=>b.chapter_number===e)&&at(e);break;case"ArrowRight":t.preventDefault();const l=s.chapter.chapter_number+1;s.allChapters.find(b=>b.chapter_number===l)&&at(l);break}};bt(()=>{const t=e=>{const o=l=>{const{scrollTop:d,scrollHeight:b,clientHeight:L}=e,A=l.deltaY,ee=d<=0,B=d+L>=b;A<0&&ee||A>0&&B||l.stopPropagation()};return e.addEventListener("wheel",o,{passive:!0}),()=>e.removeEventListener("wheel",o)};xt(()=>{const e=document.querySelectorAll('[class*="overflow-y-auto"]'),o=[];e.forEach(l=>{if(l instanceof HTMLElement){const d=t(l);o.push(d)}}),window.__scrollChainCleanup=o})}),qr(()=>{Zr(),T.value&&T.value.close(),document.removeEventListener("keydown",ar),document.removeEventListener("keydown",or);const t=window.__scrollChainCleanup;t&&Array.isArray(t)&&(t.forEach(e=>e()),delete window.__scrollChainCleanup),document.removeEventListener("fullscreenchange",Ke),document.removeEventListener("webkitfullscreenchange",Ke),document.removeEventListener("msfullscreenchange",Ke)}),Ee(()=>s.chapter,async t=>{N.value=t.title||"",v.value=t.content||"",ue.value=[],Ea(),cr(),qe.value=sr(),await st(!1,{skipGeneration:!0}),await xt(()=>{ur(),wt()})},{immediate:!1});const ue=c([]),Ve=c(!1),Qe=c(!1),nt=c(null),qe=c(!1),nr=(t,e)=>`defense_auto_generate_${t}_ch_${e}`,sr=()=>{try{return localStorage.getItem(nr(s.project.id,s.chapter.chapter_number))==="true"}catch(t){return console.warn("Failed to load defense auto-generation preference:",t),!1}},ka=t=>{try{localStorage.setItem(nr(s.project.id,s.chapter.chapter_number),String(t))}catch(e){console.warn("Failed to save defense auto-generation preference:",e)}};qe.value=sr(),Ee(v,rr),Ee(N,De);const le=j(()=>s.chapter),lr=async t=>{W.value=t,t&&Sa()&&await st(!1,{skipGeneration:!0})},Sa=()=>{if(!ue.value.length||!nt.value)return!0;const t=new Date(Date.now()-360*60*1e3);return nt.value<t},st=async(t=!1,e={})=>{if(Ve.value)return;const o=e.skipGeneration??!0;Ve.value=!0;try{console.log("Loading defense questions with params:",{project_id:s.project.id,chapter_number:le.value?.chapter_number,limit:5,force_refresh:t,skip_generation:o});const l=await be.get(`/api/projects/${s.project.id}/defense/questions`,{params:{chapter_number:le.value?.chapter_number||null,limit:5,force_refresh:t?1:0,skip_generation:o?1:0},headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(console.log("Defense questions loaded:",l.data),console.log("Questions array:",l.data.questions),console.log("Questions count:",l.data.questions?l.data.questions.length:0),ue.value=l.data.questions||[],nt.value=new Date,l.data.questions&&l.data.questions.length>0){const d=`defense_questions_${s.project.id}_chapter_${le.value?.chapter_number}`;localStorage.setItem(d,JSON.stringify({questions:l.data.questions,chapter_number:le.value?.chapter_number,loaded_at:new Date().toISOString()}))}else t||(console.log("No existing questions found for this chapter"),console.log(`Current word count: ${Y.value}/${ht}`),console.log('User must click "Generate Questions" button to create defense questions'))}catch(l){if(console.error("Failed to load defense questions:",l),l.response)if(console.error("Response status:",l.response.status),console.error("Response data:",l.response.data),l.response.status===422){console.error("Validation errors:",l.response.data.errors);const d=Object.values(l.response.data.errors||{})[0];d&&Array.isArray(d)?m.error(`Validation Error: ${d[0]}`):m.error("Invalid request parameters. Please refresh the page.")}else l.response.status===500?m.error("Server error. Please try again later."):m.error("Failed to load defense questions");else l.request?(console.error("No response received:",l.request),m.error("Network error. Please check your connection.")):(console.error("Error setting up request:",l.message),m.error("An unexpected error occurred"));ue.value=[]}finally{Ve.value=!1}},wt=async()=>{!qe.value||Qe.value||Ve.value||lt.value||!Ft.value||ue.value.length>0||await jt({autoTriggered:!0})},ir=t=>{qe.value=t,ka(t),t&&wt()};Ee(v,rr),Ee(N,De),Ee([Y,qe],()=>{wt()});const jt=async(t={})=>{if(Qe.value)return;const e=t.autoTriggered??!1,o=Te.defense();if(Ge(o,"generate defense questions")){Qe.value=!0;try{const l=b=>b?b.replace(/<[^>]*>/g," ").trim().split(/\s+/).filter(L=>L.length>0).length:0,d=await be.post(`/api/projects/${s.project.id}/defense/questions/generate`,{chapter_number:le.value.chapter_number},{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),Accept:"application/json","Content-Type":"application/json"}});if(d.data&&d.data.questions){ue.value=d.data.questions,nt.value=new Date;const b=d.data.questions.reduce((A,ee)=>{const B=l(ee.question),U=l(ee.suggested_answer),de=(ee.key_points||[]).reduce((fe,je)=>fe+l(je),0);return A+B+U+de},0),L=`defense_questions_${s.project.id}_chapter_${le.value?.chapter_number}`;localStorage.setItem(L,JSON.stringify({questions:d.data.questions,chapter_number:le.value?.chapter_number,loaded_at:new Date().toISOString()})),m.success(`Generated ${d.data.questions.length} new questions`),Ze(b||Te.defense(),"Defense questions","chapter",s.chapter.id).catch(A=>console.error("Failed to record word usage (defense):",A)),lt.value=!0,Ta(),e&&console.log("Auto-generated defense questions after meeting threshold.")}}catch(l){console.error("Failed to generate defense questions:",l),m.error("Failed to generate defense questions")}finally{Qe.value=!1}}},{hasTriggeredGeneration:lt,startWatching:cr,stopWatching:Ea,forceCheck:ur,getStatusMessage:dr,markGenerationTriggered:Ta}=To(s.project,s.chapter,v),Ft=ia,pr=async()=>{console.log("ðŸ”µ [MARK COMPLETE] Function called"),console.log("ðŸ”µ [MARK COMPLETE] Current word count:",Y.value);try{console.log("ðŸ”µ [MARK COMPLETE] Saving chapter..."),await xe(!1),console.log("âœ… [MARK COMPLETE] Chapter saved");const t=V("chapters.mark-complete",{project:s.project.slug,chapter:s.chapter.chapter_number});console.log("ðŸ”µ [MARK COMPLETE] Posting to:",t),Je.post(t,{},{onSuccess:()=>{console.log("âœ… [MARK COMPLETE] Request successful")},onError:e=>{console.error("âŒ [MARK COMPLETE] Request failed:",e)}})}catch(t){console.error("âŒ [MARK COMPLETE] Error:",t),m.error("Failed to save chapter before marking complete")}},gr=j(()=>{const t=Y.value;return t>0&&t<ht&&!lt.value}),vr=ua,hr=ca,fr=async(t,e)=>{try{await be.patch(`/api/projects/${s.project.id}/defense/questions/${t}`,{user_marked_helpful:e},{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),Accept:"application/json","Content-Type":"application/json"}});const o=ue.value.find(l=>l.id===t);o&&(o.user_marked_helpful=e),m.success(e?"Question marked as helpful":"Removed helpful mark")}catch(o){console.error("Failed to mark question:",o),m.error("Failed to update question")}},mr=async t=>{try{await be.delete(`/api/projects/${s.project.id}/defense/questions/${t}`,{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),Accept:"application/json"}}),ue.value=ue.value.filter(e=>e.id!==t),localStorage.setItem(`defense_questions_${s.project.id}`,JSON.stringify({questions:ue.value,loaded_at:new Date().toISOString()})),m.success("Question hidden")}catch(e){console.error("Failed to hide question:",e),m.error("Failed to hide question")}};return bt(async()=>{const t=`defense_questions_${s.project.id}_chapter_${le.value?.chapter_number}`,e=localStorage.getItem(t);let o=!0;if(e){const l=JSON.parse(e),d=new Date(l.loaded_at),b=new Date(Date.now()-360*60*1e3);d>b&&l.chapter_number===le.value?.chapter_number&&(ue.value=l.questions,nt.value=d,o=!1)}o&&await st(!1,{skipGeneration:!0}),cr(),await xt(()=>{ur(),wt()})}),bt(async()=>{await sa()}),(t,e)=>(_(),H(r(La),null,{default:i(()=>[se.value?(_(),H(r(f),{key:0,project:ye.value,chapter:_e.value,class:ne({dark:R.value}),"chapter-title":N.value,"chapter-content":v.value,"current-word-count":r(Y),"target-word-count":ge.value,"progress-percentage":r(At),"writing-quality-score":r($e),"is-valid":ft.value,"is-saving":r(Ae),"show-preview":z.value,"is-generating":E.value,"generation-progress":x.value,"history-index":r(ra),"content-history-length":r(ta).length,"selected-text":X.value,"onUpdate:chapterTitle":e[0]||(e[0]=o=>N.value=o),"onUpdate:chapterContent":e[1]||(e[1]=o=>v.value=o),"onUpdate:selectedText":e[2]||(e[2]=o=>X.value=o),"onUpdate:showPreview":e[3]||(e[3]=o=>z.value=o),onSave:e[4]||(e[4]=o=>Vt(o)),onUndo:Qt,onRedo:Jt,onExitChatMode:ya},null,8,["project","chapter","class","chapter-title","chapter-content","current-word-count","target-word-count","progress-percentage","writing-quality-score","is-valid","is-saving","show-preview","is-generating","generation-progress","history-index","content-history-length","selected-text"])):ve.value?(_(),H(r(u),{key:1,project:ye.value,chapter:_e.value,class:ne({dark:R.value}),"chapter-title":N.value,"chapter-content":v.value,"current-word-count":r(Y),"target-word-count":ge.value,"progress-percentage":r(At),onExitCitationMode:_a},null,8,["project","chapter","class","chapter-title","chapter-content","current-word-count","target-word-count","progress-percentage"])):te.value?(_(),K("div",{key:2,class:ne(["flex h-screen flex-col overflow-hidden bg-background dark:bg-background font-sans selection:bg-primary/20 transition-colors duration-300",{dark:R.value}])},[e[52]||(e[52]=a("div",{class:"absolute inset-0 z-0 overflow-hidden pointer-events-none"},[a("div",{class:"absolute top-[-20%] left-[-10%] w-[50%] h-[50%] rounded-full bg-blue-500/5 blur-[120px]"}),a("div",{class:"absolute bottom-[-20%] right-[-10%] w-[50%] h-[50%] rounded-full bg-purple-500/5 blur-[120px]"})],-1)),a("div",Do,[a("div",Mo,[n(r(Ce),null,{default:i(()=>[n(r(ke),{asChild:""},{default:i(()=>[n(r(G),{onClick:e[5]||(e[5]=o=>r(Je).visit(r(V)("projects.show",s.project.slug))),variant:"ghost",size:"icon",class:"h-10 w-10 rounded-full hover:bg-primary/10 hover:text-primary transition-all duration-300"},{default:i(()=>[n(r(Ka),{class:"h-5 w-5"})]),_:1})]),_:1}),n(r(Se),null,{default:i(()=>[...e[30]||(e[30]=[a("p",null,"Back to Project",-1)])]),_:1})]),_:1}),a("div",qo,[n(yr,{as:"h1",class:"text-lg font-bold tracking-tight text-foreground/90 font-display",content:s.project.title},null,8,["content"]),a("div",jo,[n(r(Oe),{variant:"outline",class:"h-5 px-2 rounded-full border-primary/20 bg-primary/5 text-primary font-medium"},{default:i(()=>[$(" Chapter "+D(s.chapter.chapter_number),1)]),_:1}),a("span",Fo,[e[31]||(e[31]=a("span",{class:"h-1.5 w-1.5 rounded-full bg-green-500 animate-pulse"},null,-1)),$(" "+D(r(Y))+" words ",1)])])])]),a("div",Lo,[a("div",Oo,[n(r(G),{onClick:e[6]||(e[6]=o=>C.value=!C.value),variant:C.value?"secondary":"ghost",size:"sm",class:ne(["h-8 px-4 rounded-full text-xs font-medium transition-all duration-300",C.value?"bg-primary/10 text-primary hover:bg-primary/15":"hover:bg-muted"])},{default:i(()=>[n(r(kr),{class:"mr-2 h-3.5 w-3.5"}),e[32]||(e[32]=$(" Outline ",-1))]),_:1},8,["variant","class"]),e[34]||(e[34]=a("div",{class:"w-px h-4 bg-border/50 mx-1"},null,-1)),n(r(G),{onClick:e[7]||(e[7]=o=>ae.value=!ae.value),variant:ae.value?"secondary":"ghost",size:"sm",class:ne(["h-8 px-4 rounded-full text-xs font-medium transition-all duration-300",ae.value?"bg-primary/10 text-primary hover:bg-primary/15":"hover:bg-muted"])},{default:i(()=>[n(r(it),{class:"mr-2 h-3.5 w-3.5"}),e[33]||(e[33]=$(" Assistant ",-1))]),_:1},8,["variant","class"])]),a("div",zo,[n(r(Ce),null,{default:i(()=>[n(r(ke),{asChild:""},{default:i(()=>[n(r(G),{onClick:e[8]||(e[8]=o=>J.value=!J.value),variant:J.value?"secondary":"ghost",size:"icon",class:"h-9 w-9 rounded-full transition-all hover:bg-muted"},{default:i(()=>[n(r($r),{class:"h-4.5 w-4.5 text-muted-foreground"})]),_:1},8,["variant"])]),_:1}),n(r(Se),null,{default:i(()=>[a("p",null,D(J.value?"Hide":"Show")+" Statistics",1)]),_:1})]),_:1}),n(r(Ce),null,{default:i(()=>[n(r(ke),{asChild:""},{default:i(()=>[n(r(G),{onClick:me,variant:R.value?"secondary":"ghost",size:"icon",class:"h-9 w-9 rounded-full transition-all hover:bg-muted"},{default:i(()=>[R.value?(_(),H(r(_r),{key:0,class:"h-4.5 w-4.5 text-foreground"})):(_(),H(r(Cr),{key:1,class:"h-4.5 w-4.5 text-muted-foreground"}))]),_:1},8,["variant"])]),_:1}),n(r(Se),null,{default:i(()=>[...e[35]||(e[35]=[a("p",null,"Toggle Dark Mode",-1)])]),_:1})]),_:1}),n(Sr,{project:ye.value,"current-chapter":_e.value,"all-chapters":Me.value,size:"icon",variant:"ghost",class:"h-9 w-9 rounded-full hover:bg-muted"},null,8,["project","current-chapter","all-chapters"])])])]),a("div",Io,[a("div",{class:"absolute top-0 left-0 h-full bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 transition-all duration-700 ease-out shadow-[0_0_10px_rgba(59,130,246,0.5)]",style:ct({width:`${Math.min(r(At),100)}%`})},null,4)]),E.value?(_(),K("div",Wo,[a("div",No,[e[41]||(e[41]=a("div",{class:"absolute inset-0 -skew-x-12 animate-pulse bg-gradient-to-r from-transparent via-white/10 to-transparent"},null,-1)),a("div",Uo,[a("div",Go,[a("div",Ho,[a("div",Bo,[n(r(it),{class:"h-3 w-3 text-white"})]),e[36]||(e[36]=a("div",{class:"absolute inset-0 h-6 w-6 animate-ping rounded-full bg-gradient-to-br from-blue-500 to-purple-600 opacity-20"},null,-1))]),a("div",null,[e[37]||(e[37]=a("h4",{class:"text-xs font-semibold text-blue-900 dark:text-blue-100"},"AI Generator",-1)),a("p",Ko,D(P.value),1)])]),n(r(Oe),{variant:"outline",class:"border-blue-300 text-xs text-blue-700 dark:border-blue-700 dark:text-blue-300"},{default:i(()=>[$(D(Math.round(y.value))+"% ",1)]),_:1})]),a("div",Vo,[a("div",Qo,[e[38]||(e[38]=a("span",{class:"text-xs text-blue-800 dark:text-blue-200"},"Generation Progress",-1)),a("span",Jo,D(M.value)+" / "+D(Z.value)+" words",1)]),a("div",Xo,[a("div",{class:"absolute top-0 left-0 h-full rounded-full bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-500 ease-out",style:ct({width:`${y.value}%`})},[...e[39]||(e[39]=[a("div",{class:"absolute inset-0 animate-pulse bg-gradient-to-r from-transparent via-white/30 to-transparent"},null,-1)])],4),a("div",{class:"absolute top-0 left-0 h-full rounded-full bg-gradient-to-r from-blue-400 to-purple-400 opacity-50 blur-sm transition-all duration-500",style:ct({width:`${y.value}%`})},null,4)])]),a("div",Yo,[a("div",Zo,[P.value==="Initializing"?(_(),K("div",en)):P.value==="Connecting"?(_(),K("div",tn,[...e[40]||(e[40]=[a("div",{class:"h-2 w-0.5 animate-pulse rounded-full bg-blue-500"},null,-1),a("div",{class:"h-2 w-0.5 animate-pulse rounded-full bg-purple-500",style:{"animation-delay":"0.2s"}},null,-1),a("div",{class:"h-2 w-0.5 animate-pulse rounded-full bg-blue-500",style:{"animation-delay":"0.4s"}},null,-1)])])):P.value==="Generating"?(_(),K("div",rn)):P.value==="Complete"?(_(),K("div",an)):(_(),K("div",on))]),a("p",nn,D(x.value),1)])])])):ie("",!0),J.value?(_(),H(Dr,{key:1,"show-statistics":J.value,"current-word-count":r(Y),"writing-stats":r(Tt),"quality-analysis":r(we),"is-analyzing":r(Bt),class:"relative z-20 mx-4 mt-2 rounded-lg border border-border/40 bg-background/60 backdrop-blur-md"},null,8,["show-statistics","current-word-count","writing-stats","quality-analysis","is-analyzing"])):ie("",!0),a("div",sn,[n(yt,{"enter-active-class":"transition-all duration-300 ease-in-out","enter-from-class":"-ml-72 opacity-0","enter-to-class":"ml-0 opacity-100","leave-active-class":"transition-all duration-300 ease-in-out","leave-from-class":"ml-0 opacity-100","leave-to-class":"-ml-72 opacity-0"},{default:i(()=>[C.value?(_(),K("div",ln,[a("div",cn,[a("div",un,[a("div",dn,[e[42]||(e[42]=a("h2",{class:"text-sm font-semibold text-foreground mb-1"},"Table of Contents",-1)),a("p",pn,D(Me.value.length)+" Chapters ",1)]),(_(),H(_t,null,{fallback:i(()=>[...e[43]||(e[43]=[a("div",{class:"flex items-center justify-center p-8"},[a("div",{class:"h-6 w-6 animate-spin rounded-full border-2 border-primary border-t-transparent"})],-1)])]),default:i(()=>[n(r(S),{"all-chapters":Me.value,"current-chapter":_e.value,project:ye.value,outlines:t.project.outlines||[],"faculty-chapters":t.facultyChapters||[],"current-word-count":r(Y),"target-word-count":ge.value,"writing-quality-score":r($e),"chapter-content-length":v.value.length,onGoToChapter:at,onGenerateNextChapter:$t},null,8,["all-chapters","current-chapter","project","outlines","faculty-chapters","current-word-count","target-word-count","writing-quality-score","chapter-content-length"])]),_:1}))])])])):ie("",!0)]),_:1}),a("div",gn,[a("div",vn,[a("div",hn,[n(r(zt),{class:"w-full max-w-[850px] min-h-[calc(100vh-180px)] flex flex-col bg-background shadow-xl shadow-black/5 ring-1 ring-black/5 dark:ring-white/10 rounded-xl overflow-hidden transition-all duration-300"},{default:i(()=>[n(r(Wt),{class:"flex-shrink-0 border-b border-border/30 px-8 py-6 bg-background/50 backdrop-blur-sm sticky top-0 z-10"},{default:i(()=>[a("div",fn,[a("div",mn,[n(r(qa),{for:"chapter-title-fs",class:"text-xs font-medium text-zinc-500 dark:text-zinc-400 uppercase tracking-wider"},{default:i(()=>[...e[44]||(e[44]=[$("Chapter Title",-1)])]),_:1}),n(r(Ma),{id:"chapter-title-fs",modelValue:N.value,"onUpdate:modelValue":e[9]||(e[9]=o=>N.value=o),placeholder:"Enter chapter title...",class:"h-auto p-0 border-0 bg-transparent text-2xl font-bold placeholder:text-muted-foreground/40 focus-visible:ring-0 px-0 text-foreground"},null,8,["modelValue"])]),a("div",wn,[n(r(Oe),{variant:t.chapter.status==="approved"?"default":"secondary",class:"rounded-full px-3"},{default:i(()=>[$(D(t.chapter.status.replace("_"," ")),1)]),_:1},8,["variant"]),n(r(Oe),{variant:"outline",class:ne(["rounded-full px-3 transition-colors",{"text-green-600 border-green-200 bg-green-50 dark:bg-green-900/20 dark:border-green-800":(r(we)?.total_score||0)>=80,"text-yellow-600 border-yellow-200 bg-yellow-50 dark:bg-yellow-900/20 dark:border-yellow-800":(r(we)?.total_score||0)>=70&&(r(we)?.total_score||0)<80,"text-orange-600 border-orange-200 bg-orange-50 dark:bg-orange-900/20 dark:border-orange-800":(r(we)?.total_score||0)>=60&&(r(we)?.total_score||0)<70,"text-red-600 border-red-200 bg-red-50 dark:bg-red-900/20 dark:border-red-800":(r(we)?.total_score||0)<60}])},{default:i(()=>[$(D(r(we)?.total_score?Math.round(r(we).total_score):r($e))+"% Quality ",1)]),_:1},8,["class"])])])]),_:1}),n(r(It),{class:"flex min-h-0 flex-1 flex-col p-0"},{default:i(()=>[a("div",bn,[a("div",xn,[n(r(G),{onClick:er,variant:oe.value?"default":"ghost",size:"sm",class:"h-7 text-xs rounded-full text-zinc-700 dark:text-zinc-300 hover:text-foreground"},{default:i(()=>[n(r(Rr),{class:"mr-1.5 h-3.5 w-3.5"}),$(" "+D(oe.value?"Edit":"Preview"),1)]),_:1},8,["variant"])]),a("div",yn,[a("div",_n,D(t.aiChapterAnalysis?.section.name||t.getSectionInfo(t.nextSection).name),1),a("div",Cn,D(t.aiChapterAnalysis?.section.description||t.getSectionInfo(t.nextSection).description),1)])]),a("div",kn,[Xe(n(Tr,{modelValue:v.value,"onUpdate:modelValue":e[10]||(e[10]=o=>v.value=o),placeholder:"Start writing your chapter...","min-height":"500px",class:"min-h-[500px] px-8 py-6",ref_key:"richTextEditor",ref:mt,"show-toolbar":!0,"streaming-mode":rt.value,"is-generating":E.value,"generation-progress":x.value,"generation-percentage":y.value,"generation-phase":P.value,"onUpdate:selectedText":e[11]||(e[11]=o=>{X.value=o})},null,8,["modelValue","streaming-mode","is-generating","generation-progress","generation-percentage","generation-phase"]),[[Ye,!oe.value]]),Xe(a("div",Sn,[n(Er,{content:v.value,"show-font-controls":!1,class:"prose-lg mx-auto",style:{"font-family":"'Times New Roman', serif","line-height":"1.8"}},null,8,["content"])],512),[[Ye,oe.value]])])]),_:1}),a("div",En,[a("div",Tn,D(r(Ae)?"Saving...":"All changes saved"),1),a("div",An,[n(r(G),{onClick:e[12]||(e[12]=o=>r(xe)(!1)),disabled:!ft.value||r(Ae),size:"sm",variant:"ghost",class:"h-8 rounded-full text-zinc-700 dark:text-zinc-300 hover:text-foreground"},{default:i(()=>[n(r(Pr),{class:"mr-2 h-3.5 w-3.5"}),e[45]||(e[45]=$(" Save Draft ",-1))]),_:1},8,["disabled"]),n(r(G),{onClick:tr,variant:"outline",size:"sm",class:"h-8 rounded-full"},{default:i(()=>[n(r(kt),{class:"mr-2 h-3.5 w-3.5"}),e[46]||(e[46]=$(" Run Bulk Analysis ",-1))]),_:1}),n(r(G),{onClick:pr,disabled:r(Ae),size:"sm",class:"h-8 rounded-full bg-gradient-to-r from-primary to-primary/90 shadow-sm hover:shadow-md transition-all"},{default:i(()=>[n(r(Lt),{class:"mr-2 h-3.5 w-3.5"}),e[47]||(e[47]=$(" Complete ",-1))]),_:1},8,["disabled"])])])]),_:1}),e[48]||(e[48]=a("div",{class:"h-12"},null,-1))])])]),n(yt,{"enter-active-class":"transition-all duration-300 ease-in-out","enter-from-class":"-mr-72 opacity-0","enter-to-class":"mr-0 opacity-100","leave-active-class":"transition-all duration-300 ease-in-out","leave-from-class":"mr-0 opacity-100","leave-to-class":"-mr-72 opacity-0"},{default:i(()=>[ae.value?(_(),K("div",$n,[a("div",Rn,[a("div",Pn,[(_(),H(_t,null,{fallback:i(()=>[...e[49]||(e[49]=[a("div",{class:"flex items-center justify-center p-8"},[a("div",{class:"h-6 w-6 animate-spin rounded-full border-2 border-primary border-t-transparent"})],-1)])]),default:i(()=>[n(r(g),{project:ye.value,chapter:_e.value,"is-generating":E.value,"selected-text":X.value,"is-loading-suggestions":et.value,"show-citation-helper":Re.value,"chapter-content":v.value,"current-word-count":r(Y),"target-word-count":ge.value,onStartStreamingGeneration:Rt,onGetAiSuggestions:Dt,"onUpdate:showCitationHelper":e[13]||(e[13]=o=>Re.value=o),onInsertCitation:Yt,onCheckCitations:Mt},null,8,["project","chapter","is-generating","selected-text","is-loading-suggestions","show-citation-helper","chapter-content","current-word-count","target-word-count"])]),_:1})),(_(),H(_t,null,{fallback:i(()=>[...e[50]||(e[50]=[a("div",{class:"flex items-center justify-center p-4"},[a("div",{class:"h-4 w-4 animate-spin rounded-full border-2 border-muted border-t-transparent"})],-1)])]),default:i(()=>[n(r(w),{"show-defense-prep":W.value,questions:ue.value,"is-loading":Ve.value,"is-generating":Qe.value,"chapter-context":{chapter_number:le.value.chapter_number,chapter_title:le.value.title,word_count:r(Y)},"defense-watcher":{meetsThreshold:r(Ft),shouldShowProgress:gr.value,progressPercentage:r(vr),wordsRemaining:r(hr),hasTriggeredGeneration:r(lt),threshold:r(ht),statusMessage:r(dr)()},"auto-generate-enabled":qe.value,"onUpdate:showDefensePrep":lr,onGenerateMore:jt,onToggleAutoGenerate:ir,onRefresh:e[14]||(e[14]=()=>st(!0,{skipGeneration:!0})),onMarkHelpful:fr,onHideQuestion:mr},null,8,["show-defense-prep","questions","is-loading","is-generating","chapter-context","defense-watcher","auto-generate-enabled"])]),_:1})),(_(),H(_t,null,{fallback:i(()=>[...e[51]||(e[51]=[a("div",{class:"flex items-center justify-center p-4"},[a("div",{class:"h-4 w-4 animate-spin rounded-full border-2 border-muted border-t-transparent"})],-1)])]),default:i(()=>[n(r(p),{"chapter-id":le.value.id,content:v.value},null,8,["chapter-id","content"])]),_:1}))])])])):ie("",!0)]),_:1})])],2)):(_(),H(Fa,{key:3,class:ne(["h-screen overflow-hidden bg-background dark:bg-background transition-colors duration-300",{dark:R.value}])},{default:i(()=>[a("div",Dn,[e[78]||(e[78]=a("div",{class:"absolute inset-0 z-0 overflow-hidden pointer-events-none"},[a("div",{class:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] rounded-full bg-blue-500/5 blur-[100px]"}),a("div",{class:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] rounded-full bg-purple-500/5 blur-[100px]"})],-1)),Xe(a("aside",Mn,[a("div",qn,[e[53]||(e[53]=a("span",{class:"text-sm font-semibold tracking-tight text-foreground"},"Navigation",-1)),n(r(Oe),{variant:"outline",class:"text-[10px] h-5 px-1.5"},{default:i(()=>[$(D(Me.value.length)+" Chapters ",1)]),_:1})]),n(r(xr),{class:"flex-1"},{default:i(()=>[a("div",jn,[n(r(S),{"all-chapters":Me.value,"current-chapter":_e.value,project:ye.value,outlines:t.project.outlines||[],"faculty-chapters":t.facultyChapters||[],"current-word-count":r(Y),"target-word-count":ge.value,"writing-quality-score":r($e),"chapter-content-length":v.value.length,onGoToChapter:at,onGenerateNextChapter:$t},null,8,["all-chapters","current-chapter","project","outlines","faculty-chapters","current-word-count","target-word-count","writing-quality-score","chapter-content-length"])])]),_:1})],512),[[Ye,!ze.value]]),a("main",Fn,[a("header",Ln,[a("div",On,[a("div",zn,[n(r(G),{variant:"ghost",size:"icon",onClick:e[15]||(e[15]=o=>ze.value=!ze.value),class:"hidden lg:flex text-muted-foreground hover:text-foreground -ml-2 h-8 w-8"},{default:i(()=>[ze.value?(_(),H(r(Qa),{key:1,class:"h-4 w-4"})):(_(),H(r(Va),{key:0,class:"h-4 w-4"}))]),_:1}),n(r(G),{variant:"ghost",size:"icon",onClick:e[16]||(e[16]=o=>ce.value=!0),class:"lg:hidden text-muted-foreground hover:text-foreground -ml-2 h-8 w-8"},{default:i(()=>[n(r(kr),{class:"h-4 w-4"})]),_:1}),e[54]||(e[54]=a("div",{class:"h-8 w-px bg-border/50 hidden lg:block mx-1"},null,-1))]),a("div",In,[a("div",Wn,[n(yr,{as:"h1",class:"text-lg font-bold tracking-tight text-foreground leading-tight cursor-pointer hover:text-primary/80 transition-colors break-words line-clamp-2",content:s.project.title,onClick:e[17]||(e[17]=o=>r(Je).visit(r(V)("projects.show",s.project.slug)))},null,8,["content"]),n(r(Oe),{variant:"secondary",class:"h-5 px-2 text-[10px] font-medium rounded-full bg-secondary/50 border border-border/50 shrink-0 mt-0.5"},{default:i(()=>[$(" Ch "+D(s.chapter.chapter_number),1)]),_:1})]),a("div",Nn,[a("div",Un,[n(r(Ce),null,{default:i(()=>[n(r(ke),{asChild:""},{default:i(()=>[n(r(G),{onClick:e[18]||(e[18]=o=>J.value=!J.value),variant:J.value?"secondary":"ghost",size:"sm",class:"h-7 px-3 text-xs gap-2 text-zinc-700 dark:text-zinc-300 hover:text-foreground"},{default:i(()=>[n(r($r),{class:"h-3.5 w-3.5"}),e[55]||(e[55]=$(" Stats ",-1))]),_:1},8,["variant"])]),_:1}),n(r(Se),null,{default:i(()=>[...e[56]||(e[56]=[$("Toggle Writing Statistics",-1)])]),_:1})]),_:1}),e[62]||(e[62]=a("div",{class:"w-px h-3 bg-border/50 mx-0.5"},null,-1)),n(r(Ce),null,{default:i(()=>[n(r(ke),{asChild:""},{default:i(()=>[n(r(G),{onClick:er,variant:oe.value?"secondary":"ghost",size:"sm",class:"h-7 px-3 text-xs gap-2 text-zinc-700 dark:text-zinc-300 hover:text-foreground"},{default:i(()=>[oe.value?(_(),H(r(ro),{key:1,class:"h-3.5 w-3.5"})):(_(),H(r(Rr),{key:0,class:"h-3.5 w-3.5"})),$(" "+D(oe.value?"Edit":"Preview"),1)]),_:1},8,["variant"])]),_:1}),n(r(Se),null,{default:i(()=>[...e[57]||(e[57]=[$("Toggle Preview Mode",-1)])]),_:1})]),_:1}),e[63]||(e[63]=a("div",{class:"w-px h-3 bg-border/50 mx-0.5"},null,-1)),n(r(Ce),null,{default:i(()=>[n(r(ke),{asChild:""},{default:i(()=>[n(r(G),{onClick:xa,variant:"ghost",size:"sm",class:"h-7 px-3 text-xs gap-2 text-muted-foreground hover:text-foreground"},{default:i(()=>[n(r(Ja),{class:"h-3.5 w-3.5 text-blue-500"}),e[58]||(e[58]=a("span",{class:"text-foreground"},"AI Chat",-1))]),_:1})]),_:1}),n(r(Se),null,{default:i(()=>[...e[59]||(e[59]=[$("Open AI Assistant Overlay",-1)])]),_:1})]),_:1}),e[64]||(e[64]=a("div",{class:"w-px h-3 bg-border/50 mx-0.5"},null,-1)),n(r(Ce),null,{default:i(()=>[n(r(ke),{asChild:""},{default:i(()=>[n(r(G),{onClick:Zt,variant:"ghost",size:"sm",class:"h-7 px-3 text-xs gap-2 text-zinc-700 dark:text-zinc-300 hover:text-foreground",title:te.value?"Exit Full Screen":"Enter Full Screen"},{default:i(()=>[te.value?(_(),H(r(Wa),{key:0,class:"h-3.5 w-3.5"})):(_(),H(r(Na),{key:1,class:"h-3.5 w-3.5"}))]),_:1},8,["title"])]),_:1}),n(r(Se),null,{default:i(()=>[...e[60]||(e[60]=[$("Toggle Full Screen",-1)])]),_:1})]),_:1}),e[65]||(e[65]=a("div",{class:"w-px h-3 bg-border/50 mx-0.5"},null,-1)),n(r(Ce),null,{default:i(()=>[n(r(ke),{asChild:""},{default:i(()=>[n(r(G),{onClick:me,variant:"ghost",size:"sm",class:"h-7 px-3 text-xs gap-2 text-zinc-700 dark:text-zinc-300 hover:text-foreground"},{default:i(()=>[R.value?(_(),H(r(_r),{key:0,class:"h-3.5 w-3.5 text-foreground"})):(_(),H(r(Cr),{key:1,class:"h-3.5 w-3.5"})),$(" "+D(R.value?"Dark":"Light"),1)]),_:1})]),_:1}),n(r(Se),null,{default:i(()=>[...e[61]||(e[61]=[$("Toggle Dark Mode",-1)])]),_:1})]),_:1})]),n(Sr,{project:ye.value,"current-chapter":_e.value,"all-chapters":Me.value,size:"sm",variant:"outline",class:"h-7 hidden md:flex text-zinc-700 dark:text-zinc-300"},null,8,["project","current-chapter","all-chapters"]),n(r(G),{variant:"ghost",size:"sm",class:"hidden md:flex h-7 gap-2 text-zinc-700 dark:text-zinc-300 hover:text-foreground",onClick:tr,title:"Open bulk analysis"},{default:i(()=>[n(r(it),{class:"w-4 h-4"}),e[66]||(e[66]=a("span",{class:"text-xs font-medium"},"Analyze",-1))]),_:1}),n(r(G),{onClick:e[19]||(e[19]=o=>r(xe)(!1)),disabled:r(Ae),variant:ft.value?"default":"secondary",size:"sm",class:"h-7 px-3 text-xs shadow-sm gap-2"},{default:i(()=>[n(r(Pr),{class:"h-3.5 w-3.5"}),$(" "+D(r(Ae)?"Saving...":"Save"),1)]),_:1},8,["disabled","variant"]),n(r(G),{onClick:pr,disabled:r(Ae),size:"sm",class:"h-7 px-3 text-xs shadow-sm gap-2"},{default:i(()=>[n(r(Lt),{class:"h-3.5 w-3.5"}),e[67]||(e[67]=$(" Mark Complete ",-1))]),_:1},8,["disabled"])])])]),a("div",Gn,[n(r(G),{variant:"ghost",size:"icon",onClick:e[20]||(e[20]=o=>Ie.value=!Ie.value),class:"hidden lg:flex text-muted-foreground hover:text-foreground ml-1 h-8 w-8"},{default:i(()=>[Ie.value?(_(),H(r(Ga),{key:1,class:"h-4 w-4"})):(_(),H(r(Ua),{key:0,class:"h-4 w-4"}))]),_:1}),n(r(G),{variant:"ghost",size:"icon",onClick:e[21]||(e[21]=o=>he.value=!0),class:"lg:hidden text-muted-foreground hover:text-foreground ml-1 h-8 w-8"},{default:i(()=>[n(r(it),{class:"h-4 w-4"})]),_:1})])]),a("div",Hn,[n(yt,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 -translate-y-4","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 -translate-y-4"},{default:i(()=>[E.value?(_(),K("div",Bn,[a("div",Kn,[a("div",Vn,[a("div",Qn,[a("div",Jn,[n(r(it),{class:"h-4 w-4 text-white animate-pulse"})]),a("div",Xn,[a("div",Yn,[e[68]||(e[68]=a("h4",{class:"text-xs font-semibold text-foreground"},"Generating Content...",-1)),a("span",Zn,D(Math.round(y.value))+"%",1)]),a("div",es,[a("div",{class:"h-full bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-300",style:ct({width:`${y.value}%`})},null,4)])])]),a("p",ts,D(x.value),1)])])])):ie("",!0)]),_:1}),n(r(xr),{ref_key:"editorScrollRef",ref:Gt,class:"h-full w-full"},{default:i(()=>[a("div",rs,[n(yt,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 -translate-y-2","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 -translate-y-2"},{default:i(()=>[J.value?(_(),H(Dr,{key:0,"show-statistics":!0,"current-word-count":r(Y),"writing-stats":r(Tt),"quality-analysis":r(we),"is-analyzing":r(Bt),class:"mb-8"},null,8,["current-word-count","writing-stats","quality-analysis","is-analyzing"])):ie("",!0)]),_:1}),Xe(a("div",as,[n(Tr,{ref_key:"richTextEditorFullscreen",ref:ot,modelValue:v.value,"onUpdate:modelValue":e[22]||(e[22]=o=>v.value=o),placeholder:"Start writing your chapter...",class:"prose prose-slate dark:prose-invert prose-lg max-w-none focus:outline-none min-h-[500px]","streaming-mode":rt.value,"is-generating":E.value,"generation-progress":x.value,"generation-percentage":y.value,"generation-phase":P.value,"onUpdate:selectedText":e[23]||(e[23]=o=>X.value=o),"min-height":"500px"},null,8,["modelValue","streaming-mode","is-generating","generation-progress","generation-percentage","generation-phase"])],512),[[Ye,!oe.value]]),Xe(a("div",os,[n(Er,{content:v.value,class:"prose prose-slate dark:prose-invert prose-lg max-w-none"},null,8,["content"])],512),[[Ye,oe.value]])])]),_:1},512)]),a("div",ns,[a("div",ss,[a("span",null,"Words: "+D(r(Y))+" / "+D(ge.value),1),a("span",ls,"Last saved: "+D(r(Ae)?"Saving...":"Just now"),1)]),a("div",is,[a("span",null,[e[69]||(e[69]=$("Quality: ",-1)),a("span",{class:ne(r($e)>70?"text-green-500":"text-amber-500")},D(r($e))+"%",3)]),ft.value?(_(),K("span",cs,[n(r(Lt),{class:"h-3 w-3"}),e[70]||(e[70]=$(" Ready ",-1))])):ie("",!0)])])]),Xe(a("aside",us,[a("div",ds,[e[72]||(e[72]=a("span",{class:"text-sm font-semibold tracking-tight text-foreground"},"Writing Assistant",-1)),n(r(Ce),null,{default:i(()=>[n(r(ke),{asChild:""},{default:i(()=>[n(r(G),{variant:"ghost",size:"icon",class:"h-7 w-7"},{default:i(()=>[n(r(kt),{class:"h-3.5 w-3.5"})]),_:1})]),_:1}),n(r(Se),null,{default:i(()=>[...e[71]||(e[71]=[$("Manage Citations",-1)])]),_:1})]),_:1})]),a("div",ps,[a("div",gs,[n(r(g),{project:ye.value,chapter:_e.value,"is-generating":E.value,"selected-text":X.value,"is-loading-suggestions":et.value,"show-citation-helper":Re.value,"chapter-content":v.value,"current-word-count":r(Y),"target-word-count":ge.value,onStartStreamingGeneration:Rt,onGetAiSuggestions:Dt,"onUpdate:showCitationHelper":e[24]||(e[24]=o=>Re.value=o),onInsertCitation:Yt,onCheckCitations:Mt},null,8,["project","chapter","is-generating","selected-text","is-loading-suggestions","show-citation-helper","chapter-content","current-word-count","target-word-count"]),n(r(w),{"show-defense-prep":W.value,questions:ue.value,"is-loading":Ve.value,"is-generating":Qe.value,"chapter-context":{chapter_number:le.value.chapter_number,chapter_title:le.value.title,word_count:r(Y)},"defense-watcher":{meetsThreshold:r(Ft),shouldShowProgress:gr.value,progressPercentage:r(vr),wordsRemaining:r(hr),hasTriggeredGeneration:r(lt),threshold:r(ht),statusMessage:r(dr)()},"auto-generate-enabled":qe.value,"onUpdate:showDefensePrep":lr,onGenerateMore:jt,onToggleAutoGenerate:ir,onRefresh:e[25]||(e[25]=()=>st(!0,{skipGeneration:!0})),onMarkHelpful:fr,onHideQuestion:mr},null,8,["show-defense-prep","questions","is-loading","is-generating","chapter-context","defense-watcher","auto-generate-enabled"])])])],512),[[Ye,!Ie.value]]),n(r(F),{"show-left-sidebar":ce.value,"show-right-sidebar":he.value,"is-mobile":ut.value,"all-chapters":Me.value,"current-chapter":_e.value,project:ye.value,"current-word-count":r(Y),"target-word-count":ge.value,"writing-quality-score":r($e),"chapter-content-length":v.value.length,"is-generating":E.value,"selected-text":X.value,"is-loading-suggestions":et.value,"show-citation-helper":Re.value,"chapter-content":v.value,"onUpdate:showLeftSidebar":e[26]||(e[26]=o=>ce.value=o),"onUpdate:showRightSidebar":e[27]||(e[27]=o=>he.value=o),onGoToChapter:at,onGenerateNextChapter:$t,onStartStreamingGeneration:Rt,onGetAiSuggestions:Dt,"onUpdate:showCitationHelper":e[28]||(e[28]=o=>Re.value=o),onCheckCitations:Mt},null,8,["show-left-sidebar","show-right-sidebar","is-mobile","all-chapters","current-chapter","project","current-word-count","target-word-count","writing-quality-score","chapter-content-length","is-generating","selected-text","is-loading-suggestions","show-citation-helper","chapter-content"]),n(Oa,{open:r(Ut),"current-balance":r(Lr),"required-words":r(Or),action:r(zr),"onUpdate:open":e[29]||(e[29]=o=>Ut.value=o),onClose:r(Wr)},null,8,["open","current-balance","required-words","action","onClose"]),Ue.value?(_(),K("div",vs,[n(r(zt),{class:"w-full max-w-md mx-4 bg-white dark:bg-slate-900 border-amber-500/50 shadow-2xl"},{default:i(()=>[n(r(Wt),null,{default:i(()=>[n(r(jr),{class:"flex items-center gap-2 text-amber-600 dark:text-amber-400"},{default:i(()=>[...e[73]||(e[73]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1),$(" Generation Interrupted ",-1)])]),_:1})]),_:1}),n(r(It),null,{default:i(()=>[a("p",hs,[e[74]||(e[74]=$(" Connection lost. ",-1)),a("span",fs,D(gt.value)+" words",1),e[75]||(e[75]=$(" may have been saved. ",-1))]),a("div",ms,[n(r(G),{onClick:fa,class:"flex-1 bg-amber-600 hover:bg-amber-700 text-white"},{default:i(()=>[...e[76]||(e[76]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),$(" Reload & Recover ",-1)])]),_:1}),n(r(G),{onClick:ma,variant:"outline",class:"flex-1"},{default:i(()=>[...e[77]||(e[77]=[$(" Dismiss ",-1)])]),_:1})])]),_:1})]),_:1})])):ie("",!0)])]),_:1},8,["class"]))]),_:1}))}}),$l=Xa(bs,[["__scopeId","data-v-7a038806"]]);export{$l as default};
