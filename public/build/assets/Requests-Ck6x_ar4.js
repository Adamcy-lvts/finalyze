import{bt as j,bs as k,cn as C,co as l,cp as r,cq as o,bE as s,cs as u,cB as m,cG as w,cS as h,df as N,cr as n,ct as d,ce as p,cl as f,cj as c}from"./vendor-DgjuSLrY.js";import{_ as S}from"./AdminLayout.vue_vue_type_script_setup_true_lang-nXq3DGFH.js";import{_ as $,a as R}from"./CardContent.vue_vue_type_script_setup_true_lang-CzDqfk0_.js";import{_ as V,a as F}from"./CardTitle.vue_vue_type_script_setup_true_lang-BXn45Ckp.js";import{_}from"./index-BevM4Rk7.js";import{_ as T}from"./Input.vue_vue_type_script_setup_true_lang-D350FEG5.js";import"./Sonner.vue_vue_type_script_setup_true_lang-oHQkWKcv.js";import"./UserInfo.vue_vue_type_script_setup_true_lang-Bih4cv7s.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-D_wg_4gP.js";const O={key:0,class:"text-sm text-muted-foreground"},P={key:1,class:"space-y-4"},B={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},A={class:"font-medium"},D={class:"text-sm text-muted-foreground"},E={class:"text-xs text-muted-foreground mt-1"},z={class:"text-xs text-muted-foreground"},G={class:"flex flex-col sm:flex-row gap-2 sm:items-center"},K={key:2,class:"flex items-center justify-between mt-6"},L={class:"text-sm text-muted-foreground"},U={class:"flex gap-2"},ee=j({__name:"Requests",props:{requests:{}},setup(x){const a=x,g=k({}),q=async i=>{try{const t=await(await fetch(f("admin.affiliates.requests.approve",i.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}})).json();t.success?(c.success("Request approved"),p.reload({only:["requests"]})):c.error(t.message||"Failed to approve request")}catch{c.error("Failed to approve request")}},y=async i=>{try{const t=await(await fetch(f("admin.affiliates.requests.reject",i.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({reason:g.value[i.id]||null})})).json();t.success?(c.success("Request rejected"),p.reload({only:["requests"]})):c.error(t.message||"Failed to reject request")}catch{c.error("Failed to reject request")}},b=i=>i?new Date(i).toLocaleDateString("en-NG",{year:"numeric",month:"short",day:"numeric"}):"â€”";return(i,e)=>(l(),C(S,{title:"Affiliate Requests",subtitle:"Review and approve affiliate applications."},{default:r(()=>[o(s($),{class:"border-border/50"},{default:r(()=>[o(s(V),null,{default:r(()=>[o(s(F),null,{default:r(()=>[...e[2]||(e[2]=[u("Pending Requests",-1)])]),_:1})]),_:1}),o(s(R),null,{default:r(()=>[a.requests.data.length===0?(l(),m("div",O,"No pending requests.")):(l(),m("div",P,[(l(!0),m(h,null,N(a.requests.data,t=>(l(),m("div",{key:t.id,class:"rounded-lg border border-border/50 p-4"},[n("div",B,[n("div",null,[n("p",A,d(t.name),1),n("p",D,d(t.email),1),n("p",E,"Requested: "+d(b(t.requested_at)),1),n("p",z,"Projects: "+d(t.projects_count),1)]),n("div",G,[o(s(T),{modelValue:g.value[t.id],"onUpdate:modelValue":v=>g.value[t.id]=v,placeholder:"Optional rejection note",class:"min-w-[200px]"},null,8,["modelValue","onUpdate:modelValue"]),o(s(_),{variant:"outline",onClick:v=>y(t)},{default:r(()=>[...e[3]||(e[3]=[u("Reject",-1)])]),_:2},1032,["onClick"]),o(s(_),{onClick:v=>q(t)},{default:r(()=>[...e[4]||(e[4]=[u("Approve",-1)])]),_:2},1032,["onClick"])])])]))),128))])),a.requests.last_page>1?(l(),m("div",K,[n("p",L," Page "+d(a.requests.current_page)+" of "+d(a.requests.last_page),1),n("div",U,[o(s(_),{variant:"outline",size:"sm",disabled:a.requests.current_page===1,onClick:e[0]||(e[0]=t=>s(p).get(s(f)("admin.affiliates.requests.index"),{page:a.requests.current_page-1},{preserveState:!0}))},{default:r(()=>[...e[5]||(e[5]=[u(" Previous ",-1)])]),_:1},8,["disabled"]),o(s(_),{variant:"outline",size:"sm",disabled:a.requests.current_page===a.requests.last_page,onClick:e[1]||(e[1]=t=>s(p).get(s(f)("admin.affiliates.requests.index"),{page:a.requests.current_page+1},{preserveState:!0}))},{default:r(()=>[...e[6]||(e[6]=[u(" Next ",-1)])]),_:1},8,["disabled"])])])):w("",!0)]),_:1})]),_:1})]),_:1}))}});export{ee as default};
