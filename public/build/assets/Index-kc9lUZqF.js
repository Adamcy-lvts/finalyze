import{C as D,_ as L}from"./AdminLayout.vue_vue_type_script_setup_true_lang-BmWEOCo2.js";import{_ as m,a as f}from"./CardContent.vue_vue_type_script_setup_true_lang-CvS13D9K.js";import{_ as V}from"./CardDescription.vue_vue_type_script_setup_true_lang-Cs7UBZQI.js";import{_ as p,a as _}from"./CardTitle.vue_vue_type_script_setup_true_lang-Dtj1h7eV.js";import{_ as E,S as P,D as q,C as T,a as z,b as K}from"./ChartTooltip.vue_vue_type_script_setup_true_lang-CBWD4yqi.js";import{d as U,y as h,a as u,F as G,q as H,V as J,C as W,o as w,E as s,K as l,c as C,O as X,H as e,n as M,M as r,u as t,P as c,J as Q}from"./app-C0iaHDzA.js";import{D as Y}from"./dollar-sign-DNKWLpv-.js";import{T as Z}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DouIdNch.js";import{A as ee}from"./activity-44oHyX8R.js";import"./UserInfo.vue_vue_type_script_setup_true_lang-XM7CyggX.js";import"./index-B8MfLIKH.js";import"./Presence-CRc-3ouu.js";import"./useForwardExpose-CSM5MnWw.js";import"./index-QcnTpKuz.js";import"./DialogTitle-BWlFjS2U.js";import"./x-D8_aAgCu.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-BKMm_IJw.js";import"./VisuallyHidden-DD6JSlZR.js";import"./users-B8oBx9bv.js";import"./chart-column-DJp6om8B.js";import"./index-CfcoRdXz.js";import"./file-text-DreGdZtM.js";import"./list-B_9x6MZm.js";import"./log-out-CMOHZ4dv.js";import"./loader-circle-Ckfjc31V.js";import"./index-BWEDi_FC.js";import"./axis-DouJwEGg.js";import"./linear-C5NI_5MW.js";import"./init-Dmth1JHB.js";import"./defaultLocale-C4B-KCzX.js";import"./band-BjYQJviF.js";import"./ordinal-B-SEvE7q.js";const te={class:"space-y-6"},se={class:"flex justify-end"},oe={key:0},ae={key:1},le={class:"flex items-center justify-between"},re={class:"text-sm text-muted-foreground"},ne={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-4"},ie={class:"text-2xl font-bold"},de={class:"text-xs text-muted-foreground mt-1"},ue={class:"text-2xl font-bold"},ce={class:"text-xs text-muted-foreground mt-1"},me={class:"text-2xl font-bold"},fe={class:"text-xs text-muted-foreground mt-1"},pe={class:"text-2xl font-bold"},_e={class:"text-xs text-muted-foreground mt-1"},ge={class:"grid gap-6 lg:grid-cols-2"},We=U({__name:"Index",props:{metrics:{},usageByModel:{},billingSnapshot:{}},setup(j){const k=j,S={liability_tokens:0,wallet_tokens:0,avg_daily_tokens_7:0,avg_daily_tokens_30:0,runway_days:null,status:"safe"},n=h(k.metrics??S),d=h(k.billingSnapshot??null),g=h(k.usageByModel??[]),x=u(()=>n.value?.status??"safe"),b=h(!1),$=u(()=>n.value?.liability_tokens??0),I=u(()=>n.value?.wallet_tokens??0),F=u(()=>n.value?.avg_daily_tokens_7??0),A=u(()=>!n.value||n.value.runway_days===null?"∞":`${n.value.runway_days} days`),N=u(()=>g.value?.length?g.value.map(a=>({model:a.model,input:a.input,output:a.output})):[]),v={input:{label:"Input Tokens",color:"hsl(var(--primary))"},output:{label:"Output Tokens",color:"hsl(var(--chart-2))"}},y=a=>a==null?"0":Number(a).toLocaleString();let B=null;G(()=>{B=window.Echo?.private("admin.ai"),B?.listen(".ai.provisioning.updated",a=>{a.metrics&&(n.value=a.metrics),a.snapshot&&(d.value=a.snapshot),a.usageByModel&&(g.value=a.usageByModel)})}),H(()=>{B?.stopListening(".ai.provisioning.updated")});const O=async()=>{try{b.value=!0;const o=await(await fetch(Q("admin.ai.refresh"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}})).json();o?.metrics&&(n.value=o.metrics),o?.snapshot&&(d.value=o.snapshot),o?.usageByModel&&(g.value=o.usageByModel)}catch(a){console.error("Failed to refresh AI metrics",a)}finally{b.value=!1}};return(a,o)=>{const R=J("Button");return w(),W(L,{title:"AI Monitoring",subtitle:"Real-time insights into AI generation performance."},{default:s(()=>[l("div",te,[l("div",se,[e(R,{size:"sm",disabled:b.value,onClick:O},{default:s(()=>[b.value?(w(),C("span",oe,"Refreshing...")):(w(),C("span",ae,"Refresh now"))]),_:1},8,["disabled"])]),x.value!=="safe"?(w(),C("div",{key:0,class:M(["rounded-lg border p-4",x.value==="critical"?"border-rose-500/50 bg-rose-500/10":"border-amber-500/50 bg-amber-500/10"])},[l("div",le,[l("div",null,[l("p",{class:M(["text-sm font-semibold",x.value==="critical"?"text-rose-600":"text-amber-600"])},r(x.value==="critical"?"Critical OpenAI Balance":"Low OpenAI Balance"),3),l("p",re," Available $"+r(d.value?.available_usd?.toFixed(2)??"0.00")+" · Liability "+r(y($.value))+" tokens · Runway "+r(A.value),1)])])],2)):X("",!0),l("div",ne,[e(t(m),{class:"bg-card text-card-foreground border-border/50 shadow-sm"},{default:s(()=>[e(t(p),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[e(t(_),{class:"text-sm font-medium text-muted-foreground"},{default:s(()=>[...o[0]||(o[0]=[c("OpenAI Available",-1)])]),_:1}),e(t(Y),{class:"h-4 w-4 text-primary"})]),_:1}),e(t(f),null,{default:s(()=>[l("div",ie,"$"+r(d.value?.available_usd?.toFixed(2)??"0.00"),1),l("p",de,"Granted $"+r(d.value?.granted_usd?.toFixed(2)??"0.00"),1)]),_:1})]),_:1}),e(t(m),{class:"bg-card text-card-foreground border-border/50 shadow-sm"},{default:s(()=>[e(t(p),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[e(t(_),{class:"text-sm font-medium text-muted-foreground"},{default:s(()=>[...o[1]||(o[1]=[c("Liability (tokens)",-1)])]),_:1}),e(t(D),{class:"h-4 w-4 text-emerald-500"})]),_:1}),e(t(f),null,{default:s(()=>[l("div",ue,r(y($.value)),1),l("p",ce,"Wallet "+r(y(I.value))+" tokens",1)]),_:1})]),_:1}),e(t(m),{class:"bg-card text-card-foreground border-border/50 shadow-sm"},{default:s(()=>[e(t(p),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[e(t(_),{class:"text-sm font-medium text-muted-foreground"},{default:s(()=>[...o[2]||(o[2]=[c("Runway",-1)])]),_:1}),e(t(Z),{class:"h-4 w-4 text-amber-500"})]),_:1}),e(t(f),null,{default:s(()=>[l("div",me,r(A.value),1),l("p",fe,"Avg burn (7d): "+r(y(F.value))+" tokens/day",1)]),_:1})]),_:1}),e(t(m),{class:"bg-card text-card-foreground border-border/50 shadow-sm"},{default:s(()=>[e(t(p),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[e(t(_),{class:"text-sm font-medium text-muted-foreground"},{default:s(()=>[...o[3]||(o[3]=[c("Billing Period",-1)])]),_:1}),e(t(ee),{class:"h-4 w-4 text-rose-500"})]),_:1}),e(t(f),null,{default:s(()=>[l("div",pe," $"+r(d.value?.used_usd?.toFixed(2)??"0.00")+" used ",1),l("p",_e,r(d.value?.period_start??"—")+" → "+r(d.value?.period_end??"—"),1)]),_:1})]),_:1})]),l("div",ge,[e(t(m),{class:"bg-card text-card-foreground border-border/50 shadow-sm"},{default:s(()=>[e(t(p),null,{default:s(()=>[e(t(_),{class:"text-base font-semibold"},{default:s(()=>[...o[4]||(o[4]=[c("Token Usage",-1)])]),_:1}),e(t(V),null,{default:s(()=>[...o[5]||(o[5]=[c("Total tokens consumed per model",-1)])]),_:1})]),_:1}),e(t(f),{class:"pl-0"},{default:s(()=>[e(t(E),{config:v,class:"h-[300px] w-full"},{default:s(()=>[e(t(P),{data:N.value,height:300,margin:{top:10,right:10,bottom:0,left:10}},{default:s(()=>[e(t(q),{x:i=>i.model,y:[i=>i.input,i=>i.output],color:[v.input.color,v.output.color],"rounded-corners":4,"bar-padding":.2},null,8,["x","y","color"]),e(t(T),{type:"x",x:i=>i.model,"grid-line":!1,"domain-line":!1,color:"#888888"},null,8,["x"]),e(t(T),{type:"y","grid-line":!0,"domain-line":!1,"tick-line":!1,"tick-format":i=>i/1e3+"k",color:"#888888"},null,8,["tick-format"]),e(t(z)),e(t(K),{config:v,class:"mt-4 justify-center"})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1})])])]),_:1})}}});export{We as default};
