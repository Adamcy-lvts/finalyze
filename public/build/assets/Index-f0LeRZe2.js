import{bu as q,dL as X,cn as S,co as m,cp as l,cq as t,bF as e,cr as d,dM as Y,cs as i,dj as Z,dN as ee,ce as z,cl as A,by as x,dO as te,ch as se,ck as C,bt as D,dx as ae,bv as le,cG as g,dQ as re,ct as u,cA as oe,cL as de,dE as ne,cB as v,cS as K,de as T,dT as ie}from"./vendor-BJBNFzu6.js";import{_ as ue}from"./AdminLayout.vue_vue_type_script_setup_true_lang-5PjUNBKt.js";import{_ as me}from"./DataTable.vue_vue_type_script_setup_true_lang-D8xdcjeO.js";import{_ as G}from"./Switch.vue_vue_type_script_setup_true_lang-CJ_Us863.js";import{_ as h}from"./index-DKTzjY4t.js";import{_ as ce,a as pe,b as fe,c as M,d as _e,e as ve}from"./Sonner.vue_vue_type_script_setup_true_lang-C7Uf4kO1.js";import{_ as B,a as I}from"./CardContent.vue_vue_type_script_setup_true_lang-BmpoBQtZ.js";import{_ as ge}from"./CardDescription.vue_vue_type_script_setup_true_lang-KZvNMa6T.js";import{_ as N,a as O}from"./CardTitle.vue_vue_type_script_setup_true_lang-CLvp_ZLs.js";import{_ as E}from"./Input.vue_vue_type_script_setup_true_lang-CB-7LUUJ.js";import{_ as b}from"./Label.vue_vue_type_script_setup_true_lang-YwrTvequ.js";import{_ as ye}from"./Textarea.vue_vue_type_script_setup_true_lang-BY6MGpO5.js";import{_ as xe}from"./Checkbox.vue_vue_type_script_setup_true_lang-BMD0Hw_m.js";import{_ as be,a as $e}from"./index-BWPj8eKR.js";import{_ as ke}from"./AlertTitle.vue_vue_type_script_setup_true_lang-BWkRHULC.js";import{_ as Ve,a as we}from"./DialogContent.vue_vue_type_script_setup_true_lang-C8SicQru.js";import{_ as Ce}from"./DialogDescription.vue_vue_type_script_setup_true_lang-B95wIsmA.js";import{_ as Se,a as he}from"./DialogTitle.vue_vue_type_script_setup_true_lang-vwptL7Il.js";import{_ as Fe,a as Ue,b as De,c as Ee,d as Ae}from"./SelectValue.vue_vue_type_script_setup_true_lang-wpFPlOW9.js";import"./UserInfo.vue_vue_type_script_setup_true_lang-LFxEtfzj.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-D5gHzBY1.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-DqI1VKin.js";const je=q({__name:"DepartmentActions",props:{department:{}},setup(n){const f=n,$=X("onEditDepartment"),y=()=>{confirm(`Delete ${f.department.name}?`)&&z.delete(A("admin.system.departments.destroy",{department:f.department.id}),{preserveScroll:!0})};return(F,p)=>(m(),S(e(ve),null,{default:l(()=>[t(e(ce),{"as-child":""},{default:l(()=>[t(e(h),{variant:"ghost",class:"h-8 w-8 p-0"},{default:l(()=>[p[1]||(p[1]=d("span",{class:"sr-only"},"Open menu",-1)),t(e(Y),{class:"h-4 w-4"})]),_:1})]),_:1}),t(e(pe),{align:"end"},{default:l(()=>[t(e(fe),null,{default:l(()=>[...p[2]||(p[2]=[i("Actions",-1)])]),_:1}),t(e(M),{onClick:p[0]||(p[0]=k=>e($)?.(f.department))},{default:l(()=>[t(e(Z),{class:"mr-2 h-4 w-4"}),p[3]||(p[3]=i(" Edit ",-1))]),_:1}),t(e(_e)),t(e(M),{onClick:y,class:"text-rose-600 focus:text-rose-600 focus:bg-rose-50"},{default:l(()=>[t(e(ee),{class:"mr-2 h-4 w-4"}),p[4]||(p[4]=i(" Delete ",-1))]),_:1})]),_:1})]),_:1}))}}),Be=(n,f)=>{z.put(A("admin.system.departments.toggle-active",{department:n.id}),{is_active:f},{preserveScroll:!0})},Ie=[{accessorKey:"name",header:({column:n})=>x(h,{variant:"ghost",class:"-ml-2 text-xs hover:bg-muted/50",onClick:()=>n.toggleSorting(n.getIsSorted()==="asc")},()=>["Name",x(te,{class:"ml-2 h-3 w-3"})]),cell:({row:n})=>{const f=n.getValue("name"),$=n.original.slug,y=n.original.code,F=y?`${y} · ${$}`:$;return x("div",{class:"flex flex-col"},[x("span",{class:"font-medium"},f),x("span",{class:"text-xs text-muted-foreground"},F)])}},{accessorKey:"faculty_name",header:"Faculty",cell:({row:n})=>n.original.faculty_name||"—"},{accessorKey:"sort_order",header:"Order",cell:({row:n})=>n.getValue("sort_order")},{accessorKey:"is_active",header:"Active",cell:({row:n})=>x(G,{checked:n.original.is_active,"onUpdate:checked":f=>Be(n.original,f)})},{id:"actions",cell:({row:n})=>x(je,{department:n.original})}],Ne={class:"grid gap-4 md:grid-cols-2 mb-6"},Oe={class:"text-2xl font-bold"},Le={class:"text-2xl font-bold"},Pe={class:"grid gap-4 py-4"},Ke={class:"grid gap-4 md:grid-cols-2"},Te={class:"space-y-1"},Me={key:0,class:"text-xs text-rose-500"},qe={class:"space-y-1"},ze={key:0,class:"text-xs text-rose-500"},Ge={class:"grid gap-4 md:grid-cols-2"},Qe={class:"space-y-1"},He={key:0,class:"text-xs text-rose-500"},Je={class:"space-y-1"},Re={key:0,class:"text-xs text-rose-500"},We={class:"space-y-2"},Xe={class:"grid gap-2 md:grid-cols-2"},Ye={key:0,class:"text-xs text-rose-500"},Ze={class:"space-y-1"},et={key:0,class:"text-xs text-rose-500"},tt={class:"grid gap-4 md:grid-cols-2"},st={class:"space-y-1"},at={key:0,class:"text-xs text-rose-500"},lt={class:"flex items-center justify-between rounded-md border border-border/70 bg-muted/30 px-3 py-2 text-sm"},rt={class:"flex justify-end gap-2"},Ft=q({__name:"Index",props:{departments:{},faculties:{},stats:{}},setup(n){const f=n,$=se(),y=C(()=>$.props.flash),F=C(()=>f.departments??[]),p=C(()=>f.faculties??[]),k=D(null),V=D(!1),c=D([]),_=D(""),L=()=>({name:"",slug:"",code:"",description:"",faculty_ids:[],primary_faculty_id:"",sort_order:0,is_active:!0}),a=ae({...L()}),U=C(()=>k.value!==null),P=()=>{k.value=null,a.clearErrors(),Object.assign(a,L()),c.value=[],_.value=""},Q=()=>{P(),V.value=!0},H=o=>{k.value=o.id,a.clearErrors(),a.name=o.name??"",a.slug=o.slug??"",a.code=o.code??"",a.description=o.description??"";const s=o.faculty_id?[o.faculty_id]:[],r=o.faculty_ids&&o.faculty_ids.length>0?o.faculty_ids:s;c.value=r.filter(Boolean).map(j=>String(j));const w=o.primary_faculty_id??o.faculty_id??r[0]??null;_.value=w?String(w):"",_.value&&!c.value.includes(_.value)&&(c.value=[...c.value,_.value]),a.sort_order=Number(o.sort_order??0),a.is_active=!!o.is_active,V.value=!0},J=C(()=>p.value.filter(o=>c.value.includes(String(o.id)))),R=(o,s)=>{const r=String(o);if(s===!0){c.value.includes(r)||(c.value=[...c.value,r]),_.value||(_.value=r);return}c.value=c.value.filter(j=>j!==r),_.value===r&&(_.value=c.value[0]??"")},W=()=>{a.faculty_ids=[...c.value],a.primary_faculty_id=_.value;const o={preserveScroll:!0,onSuccess:()=>{V.value=!1,P()}};if(!a.primary_faculty_id&&a.faculty_ids.length>0&&(a.primary_faculty_id=a.faculty_ids[0]),U.value&&k.value!==null){a.put(A("admin.system.departments.update",{department:k.value}),o);return}a.post(A("admin.system.departments.store"),o)};return le("onEditDepartment",H),(o,s)=>(m(),S(ue,{title:"Departments",subtitle:"Manage departments available for project setup."},{default:l(()=>[d("div",Ne,[t(e(B),{class:"bg-card text-card-foreground border-border/50 shadow-sm"},{default:l(()=>[t(e(N),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[t(e(O),{class:"text-sm font-medium text-muted-foreground"},{default:l(()=>[...s[9]||(s[9]=[i("Total Departments",-1)])]),_:1}),t(e(re),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(I),null,{default:l(()=>[d("div",Oe,u(o.stats.total),1)]),_:1})]),_:1}),t(e(B),{class:"bg-card text-card-foreground border-border/50 shadow-sm"},{default:l(()=>[t(e(N),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[t(e(O),{class:"text-sm font-medium text-muted-foreground"},{default:l(()=>[...s[10]||(s[10]=[i("Active",-1)])]),_:1}),t(e(oe),{class:"h-4 w-4 text-emerald-500"})]),_:1}),t(e(I),null,{default:l(()=>[d("div",Le,u(o.stats.active),1)]),_:1})]),_:1})]),y.value?.success?(m(),S(e(be),{key:0,class:"mb-6 border border-emerald-500/40 bg-emerald-500/10"},{default:l(()=>[t(e(de),{class:"h-4 w-4 text-emerald-500"}),t(e(ke),null,{default:l(()=>[...s[11]||(s[11]=[i("Updated",-1)])]),_:1}),t(e($e),null,{default:l(()=>[i(u(y.value.success),1)]),_:1})]),_:1})):g("",!0),t(e(B),{class:"border border-border/50 bg-card shadow-sm"},{default:l(()=>[t(e(N),{class:"flex flex-row items-center justify-between pb-3"},{default:l(()=>[d("div",null,[t(e(O),{class:"text-base font-semibold text-foreground"},{default:l(()=>[...s[12]||(s[12]=[i("Departments",-1)])]),_:1}),t(e(ge),null,{default:l(()=>[...s[13]||(s[13]=[i("Assign departments to faculties for selection.",-1)])]),_:1})]),t(e(h),{size:"sm",onClick:Q},{default:l(()=>[t(e(ne),{class:"mr-2 h-4 w-4"}),s[14]||(s[14]=i(" Add Department ",-1))]),_:1})]),_:1}),t(e(I),null,{default:l(()=>[t(me,{columns:e(Ie),data:F.value,"search-key":"name","search-placeholder":"Filter departments..."},null,8,["columns","data"])]),_:1})]),_:1}),t(e(Ve),{open:V.value,"onUpdate:open":s[8]||(s[8]=r=>V.value=r)},{default:l(()=>[t(e(we),{class:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto"},{default:l(()=>[t(e(Se),null,{default:l(()=>[t(e(he),null,{default:l(()=>[i(u(U.value?"Edit department":"Create department"),1)]),_:1}),t(e(Ce),null,{default:l(()=>[i(u(U.value?"Update department details.":"Add a new department to the catalog."),1)]),_:1})]),_:1}),d("div",Pe,[d("div",Ke,[d("div",Te,[t(e(b),null,{default:l(()=>[...s[15]||(s[15]=[i("Name",-1)])]),_:1}),t(e(E),{modelValue:e(a).name,"onUpdate:modelValue":s[0]||(s[0]=r=>e(a).name=r),placeholder:"Computer Science"},null,8,["modelValue"]),e(a).errors.name?(m(),v("p",Me,u(e(a).errors.name),1)):g("",!0)]),d("div",qe,[t(e(b),null,{default:l(()=>[...s[16]||(s[16]=[i("Slug",-1)])]),_:1}),t(e(E),{modelValue:e(a).slug,"onUpdate:modelValue":s[1]||(s[1]=r=>e(a).slug=r),placeholder:"computer-science"},null,8,["modelValue"]),e(a).errors.slug?(m(),v("p",ze,u(e(a).errors.slug),1)):g("",!0)])]),d("div",Ge,[d("div",Qe,[t(e(b),null,{default:l(()=>[...s[17]||(s[17]=[i("Code",-1)])]),_:1}),t(e(E),{modelValue:e(a).code,"onUpdate:modelValue":s[2]||(s[2]=r=>e(a).code=r),placeholder:"CSC"},null,8,["modelValue"]),e(a).errors.code?(m(),v("p",He,u(e(a).errors.code),1)):g("",!0)]),d("div",Je,[t(e(b),null,{default:l(()=>[...s[18]||(s[18]=[i("Primary Faculty",-1)])]),_:1}),t(e(Fe),{modelValue:_.value,"onUpdate:modelValue":s[3]||(s[3]=r=>_.value=r)},{default:l(()=>[t(e(Ue),null,{default:l(()=>[t(e(De),{placeholder:"Select primary faculty"})]),_:1}),t(e(Ee),null,{default:l(()=>[(m(!0),v(K,null,T(J.value,r=>(m(),S(e(Ae),{key:r.id,value:String(r.id)},{default:l(()=>[i(u(r.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(a).errors.primary_faculty_id?(m(),v("p",Re,u(e(a).errors.primary_faculty_id),1)):g("",!0)])]),d("div",We,[t(e(b),null,{default:l(()=>[...s[19]||(s[19]=[i("Faculties (appear in multiple lists)",-1)])]),_:1}),d("div",Xe,[(m(!0),v(K,null,T(p.value,r=>(m(),v("label",{key:r.id,class:"flex items-center gap-2 rounded-md border border-border/70 bg-muted/30 px-3 py-2 text-sm"},[t(e(xe),{"model-value":c.value.includes(String(r.id)),"onUpdate:modelValue":w=>R(r.id,w)},null,8,["model-value","onUpdate:modelValue"]),d("span",null,u(r.name),1)]))),128))]),e(a).errors.faculty_ids?(m(),v("p",Ye,u(e(a).errors.faculty_ids),1)):g("",!0)]),d("div",Ze,[t(e(b),null,{default:l(()=>[...s[20]||(s[20]=[i("Description",-1)])]),_:1}),t(e(ye),{modelValue:e(a).description,"onUpdate:modelValue":s[4]||(s[4]=r=>e(a).description=r),rows:"3",placeholder:"Optional description..."},null,8,["modelValue"]),e(a).errors.description?(m(),v("p",et,u(e(a).errors.description),1)):g("",!0)]),d("div",tt,[d("div",st,[t(e(b),null,{default:l(()=>[...s[21]||(s[21]=[i("Sort Order",-1)])]),_:1}),t(e(E),{modelValue:e(a).sort_order,"onUpdate:modelValue":s[5]||(s[5]=r=>e(a).sort_order=r),type:"number",min:"0"},null,8,["modelValue"]),e(a).errors.sort_order?(m(),v("p",at,u(e(a).errors.sort_order),1)):g("",!0)]),d("label",lt,[s[22]||(s[22]=d("span",{class:"text-foreground"},"Active",-1)),t(e(G),{checked:e(a).is_active,"onUpdate:checked":s[6]||(s[6]=r=>e(a).is_active=r)},null,8,["checked"])])])]),d("div",rt,[t(e(h),{variant:"ghost",onClick:s[7]||(s[7]=r=>V.value=!1)},{default:l(()=>[...s[23]||(s[23]=[i("Cancel",-1)])]),_:1}),t(e(h),{disabled:e(a).processing,onClick:W},{default:l(()=>[e(a).processing?(m(),S(e(ie),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):g("",!0),d("span",null,u(U.value?"Update department":"Add department"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["open"])]),_:1}))}});export{Ft as default};
