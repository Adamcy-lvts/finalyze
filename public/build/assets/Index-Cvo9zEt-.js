import{bt as q,dT as R,cm as S,cn as m,co as l,cp as s,bE as e,cq as d,dU as X,cr as i,dm as Z,dV as ee,cd as z,ck as A,bx as x,dW as se,cg as te,cj as C,bs as D,dF as ae,bu as le,cH as g,dY as re,cs as u,cz as oe,cM as de,dM as ne,cC as v,cS as M,dh as T,dw as ie}from"./vendor-B0P7kkmx.js";import{_ as ue}from"./AdminLayout.vue_vue_type_script_setup_true_lang-B-851hYY.js";import{_ as me}from"./DataTable.vue_vue_type_script_setup_true_lang-Dh14W6ZJ.js";import{_ as H}from"./Switch.vue_vue_type_script_setup_true_lang-BIxiqTEX.js";import{_ as h}from"./index-CeE5dpwC.js";import{_ as ce,a as pe,b as fe,c as L,d as _e,e as ve}from"./Sonner.vue_vue_type_script_setup_true_lang-DEHww6d5.js";import{_ as I,a as B}from"./CardContent.vue_vue_type_script_setup_true_lang-Inj97kMy.js";import{_ as ge}from"./CardDescription.vue_vue_type_script_setup_true_lang-DRGhurAy.js";import{_ as N,a as O}from"./CardTitle.vue_vue_type_script_setup_true_lang-mTag2pdV.js";import{_ as E}from"./Input.vue_vue_type_script_setup_true_lang-0iIQAkgW.js";import{_ as b}from"./Label.vue_vue_type_script_setup_true_lang-DRSnzPnQ.js";import{_ as ye}from"./Textarea.vue_vue_type_script_setup_true_lang-DYAne4do.js";import{_ as xe}from"./Checkbox.vue_vue_type_script_setup_true_lang-BJE_DG-V.js";import{_ as be,a as $e}from"./index-z7e1PJ88.js";import{_ as ke}from"./AlertTitle.vue_vue_type_script_setup_true_lang-CUjPw_KO.js";import{_ as Ve,a as we}from"./DialogContent.vue_vue_type_script_setup_true_lang-BcLRXWRk.js";import{_ as Ce}from"./DialogDescription.vue_vue_type_script_setup_true_lang-CZgsL1-5.js";import{_ as Se,a as he}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BZjZPbYx.js";import{_ as Ue,a as Fe,b as De,c as Ee,d as Ae}from"./SelectValue.vue_vue_type_script_setup_true_lang-DCcwzhya.js";import"./UserInfo.vue_vue_type_script_setup_true_lang-mfygCHkH.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-j6BVOz2e.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-ChQslsBR.js";const je=q({__name:"DepartmentActions",props:{department:{}},setup(n){const f=n,$=R("onEditDepartment"),y=()=>{confirm(`Delete ${f.department.name}?`)&&z.delete(A("admin.system.departments.destroy",{department:f.department.id}),{preserveScroll:!0})};return(U,p)=>(m(),S(e(ve),null,{default:l(()=>[s(e(ce),{"as-child":""},{default:l(()=>[s(e(h),{variant:"ghost",class:"h-8 w-8 p-0"},{default:l(()=>[p[1]||(p[1]=d("span",{class:"sr-only"},"Open menu",-1)),s(e(X),{class:"h-4 w-4"})]),_:1})]),_:1}),s(e(pe),{align:"end"},{default:l(()=>[s(e(fe),null,{default:l(()=>[...p[2]||(p[2]=[i("Actions",-1)])]),_:1}),s(e(L),{onClick:p[0]||(p[0]=k=>e($)?.(f.department))},{default:l(()=>[s(e(Z),{class:"mr-2 h-4 w-4"}),p[3]||(p[3]=i(" Edit ",-1))]),_:1}),s(e(_e)),s(e(L),{onClick:y,class:"text-rose-600 focus:text-rose-600 focus:bg-rose-50"},{default:l(()=>[s(e(ee),{class:"mr-2 h-4 w-4"}),p[4]||(p[4]=i(" Delete ",-1))]),_:1})]),_:1})]),_:1}))}}),Ie=(n,f)=>{z.put(A("admin.system.departments.toggle-active",{department:n.id}),{is_active:f},{preserveScroll:!0})},Be=[{accessorKey:"name",header:({column:n})=>x(h,{variant:"ghost",class:"-ml-2 text-xs hover:bg-muted/50",onClick:()=>n.toggleSorting(n.getIsSorted()==="asc")},()=>["Name",x(se,{class:"ml-2 h-3 w-3"})]),cell:({row:n})=>{const f=n.getValue("name"),$=n.original.slug,y=n.original.code,U=y?`${y} · ${$}`:$;return x("div",{class:"flex flex-col"},[x("span",{class:"font-medium"},f),x("span",{class:"text-xs text-muted-foreground"},U)])}},{accessorKey:"faculty_name",header:"Faculty",cell:({row:n})=>n.original.faculty_name||"—"},{accessorKey:"sort_order",header:"Order",cell:({row:n})=>n.getValue("sort_order")},{accessorKey:"is_active",header:"Active",cell:({row:n})=>x(H,{checked:n.original.is_active,"onUpdate:checked":f=>Ie(n.original,f)})},{id:"actions",cell:({row:n})=>x(je,{department:n.original})}],Ne={class:"grid gap-4 md:grid-cols-2 mb-6"},Oe={class:"text-2xl font-bold"},Pe={class:"text-2xl font-bold"},Ke={class:"grid gap-4 py-4"},Me={class:"grid gap-4 md:grid-cols-2"},Te={class:"space-y-1"},Le={key:0,class:"text-xs text-rose-500"},qe={class:"space-y-1"},ze={key:0,class:"text-xs text-rose-500"},He={class:"grid gap-4 md:grid-cols-2"},We={class:"space-y-1"},Ye={key:0,class:"text-xs text-rose-500"},Ge={class:"space-y-1"},Je={key:0,class:"text-xs text-rose-500"},Qe={class:"space-y-2"},Re={class:"grid gap-2 md:grid-cols-2"},Xe={key:0,class:"text-xs text-rose-500"},Ze={class:"space-y-1"},es={key:0,class:"text-xs text-rose-500"},ss={class:"grid gap-4 md:grid-cols-2"},ts={class:"space-y-1"},as={key:0,class:"text-xs text-rose-500"},ls={class:"flex items-center justify-between rounded-md border border-border/70 bg-muted/30 px-3 py-2 text-sm"},rs={class:"flex justify-end gap-2"},Us=q({__name:"Index",props:{departments:{},faculties:{},stats:{}},setup(n){const f=n,$=te(),y=C(()=>$.props.flash),U=C(()=>f.departments??[]),p=C(()=>f.faculties??[]),k=D(null),V=D(!1),c=D([]),_=D(""),P=()=>({name:"",slug:"",code:"",description:"",faculty_ids:[],primary_faculty_id:"",sort_order:0,is_active:!0}),a=ae({...P()}),F=C(()=>k.value!==null),K=()=>{k.value=null,a.clearErrors(),Object.assign(a,P()),c.value=[],_.value=""},W=()=>{K(),V.value=!0},Y=o=>{k.value=o.id,a.clearErrors(),a.name=o.name??"",a.slug=o.slug??"",a.code=o.code??"",a.description=o.description??"";const t=o.faculty_id?[o.faculty_id]:[],r=o.faculty_ids&&o.faculty_ids.length>0?o.faculty_ids:t;c.value=r.filter(Boolean).map(j=>String(j));const w=o.primary_faculty_id??o.faculty_id??r[0]??null;_.value=w?String(w):"",_.value&&!c.value.includes(_.value)&&(c.value=[...c.value,_.value]),a.sort_order=Number(o.sort_order??0),a.is_active=!!o.is_active,V.value=!0},G=C(()=>p.value.filter(o=>c.value.includes(String(o.id)))),J=(o,t)=>{const r=String(o);if(t===!0){c.value.includes(r)||(c.value=[...c.value,r]),_.value||(_.value=r);return}c.value=c.value.filter(j=>j!==r),_.value===r&&(_.value=c.value[0]??"")},Q=()=>{a.faculty_ids=[...c.value],a.primary_faculty_id=_.value;const o={preserveScroll:!0,onSuccess:()=>{V.value=!1,K()}};if(!a.primary_faculty_id&&a.faculty_ids.length>0&&(a.primary_faculty_id=a.faculty_ids[0]),F.value&&k.value!==null){a.put(A("admin.system.departments.update",{department:k.value}),o);return}a.post(A("admin.system.departments.store"),o)};return le("onEditDepartment",Y),(o,t)=>(m(),S(ue,{title:"Departments",subtitle:"Manage departments available for project setup."},{default:l(()=>[d("div",Ne,[s(e(I),{class:"bg-card text-card-foreground border-border/50 shadow-sm"},{default:l(()=>[s(e(N),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[s(e(O),{class:"text-sm font-medium text-muted-foreground"},{default:l(()=>[...t[9]||(t[9]=[i("Total Departments",-1)])]),_:1}),s(e(re),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),s(e(B),null,{default:l(()=>[d("div",Oe,u(o.stats.total),1)]),_:1})]),_:1}),s(e(I),{class:"bg-card text-card-foreground border-border/50 shadow-sm"},{default:l(()=>[s(e(N),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[s(e(O),{class:"text-sm font-medium text-muted-foreground"},{default:l(()=>[...t[10]||(t[10]=[i("Active",-1)])]),_:1}),s(e(oe),{class:"h-4 w-4 text-emerald-500"})]),_:1}),s(e(B),null,{default:l(()=>[d("div",Pe,u(o.stats.active),1)]),_:1})]),_:1})]),y.value?.success?(m(),S(e(be),{key:0,class:"mb-6 border border-emerald-500/40 bg-emerald-500/10"},{default:l(()=>[s(e(de),{class:"h-4 w-4 text-emerald-500"}),s(e(ke),null,{default:l(()=>[...t[11]||(t[11]=[i("Updated",-1)])]),_:1}),s(e($e),null,{default:l(()=>[i(u(y.value.success),1)]),_:1})]),_:1})):g("",!0),s(e(I),{class:"border border-border/50 bg-card shadow-sm"},{default:l(()=>[s(e(N),{class:"flex flex-row items-center justify-between pb-3"},{default:l(()=>[d("div",null,[s(e(O),{class:"text-base font-semibold text-foreground"},{default:l(()=>[...t[12]||(t[12]=[i("Departments",-1)])]),_:1}),s(e(ge),null,{default:l(()=>[...t[13]||(t[13]=[i("Assign departments to faculties for selection.",-1)])]),_:1})]),s(e(h),{size:"sm",onClick:W},{default:l(()=>[s(e(ne),{class:"mr-2 h-4 w-4"}),t[14]||(t[14]=i(" Add Department ",-1))]),_:1})]),_:1}),s(e(B),null,{default:l(()=>[s(me,{columns:e(Be),data:U.value,"search-key":"name","search-placeholder":"Filter departments..."},null,8,["columns","data"])]),_:1})]),_:1}),s(e(Ve),{open:V.value,"onUpdate:open":t[8]||(t[8]=r=>V.value=r)},{default:l(()=>[s(e(we),{class:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto"},{default:l(()=>[s(e(Se),null,{default:l(()=>[s(e(he),null,{default:l(()=>[i(u(F.value?"Edit department":"Create department"),1)]),_:1}),s(e(Ce),null,{default:l(()=>[i(u(F.value?"Update department details.":"Add a new department to the catalog."),1)]),_:1})]),_:1}),d("div",Ke,[d("div",Me,[d("div",Te,[s(e(b),null,{default:l(()=>[...t[15]||(t[15]=[i("Name",-1)])]),_:1}),s(e(E),{modelValue:e(a).name,"onUpdate:modelValue":t[0]||(t[0]=r=>e(a).name=r),placeholder:"Computer Science"},null,8,["modelValue"]),e(a).errors.name?(m(),v("p",Le,u(e(a).errors.name),1)):g("",!0)]),d("div",qe,[s(e(b),null,{default:l(()=>[...t[16]||(t[16]=[i("Slug",-1)])]),_:1}),s(e(E),{modelValue:e(a).slug,"onUpdate:modelValue":t[1]||(t[1]=r=>e(a).slug=r),placeholder:"computer-science"},null,8,["modelValue"]),e(a).errors.slug?(m(),v("p",ze,u(e(a).errors.slug),1)):g("",!0)])]),d("div",He,[d("div",We,[s(e(b),null,{default:l(()=>[...t[17]||(t[17]=[i("Code",-1)])]),_:1}),s(e(E),{modelValue:e(a).code,"onUpdate:modelValue":t[2]||(t[2]=r=>e(a).code=r),placeholder:"CSC"},null,8,["modelValue"]),e(a).errors.code?(m(),v("p",Ye,u(e(a).errors.code),1)):g("",!0)]),d("div",Ge,[s(e(b),null,{default:l(()=>[...t[18]||(t[18]=[i("Primary Faculty",-1)])]),_:1}),s(e(Ue),{modelValue:_.value,"onUpdate:modelValue":t[3]||(t[3]=r=>_.value=r)},{default:l(()=>[s(e(Fe),null,{default:l(()=>[s(e(De),{placeholder:"Select primary faculty"})]),_:1}),s(e(Ee),null,{default:l(()=>[(m(!0),v(M,null,T(G.value,r=>(m(),S(e(Ae),{key:r.id,value:String(r.id)},{default:l(()=>[i(u(r.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(a).errors.primary_faculty_id?(m(),v("p",Je,u(e(a).errors.primary_faculty_id),1)):g("",!0)])]),d("div",Qe,[s(e(b),null,{default:l(()=>[...t[19]||(t[19]=[i("Faculties (appear in multiple lists)",-1)])]),_:1}),d("div",Re,[(m(!0),v(M,null,T(p.value,r=>(m(),v("label",{key:r.id,class:"flex items-center gap-2 rounded-md border border-border/70 bg-muted/30 px-3 py-2 text-sm"},[s(e(xe),{"model-value":c.value.includes(String(r.id)),"onUpdate:modelValue":w=>J(r.id,w)},null,8,["model-value","onUpdate:modelValue"]),d("span",null,u(r.name),1)]))),128))]),e(a).errors.faculty_ids?(m(),v("p",Xe,u(e(a).errors.faculty_ids),1)):g("",!0)]),d("div",Ze,[s(e(b),null,{default:l(()=>[...t[20]||(t[20]=[i("Description",-1)])]),_:1}),s(e(ye),{modelValue:e(a).description,"onUpdate:modelValue":t[4]||(t[4]=r=>e(a).description=r),rows:"3",placeholder:"Optional description..."},null,8,["modelValue"]),e(a).errors.description?(m(),v("p",es,u(e(a).errors.description),1)):g("",!0)]),d("div",ss,[d("div",ts,[s(e(b),null,{default:l(()=>[...t[21]||(t[21]=[i("Sort Order",-1)])]),_:1}),s(e(E),{modelValue:e(a).sort_order,"onUpdate:modelValue":t[5]||(t[5]=r=>e(a).sort_order=r),type:"number",min:"0"},null,8,["modelValue"]),e(a).errors.sort_order?(m(),v("p",as,u(e(a).errors.sort_order),1)):g("",!0)]),d("label",ls,[t[22]||(t[22]=d("span",{class:"text-foreground"},"Active",-1)),s(e(H),{checked:e(a).is_active,"onUpdate:checked":t[6]||(t[6]=r=>e(a).is_active=r)},null,8,["checked"])])])]),d("div",rs,[s(e(h),{variant:"ghost",onClick:t[7]||(t[7]=r=>V.value=!1)},{default:l(()=>[...t[23]||(t[23]=[i("Cancel",-1)])]),_:1}),s(e(h),{disabled:e(a).processing,onClick:Q},{default:l(()=>[e(a).processing?(m(),S(e(ie),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):g("",!0),d("span",null,u(F.value?"Update department":"Add department"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["open"])]),_:1}))}});export{Us as default};
