import{d as j,p as L,C as V,o as p,E as l,H as s,u as e,K as n,P as o,N as M,J as $,R as B,W as f,I as z,a as U,y as J,j as q,X as G,ag as H,O as g,M as _,c as y}from"./app-C0iaHDzA.js";import{F as R,_ as W}from"./AdminLayout.vue_vue_type_script_setup_true_lang-BmWEOCo2.js";import{_ as X}from"./DataTable.vue_vue_type_script_setup_true_lang-CEfx__Lu.js";import{_ as Q}from"./index-CFG1xxFQ.js";import{_ as P}from"./Switch.vue_vue_type_script_setup_true_lang-DjomhfHM.js";import{_ as h}from"./index-B8MfLIKH.js";import{a as Y,b as Z,c as ee,d as E,e as te,f as se}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DouIdNch.js";import{E as re}from"./ellipsis-BlSe0ofw.js";import{P as le}from"./pencil-B9pX0PtW.js";import{T as ae}from"./trash-2-B8kJsJne.js";import{A as T}from"./arrow-up-down-CGn07P3x.js";import{_ as oe,a as ue}from"./CardContent.vue_vue_type_script_setup_true_lang-CvS13D9K.js";import{_ as ne}from"./CardDescription.vue_vue_type_script_setup_true_lang-Cs7UBZQI.js";import{_ as ie,a as de}from"./CardTitle.vue_vue_type_script_setup_true_lang-Dtj1h7eV.js";import{_ as N}from"./Input.vue_vue_type_script_setup_true_lang-BYYS994a.js";import{_ as v}from"./Label.vue_vue_type_script_setup_true_lang-B7f0Rqr2.js";import{_ as b}from"./Textarea.vue_vue_type_script_setup_true_lang-Bs5jiDAg.js";import{_ as F}from"./Checkbox.vue_vue_type_script_setup_true_lang-DU3A86Ze.js";import{_ as me,a as ce}from"./index-DtaXEV0f.js";import{_ as pe}from"./AlertTitle.vue_vue_type_script_setup_true_lang-B86mQtA4.js";import{_ as fe,c as _e,a as ge,b as ye}from"./DialogTitle.vue_vue_type_script_setup_true_lang-CIW5gWx4.js";import{_ as ve}from"./DialogDescription.vue_vue_type_script_setup_true_lang-CjUrEdle.js";import{_ as xe,a as he,b as ke,c as be}from"./AccordionTrigger.vue_vue_type_script_setup_true_lang-CoXZo_Cy.js";import{S as $e}from"./sparkles-DjpFunwX.js";import{P as Se}from"./plus-ByuKSV2l.js";import{L as we}from"./loader-circle-Ckfjc31V.js";import"./UserInfo.vue_vue_type_script_setup_true_lang-XM7CyggX.js";import"./Presence-CRc-3ouu.js";import"./useForwardExpose-CSM5MnWw.js";import"./index-QcnTpKuz.js";import"./DialogTitle-BWlFjS2U.js";import"./x-D8_aAgCu.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-BKMm_IJw.js";import"./VisuallyHidden-DD6JSlZR.js";import"./users-B8oBx9bv.js";import"./chart-column-DJp6om8B.js";import"./index-CfcoRdXz.js";import"./file-text-DreGdZtM.js";import"./list-B_9x6MZm.js";import"./log-out-CMOHZ4dv.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-B1btNCWI.js";import"./search-D6BuuhDa.js";import"./chevron-left-CnXpyzG_.js";import"./chevron-right-CJecl17p.js";import"./useFormControl-DfaHNq9n.js";import"./VisuallyHiddenInput-D_bYS2YG.js";import"./nullish-CHIgUVhi.js";import"./isValueEqualOrExist-DSClXoPv.js";import"./ohash.D__AXeF1-C-E83dC9.js";import"./RovingFocusItem-DukNPlSL.js";import"./minus-Cyw4nabl.js";import"./check--aeEQYMB.js";import"./CollapsibleTrigger-Cnq0roxB.js";import"./chevron-down-IOA8eJLm.js";const Ve=j({__name:"StructureActions",props:{structure:{}},setup(u){const m=u,k=L("onEditFacultyStructure"),S=()=>{confirm(`Delete ${m.structure.faculty_name}? This will also delete chapters/sections.`)&&B.delete($("admin.system.faculty-structures.destroy",{structure:m.structure.id}),{preserveScroll:!0})};return(O,d)=>(p(),V(e(se),null,{default:l(()=>[s(e(Y),{"as-child":""},{default:l(()=>[s(e(h),{variant:"ghost",class:"h-8 w-8 p-0"},{default:l(()=>[d[1]||(d[1]=n("span",{class:"sr-only"},"Open menu",-1)),s(e(re),{class:"h-4 w-4"})]),_:1})]),_:1}),s(e(Z),{align:"end"},{default:l(()=>[s(e(ee),null,{default:l(()=>[...d[2]||(d[2]=[o("Actions",-1)])]),_:1}),s(e(E),{"as-child":""},{default:l(()=>[s(e(M),{href:e($)("admin.system.faculty-structures.show",{structure:m.structure.id})},{default:l(()=>[s(e(R),{class:"mr-2 h-4 w-4"}),d[3]||(d[3]=o(" Manage Chapters ",-1))]),_:1},8,["href"])]),_:1}),s(e(E),{onClick:d[0]||(d[0]=x=>e(k)?.(m.structure))},{default:l(()=>[s(e(le),{class:"mr-2 h-4 w-4"}),d[4]||(d[4]=o(" Edit ",-1))]),_:1}),s(e(te)),s(e(E),{onClick:S,class:"text-rose-600 focus:text-rose-600 focus:bg-rose-50"},{default:l(()=>[s(e(ae),{class:"mr-2 h-4 w-4"}),d[5]||(d[5]=o(" Delete ",-1))]),_:1})]),_:1})]),_:1}))}}),Ce=(u,m)=>{B.put($("admin.system.faculty-structures.toggle-active",{structure:u.id}),{is_active:m},{preserveScroll:!0})},Ue=[{accessorKey:"faculty_name",header:({column:u})=>f(h,{variant:"ghost",class:"-ml-2 text-xs hover:bg-muted/50",onClick:()=>u.toggleSorting(u.getIsSorted()==="asc")},()=>["Faculty",f(T,{class:"ml-2 h-3 w-3"})]),cell:({row:u})=>{const m=u.original;return f("div",{class:"flex flex-col"},[f("span",{class:"font-medium"},m.faculty_name),f("span",{class:"text-xs text-muted-foreground"},m.faculty_slug)])}},{id:"levels",header:"Levels",cell:({row:u})=>{const m=(u.original.academic_levels??[]).slice(0,3);return m.length?f("div",{class:"flex flex-wrap gap-1"},m.map(k=>f(Q,{variant:"outline",class:"capitalize"},()=>k))):f("span",{class:"text-xs text-muted-foreground"},"â€”")}},{accessorKey:"chapters_count",header:({column:u})=>f(h,{variant:"ghost",class:"-ml-2 text-xs hover:bg-muted/50",onClick:()=>u.toggleSorting(u.getIsSorted()==="asc")},()=>["Chapters",f(T,{class:"ml-2 h-3 w-3"})]),cell:({row:u})=>String(u.original.chapters_count??0)},{accessorKey:"sort_order",header:"Order",cell:({row:u})=>u.getValue("sort_order")},{accessorKey:"is_active",header:"Active",cell:({row:u})=>f(P,{checked:!!u.original.is_active,"onUpdate:checked":m=>Ce(u.original,m)})},{id:"actions",cell:({row:u})=>f(Ve,{structure:u.original})}],Ee={class:"grid gap-4 py-4"},Ne={class:"grid gap-4 md:grid-cols-2"},Fe={class:"space-y-1"},Oe={key:0,class:"text-xs text-rose-500"},Ae={class:"space-y-1"},De={key:0,class:"text-xs text-rose-500"},Je={class:"space-y-1"},Te={key:0,class:"text-xs text-rose-500"},je={class:"grid gap-4 md:grid-cols-3"},Be={class:"space-y-1"},Pe={key:0,class:"text-xs text-rose-500"},Ie={class:"flex items-center justify-between rounded-md border border-border/70 bg-muted/30 px-3 py-2 text-sm md:col-span-2"},Ke={class:"space-y-2"},Le={class:"flex flex-wrap gap-4"},Me={class:"flex items-center gap-2 text-sm"},ze={class:"flex items-center gap-2 text-sm"},qe={class:"flex items-center gap-2 text-sm"},Ge={key:0,class:"text-xs text-rose-500"},He={class:"space-y-1"},Re={key:0,class:"text-xs text-rose-500"},We={class:"space-y-1"},Xe={key:0,class:"text-xs text-rose-500"},Qe={class:"space-y-1"},Ye={key:0,class:"text-xs text-rose-500"},Ze={class:"space-y-1"},et={key:0,class:"text-xs text-rose-500"},tt={class:"flex justify-end gap-2"},rs=j({__name:"Index",props:{structures:{}},setup(u){const m=u,k=z(),S=U(()=>k.props.flash),O=U(()=>m.structures??[]),d=J(null),x=J(!1),c=q({undergraduate:!0,masters:!0,phd:!0}),A=()=>({faculty_name:"",faculty_slug:"",description:"",is_active:!0,sort_order:0,academic_levels:[],default_structure:"",chapter_templates:"",guidance_templates:"",terminology:""}),r=G({...A()}),C=U(()=>d.value!==null),D=()=>{d.value=null,r.clearErrors(),Object.assign(r,A()),c.undergraduate=!0,c.masters=!0,c.phd=!0},w=i=>{if(i==null)return"";if(typeof i=="string")return i;try{return JSON.stringify(i,null,2)}catch{return""}},I=()=>{D(),x.value=!0};H("onEditFacultyStructure",i=>{d.value=i.id,r.clearErrors(),r.faculty_name=i.faculty_name??"",r.faculty_slug=i.faculty_slug??"",r.description=i.description??"",r.is_active=!!i.is_active,r.sort_order=Number(i.sort_order??0),r.default_structure=w(i.default_structure),r.chapter_templates=w(i.chapter_templates),r.guidance_templates=w(i.guidance_templates),r.terminology=w(i.terminology);const t=i.academic_levels??[];c.undergraduate=t.includes("undergraduate"),c.masters=t.includes("masters"),c.phd=t.includes("phd"),x.value=!0});const K=()=>{r.clearErrors(),r.transform(t=>({...t,sort_order:Number(t.sort_order??0),is_active:!!t.is_active,academic_levels:[...c.undergraduate?["undergraduate"]:[],...c.masters?["masters"]:[],...c.phd?["phd"]:[]]}));const i={preserveScroll:!0,onSuccess:()=>{x.value=!1,D()}};C.value&&d.value?r.put($("admin.system.faculty-structures.update",{structure:d.value}),i):r.post($("admin.system.faculty-structures.store"),i)};return(i,t)=>(p(),V(W,{title:"Faculty Structures",subtitle:"Control chapter titles, word counts, and sections per faculty."},{default:l(()=>[S.value?.success?(p(),V(e(me),{key:0,class:"mb-6 border border-emerald-500/40 bg-emerald-500/10"},{default:l(()=>[s(e($e),{class:"h-4 w-4 text-emerald-500"}),s(e(pe),null,{default:l(()=>[...t[14]||(t[14]=[o("Updated",-1)])]),_:1}),s(e(ce),null,{default:l(()=>[o(_(S.value.success),1)]),_:1})]),_:1})):g("",!0),s(e(oe),{class:"border border-border/50 bg-card shadow-sm"},{default:l(()=>[s(e(ie),{class:"flex flex-row items-center justify-between pb-3"},{default:l(()=>[n("div",null,[s(e(de),{class:"text-base font-semibold text-foreground"},{default:l(()=>[...t[15]||(t[15]=[o("Structures",-1)])]),_:1}),s(e(ne),null,{default:l(()=>[...t[16]||(t[16]=[o(" These drive `FacultyStructureService` and therefore the chapter structure used for generation. ",-1)])]),_:1})]),s(e(h),{size:"sm",onClick:I},{default:l(()=>[s(e(Se),{class:"mr-2 h-4 w-4"}),t[17]||(t[17]=o(" Add Structure ",-1))]),_:1})]),_:1}),s(e(ue),null,{default:l(()=>[s(X,{columns:e(Ue),data:O.value,"search-key":"faculty_name","search-placeholder":"Filter structures..."},null,8,["columns","data"])]),_:1})]),_:1}),s(e(fe),{open:x.value,"onUpdate:open":t[13]||(t[13]=a=>x.value=a)},{default:l(()=>[s(e(_e),{class:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto"},{default:l(()=>[s(e(ge),null,{default:l(()=>[s(e(ye),null,{default:l(()=>[o(_(C.value?"Edit structure":"Create structure"),1)]),_:1}),s(e(ve),null,{default:l(()=>[...t[18]||(t[18]=[o(" Create a faculty structure, then manage its chapters and sections. ",-1)])]),_:1})]),_:1}),n("div",Ee,[n("div",Ne,[n("div",Fe,[s(e(v),null,{default:l(()=>[...t[19]||(t[19]=[o("Faculty Name",-1)])]),_:1}),s(e(N),{modelValue:e(r).faculty_name,"onUpdate:modelValue":t[0]||(t[0]=a=>e(r).faculty_name=a),placeholder:"Social Sciences"},null,8,["modelValue"]),e(r).errors.faculty_name?(p(),y("p",Oe,_(e(r).errors.faculty_name),1)):g("",!0)]),n("div",Ae,[s(e(v),null,{default:l(()=>[...t[20]||(t[20]=[o("Faculty Slug",-1)])]),_:1}),s(e(N),{modelValue:e(r).faculty_slug,"onUpdate:modelValue":t[1]||(t[1]=a=>e(r).faculty_slug=a),placeholder:"social-sciences"},null,8,["modelValue"]),e(r).errors.faculty_slug?(p(),y("p",De,_(e(r).errors.faculty_slug),1)):g("",!0)])]),n("div",Je,[s(e(v),null,{default:l(()=>[...t[21]||(t[21]=[o("Description",-1)])]),_:1}),s(e(b),{modelValue:e(r).description,"onUpdate:modelValue":t[2]||(t[2]=a=>e(r).description=a),rows:"3",placeholder:"Optional description..."},null,8,["modelValue"]),e(r).errors.description?(p(),y("p",Te,_(e(r).errors.description),1)):g("",!0)]),n("div",je,[n("div",Be,[s(e(v),null,{default:l(()=>[...t[22]||(t[22]=[o("Sort Order",-1)])]),_:1}),s(e(N),{modelValue:e(r).sort_order,"onUpdate:modelValue":t[3]||(t[3]=a=>e(r).sort_order=a),type:"number",min:"0",max:"1000"},null,8,["modelValue"]),e(r).errors.sort_order?(p(),y("p",Pe,_(e(r).errors.sort_order),1)):g("",!0)]),n("label",Ie,[t[23]||(t[23]=n("span",{class:"text-foreground"},"Active",-1)),s(e(P),{checked:e(r).is_active,"onUpdate:checked":t[4]||(t[4]=a=>e(r).is_active=a)},null,8,["checked"])])]),n("div",Ke,[s(e(v),null,{default:l(()=>[...t[24]||(t[24]=[o("Academic Levels",-1)])]),_:1}),n("div",Le,[n("label",Me,[s(e(F),{checked:c.undergraduate,"onUpdate:checked":t[5]||(t[5]=a=>c.undergraduate=a)},null,8,["checked"]),t[25]||(t[25]=o(" Undergraduate ",-1))]),n("label",ze,[s(e(F),{checked:c.masters,"onUpdate:checked":t[6]||(t[6]=a=>c.masters=a)},null,8,["checked"]),t[26]||(t[26]=o(" Masters ",-1))]),n("label",qe,[s(e(F),{checked:c.phd,"onUpdate:checked":t[7]||(t[7]=a=>c.phd=a)},null,8,["checked"]),t[27]||(t[27]=o(" PhD ",-1))])]),e(r).errors.academic_levels?(p(),y("p",Ge,_(e(r).errors.academic_levels),1)):g("",!0)]),s(e(xe),{type:"multiple",class:"w-full"},{default:l(()=>[s(e(he),{value:"advanced"},{default:l(()=>[s(e(ke),null,{default:l(()=>[...t[28]||(t[28]=[o("Advanced JSON (optional)",-1)])]),_:1}),s(e(be),{class:"space-y-4"},{default:l(()=>[n("div",He,[s(e(v),null,{default:l(()=>[...t[29]||(t[29]=[o("Default Structure (JSON)",-1)])]),_:1}),s(e(b),{modelValue:e(r).default_structure,"onUpdate:modelValue":t[8]||(t[8]=a=>e(r).default_structure=a),rows:"6",class:"font-mono text-sm",placeholder:"{}"},null,8,["modelValue"]),e(r).errors.default_structure?(p(),y("p",Re,_(e(r).errors.default_structure),1)):g("",!0)]),n("div",We,[s(e(v),null,{default:l(()=>[...t[30]||(t[30]=[o("Chapter Templates (JSON)",-1)])]),_:1}),s(e(b),{modelValue:e(r).chapter_templates,"onUpdate:modelValue":t[9]||(t[9]=a=>e(r).chapter_templates=a),rows:"6",class:"font-mono text-sm",placeholder:"{}"},null,8,["modelValue"]),e(r).errors.chapter_templates?(p(),y("p",Xe,_(e(r).errors.chapter_templates),1)):g("",!0)]),n("div",Qe,[s(e(v),null,{default:l(()=>[...t[31]||(t[31]=[o("Guidance Templates (JSON)",-1)])]),_:1}),s(e(b),{modelValue:e(r).guidance_templates,"onUpdate:modelValue":t[10]||(t[10]=a=>e(r).guidance_templates=a),rows:"6",class:"font-mono text-sm",placeholder:"{}"},null,8,["modelValue"]),e(r).errors.guidance_templates?(p(),y("p",Ye,_(e(r).errors.guidance_templates),1)):g("",!0)]),n("div",Ze,[s(e(v),null,{default:l(()=>[...t[32]||(t[32]=[o("Terminology (JSON)",-1)])]),_:1}),s(e(b),{modelValue:e(r).terminology,"onUpdate:modelValue":t[11]||(t[11]=a=>e(r).terminology=a),rows:"6",class:"font-mono text-sm",placeholder:"{}"},null,8,["modelValue"]),e(r).errors.terminology?(p(),y("p",et,_(e(r).errors.terminology),1)):g("",!0)])]),_:1})]),_:1})]),_:1})]),n("div",tt,[s(e(h),{variant:"ghost",onClick:t[12]||(t[12]=a=>x.value=!1)},{default:l(()=>[...t[33]||(t[33]=[o("Cancel",-1)])]),_:1}),s(e(h),{disabled:e(r).processing,onClick:K},{default:l(()=>[e(r).processing?(p(),V(e(we),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):g("",!0),n("span",null,_(C.value?"Update structure":"Add structure"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["open"])]),_:1}))}});export{rs as default};
